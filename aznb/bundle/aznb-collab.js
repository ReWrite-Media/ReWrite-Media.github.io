(window.webpackJsonpAzureNotebooks=window.webpackJsonpAzureNotebooks||[]).push([[4],{"../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js":function(e,t,n){"use strict";function r(e,t){if(!e)throw new Error(t)}n.d(t,"a",(function(){return r}))},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/base64Encoding.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/bufferBrowser.js");const o=e=>r.a.from(e,"base64").toString("utf-8"),s=e=>r.a.from(e,"utf8").toString("base64"),i=(e,t)=>{switch(t){case"utf8":case"utf-8":return e;default:return r.a.from(e,t).toString()}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/batchManager.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t=100){this.process=e,this.maxBatchSize=t,this.pendingWork=new Map}add(e,t){this.pendingWork.has(e)||this.pendingWork.set(e,[]),this.pendingWork.get(e).push(t),this.pendingWork.get(e).length>=this.maxBatchSize?(void 0!==this.pendingTimer&&clearTimeout(this.pendingTimer),this.pendingTimer=void 0,this.startWork()):void 0===this.pendingTimer&&(this.pendingTimer=setTimeout(()=>{this.pendingTimer=void 0,this.startWork()},0))}drain(){this.startWork()}startWork(){const e=this.pendingWork;this.pendingWork=new Map;for(const[t,n]of e)this.process(t,n)}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/bufferBrowser.js":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n("../notebook-dds/node_modules/base64-js/index.js");function o(e,t){switch(t){case"base64":return r.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const s=(e,t)=>a.from(e,t).buffer,i=(e,t)=>a.from(e).toString(t);class a extends Uint8Array{toString(e){return o(this,e)}static from(e,t,n){if("string"==typeof e)return a.fromString(e,t);if(e instanceof ArrayBuffer)return a.fromArrayBuffer(e,t,n);throw new TypeError}static fromArrayBuffer(e,t,n){const r=null!=t?t:0,o=null!=n?n:e.byteLength-r;if(r<0||r>e.byteLength||o<0||o+r>e.byteLength)throw new RangeError;return new a(e,r,o)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),n=r.toByteArray(t);return new a(n.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new a(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;return t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!=0&&(t+=["","===","==","="][t.length%4]),t}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/disposal.js":function(e,t,n){"use strict";function r(e,t){return(...n)=>{if(e.disposed)throw new Error("Already disposed");return t(...n)}}n.d(t,"a",(function(){return r}))},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/eventForwarder.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/typedEventEmitter.js");class o extends r.a{constructor(e){if(super(),this.isDisposed=!1,this.forwardingEvents=new Map,void 0!==e){const t=t=>this.unforwardEvent(e,t),n=t=>this.forwardEvent(e,t);this.on(o.removeListenerEvent,t),this.on(o.newListenerEvent,n)}}static isEmitterEvent(e){return e===o.newListenerEvent||e===o.removeListenerEvent}get disposed(){return this.isDisposed}dispose(){this.isDisposed=!0;for(const e of this.forwardingEvents.values())for(const t of e.values())try{t()}catch(e){}this.removeAllListeners(),this.forwardingEvents.clear()}forwardEvent(e,...t){for(const n of t)if(void 0!==e&&void 0!==n&&!o.isEmitterEvent(n)){let t=this.forwardingEvents.get(n);if(void 0===t&&(t=new Map,this.forwardingEvents.set(n,t)),!t.has(e)){const r=(...e)=>this.emit(n,...e);t.set(e,()=>e.off(n,r)),e.on(n,r)}}}unforwardEvent(e,...t){var n;for(const r of t)if(void 0!==r&&!o.isEmitterEvent(r)){const t=this.forwardingEvents.get(r);if((null===(n=t)||void 0===n?void 0:n.has(e))&&0===this.listenerCount(r)){const n=t.get(e);void 0!==n&&n(),t.delete(e),0===t.size&&this.forwardingEvents.delete(r)}}}}o.newListenerEvent="newListener",o.removeListenerEvent="removeListener"},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/hashFileBrowser.js":function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/bufferBrowser.js");let s;function i(e){s=e}async function a(e){if(void 0!==s)return Object(r.a)(void 0===crypto.subtle),s(e);const t=await crypto.subtle.digest("SHA-1",e),n=new Uint8Array(t);return Array.prototype.map.call(n,(function(e){return e.toString(16).padStart(2,"0")})).join("")}async function u(e){const t=`blob ${e.byteLength.toString()}${String.fromCharCode(0)}`;return a(o.a.from(t+e.toString()))}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/heap.js":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r={compare:(e,t)=>e-t,min:Number.MIN_VALUE};class o{constructor(e){this.comp=e,this.L=[{value:e.min,position:0}]}peek(){return this.L[1]}get(){this.swap(1,this.count());const e=this.L.pop();return this.fixdown(1),e.value}add(e){const t={value:e,position:this.L.length};return this.L.push(t),this.fixup(this.count()),t}update(e){const t=e.position;this.isGreaterThanParent(t)?this.fixup(t):this.fixdown(t)}remove(e){const t=e.position;this.swap(e.position,this.L.length-1),this.L.splice(this.L.length-1),t!==this.L.length&&this.update(this.L[t])}count(){return this.L.length-1}fixup(e){let t=e;for(;this.isGreaterThanParent(t);){const e=t>>1;this.swap(t,e),t=e}}isGreaterThanParent(e){return e>1&&this.comp.compare(this.L[e>>1].value,this.L[e].value)>0}fixdown(e){let t=e;for(;t<<1<=this.count();){let e=t<<1;if(e<this.count()&&this.comp.compare(this.L[e].value,this.L[e+1].value)>0&&e++,this.comp.compare(this.L[t].value,this.L[e].value)<=0)break;this.swap(t,e),t=e}}swap(e,t){const n=this.L[e];this.L[e]=this.L[t],this.L[e].position=e,this.L[t]=n,this.L[t].position=t}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"assert",(function(){return r.a})),n.d(t,"Uint8ArrayToString",(function(){return o.b})),n.d(t,"stringToBuffer",(function(){return o.h})),n.d(t,"bufferToString",(function(){return o.c})),n.d(t,"IsoBuffer",(function(){return o.a})),n.d(t,"setInsecureContextHashFn",(function(){return o.g})),n.d(t,"hashFile",(function(){return o.e})),n.d(t,"gitHashFile",(function(){return o.d})),n.d(t,"performance",(function(){return o.f})),n.d(t,"fromBase64ToUtf8",(function(){return s.a})),n.d(t,"fromUtf8ToBase64",(function(){return s.b})),n.d(t,"toUtf8",(function(){return s.c})),n.d(t,"BatchManager",(function(){return i.a})),n.d(t,"doIfNotDisposed",(function(){return a.a})),n.d(t,"EventForwarder",(function(){return u.a})),n.d(t,"NumberComparer",(function(){return c.b})),n.d(t,"Heap",(function(){return c.a})),n.d(t,"BaseTelemetryNullLogger",(function(){return d.a})),n.d(t,"TelemetryNullLogger",(function(){return d.b})),n.d(t,"PromiseCache",(function(){return h})),n.d(t,"Deferred",(function(){return f.a})),n.d(t,"LazyPromise",(function(){return f.b})),n.d(t,"RangeTracker",(function(){return g})),n.d(t,"RateLimiter",(function(){return b})),n.d(t,"safelyParseJSON",(function(){return v})),n.d(t,"Timer",(function(){return y.b})),n.d(t,"PromiseTimer",(function(){return y.a})),n.d(t,"Trace",(function(){return _.a})),n.d(t,"TypedEventEmitter",(function(){return w.a})),n.d(t,"unreachableCase",(function(){return k.a})),n.d(t,"Lazy",(function(){return S.a}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/indexBrowser.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/base64Encoding.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/batchManager.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/disposal.js"),u=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/eventForwarder.js"),c=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/heap.js"),d=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/logger.js");class l{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout(()=>{this.cleanup(e),this.cancel(e)},this.expiry.durationMs))}cancel(e){const t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}class h{constructor({expiry:e={policy:"indefinite"},removeOnError:t=(()=>!0)}={}){this.cache=new Map,this.removeOnError=t,this.gc=new l(e,e=>this.remove(e))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}async addOrGet(e,t){let n=this.get(e);return void 0===n&&(n=(async()=>t())(),this.cache.set(e,n),n.catch(t=>{this.removeOnError(t)&&this.remove(e)}),this.gc.schedule(e)),n}add(e,t){const n=this.has(e);return this.addOrGet(e,t).catch(()=>{}),!n}async addValueOrGet(e,t){return this.addOrGet(e,async()=>t)}addValue(e,t){return this.add(e,async()=>t)}}var f=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/promises.js"),m=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/cloneDeep.js"),p=n.n(m);class g{constructor(e,t){"number"==typeof e?(this.ranges=[{length:0,primary:e,secondary:t}],this.lastPrimary=e,this.lastSecondary=t):(this.ranges=p()(e.ranges),this.lastPrimary=e.lastPrimary,this.lastSecondary=e.lastSecondary)}get base(){return this.ranges[0].primary}get primaryHead(){return this.lastPrimary}get secondaryHead(){return this.lastSecondary}serialize(){return{lastPrimary:this.lastPrimary,lastSecondary:this.lastSecondary,ranges:p()(this.ranges)}}add(e,t){Object(r.a)(e>=this.lastPrimary),void 0!==this.lastSecondary&&Object(r.a)(t>=this.lastSecondary),this.lastPrimary=e,this.lastSecondary=t;const n=this.ranges[this.ranges.length-1],o=n.primary+n.length,s=n.secondary+n.length;t!==s&&(e===o?0===n.length?n.secondary=t:(n.length--,this.ranges.push({length:0,primary:e,secondary:t})):o+1===e&&s+1===t?n.length++:this.ranges.push({length:0,primary:e,secondary:t}))}get(e){Object(r.a)(e>=this.ranges[0].primary);let t=1;for(;t<this.ranges.length&&!(e<this.ranges[t].primary);t++);Object(r.a)(e>=this.ranges[t-1].primary);const n=this.ranges[t-1];return Math.min(e-n.primary,n.length)+n.secondary}updateBase(e){Object(r.a)(e>=this.ranges[0].primary);let t=1;for(;t<this.ranges.length&&!(e<this.ranges[t].primary);t++);Object(r.a)(e>=this.ranges[t-1].primary);const n=this.ranges[t-1],o=e-n.primary;n.secondary=n.secondary+Math.min(o,n.length),n.length=Math.max(n.length-o,0),n.primary=e,this.ranges=t-1>0?this.ranges.slice(t-1):this.ranges,Object(r.a)(e===this.ranges[0].primary)}}class b{constructor(e){this.windowMSec=e,this.requestMap=new Map}filter(e,t){const n=[],r=Date.now();for(const o of t){const t=`${e}/${o}`;if(this.requestMap.has(t)){if(this.requestMap.get(t)+this.windowMSec>r)continue;this.requestMap.set(t,r),n.push(o)}else this.requestMap.set(t,r),n.push(o)}return n}}function v(e){let t;try{t=JSON.parse(e)}catch(e){}return t}var y=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/timer.js"),_=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/trace.js"),w=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/typedEventEmitter.js"),k=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/unreachable.js"),S=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/lazy.js")},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/indexBrowser.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/bufferBrowser.js");n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c})),n.d(t,"h",(function(){return r.d}));var o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/hashFileBrowser.js");n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return o.b})),n.d(t,"g",(function(){return o.c}));var s=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/performanceBrowser.js");n.d(t,"f",(function(){return s.a}))},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/lazy.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/logger.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));class r{send(e){}}class o{send(e){}sendTelemetryEvent(e,t){}sendErrorEvent(e,t){}sendPerformanceEvent(e,t){}logGenericError(e,t){}logException(e,t){}debugAssert(e,t){}shipAssert(e,t){}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/performanceBrowser.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=window.performance},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/promises.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));class r{constructor(){this.completed=!1,this.p=new Promise((e,t)=>{this.res=e,this.rej=t})}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){void 0!==this.res&&(this.completed=!0,this.res(e))}reject(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}class o{constructor(e){this.execute=e}get[Symbol.toStringTag](){return this.getPromise()[Symbol.toStringTag]}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/timer.js":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return i}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/promises.js");class s{constructor(e,t,n=(()=>Date.now())){this.defaultTimeout=e,this.defaultHandler=t,this.getCurrentTick=n}get hasTimer(){return!!this.runningState}start(e=this.defaultTimeout,t=this.defaultHandler){this.startCore(e,t,e)}clear(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}restart(e,t){var n,r;if(this.runningState){const o=null!=e?e:this.runningState.intendedDuration,s=null!==(r=null!=t?t:null===(n=this.runningState.restart)||void 0===n?void 0:n.handler)&&void 0!==r?r:this.runningState.handler,i=this.calculateRemainingTime(this.runningState);o<i?this.start(o,s):o===i?(this.runningState.handler=s,this.runningState.restart=void 0,this.runningState.intendedDuration=o):this.runningState.restart={startTick:this.getCurrentTick(),duration:o,handler:s}}else this.start(e,t)}startCore(e,t,n){this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:n,handler:t,timeout:setTimeout(()=>this.handler(),e)}}handler(){Object(r.a)(!!this.runningState,"Running timer missing handler");const e=this.runningState.restart;if(void 0!==e){const t=this.calculateRemainingTime(e);this.startCore(t,()=>e.handler(),e.duration)}else{const e=this.runningState.handler;this.clear(),e()}}calculateRemainingTime(e){const t=this.getCurrentTick()-e.startTick;return e.duration-t}}class i{constructor(e,t){this.timer=new s(e,()=>this.wrapHandler(t))}get hasTimer(){return this.timer.hasTimer}async start(e,t){return this.clear(),this.deferred=new o.a,this.timer.start(e,t?()=>this.wrapHandler(t):void 0),this.deferred.promise}clear(){this.timer.clear(),this.deferred&&(this.deferred.resolve({timerResult:"cancel"}),this.deferred=void 0)}wrapHandler(e){e(),Object(r.a)(!!this.deferred,"Handler executed without deferred"),this.deferred.resolve({timerResult:"timeout"}),this.deferred=void 0}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/trace.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/performanceBrowser.js");class o{constructor(e){this.startTick=e,this.lastTick=e}static start(){const e=r.a.now();return new o(e)}trace(){const e=r.a.now(),t={totalTimeElapsed:e-this.startTick,duration:e-this.lastTick,tick:e};return this.lastTick=e,t}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/typedEventEmitter.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("./node_modules/events/events.js");class o extends r.EventEmitter{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}},"../notebook-dds/node_modules/@fluidframework/common-utils/lib/unreachable.js":function(e,t,n){"use strict";function r(e,t="Unreachable Case"){throw new Error(t)}n.d(t,"a",(function(){return r}))},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_DataView.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js"),"DataView");e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Hash.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_ListCache.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Map.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js"),"Map");e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_MapCache.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Promise.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js"),"Promise");e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Set.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js"),"Set");e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Stack.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_ListCache.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackClear.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackDelete.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackGet.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackHas.js"),u=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackSet.js");function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=o,c.prototype.delete=s,c.prototype.get=i,c.prototype.has=a,c.prototype.set=u,e.exports=c},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Symbol.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js").Symbol;e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Uint8Array.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js").Uint8Array;e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_WeakMap.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js"),"WeakMap");e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayEach.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayFilter.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,s=[];++n<r;){var i=e[n];t(i,n,e)&&(s[o++]=i)}return s}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayLikeKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseTimes.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isArguments.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isArray.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isBuffer.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isIndex.js"),u=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isTypedArray.js"),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=s(e),d=!n&&o(e),l=!n&&!d&&i(e),h=!n&&!d&&!l&&u(e),f=n||d||l||h,m=f?r(e.length,String):[],p=m.length;for(var g in e)!t&&!c.call(e,g)||f&&("length"==g||l&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,p))||m.push(g);return m}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayPush.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_assignValue.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseAssignValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/eq.js"),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var i=e[t];s.call(e,t)&&o(i,n)&&(void 0!==n||t in e)||r(e,t,n)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_assocIndexOf.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/eq.js");e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseAssign.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/keys.js");e.exports=function(e,t){return e&&r(t,o(t),e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseAssignIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/keysIn.js");e.exports=function(e,t){return e&&r(t,o(t),e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseAssignValue.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_defineProperty.js");e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseClone.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Stack.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayEach.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_assignValue.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseAssign.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseAssignIn.js"),u=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneBuffer.js"),c=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copyArray.js"),d=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copySymbols.js"),l=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copySymbolsIn.js"),h=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getAllKeys.js"),f=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getAllKeysIn.js"),m=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getTag.js"),p=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_initCloneArray.js"),g=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_initCloneByTag.js"),b=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_initCloneObject.js"),v=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isArray.js"),y=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isBuffer.js"),_=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isMap.js"),w=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObject.js"),k=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isSet.js"),S=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/keys.js"),j=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/keysIn.js"),C="[object Arguments]",x="[object Function]",O="[object Object]",E={};E[C]=E["[object Array]"]=E["[object ArrayBuffer]"]=E["[object DataView]"]=E["[object Boolean]"]=E["[object Date]"]=E["[object Float32Array]"]=E["[object Float64Array]"]=E["[object Int8Array]"]=E["[object Int16Array]"]=E["[object Int32Array]"]=E["[object Map]"]=E["[object Number]"]=E[O]=E["[object RegExp]"]=E["[object Set]"]=E["[object String]"]=E["[object Symbol]"]=E["[object Uint8Array]"]=E["[object Uint8ClampedArray]"]=E["[object Uint16Array]"]=E["[object Uint32Array]"]=!0,E["[object Error]"]=E[x]=E["[object WeakMap]"]=!1,e.exports=function e(t,n,I,A,N,T){var F,P=1&n,R=2&n,D=4&n;if(I&&(F=N?I(t,A,N,T):I(t)),void 0!==F)return F;if(!w(t))return t;var M=v(t);if(M){if(F=p(t),!P)return c(t,F)}else{var L=m(t),B=L==x||"[object GeneratorFunction]"==L;if(y(t))return u(t,P);if(L==O||L==C||B&&!N){if(F=R||B?{}:b(t),!P)return R?l(t,a(F,t)):d(t,i(F,t))}else{if(!E[L])return N?t:{};F=g(t,L,P)}}T||(T=new r);var q=T.get(t);if(q)return q;T.set(t,F),k(t)?t.forEach((function(r){F.add(e(r,n,I,r,t,T))})):_(t)&&t.forEach((function(r,o){F.set(o,e(r,n,I,o,t,T))}));var z=M?void 0:(D?R?f:h:R?j:S)(t);return o(z||t,(function(r,o){z&&(r=t[o=r]),s(F,o,e(r,n,I,o,t,T))})),F}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseCreate.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObject.js"),o=Object.create,s=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=s},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseGetAllKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayPush.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isArray.js");e.exports=function(e,t,n){var s=t(e);return o(e)?s:r(s,n(e))}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseGetTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Symbol.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getRawTag.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_objectToString.js"),i=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?o(e):s(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsArguments.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsMap.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Map]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsNative.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isFunction.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isMasked.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObject.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_toSource.js"),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,d=u.toString,l=c.hasOwnProperty,h=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||o(e))&&(r(e)?h:a).test(i(e))}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Set]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isLength.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObjectLike.js"),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&o(e.length)&&!!i[r(e)]}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isPrototype.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nativeKeys.js"),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseKeysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nativeKeysIn.js"),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return s(e);var t=o(e),n=[];for(var a in e)("constructor"!=a||!t&&i.call(e,a))&&n.push(a);return n}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseTimes.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseUnary.js":function(e,t){e.exports=function(e){return function(t){return e(t)}}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneArrayBuffer.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Uint8Array.js");e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneBuffer.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js"),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=s&&s.exports===o?r.Buffer:void 0,a=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneDataView.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneArrayBuffer.js");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneRegExp.js":function(e,t){var n=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneSymbol.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Symbol.js"),o=r?r.prototype:void 0,s=o?o.valueOf:void 0;e.exports=function(e){return s?Object(s.call(e)):{}}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneArrayBuffer.js");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copyArray.js":function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copyObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_assignValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseAssignValue.js");e.exports=function(e,t,n,s){var i=!n;n||(n={});for(var a=-1,u=t.length;++a<u;){var c=t[a],d=s?s(n[c],e[c],c,n,e):void 0;void 0===d&&(d=e[c]),i?o(n,c,d):r(n,c,d)}return n}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copySymbols.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getSymbols.js");e.exports=function(e,t){return r(e,o(e),t)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copySymbolsIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getSymbolsIn.js");e.exports=function(e,t){return r(e,o(e),t)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_coreJsData.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js")["__core-js_shared__"];e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_defineProperty.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getNative.js"),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_freeGlobal.js":function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n("./node_modules/webpack/buildin/global.js"))},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getAllKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseGetAllKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getSymbols.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/keys.js");e.exports=function(e){return r(e,s,o)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getAllKeysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseGetAllKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getSymbolsIn.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/keysIn.js");e.exports=function(e){return r(e,s,o)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getMapData.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isKeyable.js");e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getNative.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsNative.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getValue.js");e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getPrototype.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_overArg.js")(Object.getPrototypeOf,Object);e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getRawTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Symbol.js"),o=Object.prototype,s=o.hasOwnProperty,i=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=s.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[a]=n:delete e[a]),o}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getSymbols.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayFilter.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/stubArray.js"),s=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(e){return null==e?[]:(e=Object(e),r(i(e),(function(t){return s.call(e,t)})))}:o;e.exports=a},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getSymbolsIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayPush.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getSymbols.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/stubArray.js"),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,s(e)),e=o(e);return t}:i;e.exports=a},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_DataView.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Map.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Promise.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Set.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_WeakMap.js"),u=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseGetTag.js"),c=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_toSource.js"),d="[object Map]",l="[object Promise]",h="[object Set]",f="[object WeakMap]",m="[object DataView]",p=c(r),g=c(o),b=c(s),v=c(i),y=c(a),_=u;(r&&_(new r(new ArrayBuffer(1)))!=m||o&&_(new o)!=d||s&&_(s.resolve())!=l||i&&_(new i)!=h||a&&_(new a)!=f)&&(_=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case p:return m;case g:return d;case b:return l;case v:return h;case y:return f}return t}),e.exports=_},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getValue.js":function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nativeCreate.js");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashDelete.js":function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nativeCreate.js"),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nativeCreate.js"),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_hashSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nativeCreate.js");e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_initCloneArray.js":function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_initCloneByTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneArrayBuffer.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneDataView.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneRegExp.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneSymbol.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_cloneTypedArray.js");e.exports=function(e,t,n){var u=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new u(+e);case"[object DataView]":return o(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,n);case"[object Map]":return new u;case"[object Number]":case"[object String]":return new u(e);case"[object RegExp]":return s(e);case"[object Set]":return new u;case"[object Symbol]":return i(e)}}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_initCloneObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseCreate.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isPrototype.js");e.exports=function(e){return"function"!=typeof e.constructor||s(e)?{}:r(o(e))}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isIndex.js":function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isKeyable.js":function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isMasked.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_coreJsData.js"),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_isPrototype.js":function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheClear.js":function(e,t){e.exports=function(){this.__data__=[],this.size=0}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheDelete.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_assocIndexOf.js"),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_assocIndexOf.js");e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_assocIndexOf.js");e.exports=function(e){return r(this.__data__,e)>-1}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_listCacheSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_assocIndexOf.js");e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Hash.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_ListCache.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Map.js");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(s||o),string:new r}}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheDelete.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getMapData.js");e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).get(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).has(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_mapCacheSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getMapData.js");e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nativeCreate.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_getNative.js")(Object,"create");e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nativeKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_overArg.js")(Object.keys,Object);e.exports=r},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nativeKeysIn.js":function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nodeUtil.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_freeGlobal.js"),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=s&&s.exports===o&&r.process,a=function(){try{return s&&s.require&&s.require("util").types||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=a}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_objectToString.js":function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_overArg.js":function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_freeGlobal.js"),o="object"==typeof self&&self&&self.Object===Object&&self,s=r||o||Function("return this")();e.exports=s},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_ListCache.js");e.exports=function(){this.__data__=new r,this.size=0}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackDelete.js":function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackGet.js":function(e,t){e.exports=function(e){return this.__data__.get(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackHas.js":function(e,t){e.exports=function(e){return this.__data__.has(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_stackSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_ListCache.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_Map.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_MapCache.js");e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var i=n.__data__;if(!o||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new s(i)}return n.set(e,t),this.size=n.size,this}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_toSource.js":function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/cloneDeep.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseClone.js");e.exports=function(e){return r(e,5)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/eq.js":function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isArguments.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsArguments.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObjectLike.js"),s=Object.prototype,i=s.hasOwnProperty,a=s.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return o(e)&&i.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isArray.js":function(e,t){var n=Array.isArray;e.exports=n},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isArrayLike.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isFunction.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isLength.js");e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isBuffer.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_root.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/stubFalse.js"),s=t&&!t.nodeType&&t,i=s&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===s?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||o;e.exports=u}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isFunction.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObject.js");e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isLength.js":function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isMap.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsMap.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nodeUtil.js"),i=s&&s.isMap,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObject.js":function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isObjectLike.js":function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsSet.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nodeUtil.js"),i=s&&s.isSet,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseIsTypedArray.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_nodeUtil.js"),i=s&&s.isTypedArray,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/keys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayLikeKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseKeys.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isArrayLike.js");e.exports=function(e){return s(e)?r(e):o(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/keysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_arrayLikeKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/_baseKeysIn.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/isArrayLike.js");e.exports=function(e){return s(e)?r(e,!0):o(e)}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/stubArray.js":function(e,t){e.exports=function(){return[]}},"../notebook-dds/node_modules/@fluidframework/common-utils/node_modules/lodash/stubFalse.js":function(e,t){e.exports=function(){return!1}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Hash.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_ListCache.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Map.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_root.js"),"Map");e.exports=r},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_MapCache.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Stack.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_ListCache.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackClear.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackDelete.js"),i=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackGet.js"),a=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackHas.js"),u=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackSet.js");function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=o,c.prototype.delete=s,c.prototype.get=i,c.prototype.has=a,c.prototype.set=u,e.exports=c},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Symbol.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_root.js").Symbol;e.exports=r},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Uint8Array.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_root.js").Uint8Array;e.exports=r},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_apply.js":function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_arrayLikeKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseTimes.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArguments.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArray.js"),i=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isBuffer.js"),a=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isIndex.js"),u=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isTypedArray.js"),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=s(e),d=!n&&o(e),l=!n&&!d&&i(e),h=!n&&!d&&!l&&u(e),f=n||d||l||h,m=f?r(e.length,String):[],p=m.length;for(var g in e)!t&&!c.call(e,g)||f&&("length"==g||l&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,p))||m.push(g);return m}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assignMergeValue.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseAssignValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/eq.js");e.exports=function(e,t,n){(void 0!==n&&!o(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assignValue.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseAssignValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/eq.js"),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var i=e[t];s.call(e,t)&&o(i,n)&&(void 0!==n||t in e)||r(e,t,n)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assocIndexOf.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/eq.js");e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseAssignValue.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_defineProperty.js");e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseCreate.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObject.js"),o=Object.create,s=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=s},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseFor.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_createBaseFor.js")();e.exports=r},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseGetTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Symbol.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getRawTag.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_objectToString.js"),i=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?o(e):s(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseIsArguments.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseIsNative.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isFunction.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isMasked.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObject.js"),i=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_toSource.js"),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,d=u.toString,l=c.hasOwnProperty,h=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||o(e))&&(r(e)?h:a).test(i(e))}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseIsTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isLength.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObjectLike.js"),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&o(e.length)&&!!i[r(e)]}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseKeysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_nativeKeysIn.js"),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return s(e);var t=o(e),n=[];for(var a in e)("constructor"!=a||!t&&i.call(e,a))&&n.push(a);return n}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseMerge.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Stack.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assignMergeValue.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseFor.js"),i=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseMergeDeep.js"),a=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObject.js"),u=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/keysIn.js"),c=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_safeGet.js");e.exports=function e(t,n,d,l,h){t!==n&&s(n,(function(s,u){if(h||(h=new r),a(s))i(t,n,u,d,e,l,h);else{var f=l?l(c(t,u),s,u+"",t,n,h):void 0;void 0===f&&(f=s),o(t,u,f)}}),u)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseMergeDeep.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assignMergeValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_cloneBuffer.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_cloneTypedArray.js"),i=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_copyArray.js"),a=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_initCloneObject.js"),u=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArguments.js"),c=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArray.js"),d=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArrayLikeObject.js"),l=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isBuffer.js"),h=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isFunction.js"),f=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObject.js"),m=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isPlainObject.js"),p=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isTypedArray.js"),g=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_safeGet.js"),b=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/toPlainObject.js");e.exports=function(e,t,n,v,y,_,w){var k=g(e,n),S=g(t,n),j=w.get(S);if(j)r(e,n,j);else{var C=_?_(k,S,n+"",e,t,w):void 0,x=void 0===C;if(x){var O=c(S),E=!O&&l(S),I=!O&&!E&&p(S);C=S,O||E||I?c(k)?C=k:d(k)?C=i(k):E?(x=!1,C=o(S,!0)):I?(x=!1,C=s(S,!0)):C=[]:m(S)||u(S)?(C=k,u(k)?C=b(k):f(k)&&!h(k)||(C=a(S))):x=!1}x&&(w.set(S,C),y(C,S,v,_,w),w.delete(S)),r(e,n,C)}}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseRest.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/identity.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_overRest.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_setToString.js");e.exports=function(e,t){return s(o(e,t,r),e+"")}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseSetToString.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/constant.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_defineProperty.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/identity.js"),i=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:s;e.exports=i},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseTimes.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseUnary.js":function(e,t){e.exports=function(e){return function(t){return e(t)}}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_cloneArrayBuffer.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Uint8Array.js");e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_cloneBuffer.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_root.js"),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=s&&s.exports===o?r.Buffer:void 0,a=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_cloneTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_cloneArrayBuffer.js");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_copyArray.js":function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_copyObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assignValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseAssignValue.js");e.exports=function(e,t,n,s){var i=!n;n||(n={});for(var a=-1,u=t.length;++a<u;){var c=t[a],d=s?s(n[c],e[c],c,n,e):void 0;void 0===d&&(d=e[c]),i?o(n,c,d):r(n,c,d)}return n}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_coreJsData.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_root.js")["__core-js_shared__"];e.exports=r},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_createAssigner.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseRest.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isIterateeCall.js");e.exports=function(e){return r((function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(s--,i):void 0,a&&o(n[0],n[1],a)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var u=n[r];u&&e(t,u,r,i)}return t}))}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_createBaseFor.js":function(e,t){e.exports=function(e){return function(t,n,r){for(var o=-1,s=Object(t),i=r(t),a=i.length;a--;){var u=i[e?a:++o];if(!1===n(s[u],u,s))break}return t}}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_defineProperty.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getNative.js"),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_freeGlobal.js":function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n("./node_modules/webpack/buildin/global.js"))},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getMapData.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isKeyable.js");e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getNative.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseIsNative.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getValue.js");e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getPrototype.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_overArg.js")(Object.getPrototypeOf,Object);e.exports=r},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getRawTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Symbol.js"),o=Object.prototype,s=o.hasOwnProperty,i=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=s.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[a]=n:delete e[a]),o}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getValue.js":function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_nativeCreate.js");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashDelete.js":function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_nativeCreate.js"),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_nativeCreate.js"),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_hashSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_nativeCreate.js");e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_initCloneObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseCreate.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isPrototype.js");e.exports=function(e){return"function"!=typeof e.constructor||s(e)?{}:r(o(e))}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isIndex.js":function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isIterateeCall.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/eq.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArrayLike.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isIndex.js"),i=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObject.js");e.exports=function(e,t,n){if(!i(n))return!1;var a=typeof t;return!!("number"==a?o(n)&&s(t,n.length):"string"==a&&t in n)&&r(n[t],e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isKeyable.js":function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isMasked.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_coreJsData.js"),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_isPrototype.js":function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheClear.js":function(e,t){e.exports=function(){this.__data__=[],this.size=0}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheDelete.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assocIndexOf.js"),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assocIndexOf.js");e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assocIndexOf.js");e.exports=function(e){return r(this.__data__,e)>-1}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_listCacheSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_assocIndexOf.js");e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Hash.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_ListCache.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Map.js");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(s||o),string:new r}}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheDelete.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getMapData.js");e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).get(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).has(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_mapCacheSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getMapData.js");e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_nativeCreate.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getNative.js")(Object,"create");e.exports=r},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_nativeKeysIn.js":function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_nodeUtil.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_freeGlobal.js"),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=s&&s.exports===o&&r.process,a=function(){try{return s&&s.require&&s.require("util").types||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=a}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_objectToString.js":function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_overArg.js":function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_overRest.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_apply.js"),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var s=arguments,i=-1,a=o(s.length-t,0),u=Array(a);++i<a;)u[i]=s[t+i];i=-1;for(var c=Array(t+1);++i<t;)c[i]=s[i];return c[t]=n(u),r(e,this,c)}}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_root.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_freeGlobal.js"),o="object"==typeof self&&self&&self.Object===Object&&self,s=r||o||Function("return this")();e.exports=s},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_safeGet.js":function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_setToString.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseSetToString.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_shortOut.js")(r);e.exports=o},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_shortOut.js":function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var o=n(),s=16-(o-r);if(r=o,s>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_ListCache.js");e.exports=function(){this.__data__=new r,this.size=0}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackDelete.js":function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackGet.js":function(e,t){e.exports=function(e){return this.__data__.get(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackHas.js":function(e,t){e.exports=function(e){return this.__data__.has(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_stackSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_ListCache.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_Map.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_MapCache.js");e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var i=n.__data__;if(!o||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new s(i)}return n.set(e,t),this.size=n.size,this}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_toSource.js":function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/constant.js":function(e,t){e.exports=function(e){return function(){return e}}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/eq.js":function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/identity.js":function(e,t){e.exports=function(e){return e}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArguments.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseIsArguments.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObjectLike.js"),s=Object.prototype,i=s.hasOwnProperty,a=s.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return o(e)&&i.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArray.js":function(e,t){var n=Array.isArray;e.exports=n},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArrayLike.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isFunction.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isLength.js");e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArrayLikeObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArrayLike.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&r(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isBuffer.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_root.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/stubFalse.js"),s=t&&!t.nodeType&&t,i=s&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===s?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||o;e.exports=u}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isFunction.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObject.js");e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isLength.js":function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObject.js":function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObjectLike.js":function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isPlainObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_getPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isObjectLike.js"),i=Function.prototype,a=Object.prototype,u=i.toString,c=a.hasOwnProperty,d=u.call(Object);e.exports=function(e){if(!s(e)||"[object Object]"!=r(e))return!1;var t=o(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==d}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseIsTypedArray.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_nodeUtil.js"),i=s&&s.isTypedArray,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/keysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_arrayLikeKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseKeysIn.js"),s=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/isArrayLike.js");e.exports=function(e){return s(e)?r(e,!0):o(e)}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/merge.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_baseMerge.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_createAssigner.js")((function(e,t,n){r(e,t,n)}));e.exports=o},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/stubFalse.js":function(e,t){e.exports=function(){return!1}},"../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/toPlainObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/keysIn.js");e.exports=function(e){return r(e,o(e))}},"../notebook-dds/node_modules/@fluidframework/container-runtime-definitions/dist/containerRuntime.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IContainerRuntime=void 0,t.IContainerRuntime="IContainerRuntime"},"../notebook-dds/node_modules/@fluidframework/container-runtime-definitions/dist/containerRuntimeDirtyable.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IContainerRuntimeDirtyable=void 0,t.IContainerRuntimeDirtyable="IContainerRuntimeDirtyable"},"../notebook-dds/node_modules/@fluidframework/container-runtime-definitions/dist/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/container-runtime-definitions/dist/containerRuntime.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/container-runtime-definitions/dist/containerRuntimeDirtyable.js"),t)},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_DataView.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js"),"DataView");e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Hash.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_ListCache.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Map.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js"),"Map");e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_MapCache.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Promise.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js"),"Promise");e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Set.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js"),"Set");e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Stack.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_ListCache.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackClear.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackDelete.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackGet.js"),a=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackHas.js"),u=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackSet.js");function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=o,c.prototype.delete=s,c.prototype.get=i,c.prototype.has=a,c.prototype.set=u,e.exports=c},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Symbol.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js").Symbol;e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Uint8Array.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js").Uint8Array;e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_WeakMap.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js"),"WeakMap");e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayEach.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayFilter.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,s=[];++n<r;){var i=e[n];t(i,n,e)&&(s[o++]=i)}return s}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayLikeKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseTimes.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isArguments.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isArray.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isBuffer.js"),a=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isIndex.js"),u=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isTypedArray.js"),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=s(e),d=!n&&o(e),l=!n&&!d&&i(e),h=!n&&!d&&!l&&u(e),f=n||d||l||h,m=f?r(e.length,String):[],p=m.length;for(var g in e)!t&&!c.call(e,g)||f&&("length"==g||l&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,p))||m.push(g);return m}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayPush.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_assignValue.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseAssignValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/eq.js"),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var i=e[t];s.call(e,t)&&o(i,n)&&(void 0!==n||t in e)||r(e,t,n)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_assocIndexOf.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/eq.js");e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseAssign.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/keys.js");e.exports=function(e,t){return e&&r(t,o(t),e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseAssignIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/keysIn.js");e.exports=function(e,t){return e&&r(t,o(t),e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseAssignValue.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_defineProperty.js");e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseClone.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Stack.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayEach.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_assignValue.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseAssign.js"),a=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseAssignIn.js"),u=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneBuffer.js"),c=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copyArray.js"),d=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copySymbols.js"),l=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copySymbolsIn.js"),h=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getAllKeys.js"),f=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getAllKeysIn.js"),m=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getTag.js"),p=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_initCloneArray.js"),g=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_initCloneByTag.js"),b=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_initCloneObject.js"),v=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isArray.js"),y=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isBuffer.js"),_=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isMap.js"),w=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObject.js"),k=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isSet.js"),S=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/keys.js"),j=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/keysIn.js"),C="[object Arguments]",x="[object Function]",O="[object Object]",E={};E[C]=E["[object Array]"]=E["[object ArrayBuffer]"]=E["[object DataView]"]=E["[object Boolean]"]=E["[object Date]"]=E["[object Float32Array]"]=E["[object Float64Array]"]=E["[object Int8Array]"]=E["[object Int16Array]"]=E["[object Int32Array]"]=E["[object Map]"]=E["[object Number]"]=E[O]=E["[object RegExp]"]=E["[object Set]"]=E["[object String]"]=E["[object Symbol]"]=E["[object Uint8Array]"]=E["[object Uint8ClampedArray]"]=E["[object Uint16Array]"]=E["[object Uint32Array]"]=!0,E["[object Error]"]=E[x]=E["[object WeakMap]"]=!1,e.exports=function e(t,n,I,A,N,T){var F,P=1&n,R=2&n,D=4&n;if(I&&(F=N?I(t,A,N,T):I(t)),void 0!==F)return F;if(!w(t))return t;var M=v(t);if(M){if(F=p(t),!P)return c(t,F)}else{var L=m(t),B=L==x||"[object GeneratorFunction]"==L;if(y(t))return u(t,P);if(L==O||L==C||B&&!N){if(F=R||B?{}:b(t),!P)return R?l(t,a(F,t)):d(t,i(F,t))}else{if(!E[L])return N?t:{};F=g(t,L,P)}}T||(T=new r);var q=T.get(t);if(q)return q;T.set(t,F),k(t)?t.forEach((function(r){F.add(e(r,n,I,r,t,T))})):_(t)&&t.forEach((function(r,o){F.set(o,e(r,n,I,o,t,T))}));var z=M?void 0:(D?R?f:h:R?j:S)(t);return o(z||t,(function(r,o){z&&(r=t[o=r]),s(F,o,e(r,n,I,o,t,T))})),F}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseCreate.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObject.js"),o=Object.create,s=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=s},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseGetAllKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayPush.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isArray.js");e.exports=function(e,t,n){var s=t(e);return o(e)?s:r(s,n(e))}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseGetTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Symbol.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getRawTag.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_objectToString.js"),i=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?o(e):s(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsArguments.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsMap.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Map]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsNative.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isFunction.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isMasked.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObject.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_toSource.js"),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,d=u.toString,l=c.hasOwnProperty,h=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||o(e))&&(r(e)?h:a).test(i(e))}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Set]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isLength.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObjectLike.js"),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&o(e.length)&&!!i[r(e)]}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isPrototype.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nativeKeys.js"),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseKeysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nativeKeysIn.js"),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return s(e);var t=o(e),n=[];for(var a in e)("constructor"!=a||!t&&i.call(e,a))&&n.push(a);return n}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseTimes.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseUnary.js":function(e,t){e.exports=function(e){return function(t){return e(t)}}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneArrayBuffer.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Uint8Array.js");e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneBuffer.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js"),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=s&&s.exports===o?r.Buffer:void 0,a=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneDataView.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneArrayBuffer.js");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneRegExp.js":function(e,t){var n=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneSymbol.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Symbol.js"),o=r?r.prototype:void 0,s=o?o.valueOf:void 0;e.exports=function(e){return s?Object(s.call(e)):{}}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneArrayBuffer.js");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copyArray.js":function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copyObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_assignValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseAssignValue.js");e.exports=function(e,t,n,s){var i=!n;n||(n={});for(var a=-1,u=t.length;++a<u;){var c=t[a],d=s?s(n[c],e[c],c,n,e):void 0;void 0===d&&(d=e[c]),i?o(n,c,d):r(n,c,d)}return n}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copySymbols.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getSymbols.js");e.exports=function(e,t){return r(e,o(e),t)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copySymbolsIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getSymbolsIn.js");e.exports=function(e,t){return r(e,o(e),t)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_coreJsData.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js")["__core-js_shared__"];e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_defineProperty.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getNative.js"),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_freeGlobal.js":function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n("./node_modules/webpack/buildin/global.js"))},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getAllKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseGetAllKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getSymbols.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/keys.js");e.exports=function(e){return r(e,s,o)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getAllKeysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseGetAllKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getSymbolsIn.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/keysIn.js");e.exports=function(e){return r(e,s,o)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getMapData.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isKeyable.js");e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getNative.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsNative.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getValue.js");e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getPrototype.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_overArg.js")(Object.getPrototypeOf,Object);e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getRawTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Symbol.js"),o=Object.prototype,s=o.hasOwnProperty,i=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=s.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[a]=n:delete e[a]),o}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getSymbols.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayFilter.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/stubArray.js"),s=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(e){return null==e?[]:(e=Object(e),r(i(e),(function(t){return s.call(e,t)})))}:o;e.exports=a},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getSymbolsIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayPush.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getSymbols.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/stubArray.js"),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,s(e)),e=o(e);return t}:i;e.exports=a},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_DataView.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Map.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Promise.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Set.js"),a=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_WeakMap.js"),u=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseGetTag.js"),c=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_toSource.js"),d="[object Map]",l="[object Promise]",h="[object Set]",f="[object WeakMap]",m="[object DataView]",p=c(r),g=c(o),b=c(s),v=c(i),y=c(a),_=u;(r&&_(new r(new ArrayBuffer(1)))!=m||o&&_(new o)!=d||s&&_(s.resolve())!=l||i&&_(new i)!=h||a&&_(new a)!=f)&&(_=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case p:return m;case g:return d;case b:return l;case v:return h;case y:return f}return t}),e.exports=_},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getValue.js":function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nativeCreate.js");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashDelete.js":function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nativeCreate.js"),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nativeCreate.js"),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_hashSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nativeCreate.js");e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_initCloneArray.js":function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_initCloneByTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneArrayBuffer.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneDataView.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneRegExp.js"),i=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneSymbol.js"),a=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_cloneTypedArray.js");e.exports=function(e,t,n){var u=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new u(+e);case"[object DataView]":return o(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,n);case"[object Map]":return new u;case"[object Number]":case"[object String]":return new u(e);case"[object RegExp]":return s(e);case"[object Set]":return new u;case"[object Symbol]":return i(e)}}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_initCloneObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseCreate.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isPrototype.js");e.exports=function(e){return"function"!=typeof e.constructor||s(e)?{}:r(o(e))}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isIndex.js":function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isKeyable.js":function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isMasked.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_coreJsData.js"),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_isPrototype.js":function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheClear.js":function(e,t){e.exports=function(){this.__data__=[],this.size=0}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheDelete.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_assocIndexOf.js"),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_assocIndexOf.js");e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_assocIndexOf.js");e.exports=function(e){return r(this.__data__,e)>-1}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_listCacheSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_assocIndexOf.js");e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Hash.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_ListCache.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Map.js");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(s||o),string:new r}}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheDelete.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getMapData.js");e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).get(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).has(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_mapCacheSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getMapData.js");e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nativeCreate.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_getNative.js")(Object,"create");e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nativeKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_overArg.js")(Object.keys,Object);e.exports=r},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nativeKeysIn.js":function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nodeUtil.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_freeGlobal.js"),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=s&&s.exports===o&&r.process,a=function(){try{return s&&s.require&&s.require("util").types||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=a}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_objectToString.js":function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_overArg.js":function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_freeGlobal.js"),o="object"==typeof self&&self&&self.Object===Object&&self,s=r||o||Function("return this")();e.exports=s},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_ListCache.js");e.exports=function(){this.__data__=new r,this.size=0}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackDelete.js":function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackGet.js":function(e,t){e.exports=function(e){return this.__data__.get(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackHas.js":function(e,t){e.exports=function(e){return this.__data__.has(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_stackSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_ListCache.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_Map.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_MapCache.js");e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var i=n.__data__;if(!o||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new s(i)}return n.set(e,t),this.size=n.size,this}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_toSource.js":function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/cloneDeep.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseClone.js");e.exports=function(e){return r(e,5)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/eq.js":function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isArguments.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsArguments.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObjectLike.js"),s=Object.prototype,i=s.hasOwnProperty,a=s.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return o(e)&&i.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isArray.js":function(e,t){var n=Array.isArray;e.exports=n},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isArrayLike.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isFunction.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isLength.js");e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isBuffer.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_root.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/stubFalse.js"),s=t&&!t.nodeType&&t,i=s&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===s?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||o;e.exports=u}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isFunction.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObject.js");e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isLength.js":function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isMap.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsMap.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nodeUtil.js"),i=s&&s.isMap,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObject.js":function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isObjectLike.js":function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsSet.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nodeUtil.js"),i=s&&s.isSet,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseIsTypedArray.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_nodeUtil.js"),i=s&&s.isTypedArray,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/keys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayLikeKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseKeys.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isArrayLike.js");e.exports=function(e){return s(e)?r(e):o(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/keysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_arrayLikeKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/_baseKeysIn.js"),s=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/isArrayLike.js");e.exports=function(e){return s(e)?r(e,!0):o(e)}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/stubArray.js":function(e,t){e.exports=function(){return[]}},"../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/stubFalse.js":function(e,t){e.exports=function(){return!1}},"../notebook-dds/node_modules/@fluidframework/driver-base/lib/documentDeltaConnection.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/typedEventEmitter.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/batchManager.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js"),i=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/network.js"),a=n("../notebook-dds/node_modules/debug/src/browser.js");const u=n.n(a)()("fluid:socket-storage-shared");u("Package: @fluidframework/driver-base - Version: 0.34.1");class c extends r.a{constructor(e,t,n){super(),this.socket=e,this.documentId=t,this.logger=n,this.queuedMessages=[],this.queuedSignals=[],this.earlyOpHandlerAttached=!1,this.connectionListeners=[],this.trackedListeners=[],this.closed=!1,this.earlyOpHandler=(e,t)=>{u("Queued early ops",t.length),this.queuedMessages.push(...t)},this.earlySignalHandler=e=>{u("Queued early signals"),this.queuedSignals.push(e)},this.submitManager=new o.a((e,t)=>{this.closed||this.socket.emit(e,this.clientId,t)}),this.on("newListener",(e,t)=>{if(!c.eventsToForward.includes(e))throw new Error("DocumentDeltaConnection: Registering for unknown event: "+e);this.closed||"error"===e||0!==this.listeners(e).length||this.addTrackedListener(e,(...t)=>{this.emit(e,...t)})})}get hasDetails(){return!!this._details}get details(){if(!this._details)throw new Error("Internal error: calling method before _details is initialized!");return this._details}get clientId(){return this.details.clientId}get mode(){return this.details.mode}get claims(){return this.details.claims}get existing(){return this.details.existing}get maxMessageSize(){return this.details.maxMessageSize}get version(){return this.details.version}get serviceConfiguration(){return this.details.serviceConfiguration}get initialMessages(){return Object(s.a)(this.earlyOpHandlerAttached,"Potentially missed initial messages"),Object(s.a)(0!==this.listeners("op").length,"No op handler is setup!"),this.removeEarlyOpHandler(),this.queuedMessages.length>0&&(this.details.initialMessages.push(...this.queuedMessages),this.details.initialMessages.sort((e,t)=>e.sequenceNumber-t.sequenceNumber),this.queuedMessages.length=0),this.details.initialMessages}get initialSignals(){return Object(s.a)(0!==this.listeners("signal").length,"No signal handler is setup!"),this.removeEarlySignalHandler(),this.queuedSignals.length>0&&(this.details.initialSignals.push(...this.queuedSignals),this.queuedSignals.length=0),this.details.initialSignals}get initialClients(){return this.details.initialClients}submit(e){this.submitManager.add("submitOp",e)}submitSignal(e){this.submitManager.add("submitSignal",[e])}close(){this.closeCore(!1,Object(i.h)("client closing connection",!0))}closeCore(e,t){this.closed?this.logger.sendErrorEvent({eventName:"DoubleClose",connectionEvents:this.connectionListeners.length,trackedEvents:this.trackedListeners.length,socketProtocolError:e},t):(this.closed=!0,this.removeTrackedListeners(),this.disconnect(e,t))}disconnect(e,t){this.socket.disconnect()}async initialize(e,t){this.socket.on("op",this.earlyOpHandler),this.socket.on("signal",this.earlySignalHandler),this.earlyOpHandlerAttached=!0;let n=!1;this._details=await new Promise((r,o)=>{const s=(e,t)=>{n||this.closeCore(e,t),o(t)};this.addConnectionListener("connect_error",e=>{s(!0,this.createErrorObject("connect_error",e))}),this.addConnectionListener("connect_timeout",()=>{s(!0,this.createErrorObject("connect_timeout"))}),this.addConnectionListener("disconnect",e=>{s(!0,this.createErrorObject("disconnect",e))}),this.addConnectionListener("connect_document_success",t=>{void 0!==e.nonce&&void 0!==t.nonce&&t.nonce!==e.nonce||(this.checkpointSequenceNumber=t.checkpointSequenceNumber,this.removeConnectionListeners(),r(t),n=!0)}),this.addTrackedListener("error",e=>{const t=this.createErrorObject("error",e,"Invalid namespace"!==e);this.emit("error",t),s(!0,t)}),this.addConnectionListener("connect_document_error",t=>{void 0!==e.nonce&&void 0!==t.nonce&&t.nonce!==e.nonce||s(!1,this.createErrorObject("connect_document_error",t))}),this.socket.emit("connect_document",e),this.socketConnectionTimeout=setTimeout(()=>{s(!1,this.createErrorObject("Timeout waiting for handshake from ordering service"))},t+2e3)})}removeEarlyOpHandler(){this.socket.removeListener("op",this.earlyOpHandler),this.earlyOpHandlerAttached=!1}removeEarlySignalHandler(){this.socket.removeListener("signal",this.earlySignalHandler)}addConnectionListener(e,t){this.socket.on(e,t),this.connectionListeners.push({event:e,listener:t})}addTrackedListener(e,t){this.socket.on(e,t),this.trackedListeners.push({event:e,listener:t})}removeTrackedListeners(){for(const{event:e,listener:t}of this.trackedListeners)this.socket.off(e,t);this.removeConnectionListeners(),this.removeEarlyOpHandler(),this.removeEarlySignalHandler(),this.trackedListeners=[]}removeConnectionListeners(){clearTimeout(this.socketConnectionTimeout);for(const{event:e,listener:t}of this.connectionListeners)this.socket.off(e,t);this.connectionListeners=[]}createErrorObject(e,t,n=!0){let r="socket.io: "+e;return"string"==typeof t&&(r=`${r}: ${t}`),Object(i.h)(r,n)}}c.eventsToForward=["nack","disconnect","op","signal","pong","error"]},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/blobCacheStorageService.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/bufferBrowser.js"),o=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/documentStorageServiceProxy.js");class s extends o.a{constructor(e,t){super(e),this.blobs=t}async read(e){const t=this.blobs.get(e);return void 0!==t?t:this.internalStorageService.read(e)}async readBlob(e){const t=this.blobs.get(e);return void 0!==t?Object(r.d)(t,"base64"):this.internalStorageService.readBlob(e)}}},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/buildSnapshotTree.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/bufferBrowser.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/storage.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/blobs.js"),a=n("../notebook-dds/node_modules/uuid/dist/esm-browser/v4.js");function u(e,t,n){const i=[];for(const c of t){const t=`${e}${c.path}`;if(c.type===s.b.Blob){const e=c.value,o=r.a.from(e.contents,e.encoding),u=Object(a.a)();n.set(u,o.toString("base64"));const d={mode:s.a[c.mode],path:t,sha:u,size:o.length,type:"blob",url:""};i.push(d)}else if(c.type===s.b.Commit){const e={mode:s.a[c.mode],path:t,sha:c.value,size:-1,type:"commit",url:""};i.push(e)}else{Object(o.a)(c.type===s.b.Tree);const e=c.value,r={mode:s.a[c.mode],path:t,sha:"",size:-1,type:"tree",url:""};i.push(r);const a=u(t+"/",e.entries,n);i.push(...a)}}return i}function c(e,t){const n=function(e,t){return{sha:"",tree:u("",e,t),url:""}}(e,t);return Object(i.f)(n)}},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/documentStorageServiceProxy.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this.internalStorageService=e}get repositoryUrl(){return this.internalStorageService.repositoryUrl}async getSnapshotTree(e){return this.internalStorageService.getSnapshotTree(e)}async getVersions(e,t){return this.internalStorageService.getVersions(e,t)}async read(e){return this.internalStorageService.read(e)}async write(e,t,n,r){return this.internalStorageService.write(e,t,n,r)}async uploadSummaryWithContext(e,t){return this.internalStorageService.uploadSummaryWithContext(e,t)}async downloadSummary(e){return this.internalStorageService.downloadSummary(e)}async createBlob(e){return this.internalStorageService.createBlob(e)}async readBlob(e){return this.internalStorageService.readBlob(e)}}},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/fluidResolvedUrl.js":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r=e=>"fluid"===(null==e?void 0:e.type);function o(e){if(!r(e))throw new Error("resolved is not a Fluid url. Type: "+(null==e?void 0:e.type))}},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/index.js":function(e,t,n){"use strict";n.r(t);var r=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/blobCacheStorageService.js");n.d(t,"BlobCacheStorageService",(function(){return r.a}));var o=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/buildSnapshotTree.js");n.d(t,"buildSnapshotTree",(function(){return o.a}));var s=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/documentStorageServiceProxy.js");n.d(t,"DocumentStorageServiceProxy",(function(){return s.a}));var i=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/multiDocumentServiceFactory.js");n.d(t,"MultiDocumentServiceFactory",(function(){return i.a}));var a=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/multiUrlResolver.js");n.d(t,"configurableUrlResolver",(function(){return a.b})),n.d(t,"MultiUrlResolver",(function(){return a.a}));var u=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/network.js");n.d(t,"OnlineStatus",(function(){return u.e})),n.d(t,"isOnline",(function(){return u.j})),n.d(t,"GenericNetworkError",(function(){return u.b})),n.d(t,"AuthorizationError",(function(){return u.a})),n.d(t,"NetworkErrorBasic",(function(){return u.c})),n.d(t,"NonRetryableError",(function(){return u.d})),n.d(t,"ThrottlingError",(function(){return u.f})),n.d(t,"createWriteError",(function(){return u.i})),n.d(t,"createGenericNetworkError",(function(){return u.h})),n.d(t,"canRetryOnError",(function(){return u.g}));var c=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/readAndParse.js");n.d(t,"readAndParse",(function(){return c.a})),n.d(t,"readAndParseFromBlobs",(function(){return c.b}));var d=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/fluidResolvedUrl.js");n.d(t,"isFluidResolvedUrl",(function(){return d.b})),n.d(t,"ensureFluidResolvedUrl",(function(){return d.a}));var l=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/summaryForCreateNew.js");n.d(t,"combineAppAndProtocolSummary",(function(){return l.a})),n.d(t,"getDocAttributesFromProtocolSummary",(function(){return l.b})),n.d(t,"getQuorumValuesFromProtocolSummary",(function(){return l.c}))},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/multiDocumentServiceFactory.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("./node_modules/url/url.js"),o=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/fluidResolvedUrl.js");class s{constructor(e){this.protocolName="none:",this.protocolToDocumentFactoryMap=new Map,e.forEach(e=>{this.protocolToDocumentFactoryMap.set(e.protocolName,e)})}static create(e){if(Array.isArray(e)){const t=[];return e.forEach(e=>{const n=e;void 0!==n.protocolToDocumentFactoryMap?t.push(...n.protocolToDocumentFactoryMap.values()):t.push(e)}),1===t.length?t[0]:new s(t)}return e}async createDocumentService(e,t){Object(o.a)(e);const n=Object(r.parse)(e.url);if(void 0===n.protocol)throw new Error("No protocol provided");const s=this.protocolToDocumentFactoryMap.get(n.protocol);if(void 0===s)throw new Error("Unknown Fluid protocol");return s.createDocumentService(e,t)}async createContainer(e,t,n){Object(o.a)(t);const s=Object(r.parse)(t.url);if(void 0===s.protocol)throw new Error("No protocol provided");const i=this.protocolToDocumentFactoryMap.get(s.protocol);if(void 0===i)throw new Error("Unknown Fluid protocol");return i.createContainer(e,t,n)}}},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/multiUrlResolver.js":function(e,t,n){"use strict";async function r(e,t){const n=t.url;let r;for(const t of e)if(r=await t.resolve({url:n}),void 0!==r)return r}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));class o{constructor(e){this.urlResolvers=e}static create(e){return Array.isArray(e)?1===e.length?e[0]:new o(e):e}async resolve(e){return r(this.urlResolvers,e)}async getAbsoluteUrl(e,t){throw new Error("Not implmented")}}},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/network.js":function(e,t,n){"use strict";var r;n.d(t,"e",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return h})),n.d(t,"h",(function(){return f})),n.d(t,"g",(function(){return m})),function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.incorrectServerResponse="incorrectServerResponse"}(r||(r={}));var o,s=n("../notebook-dds/node_modules/@fluidframework/telemetry-utils/lib/logger.js");function i(){return"object"==typeof navigator&&null!==navigator&&"boolean"==typeof navigator.onLine?navigator.onLine?o.Online:o.Offline:o.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(o||(o={}));class a extends s.b{constructor(e,t,n){super(e,{statusCode:n}),this.canRetry=t,this.errorType=r.genericNetworkError}}class u extends s.b{constructor(e,t,n){super(e,{statusCode:n}),this.claims=t,this.errorType=r.authorizationError,this.canRetry=!1}}class c extends s.b{constructor(e,t,n,r){super(e,{statusCode:r}),this.errorType=t,this.canRetry=n}}class d extends c{constructor(e,t,n){super(e,t,!1,n),this.errorType=t}}class l extends s.b{constructor(e,t,n){super(e,{statusCode:n}),this.retryAfterSeconds=t,this.errorType=r.throttlingError,this.canRetry=!0}}const h=e=>new d(e,r.writeError,void 0);function f(e,t,n,r){return void 0!==n&&t?new l(e,n,r):new a(e,t,r)}const m=e=>!0===(null==e?void 0:e.canRetry)},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/readAndParse.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/base64Encoding.js");async function o(e,t){const n=await e.read(t),o=Object(r.a)(n);return JSON.parse(o)}function s(e,t){const n=e[t],o=Object(r.a)(n);return JSON.parse(o)}},"../notebook-dds/node_modules/@fluidframework/driver-utils/lib/summaryForCreateNew.js":function(e,t,n){"use strict";function r(e,t){return{type:1,tree:{".protocol":t,".app":e}}}function o(e){var t;const n=e.tree.attributes,r=JSON.parse(n.content);return r.term=null!==(t=r.term)&&void 0!==t?t:1,r}function s(e){const t=e.tree.quorumValues;return JSON.parse(t.content)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}))},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/auth.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUser=t.generateToken=void 0;const r=n("../notebook-dds/node_modules/jsrsasign/lib/jsrsasign.js"),o=n("../notebook-dds/node_modules/uuid/dist/esm-browser/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/index.js");function i(){return{id:o.v4(),name:s.getRandomName(" ",!0)}}t.generateToken=function(e,t,n,o,s,a=3600,u="1.0"){""!==(s=s||i()).id&&void 0!==s.id||(s=i());const c=Math.round((new Date).getTime()/1e3),d={documentId:t,scopes:o,tenantId:e,user:s,iat:c,exp:c+a,ver:u},l={utf8:n};return r.KJUR.jws.JWS.sign(null,JSON.stringify({alg:"HS256",typ:"JWT"}),d,l)},t.generateUser=i},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/debug.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0;const o=r(n("../notebook-dds/node_modules/debug/src/browser.js")),s=n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/packageVersion.js");t.debug=o.default("fluid:local-driver"),t.debug(`Package: ${s.pkgName} - Version: ${s.pkgVersion}`)},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/localDeltaStorageService.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/localDocumentDeltaConnection.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/localDocumentService.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/localDocumentServiceFactory.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/localResolver.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/localSessionStorageDb.js"),t)},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/localDeltaStorageService.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalDeltaStorageService=void 0,t.LocalDeltaStorageService=class{constructor(e,t,n){this.tenantId=e,this.id=t,this.databaseManager=n}async get(e,t){const n={documentId:this.id,tenantId:this.tenantId,"operation.sequenceNumber":{}};n["operation.sequenceNumber"].$gt=e,n["operation.sequenceNumber"].$lt=t;const r=await this.databaseManager.getDeltaCollection(this.tenantId,this.id);return{messages:(await r.find(n,{"operation.sequenceNumber":1})).map(e=>e.operation),partialResult:!1}}}},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/localDocumentDeltaConnection.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalDocumentDeltaConnection=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/debug.js"),i=["^0.3.0","^0.2.0","^0.1.0"];class a extends r.TypedEventEmitter{constructor(e,t,n){super(),this.socket=e,this.documentId=t,this.details=n,this.subscribedEvents=new Set,this.submitManager=new r.BatchManager((e,t)=>{this.socket.emit(e,this.details.clientId,t,e=>{e&&s.debug("Emit error",e)})}),this.on("newListener",(e,t)=>{this.subscribedEvents.has(e)||(this.subscribedEvents.add(e),this.socket.on(e,(...t)=>{this.emit(e,...t)}))})}static async create(e,t,n,r,o){const u=o.createConnection(),c={client:r,id:t,mode:r.mode,tenantId:e,token:n,versions:i},d=await new Promise((e,t)=>{const n=[],r=[],o=(e,t)=>{s.debug("Queued early ops",t.length),n.push(...t)};u.on("op",o);const i=e=>{s.debug("Queued early signals"),r.push(e)};u.on("signal",i),u.on("connect_error",e=>{t(e)}),u.on("connect_document_success",t=>{u.removeListener("op",o),u.removeListener("signal",i),n.length>0&&(t.initialMessages.push(...n),t.initialMessages.sort((e,t)=>e.sequenceNumber-t.sequenceNumber)),r.length>0&&t.initialSignals.push(...r),e(t)}),u.on("connect_document_error",t),u.emit("connect_document",c)}),l=new a(u,t,d);return Promise.resolve(l)}get clientId(){return this.details.clientId}get mode(){return this.details.mode}get claims(){return this.details.claims}get existing(){return this.details.existing}get maxMessageSize(){return this.details.maxMessageSize}get initialMessages(){return this.details.initialMessages}get initialSignals(){return this.details.initialSignals}get initialClients(){return this.details.initialClients}get version(){return i[0]}get serviceConfiguration(){return this.details.serviceConfiguration}submit(e){Promise.resolve().then(()=>{this.submitManager.add("submitOp",e),this.submitManager.drain()})}submitSignal(e){this.submitManager.add("submitSignal",e),this.submitManager.drain()}close(){this.disconnectClient("client close")}disconnectClient(e){this.socket.emit("disconnect",e)}nackClient(e=400,t=o.NackErrorType.ThrottlingError,n){const r={operation:void 0,sequenceNumber:-1,content:{code:e,type:t,message:n}};this.socket.emit("nack","",[r])}}t.LocalDocumentDeltaConnection=a},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/localDocumentService.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalDocumentService=t.LocalDocumentService=void 0;const i=s(n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/index.js")),a=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/index.js"),u=n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/index.js"),c=n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/index.js");class d{constructor(e,t,n,r,o,s,i){this.resolvedUrl=e,this.localDeltaConnectionServer=t,this.tokenProvider=n,this.tenantId=r,this.documentId=o,this.documentDeltaConnectionsMap=s,this.innerDocumentService=i}async connectToStorage(){return new i.DocumentStorageService(this.documentId,new a.GitManager(new u.TestHistorian(this.localDeltaConnectionServer.testDbFactory.testDatabase)))}async connectToDeltaStorage(){return this.innerDocumentService?this.innerDocumentService.connectToDeltaStorage():new c.LocalDeltaStorageService(this.tenantId,this.documentId,this.localDeltaConnectionServer.databaseManager)}async connectToDeltaStream(e){if(this.innerDocumentService)return this.innerDocumentService.connectToDeltaStream(e);const t=await this.tokenProvider.fetchOrdererToken(this.tenantId,this.documentId),n=await c.LocalDocumentDeltaConnection.create(this.tenantId,this.documentId,t.jwt,e,this.localDeltaConnectionServer.webSocketServer),r=n.clientId;return this.documentDeltaConnectionsMap.set(r,n),n.on("disconnect",()=>{this.documentDeltaConnectionsMap.delete(r)}),n}getErrorTrackingService(){return null}}t.LocalDocumentService=d,t.createLocalDocumentService=function(e,t,n,r,o,s,i){return new d(e,t,n,r,o,s,i)}},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/localDocumentServiceFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalDocumentServiceFactory=void 0;const r=n("./node_modules/url/url.js"),o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/index.js"),i=n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/localDocumentService.js");t.LocalDocumentServiceFactory=class{constructor(e,t){this.localDeltaConnectionServer=e,this.innerDocumentService=t,this.protocolName="fluid-test:",this.documentDeltaConnectionsMap=new Map}async createContainer(e,t,n){var r;s.ensureFluidResolvedUrl(t);const o=new URL(t.url).pathname.split("/"),i=o[o.length-2],a=o[o.length-1];if(!this.localDeltaConnectionServer)throw new Error("Provide the localDeltaConnectionServer!!");const u=this.localDeltaConnectionServer.documentStorage,c=e.tree[".protocol"],d=e.tree[".app"];if(!c||!d)throw new Error("Protocol and App Summary required in the full summary");const l=s.getDocAttributesFromProtocolSummary(c),h=s.getQuorumValuesFromProtocolSummary(c),f=l.sequenceNumber;return await u.createDocument(i,a,d,f,null!==(r=l.term)&&void 0!==r?r:1,h),this.createDocumentService(t,n)}async createDocumentService(e,t){s.ensureFluidResolvedUrl(e);const n=r.parse(e.url),[,a,u]=n.path?n.path.split("/"):[];if(!u||!a)throw new Error(`Couldn't parse resolved url. [documentId:${u}][tenantId:${a}]`);const c=e.tokens.jwt;if(!c)throw new Error("Token was not provided.");const d=new o.DefaultTokenProvider(c);return i.createLocalDocumentService(e,this.localDeltaConnectionServer,d,a,u,this.documentDeltaConnectionsMap,this.innerDocumentService)}disconnectClient(e,t){if(!this.documentDeltaConnectionsMap.has(e))throw new Error("No client with the id: "+e);this.documentDeltaConnectionsMap.get(e).disconnectClient(t)}nackClient(e,t,n,r){if(!this.documentDeltaConnectionsMap.has(e))throw new Error("No client with the id: "+e);this.documentDeltaConnectionsMap.get(e).nackClient(t,n,r)}}},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/localResolver.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalResolver=t.createLocalResolverCreateNewRequest=void 0;const r=n("./node_modules/url/url.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/local-driver/node_modules/@fluidframework/driver-definitions/lib/index.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/auth.js");function u(e){return{url:"http://localhost:3000/"+e,headers:{[s.DriverHeader.createNew]:!0}}}t.createLocalResolverCreateNewRequest=u,t.LocalResolver=class{constructor(){this.tenantId="tenantId",this.tokenKey="tokenKey"}async resolve(e){const t=new URL(e.url).pathname.substr(1),n=t.split("/")[0],r=[i.ScopeType.DocRead,i.ScopeType.DocWrite,i.ScopeType.SummaryWrite];return{endpoints:{deltaStorageUrl:`http://localhost:3000/deltas/${this.tenantId}/${n}`,ordererUrl:"http://localhost:3000",storageUrl:"http://localhost:3000/repos/"+this.tenantId},tokens:{jwt:a.generateToken(this.tenantId,n,this.tokenKey,r)},type:"fluid",url:`fluid-test://localhost:3000/${this.tenantId}/${t}`}}async getAbsoluteUrl(e,t){let n=t;n.startsWith("/")&&(n=n.substr(1));const s=e,i=r.parse(s.url);if(void 0===i.pathname)throw new Error("Url should contain tenant and docId!!");const[,,a]=i.pathname.split("/");return o.assert(!!a,"The resolvedUrl must have a documentId"),`http://localhost:3000/${a}/${n}`}createCreateNewRequest(e){return u(e)}}},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/localSessionStorageDb.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalSessionStorageDbFactory=void 0;const r=n("./node_modules/events/events.js"),o=n("../notebook-dds/node_modules/uuid/dist/esm-browser/index.js");class s{constructor(e,t){this.collectionName=`${e}-${t}`}async find(e,t){function n(e,t){const n=t.split(".");let r=e;return n.forEach(e=>{r=r[e]}),r}const r=Object.keys(e);let o=this.getAllInternal();return r.forEach(t=>{e[t]&&(e[t].$gt>0||e[t].$lt>0?(e[t].$gt>0&&(o=o.filter(r=>n(r,t)>e[t].$gt)),e[t].$lt>0&&(o=o.filter(r=>n(r,t)<e[t].$lt))):o=o.filter(r=>n(r,t)===e[t]))}),t&&1===Object.keys(t).length&&(o=o.sort((function(e,r){const o=Object.keys(t)[0];return 1===t[o]?n(e,o)-n(r,o):n(r,o)-n(e,o)}))),o}async findAll(){return Promise.resolve(this.getAllInternal())}async findOne(e){return Promise.resolve(this.findOneInternal(e))}async update(e,t,n){const r=this.findOneInternal(e);if(!r)throw new Error("Not found");for(const e of Object.keys(t))r[e]=t[e];this.insertInternal(r)}async upsert(e,t,n){const r=this.findOneInternal(e);if(r){for(const e of Object.keys(t))r[e]=t[e];this.insertInternal(r)}else this.insertInternal(t)}async insertOne(e){const t=this.findOneInternal(e);if(t){if(JSON.stringify(t)===JSON.stringify(e))return;throw new Error("Existing Object!!")}return this.insertInternal(e)}async findOrCreate(e,t){const n=this.findOneInternal(e);return n?{value:n,existing:!0}:(this.insertInternal(t),{value:t,existing:!1})}async insertMany(e,t){this.insertInternal(...e)}async deleteOne(e){throw new Error("Method not implemented.")}async deleteMany(e){throw new Error("Method not implemented.")}async createIndex(e,t){throw new Error("Method not implemented.")}getAllInternal(){const e=[];for(let t=0;t<sessionStorage.length;t++){const n=sessionStorage.key(t);n.startsWith(this.collectionName)&&e.push(JSON.parse(sessionStorage.getItem(n)))}return e}insertInternal(...e){for(const t of e)t&&(t._id||(t._id=o.v4()),sessionStorage.setItem(`${this.collectionName}-${t._id}`,JSON.stringify(t)))}findOneInternal(e){if(e._id){const t=sessionStorage.getItem(`${this.collectionName}-${e._id}`);if(t)return JSON.parse(t)}else{const t=Object.keys(e);for(let n=0;n<sessionStorage.length;n++){const r=sessionStorage.key(n);if(!r.startsWith(this.collectionName))continue;const o=JSON.parse(sessionStorage.getItem(r));for(const n of t)o[n],e[n];return o}}return null}}class i extends r.EventEmitter{constructor(e){super(),this.namespace=e,this.collections=new Map}async close(){return Promise.resolve()}collection(e){return this.collections.has(e)||this.collections.set(e,new s(this.namespace+"-db",e)),this.collections.get(e)}}t.LocalSessionStorageDbFactory=class{constructor(e){this.testDatabase=new i(e)}async connect(){return Promise.resolve(this.testDatabase)}}},"../notebook-dds/node_modules/@fluidframework/local-driver/dist/packageVersion.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pkgVersion=t.pkgName=void 0,t.pkgName="@fluidframework/local-driver",t.pkgVersion="0.34.1"},"../notebook-dds/node_modules/@fluidframework/local-driver/node_modules/@fluidframework/driver-definitions/lib/index.js":function(e,t,n){"use strict";var r,o,s;n.r(t),n.d(t,"DriverErrorType",(function(){return r})),n.d(t,"LoaderCachingPolicy",(function(){return o})),n.d(t,"DriverHeader",(function(){return s})),function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.incorrectServerResponse="incorrectServerResponse"}(r||(r={})),function(e){e[e.NoCaching=0]="NoCaching",e[e.Prefetch=1]="Prefetch"}(o||(o={})),function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(s||(s={}))},"../notebook-dds/node_modules/@fluidframework/protocol-base/lib/blobs.js":function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return h}));var r=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/storage.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/unreachable.js");function s(e){const t=3===e.type?e.handleType:e.type;switch(t){case 2:case 4:return r.a.File;case 1:return r.a.Directory;default:Object(o.a)(t,"Unknown type: "+t)}}function i(e){const t=3===e.type?e.handleType:e.type;switch(t){case 2:case 4:return"blob";case 1:return"tree";default:Object(o.a)(t,"Unknown type: "+t)}}function a(e,t=new Map){const n={},r={id:e.sha,blobs:{},commits:{},trees:{}};n[""]=r;for(const r of e.tree){const e=r.path.lastIndexOf("/"),o=r.path.slice(0,Math.max(0,e)),s=r.path.slice(e+1),i=n[o];if("tree"===r.type){const e={id:r.sha,blobs:{},commits:{},trees:{}};i.trees[decodeURIComponent(s)]=e,n[r.path]=e}else"blob"===r.type?(i.blobs[decodeURIComponent(s)]=r.sha,t.set(r.sha,"/"+r.path)):"commit"===r.type&&(i.commits[decodeURIComponent(s)]=r.sha)}return r}class u{constructor(e,t,n="utf-8"){this.path=e,this.mode=r.a.File,this.type=r.b.Blob,this.value={contents:t,encoding:n}}}class c{constructor(e,t){this.path=e,this.value=t,this.mode=r.a.Commit,this.type=r.b.Commit}}class d{constructor(e,t){this.path=e,this.value=t,this.mode=r.a.Directory,this.type=r.b.Tree}}class l{constructor(e,t){this.path=e,this.id=t,this.mode=r.a.File,this.type=r.b.Attachment,this.value={id:t}}}function h(e,t,n){e.entries.push({mode:r.a.File,path:t,type:r.b.Blob,value:{contents:JSON.stringify(n),encoding:"utf-8"}})}},"../notebook-dds/node_modules/@fluidframework/protocol-base/lib/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getGitMode",(function(){return r.g})),n.d(t,"getGitType",(function(){return r.h})),n.d(t,"buildHierarchy",(function(){return r.f})),n.d(t,"BlobTreeEntry",(function(){return r.b})),n.d(t,"CommitTreeEntry",(function(){return r.c})),n.d(t,"TreeTreeEntry",(function(){return r.d})),n.d(t,"AttachmentTreeEntry",(function(){return r.a})),n.d(t,"addBlobToTree",(function(){return r.e})),n.d(t,"isSystemMessage",(function(){return o.b})),n.d(t,"ProtocolOpHandler",(function(){return o.a})),n.d(t,"Quorum",(function(){return s.a})),n.d(t,"QuorumProxy",(function(){return s.b})),n.d(t,"isSystemType",(function(){return i.a})),n.d(t,"getQuorumTreeEntries",(function(){return u})),n.d(t,"mergeAppAndProtocolTree",(function(){return c})),n.d(t,"generateServiceProtocolEntries",(function(){return d}));var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/blobs.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/protocol.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/quorum.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/utils.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/storage.js");function u(e,t,n,r,o){const s={branch:e,minimumSequenceNumber:t,sequenceNumber:n,term:r};return[{mode:a.a.File,path:"quorumMembers",type:a.b.Blob,value:{contents:JSON.stringify(o.members),encoding:"utf-8"}},{mode:a.a.File,path:"quorumProposals",type:a.b.Blob,value:{contents:JSON.stringify(o.proposals),encoding:"utf-8"}},{mode:a.a.File,path:"quorumValues",type:a.b.Blob,value:{contents:JSON.stringify(o.values),encoding:"utf-8"}},{mode:a.a.File,path:"attributes",type:a.b.Blob,value:{contents:JSON.stringify(s),encoding:"utf-8"}}]}function c(e,t){const n=e.tree.map(e=>({mode:e.mode,path:e.path,sha:e.sha,type:e.type}));return n.push({mode:a.a.Directory,path:".protocol",sha:t.sha,type:"tree"}),n}function d(e,t){const n=[{mode:a.a.File,path:"deli",type:a.b.Blob,value:{contents:e,encoding:"utf-8"}}];return n.push({mode:a.a.File,path:"scribe",type:a.b.Blob,value:{contents:t,encoding:"utf-8"}}),n}},"../notebook-dds/node_modules/@fluidframework/protocol-base/lib/protocol.js":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return i}));var r=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/protocol.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/quorum.js");function s(e){switch(e.type){case r.a.ClientJoin:case r.a.ClientLeave:case r.a.Propose:case r.a.Reject:case r.a.NoOp:case r.a.NoClient:case r.a.Summarize:case r.a.SummaryAck:case r.a.SummaryNack:return!0;default:return!1}}class i{constructor(e,t,n,r,s,i,a,u){this.minimumSequenceNumber=e,this.sequenceNumber=t,this.term=null!=n?n:1,this.quorum=new o.a(e,r,s,i,a,u)}close(){this.quorum.close()}processMessage(e,t){let n=!1;switch(e.type){case r.a.ClientJoin:const o=e,s=JSON.parse(o.data),i={client:s.detail,sequenceNumber:o.sequenceNumber};this.quorum.addMember(s.clientId,i);break;case r.a.ClientLeave:const a=e,u=JSON.parse(a.data);this.quorum.removeMember(u);break;case r.a.Propose:const c=e.contents;this.quorum.addProposal(c.key,c.value,e.sequenceNumber,t,e.clientSequenceNumber),n=!0;break;case r.a.Reject:const d=e.contents;this.quorum.rejectProposal(e.clientId,d)}return this.minimumSequenceNumber=e.minimumSequenceNumber,this.sequenceNumber=e.sequenceNumber,n=this.quorum.updateMinimumSequenceNumber(e)||n,{immediateNoOp:n}}getProtocolState(){const e=this.quorum.snapshot();return{members:e.members,minimumSequenceNumber:this.minimumSequenceNumber,proposals:e.proposals,sequenceNumber:this.sequenceNumber,values:e.values}}}},"../notebook-dds/node_modules/@fluidframework/protocol-base/lib/quorum.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return h}));var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/cloneDeep.js"),o=n.n(r),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/typedEventEmitter.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/promises.js"),u=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/eventForwarder.js"),c=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/disposal.js");class d{constructor(e,t,n,r,o,s){this.sendReject=e,this.sequenceNumber=t,this.key=n,this.value=r,this.deferred=s,this.canReject=!0,this.rejections=new Set(o)}reject(){if(!this.canReject)throw new Error("Can no longer reject this proposal");this.sendReject(this.sequenceNumber)}get rejectionDisabled(){return!this.canReject}disableRejection(){this.canReject=!1}addRejection(e){Object(s.a)(!this.rejections.has(e),`!this.rejections.has(${e})`),this.rejections.add(e)}}class l extends i.a{constructor(e,t,n,r,o,s){super(),this.minimumSequenceNumber=e,this.sendProposal=o,this.sendReject=s,this.isDisposed=!1,this.localProposals=new Map,this.members=new Map(t),this.proposals=new Map(n.map(([,e,t])=>[e.sequenceNumber,new d(this.sendReject,e.sequenceNumber,e.key,e.value,t)])),this.values=new Map(r),this.pendingCommit=new Map(r.filter(e=>-1===e[1].commitSequenceNumber))}get disposed(){return this.isDisposed}close(){this.removeAllListeners()}snapshot(){const e=Array.from(this.proposals).map(([e,t])=>[e,{sequenceNumber:e,key:t.key,value:t.value},Array.from(t.rejections)]),t={members:[...this.members],proposals:e,values:[...this.values]};return o()(t)}has(e){return this.values.has(e)}get(e){const t=this.values.get(e);if(void 0!==t)return t.value}getApprovalData(e){const t=this.values.get(e);return t?o()(t):void 0}addMember(e,t){Object(s.a)(!this.members.has(e),`!this.members.has(${e})`),this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){Object(s.a)(this.members.has(e),`this.members.has(${e})`),this.members.delete(e),this.emit("removeMember",e)}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}async propose(e,t){const n=this.sendProposal(e,t);if(n<0)return this.emit("error",{eventName:"ProposalInDisconnectedState",key:e}),Promise.reject(new Error("Can't proposal in disconnected state"));const r=new a.a;return this.localProposals.set(n,r),r.promise}addProposal(e,t,n,r,o){Object(s.a)(!this.proposals.has(n),`!this.proposals.has(${n})`),Object(s.a)(!r||this.localProposals.has(o),`!${r} || this.localProposals.has(${o})`);const i=new d(this.sendReject,n,e,t,[],r?this.localProposals.get(o):void 0);this.proposals.set(n,i),this.emit("addProposal",i),i.disableRejection(),r&&this.localProposals.delete(o)}rejectProposal(e,t){Object(s.a)(this.proposals.has(t),`this.proposals.has(${t})`);const n=this.proposals.get(t);void 0!==n&&n.addRejection(e)}updateMinimumSequenceNumber(e){const t=e.minimumSequenceNumber;if(void 0!==this.minimumSequenceNumber&&(t<this.minimumSequenceNumber&&this.emit("error",{currentValue:this.minimumSequenceNumber,eventName:"QuorumMinSeqNumberError",newValue:t}),t<=this.minimumSequenceNumber))return!1;this.minimumSequenceNumber=t;let n=!1;const r=[];for(const[e,t]of this.proposals)e<=this.minimumSequenceNumber&&r.push(t);r.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);for(const t of r){const r=0===t.rejections.size;if(t.deferred&&(r?t.deferred.resolve():t.deferred.reject("Rejected by "+Array.from(t.rejections))),r){const r={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:t.key,sequenceNumber:t.sequenceNumber,value:t.value};this.values.set(r.key,r),this.pendingCommit.set(r.key,r),n=!0,this.emit("approveProposal",r.sequenceNumber,r.key,r.value,r.approvalSequenceNumber)}else this.emit("rejectProposal",t.sequenceNumber,t.key,t.value,Array.from(t.rejections));this.proposals.delete(t.sequenceNumber)}return this.pendingCommit.size>0&&Array.from(this.pendingCommit.values()).filter(e=>e.approvalSequenceNumber<=t).sort((e,t)=>e.sequenceNumber-t.sequenceNumber).forEach(t=>{t.commitSequenceNumber=e.sequenceNumber,this.emit("commitProposal",t.sequenceNumber,t.key,t.value,t.approvalSequenceNumber,t.commitSequenceNumber),this.pendingCommit.delete(t.key)}),n}setConnectionState(e,t){e||(this.localProposals.forEach(e=>{e.reject("Client got disconnected")}),this.localProposals.clear())}dispose(){throw new Error("Not implemented.")}}class h extends u.a{constructor(e){super(e),this.propose=Object(c.a)(this,e.propose.bind(e)),this.has=Object(c.a)(this,e.has.bind(e)),this.get=Object(c.a)(this,e.get.bind(e)),this.getApprovalData=Object(c.a)(this,e.getApprovalData.bind(e)),this.getMembers=Object(c.a)(this,e.getMembers.bind(e)),this.getMember=Object(c.a)(this,e.getMember.bind(e))}}},"../notebook-dds/node_modules/@fluidframework/protocol-base/lib/utils.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/protocol.js");const o=e=>e===r.a.RemoteHelp||e===r.a.ClientJoin||e===r.a.ClientLeave||e===r.a.Control},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_DataView.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js"),"DataView");e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Hash.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_ListCache.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Map.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js"),"Map");e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_MapCache.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheClear.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheDelete.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheGet.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheHas.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheSet.js");function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=i,u.prototype.set=a,e.exports=u},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Promise.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js"),"Promise");e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Set.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js"),"Set");e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Stack.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_ListCache.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackClear.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackDelete.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackGet.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackHas.js"),u=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackSet.js");function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=o,c.prototype.delete=s,c.prototype.get=i,c.prototype.has=a,c.prototype.set=u,e.exports=c},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Symbol.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js").Symbol;e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Uint8Array.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js").Uint8Array;e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_WeakMap.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getNative.js")(n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js"),"WeakMap");e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayEach.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayFilter.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,s=[];++n<r;){var i=e[n];t(i,n,e)&&(s[o++]=i)}return s}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayLikeKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseTimes.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isArguments.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isArray.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isBuffer.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isIndex.js"),u=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isTypedArray.js"),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=s(e),d=!n&&o(e),l=!n&&!d&&i(e),h=!n&&!d&&!l&&u(e),f=n||d||l||h,m=f?r(e.length,String):[],p=m.length;for(var g in e)!t&&!c.call(e,g)||f&&("length"==g||l&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,p))||m.push(g);return m}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayPush.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_assignValue.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseAssignValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/eq.js"),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var i=e[t];s.call(e,t)&&o(i,n)&&(void 0!==n||t in e)||r(e,t,n)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_assocIndexOf.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/eq.js");e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseAssign.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/keys.js");e.exports=function(e,t){return e&&r(t,o(t),e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseAssignIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/keysIn.js");e.exports=function(e,t){return e&&r(t,o(t),e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseAssignValue.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_defineProperty.js");e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseClone.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Stack.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayEach.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_assignValue.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseAssign.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseAssignIn.js"),u=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneBuffer.js"),c=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copyArray.js"),d=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copySymbols.js"),l=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copySymbolsIn.js"),h=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getAllKeys.js"),f=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getAllKeysIn.js"),m=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getTag.js"),p=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_initCloneArray.js"),g=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_initCloneByTag.js"),b=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_initCloneObject.js"),v=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isArray.js"),y=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isBuffer.js"),_=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isMap.js"),w=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObject.js"),k=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isSet.js"),S=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/keys.js"),j=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/keysIn.js"),C="[object Arguments]",x="[object Function]",O="[object Object]",E={};E[C]=E["[object Array]"]=E["[object ArrayBuffer]"]=E["[object DataView]"]=E["[object Boolean]"]=E["[object Date]"]=E["[object Float32Array]"]=E["[object Float64Array]"]=E["[object Int8Array]"]=E["[object Int16Array]"]=E["[object Int32Array]"]=E["[object Map]"]=E["[object Number]"]=E[O]=E["[object RegExp]"]=E["[object Set]"]=E["[object String]"]=E["[object Symbol]"]=E["[object Uint8Array]"]=E["[object Uint8ClampedArray]"]=E["[object Uint16Array]"]=E["[object Uint32Array]"]=!0,E["[object Error]"]=E[x]=E["[object WeakMap]"]=!1,e.exports=function e(t,n,I,A,N,T){var F,P=1&n,R=2&n,D=4&n;if(I&&(F=N?I(t,A,N,T):I(t)),void 0!==F)return F;if(!w(t))return t;var M=v(t);if(M){if(F=p(t),!P)return c(t,F)}else{var L=m(t),B=L==x||"[object GeneratorFunction]"==L;if(y(t))return u(t,P);if(L==O||L==C||B&&!N){if(F=R||B?{}:b(t),!P)return R?l(t,a(F,t)):d(t,i(F,t))}else{if(!E[L])return N?t:{};F=g(t,L,P)}}T||(T=new r);var q=T.get(t);if(q)return q;T.set(t,F),k(t)?t.forEach((function(r){F.add(e(r,n,I,r,t,T))})):_(t)&&t.forEach((function(r,o){F.set(o,e(r,n,I,o,t,T))}));var z=M?void 0:(D?R?f:h:R?j:S)(t);return o(z||t,(function(r,o){z&&(r=t[o=r]),s(F,o,e(r,n,I,o,t,T))})),F}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseCreate.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObject.js"),o=Object.create,s=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=s},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseGetAllKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayPush.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isArray.js");e.exports=function(e,t,n){var s=t(e);return o(e)?s:r(s,n(e))}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseGetTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Symbol.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getRawTag.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_objectToString.js"),i=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?o(e):s(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsArguments.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsMap.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Map]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsNative.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isFunction.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isMasked.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObject.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_toSource.js"),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,d=u.toString,l=c.hasOwnProperty,h=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||o(e))&&(r(e)?h:a).test(i(e))}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObjectLike.js");e.exports=function(e){return o(e)&&"[object Set]"==r(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isLength.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObjectLike.js"),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&o(e.length)&&!!i[r(e)]}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isPrototype.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nativeKeys.js"),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseKeysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nativeKeysIn.js"),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return s(e);var t=o(e),n=[];for(var a in e)("constructor"!=a||!t&&i.call(e,a))&&n.push(a);return n}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseTimes.js":function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseUnary.js":function(e,t){e.exports=function(e){return function(t){return e(t)}}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneArrayBuffer.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Uint8Array.js");e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneBuffer.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js"),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=s&&s.exports===o?r.Buffer:void 0,a=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneDataView.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneArrayBuffer.js");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneRegExp.js":function(e,t){var n=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneSymbol.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Symbol.js"),o=r?r.prototype:void 0,s=o?o.valueOf:void 0;e.exports=function(e){return s?Object(s.call(e)):{}}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneArrayBuffer.js");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copyArray.js":function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copyObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_assignValue.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseAssignValue.js");e.exports=function(e,t,n,s){var i=!n;n||(n={});for(var a=-1,u=t.length;++a<u;){var c=t[a],d=s?s(n[c],e[c],c,n,e):void 0;void 0===d&&(d=e[c]),i?o(n,c,d):r(n,c,d)}return n}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copySymbols.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getSymbols.js");e.exports=function(e,t){return r(e,o(e),t)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copySymbolsIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_copyObject.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getSymbolsIn.js");e.exports=function(e,t){return r(e,o(e),t)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_coreJsData.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js")["__core-js_shared__"];e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_defineProperty.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getNative.js"),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_freeGlobal.js":function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n("./node_modules/webpack/buildin/global.js"))},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getAllKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseGetAllKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getSymbols.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/keys.js");e.exports=function(e){return r(e,s,o)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getAllKeysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseGetAllKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getSymbolsIn.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/keysIn.js");e.exports=function(e){return r(e,s,o)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getMapData.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isKeyable.js");e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getNative.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsNative.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getValue.js");e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getPrototype.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_overArg.js")(Object.getPrototypeOf,Object);e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getRawTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Symbol.js"),o=Object.prototype,s=o.hasOwnProperty,i=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=s.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[a]=n:delete e[a]),o}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getSymbols.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayFilter.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/stubArray.js"),s=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(e){return null==e?[]:(e=Object(e),r(i(e),(function(t){return s.call(e,t)})))}:o;e.exports=a},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getSymbolsIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayPush.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getSymbols.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/stubArray.js"),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,s(e)),e=o(e);return t}:i;e.exports=a},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_DataView.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Map.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Promise.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Set.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_WeakMap.js"),u=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseGetTag.js"),c=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_toSource.js"),d="[object Map]",l="[object Promise]",h="[object Set]",f="[object WeakMap]",m="[object DataView]",p=c(r),g=c(o),b=c(s),v=c(i),y=c(a),_=u;(r&&_(new r(new ArrayBuffer(1)))!=m||o&&_(new o)!=d||s&&_(s.resolve())!=l||i&&_(new i)!=h||a&&_(new a)!=f)&&(_=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case p:return m;case g:return d;case b:return l;case v:return h;case y:return f}return t}),e.exports=_},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getValue.js":function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nativeCreate.js");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashDelete.js":function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nativeCreate.js"),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nativeCreate.js"),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_hashSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nativeCreate.js");e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_initCloneArray.js":function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_initCloneByTag.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneArrayBuffer.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneDataView.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneRegExp.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneSymbol.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_cloneTypedArray.js");e.exports=function(e,t,n){var u=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new u(+e);case"[object DataView]":return o(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,n);case"[object Map]":return new u;case"[object Number]":case"[object String]":return new u(e);case"[object RegExp]":return s(e);case"[object Set]":return new u;case"[object Symbol]":return i(e)}}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_initCloneObject.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseCreate.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getPrototype.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isPrototype.js");e.exports=function(e){return"function"!=typeof e.constructor||s(e)?{}:r(o(e))}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isIndex.js":function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isKeyable.js":function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isMasked.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_coreJsData.js"),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_isPrototype.js":function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheClear.js":function(e,t){e.exports=function(){this.__data__=[],this.size=0}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheDelete.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_assocIndexOf.js"),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_assocIndexOf.js");e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_assocIndexOf.js");e.exports=function(e){return r(this.__data__,e)>-1}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_listCacheSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_assocIndexOf.js");e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Hash.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_ListCache.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Map.js");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(s||o),string:new r}}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheDelete.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getMapData.js");e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheGet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).get(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheHas.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).has(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_mapCacheSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getMapData.js");e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nativeCreate.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_getNative.js")(Object,"create");e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nativeKeys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_overArg.js")(Object.keys,Object);e.exports=r},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nativeKeysIn.js":function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nodeUtil.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_freeGlobal.js"),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=s&&s.exports===o&&r.process,a=function(){try{return s&&s.require&&s.require("util").types||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=a}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_objectToString.js":function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_overArg.js":function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_freeGlobal.js"),o="object"==typeof self&&self&&self.Object===Object&&self,s=r||o||Function("return this")();e.exports=s},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackClear.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_ListCache.js");e.exports=function(){this.__data__=new r,this.size=0}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackDelete.js":function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackGet.js":function(e,t){e.exports=function(e){return this.__data__.get(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackHas.js":function(e,t){e.exports=function(e){return this.__data__.has(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_stackSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_ListCache.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_Map.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_MapCache.js");e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var i=n.__data__;if(!o||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new s(i)}return n.set(e,t),this.size=n.size,this}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_toSource.js":function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/cloneDeep.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseClone.js");e.exports=function(e){return r(e,5)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/eq.js":function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isArguments.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsArguments.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObjectLike.js"),s=Object.prototype,i=s.hasOwnProperty,a=s.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return o(e)&&i.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isArray.js":function(e,t){var n=Array.isArray;e.exports=n},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isArrayLike.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isFunction.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isLength.js");e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isBuffer.js":function(e,t,n){(function(e){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_root.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/stubFalse.js"),s=t&&!t.nodeType&&t,i=s&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===s?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||o;e.exports=u}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isFunction.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseGetTag.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObject.js");e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isLength.js":function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isMap.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsMap.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nodeUtil.js"),i=s&&s.isMap,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObject.js":function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isObjectLike.js":function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isSet.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsSet.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nodeUtil.js"),i=s&&s.isSet,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isTypedArray.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseIsTypedArray.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseUnary.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_nodeUtil.js"),i=s&&s.isTypedArray,a=i?o(i):r;e.exports=a},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/keys.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayLikeKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseKeys.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isArrayLike.js");e.exports=function(e){return s(e)?r(e):o(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/keysIn.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_arrayLikeKeys.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/_baseKeysIn.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/isArrayLike.js");e.exports=function(e){return s(e)?r(e,!0):o(e)}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/stubArray.js":function(e,t){e.exports=function(){return[]}},"../notebook-dds/node_modules/@fluidframework/protocol-base/node_modules/lodash/stubFalse.js":function(e,t){e.exports=function(){return!1}},"../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js":function(e,t,n){"use strict";n.r(t);var r=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/protocol.js");n.d(t,"MessageType",(function(){return r.a})),n.d(t,"NackErrorType",(function(){return r.b}));var o=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/storage.js");n.d(t,"FileMode",(function(){return o.a})),n.d(t,"TreeEntry",(function(){return o.b}));var s=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/scopes.js");n.d(t,"ScopeType",(function(){return s.a}))},"../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/protocol.js":function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.Save="saveOp",e.RemoteHelp="remoteHelp",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(r||(r={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(o||(o={}))},"../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/scopes.js":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.DocRead="doc:read",e.DocWrite="doc:write",e.SummaryWrite="summary:write"}(r||(r={}))},"../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/storage.js":function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.File="100644",e.Executable="100755",e.Directory="040000",e.Commit="160000",e.Symlink="120000"}(r||(r={})),function(e){e.Blob="Blob",e.Commit="Commit",e.Tree="Tree",e.Attachment="Attachment"}(o||(o={}))},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/deltaStorageService.js":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var r=n("./node_modules/querystring-es3/index.js"),o=n.n(r),s=n("../notebook-dds/node_modules/axios/index.js"),i=n.n(s),a=n("../notebook-dds/node_modules/uuid/dist/esm-browser/v4.js"),u=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/readAndParse.js");class c{constructor(e,t,n,r){this.tenantId=e,this.id=t,this.storageService=n,this.documentStorageService=r,this.logtailSha=this.documentStorageService.logTailSha}async get(e,t){const n=this.logtailSha?await Object(u.a)(this.documentStorageService,this.logtailSha):[];if(this.logtailSha=void 0,n.length>0){const t=n.filter(t=>t.sequenceNumber>e);if(t.length>0)return{messages:t,partialResult:!0}}return this.storageService.get(this.tenantId,this.id,e,t)}}class d{constructor(e,t,n){this.url=e,this.tokenProvider=t,this.logger=n}async get(e,t,n,r){const s=o.a.stringify({from:n,to:r}),u={"x-correlation-id":a.a()},c=await this.tokenProvider.fetchStorageToken(e,t);c&&(u.Authorization="Basic "+c.jwt);const d=await i.a.get(`${this.url}?${s}`,{headers:u});return this.logger&&this.logger.sendTelemetryEvent({eventName:"R11sDriverToServer",correlationId:u["x-correlation-id"]}),{messages:d.data,partialResult:!1}}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentService.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r,o=n("./node_modules/assert/assert.js"),s=n.n(o),i=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/historian.js"),a=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/gitManager.js"),u=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/index.js"),c=n.n(u),d=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/deltaStorageService.js"),l=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentStorageService.js"),h=n("../notebook-dds/node_modules/@fluidframework/driver-base/lib/documentDeltaConnection.js"),f=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/network.js"),m=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/logger.js");!function(e){e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError"}(r||(r={}));const p=["^0.4.0","^0.3.0","^0.2.0","^0.1.0"];class g extends h.a{static async create(e,t,n,r,o,s,i=2e4){const a=r(s,{query:{documentId:t,tenantId:e},reconnection:!1,transports:["websocket"],timeout:i}),u={client:o,id:t,mode:o.mode,tenantId:e,token:n,versions:p},c=new g(a,t,new m.b);return await c.initialize(u,i),c}createErrorObject(e,t,n=!0){return n&&"object"==typeof t&&null!==t?((e,t,n)=>function(e,t,n,o){switch(n){case 401:case 403:return new f.c(e,r.authorizationError,t,n);case 404:return new f.c(e,r.fileNotFoundOrAccessDeniedError,t,n);case 500:return new f.b(e,t,n);default:return Object(f.h)(e,t,o,n)}}(`socket.io: ${t}: ${e.message}`,n,e.code,e.retryAfter))(t,e,n):super.createErrorObject(e,t,n)}}var b=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/nullBlobStorageService.js");class v{constructor(e,t,n,r,o,s,i,a,u,c,d,l,h){this.resolvedUrl=e,this.ordererUrl=t,this.deltaStorageUrl=n,this.gitUrl=r,this.errorTracking=o,this.disableCache=s,this.historianApi=i,this.directCredentials=a,this.gitCache=u,this.logger=c,this.tokenProvider=d,this.tenantId=l,this.documentId=h}async connectToStorage(){if(void 0===this.gitUrl)return new b.a;const e=await this.tokenProvider.fetchStorageToken(this.tenantId,this.documentId);let t;t=this.directCredentials?this.directCredentials:{password:e.jwt,user:this.tenantId};const n=new i.a(this.gitUrl,this.historianApi,this.disableCache,t),r=new a.a(n);if(void 0!==this.gitCache){for(const e of Object.keys(this.gitCache.refs))r.addRef(e,this.gitCache.refs[e]);for(const e of this.gitCache.commits)r.addCommit(e);for(const e of this.gitCache.trees)r.addTree(e);for(const e of this.gitCache.blobs)r.addBlob(e)}return this.documentStorageService=new l.a(this.documentId,r),this.documentStorageService}async connectToDeltaStorage(){s()(this.documentStorageService,"Storage service not initialized");const e=new d.a(this.deltaStorageUrl,this.tokenProvider,this.logger);return new d.b(this.tenantId,this.documentId,e,this.documentStorageService)}async connectToDeltaStream(e){const t=await this.tokenProvider.fetchOrdererToken(this.tenantId,this.documentId);return g.create(this.tenantId,this.documentId,t.jwt,c.a,e,this.ordererUrl)}getErrorTrackingService(){return this.errorTracking}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentService2.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentService.js"),o=n("./node_modules/url/url.js"),s=n.n(o),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/typedEventEmitter.js"),a=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/batchManager.js"),u=n("../notebook-dds/node_modules/isomorphic-ws/browser.js"),c=n.n(u);class d extends i.a{constructor(e,t,n,r,o){super(),this.documentId=t;const i=s.a.parse(o),u=`${"https:"===i.protocol?"wss":"ws"}://${i.host}${i.pathname}`;this.socket=new c.a(`${u}?documentId${encodeURIComponent(t)}&tenantId${encodeURIComponent(e)}`),this.socket.onopen=()=>{const o={client:r,id:t,mode:r.mode,tenantId:e,token:n,versions:["^0.1.0"]};this.sendMessage(JSON.stringify(["connect",o]))},this.socket.onmessage=e=>{this.handleMessage(e.data)},this.socket.onclose=e=>{this.emit("disconnect",e.reason)},this.socket.onerror=e=>{this.emit("error",e),this.socket.readyState!==c.a.CONNECTING&&this.socket.readyState!==c.a.OPEN||this.socket.close(-1,e.toString())},this.once("connect_document_success",e=>{this.details=e}),this.submitManager=new a.a((e,t)=>{this.sendMessage(JSON.stringify([e,this.details.clientId,t]))})}static async create(e,t,n,r,o){return new Promise((s,i)=>{const a=new d(e,t,n,r,o),u=()=>{s(a),a.removeListener("disconnected",c)},c=e=>{i(e),a.removeListener("connect_document_success",u)};a.once("disconnected",c),a.once("connect_document_success",u)})}get clientId(){return this.details.clientId}get mode(){return this.details.mode}get claims(){return this.details.claims}get existing(){return this.details.existing}get maxMessageSize(){return this.details.maxMessageSize}get version(){return this.details.version}get initialMessages(){return this.details.initialMessages}get initialSignals(){return this.details.initialSignals}get initialClients(){return this.details.initialClients}get serviceConfiguration(){return this.details.serviceConfiguration}submit(e){this.submitManager.add("submitOp",e)}submitSignal(e){this.submitManager.add("submitSignal",e)}close(){this.socket.close()}handleMessage(e){const t=JSON.parse(e);this.emit(t[0],...t.slice(1))}sendMessage(e){this.socket.send(e,e=>{e&&this.emit("error",e)})}}class l extends r.a{constructor(e,t,n,r,o,s,i,a,u,c,d,l){super(e,t,n,r,o,s,i,a,void 0,u,c,d,l)}async connectToDeltaStream(e){const t=await this.tokenProvider.fetchOrdererToken(this.tenantId,this.documentId);return d.create(this.tenantId,this.documentId,t.jwt,e,this.ordererUrl)}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentServiceFactory.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("./node_modules/url/url.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js"),s=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/fluidResolvedUrl.js"),i=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/summaryForCreateNew.js"),a=n("../notebook-dds/node_modules/axios/index.js"),u=n.n(a),c=n("../notebook-dds/node_modules/@fluidframework/telemetry-utils/lib/logger.js"),d=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentService.js"),l=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentService2.js"),h=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/errorTracking.js");class f{constructor(e,t=!1,n=new h.a,r=!1,o=!0,s,i){this.tokenProvider=e,this.useDocumentService2=t,this.errorTracking=n,this.disableCache=r,this.historianApi=o,this.gitCache=s,this.credentials=i,this.protocolName="fluid:"}async createContainer(e,t,n){Object(s.a)(t),Object(o.a)(!!t.endpoints.ordererUrl);const a=Object(r.parse)(t.url);if(!a.pathname)throw new Error("Parsed url should contain tenant and doc Id!!");const[,c,d]=a.pathname.split("/"),l=e.tree[".protocol"],h=e.tree[".app"];if(!l||!h)throw new Error("Protocol and App Summary required in the full summary");const f=Object(i.b)(l),m=Object(i.c)(l),p=await this.tokenProvider.fetchStorageToken(c,d);return await u.a.post(`${t.endpoints.ordererUrl}/documents/${c}`,{id:d,summary:h,sequenceNumber:f.sequenceNumber,values:m},{headers:{Authorization:"Basic "+p.jwt}}),this.createDocumentService(t,n)}async createDocumentService(e,t){Object(s.a)(e);const n=e,o=n.endpoints.storageUrl,i=n.endpoints.ordererUrl,a=n.endpoints.deltaStorageUrl;if(!i||!a)throw new Error(`All endpoints urls must be provided. [ordererUrl:${i}][deltaStorageUrl:${a}]`);const u=Object(r.parse)(n.url),[,h,f]=u.pathname.split("/");if(!f||!h)throw new Error(`Couldn't parse documentId and/or tenantId. [documentId:${f}][tenantId:${h}]`);const m=c.a.create(t,"RouterliciousDriver");return this.useDocumentService2?new l.a(n,i,a,o,this.errorTracking,this.disableCache,this.historianApi,this.credentials,m,this.tokenProvider,h,f):new d.a(n,i,a,o,this.errorTracking,this.disableCache,this.historianApi,this.credentials,this.gitCache,m,this.tokenProvider,h,f)}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentStorageService.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/bufferBrowser.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/unreachable.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/hashFileBrowser.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/blobs.js");class u{constructor(e,t){this.id=e,this.manager=t,this.blobsShaCache=new Map,this._logTailSha=void 0}get repositoryUrl(){return""}get logTailSha(){return this._logTailSha}async getSnapshotTree(e){let t=e;if(!t){const e=await this.getVersions(this.id,1);if(0===e.length)return null;t=e[0]}const n=await this.manager.getTree(t.treeId),r=Object(a.f)(n,this.blobsShaCache);return this._logTailSha=".logTail"in r.trees?r.trees[".logTail"].blobs.logTail:void 0,r}async getVersions(e,t){return(await this.manager.getCommits(e||this.id,t)).map(e=>({date:e.commit.author.date,id:e.sha,treeId:e.commit.tree.sha}))}async read(e){const t=await this.manager.getBlob(e);return this.blobsShaCache.set(t.sha,""),t.content}async write(e,t,n,r){const o=r?`datastores/${this.id}/${r}`:this.id,s=await this.manager.write(o,e,t,n);return{date:s.committer.date,id:s.sha,treeId:s.tree.sha}}async uploadSummaryWithContext(e,t){const n=t.ackHandle?await this.getVersions(t.ackHandle,1).then(async e=>(this.blobsShaCache.clear(),this.getSnapshotTree(e[0]))):void 0;return this.writeSummaryTree(e,null!=n?n:void 0)}async downloadSummary(e){throw new Error("NOT IMPLEMENTED!")}async createBlob(e){return this.manager.createBlob(Object(r.b)(new Uint8Array(e),"base64"),"base64").then(e=>({id:e.sha,url:e.url}))}async readBlob(e){const t=await this.manager.getBlob(e);return this.blobsShaCache.set(t.sha,""),Object(r.d)(t.content,t.encoding)}async writeSummaryTree(e,t){const n=await Promise.all(Object.keys(e.tree).map(async n=>{const r=e.tree[n],o=await this.writeSummaryTreeObject(n,r,t);return{mode:Object(a.g)(r),path:encodeURIComponent(n),sha:o,type:Object(a.h)(r)}}));return(await this.manager.createGitTree({tree:n})).sha}async writeSummaryTreeObject(e,t,n,r=""){switch(t.type){case 2:return this.writeSummaryBlob(t.content);case 3:if(void 0===n)throw Error("Parent summary does not exist to reference by handle.");return this.getIdFromPath(t.handleType,t.handle,n);case 1:return this.writeSummaryTree(t,n);case 4:return t.id;default:Object(o.a)(t,"Unknown type: "+t.type)}}getIdFromPath(e,t,n){const r=t.split("/").map(e=>decodeURIComponent(e));return""===r[0]&&r.shift(),0===r.length?n.id:this.getIdFromPathCore(e,r,n)}getIdFromPathCore(e,t,n){var r;Object(s.a)(t.length>0,"Expected at least 1 path part");const o=t[0];if(1===t.length)switch(e){case 2:{const e=n.blobs[o];return Object(s.a)(!!e,"Parent summary does not have blob handle for specified path."),e}case 1:{const e=null===(r=n.trees[o])||void 0===r?void 0:r.id;return Object(s.a)(!!e,"Parent summary does not have tree handle for specified path."),e}default:throw Error(`Unexpected handle summary object type: "${e}".`)}return this.getIdFromPathCore(e,t.slice(1),n.trees[o])}async writeSummaryBlob(e){const{parsedContent:t,encoding:n}="string"==typeof e?{parsedContent:e,encoding:"utf-8"}:{parsedContent:Object(r.b)(e,"base64"),encoding:"base64"},o=await Object(i.a)(r.a.from(t,n));if(!this.blobsShaCache.has(o)){this.blobsShaCache.set(o,"");const e=await this.manager.createBlob(t,n);Object(s.a)(o===e.sha,"Blob.sha and hash do not match!!")}return o}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/errorTracking.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{track(e){return e()}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultErrorTracking",(function(){return r.a})),n.d(t,"DocumentDeltaStorageService",(function(){return o.b})),n.d(t,"DeltaStorageService",(function(){return o.a})),n.d(t,"DocumentService",(function(){return s.a})),n.d(t,"DocumentStorageService",(function(){return i.a})),n.d(t,"createDocumentService",(function(){return a})),n.d(t,"DocumentService2",(function(){return u.a})),n.d(t,"createDocumentService2",(function(){return c})),n.d(t,"NullBlobStorageService",(function(){return d.a})),n.d(t,"RouterliciousDocumentServiceFactory",(function(){return l.a})),n.d(t,"DefaultTokenProvider",(function(){return h}));var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/errorTracking.js"),o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/deltaStorageService.js"),s=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentService.js"),i=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentStorageService.js");function a(e,t,n,o,i,a,u,c=new r.a,d=!1,l=!0,h,f,m){return new s.a(e,t,n,o,c,d,l,h,f,m,i,a,u)}var u=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentService2.js");const c=(e,t,n,o,s,i,a,c=new r.a,d=!1,l=!0,h,f)=>new u.a(e,t,n,o,c,d,l,f,h,s,i,a);var d=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/nullBlobStorageService.js"),l=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentServiceFactory.js");class h{constructor(e){this.jwt=e}async fetchOrdererToken(){return{fromCache:!0,jwt:this.jwt}}async fetchStorageToken(){return{fromCache:!0,jwt:this.jwt}}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/nullBlobStorageService.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{get repositoryUrl(){throw new Error("Invalid operation")}async getSnapshotTree(e){return e?Promise.reject(new Error("Invalid operation")):null}async getVersions(e,t){return[]}async read(e){return Promise.reject(new Error("Invalid operation"))}async write(e,t,n,r){return Promise.reject(new Error("Null blob storage can not write commit"))}async uploadSummaryWithContext(e,t){return Promise.reject(new Error("Invalid operation"))}async downloadSummary(e){return Promise.reject(new Error("Invalid operation"))}async createBlob(e){return Promise.reject(new Error("Null blob storage can not create blob"))}async readBlob(e){return Promise.reject(new Error("Null blob storage can not read blob"))}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/globalThis.browser.js":function(e,t){e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/index.js":function(e,t,n){e.exports=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/socket.js"),e.exports.parser=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/browser.js")},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/socket.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/index.js"),o=n("../notebook-dds/node_modules/component-emitter/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/node_modules/debug/src/browser.js")("engine.io-client:socket"),i=n("../notebook-dds/node_modules/indexof/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/browser.js"),u=n("../notebook-dds/node_modules/parseuri/index.js"),c=n("../notebook-dds/node_modules/parseqs/index.js");function d(e,t){if(!(this instanceof d))return new d(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=u(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=u(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=d,d.priorWebsocketSuccess=!1,o(d.prototype),d.protocol=a.protocol,d.Socket=d,d.Transport=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transport.js"),d.transports=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/index.js"),d.parser=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/browser.js"),d.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},d.prototype.open=function(){var e;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},d.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},d.prototype.probe=function(e){s('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(s('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(s('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;d.priorWebsocketSuccess="websocket"===t.name,s('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(s("changing transport and sending upgrade packet"),h(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{s('probe transport "%s" failed',e);var i=new Error("probe error");i.transport=t.name,r.emit("upgradeError",i)}})))}function i(){n||(n=!0,h(),t.close(),t=null)}function a(n){var o=new Error("probe error: "+n);o.transport=t.name,i(),s('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function u(){a("transport closed")}function c(){a("socket closed")}function l(e){t&&e.name!==t.name&&(s('"%s" works - aborting "%s"',e.name,t.name),i())}function h(){t.removeListener("open",o),t.removeListener("error",a),t.removeListener("close",u),r.removeListener("close",c),r.removeListener("upgrading",l)}d.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",a),t.once("close",u),this.once("close",c),this.once("upgrading",l),t.open()},d.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},d.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},d.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},d.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},d.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},d.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},d.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),s("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},d.prototype.onError=function(e){s("socket error %j",e),d.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},d.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(s('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},d.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~i(this.transports,e[n])&&t.push(e[n]);return t}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transport.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/browser.js"),o=n("../notebook-dds/node_modules/component-emitter/index.js");function s(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=s,o(s.prototype),s.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},s.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},s.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},s.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},s.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},s.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},s.prototype.onPacket=function(e){this.emit("packet",e)},s.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/index.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/xmlhttprequest.js"),o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/polling-xhr.js"),s=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/polling-jsonp.js"),i=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/websocket.js");t.polling=function(e){var t=!1,n=!1,i=!1!==e.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,u=location.port;u||(u=a?443:80),t=e.hostname!==location.hostname||u!==e.port,n=e.secure!==a}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new o(e);if(!i)throw new Error("JSONP disabled");return new s(e)},t.websocket=i},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/polling-jsonp.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/polling.js"),o=n("../notebook-dds/node_modules/component-inherit/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/globalThis.browser.js");e.exports=d;var i,a=/\n/g,u=/\\n/g;function c(){}function d(e){r.call(this,e),this.query=this.query||{},i||(i=s.___eio=s.___eio||[]),this.index=i.length;var t=this;i.push((function(e){t.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=c)}),!1)}o(d,r),d.prototype.supportsBinary=!1,d.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},d.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},d.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),s=document.createElement("textarea"),i=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=i,o.method="POST",o.setAttribute("accept-charset","utf-8"),s.name="d",o.appendChild(s),document.body.appendChild(o),this.form=o,this.area=s}function c(){d(),t()}function d(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),d(),e=e.replace(u,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&c()}:this.iframe.onload=c}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/polling-xhr.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/xmlhttprequest.js"),o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/polling.js"),s=n("../notebook-dds/node_modules/component-emitter/index.js"),i=n("../notebook-dds/node_modules/component-inherit/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/node_modules/debug/src/browser.js")("engine.io-client:polling-xhr"),u=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/globalThis.browser.js");function c(){}function d(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function l(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function h(){for(var e in l.requests)l.requests.hasOwnProperty(e)&&l.requests[e].abort()}e.exports=d,e.exports.Request=l,i(d,o),d.prototype.supportsBinary=!0,d.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new l(e)},d.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=r},d.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},s(l.prototype),l.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},l.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},l.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}},l.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},l.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},l.prototype.abort=function(){this.cleanup()},l.requestsCount=0,l.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",h):"function"==typeof addEventListener&&addEventListener("onpagehide"in u?"pagehide":"unload",h,!1))},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/polling.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transport.js"),o=n("../notebook-dds/node_modules/parseqs/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/browser.js"),i=n("../notebook-dds/node_modules/component-inherit/index.js"),a=n("../notebook-dds/node_modules/yeast/index.js"),u=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/node_modules/debug/src/browser.js")("engine.io-client:polling");e.exports=d;var c=null!=new(n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/xmlhttprequest.js"))({xdomain:!1}).responseType;function d(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),r.call(this,e)}i(d,r),d.prototype.name="polling",d.prototype.doOpen=function(){this.poll()},d.prototype.pause=function(e){var t=this;function n(){u("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){u("pre-pause polling complete"),--r||n()}))),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){u("pre-pause writing complete"),--r||n()})))}else n()},d.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},d.prototype.onData=function(e){var t=this;u("polling got data %s",e),s.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},d.prototype.doClose=function(){var e=this;function t(){u("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(u("transport open - closing"),t()):(u("transport not open - deferring close"),this.once("open",t))},d.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};s.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},d.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transports/websocket.js":function(e,t,n){(function(t){var r,o,s=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/transport.js"),i=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/browser.js"),a=n("../notebook-dds/node_modules/parseqs/index.js"),u=n("../notebook-dds/node_modules/component-inherit/index.js"),c=n("../notebook-dds/node_modules/yeast/index.js"),d=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/node_modules/debug/src/browser.js")("engine.io-client:websocket");if("undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{o=n(18)}catch(e){}var l=r||o;function h(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(l=o),s.call(this,e)}e.exports=h,u(h,s),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new l(e,t):new l(e):new l(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},h.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},h.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,o=0,s=r;o<s;o++)!function(e){i.encodePacket(e,n.supportsBinary,(function(o){if(!n.usingBrowserWebSocket){var s={};e.options&&(s.compress=e.options.compress),n.perMessageDeflate&&("string"==typeof o?t.byteLength(o):o.length)<n.perMessageDeflate.threshold&&(s.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,s)}catch(e){d("websocket closed before onclose event")}--r||(n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0))}))}(e[o])},h.prototype.onClose=function(){s.prototype.onClose.call(this)},h.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},h.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},h.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===h.prototype.name)}}).call(this,n("./node_modules/buffer/index.js").Buffer)},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/xmlhttprequest.js":function(e,t,n){var r=n("../notebook-dds/node_modules/has-cors/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/globalThis.browser.js");e.exports=function(e){var t=e.xdomain,n=e.xscheme,s=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&s)return new XDomainRequest}catch(e){}if(!t)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/node_modules/debug/src/browser.js":function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).DEBUG),e}(t=e.exports=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/node_modules/debug/src/debug.js")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(s=o))})),e.splice(s,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/node_modules/debug/src/debug.js":function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,s=o-(n||o);e.diff=s,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var o=t.formatters[r];if("function"==typeof o){var s=i[u];n=o.call(e,s),i.splice(u,1),u--}return n})),t.formatArgs.call(e,i);var c=r.log||t.log||console.log.bind(console);c.apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/ms/index.js"),t.instances=[],t.names=[],t.skips=[],t.formatters={}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/browser.js":function(e,t,n){var r,o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/keys.js"),s=n("../notebook-dds/node_modules/has-binary2/index.js"),i=n("../notebook-dds/node_modules/arraybuffer.slice/index.js"),a=n("../notebook-dds/node_modules/after/index.js"),u=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/utf8.js");"undefined"!=typeof ArrayBuffer&&(r=n("../notebook-dds/node_modules/base64-arraybuffer/lib/base64-arraybuffer.js"));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),d="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=c||d;t.protocol=3;var h=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=o(h),m={type:"error",data:"parser error"},p=n("../notebook-dds/node_modules/blob/index.js");function g(e,t,n){for(var r=new Array(e.length),o=a(e.length,n),s=function(e,n,o){t(n,(function(t,n){r[e]=n,o(t,r)}))},i=0;i<e.length;i++)s(i,e[i],o)}t.encodePacket=function(e,n,r,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof r&&(o=r,r=null);var s=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,s=new Uint8Array(o),i=new Uint8Array(1+o.byteLength);i[0]=h[e.type];for(var a=0;a<s.length;a++)i[a+1]=s[a];return r(i.buffer)}(e,n,o);if(void 0!==p&&s instanceof p)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(l)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,r)},o.readAsArrayBuffer(e.data)}(e,n,r);var o=new Uint8Array(1);return o[0]=h[e.type],r(new p([o.buffer,e.data]))}(e,n,o);if(s&&s.base64)return function(e,n){return n("b"+t.packets[e.type]+e.data.data)}(e,o);var i=h[e.type];return void 0!==e.data&&(i+=r?u.encode(String(e.data),{strict:!1}):String(e.data)),o(""+i)},t.encodeBase64Packet=function(e,n){var r,o="b"+t.packets[e.type];if(void 0!==p&&e.data instanceof p){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];n(o+e)},s.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var i=new Uint8Array(e.data),a=new Array(i.length),u=0;u<i.length;u++)a[u]=i[u];r=String.fromCharCode.apply(null,a)}return o+=btoa(r),n(o)},t.decodePacket=function(e,n,r){if(void 0===e)return m;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=u.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return m;var o=e.charAt(0);return Number(o)==o&&f[o]?e.length>1?{type:f[o],data:e.substring(1)}:{type:f[o]}:m}o=new Uint8Array(e)[0];var s=i(e,1);return p&&"blob"===n&&(s=new p([s])),{type:f[o],data:s}},t.decodeBase64Packet=function(e,t){var n=f[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=r.decode(e.substr(1));return"blob"===t&&p&&(o=new p([o])),{type:n,data:o}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var o=s(e);return n&&o?p&&!l?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void g(e,(function(e,r){t.encodePacket(e,!!o&&n,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))})):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var o;if("function"==typeof n&&(r=n,n=null),""===e)return r(m,0,1);for(var s,i,a="",u=0,c=e.length;u<c;u++){var d=e.charAt(u);if(":"===d){if(""===a||a!=(s=Number(a)))return r(m,0,1);if(a!=(i=e.substr(u+1,s)).length)return r(m,0,1);if(i.length){if(o=t.decodePacket(i,n,!1),m.type===o.type&&m.data===o.data)return r(m,0,1);if(!1===r(o,u+s,c))return}u+=s,a=""}else a+=d}return""!==a?r(m,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),o=new Uint8Array(r),s=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);n=r.buffer}o[s++]=t?0:1;var a=n.byteLength.toString();for(i=0;i<a.length;i++)o[s++]=parseInt(a[i]);for(o[s++]=255,r=new Uint8Array(n),i=0;i<r.length;i++)o[s++]=r[i]})),n(o.buffer)}))},t.encodePayloadAsBlob=function(e,n){g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}var s=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),i=new Uint8Array(s.length+1);for(o=0;o<s.length;o++)i[o]=parseInt(s[o]);if(i[s.length]=255,p){var a=new p([t.buffer,i.buffer,e]);n(null,a)}}))}),(function(e,t){return n(new p(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o=e,s=[];o.byteLength>0;){for(var a=new Uint8Array(o),u=0===a[0],c="",d=1;255!==a[d];d++){if(c.length>310)return r(m,0,1);c+=a[d]}o=i(o,2+c.length),c=parseInt(c);var l=i(o,0,c);if(u)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(e){var h=new Uint8Array(l);for(l="",d=0;d<h.length;d++)l+=String.fromCharCode(h[d])}s.push(l),o=i(o,c)}var f=s.length;s.forEach((function(e,o){r(t.decodePacket(e,n,!0),o,f)}))}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/keys.js":function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-parser/lib/utf8.js":function(e,t){var n,r,o,s=String.fromCharCode;function i(e){for(var t,n,r=[],o=0,s=e.length;o<s;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<s?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function u(e,t){return s(e>>t&63|128)}function c(e,t){if(0==(4294967168&e))return s(e);var n="";return 0==(4294965248&e)?n=s(e>>6&31|192):0==(4294901760&e)?(a(e,t)||(e=65533),n=s(e>>12&15|224),n+=u(e,6)):0==(4292870144&e)&&(n=s(e>>18&7|240),n+=u(e,12),n+=u(e,6)),n+s(63&e|128)}function d(){if(o>=r)throw Error("Invalid byte index");var e=255&n[o];if(o++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function l(e){var t,s;if(o>r)throw Error("Invalid byte index");if(o==r)return!1;if(t=255&n[o],o++,0==(128&t))return t;if(192==(224&t)){if((s=(31&t)<<6|d())>=128)return s;throw Error("Invalid continuation byte")}if(224==(240&t)){if((s=(15&t)<<12|d()<<6|d())>=2048)return a(s,e)?s:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(s=(7&t)<<18|d()<<12|d()<<6|d())>=65536&&s<=1114111)return s;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=i(e),o=r.length,s=-1,a="";++s<o;)a+=c(r[s],n);return a},decode:function(e,t){var a=!1!==(t=t||{}).strict;n=i(e),r=n.length,o=0;for(var u,c=[];!1!==(u=l(a));)c.push(u);return function(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=s((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=s(t);return o}(c)}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/ms/index.js":function(e,t){var n=1e3,r=6e4,o=60*r,s=24*o;function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var a,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"days":case"day":case"d":return i*s;case"hours":case"hour":case"hrs":case"hr":case"h":return i*o;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return t.long?i(a=e,s,"day")||i(a,o,"hour")||i(a,r,"minute")||i(a,n,"second")||a+" ms":function(e){return e>=s?Math.round(e/s)+"d":e>=o?Math.round(e/o)+"h":e>=r?Math.round(e/r)+"m":e>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/index.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/url.js"),o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/manager.js"),i=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client");e.exports=t=u;var a=t.managers={};function u(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o=r(e),u=o.source,c=o.id,d=o.path,l=a[c]&&d in a[c].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||l?(i("ignoring socket cache for %s",u),n=s(u,t)):(a[c]||(i("new io instance for %s",u),a[c]=s(u,t)),n=a[c]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}t.protocol=o.protocol,t.connect=u,t.Manager=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/manager.js"),t.Socket=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/socket.js")},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/manager.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/engine.io-client/lib/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/socket.js"),s=n("../notebook-dds/node_modules/component-emitter/index.js"),i=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/on.js"),u=n("../notebook-dds/node_modules/component-bind/index.js"),c=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client:manager"),d=n("../notebook-dds/node_modules/indexof/index.js"),l=n("../notebook-dds/node_modules/backo2/index.js"),h=Object.prototype.hasOwnProperty;function f(e,t){if(!(this instanceof f))return new f(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||i;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=f,f.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},f.prototype.updateSocketIds=function(){for(var e in this.nsps)h.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},f.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},s(f.prototype),f.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},f.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},f.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(e,t){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var s=a(n,"open",(function(){o.onopen(),e&&e()})),i=a(n,"error",(function(t){if(c("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else o.maybeReconnectOnOpen()}));if(!1!==this._timeout){var u=this._timeout;c("connect attempt will timeout after %d",u),0===u&&s.destroy();var d=setTimeout((function(){c("connect attempt timed out after %d",u),s.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",u)}),u);this.subs.push({destroy:function(){clearTimeout(d)}})}return this.subs.push(s),this.subs.push(i),this},f.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",u(this,"ondata"))),this.subs.push(a(e,"ping",u(this,"onping"))),this.subs.push(a(e,"pong",u(this,"onpong"))),this.subs.push(a(e,"error",u(this,"onerror"))),this.subs.push(a(e,"close",u(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",u(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(e){this.decoder.add(e)},f.prototype.ondecoded=function(e){this.emit("packet",e)},f.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},f.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",s),n.on("connect",(function(){n.id=r.generateId(e)})),this.autoConnect&&s()}function s(){~d(r.connecting,n)||r.connecting.push(n)}return n},f.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},f.prototype.packet=function(e){c("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},f.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},f.prototype.cleanup=function(){c("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(e){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(c("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},f.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/on.js":function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/socket.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/index.js"),o=n("../notebook-dds/node_modules/component-emitter/index.js"),s=n("../notebook-dds/node_modules/to-array/index.js"),i=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/on.js"),a=n("../notebook-dds/node_modules/component-bind/index.js"),u=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client:socket"),c=n("../notebook-dds/node_modules/parseqs/index.js"),d=n("../notebook-dds/node_modules/has-binary2/index.js");e.exports=f;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=o.prototype.emit;function f(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[i(e,"open",a(this,"onopen")),i(e,"packet",a(this,"onpacket")),i(e,"close",a(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},f.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(l.hasOwnProperty(e))return h.apply(this,arguments),this;var t=s(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:d(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?c.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},f.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=s(arguments);u("sending ack %j",o),t.packet({type:d(o)?r.BINARY_ACK:r.ACK,id:e,data:o})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/lib/url.js":function(e,t,n){var r=n("../notebook-dds/node_modules/parseuri/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port,n.href=n.protocol+"://"+s+(t&&t.port===n.port?"":":"+n.port),n}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/node_modules/debug/src/browser.js":function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).DEBUG),e}(t=e.exports=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/node_modules/debug/src/debug.js")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(s=o))})),e.splice(s,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-client/node_modules/debug/src/debug.js":function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,s=o-(n||o);e.diff=s,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var o=t.formatters[r];if("function"==typeof o){var s=i[u];n=o.call(e,s),i.splice(u,1),u--}return n})),t.formatArgs.call(e,i);var c=r.log||t.log||console.log.bind(console);c.apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/ms/index.js"),t.instances=[],t.names=[],t.skips=[],t.formatters={}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/binary.js":function(e,t,n){var r=n("../notebook-dds/node_modules/isarray/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/is-buffer.js"),s=Object.prototype.toString,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===s.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===s.call(File);function u(e,t){if(!e)return e;if(o(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){for(var s=new Array(e.length),i=0;i<e.length;i++)s[i]=u(e[i],t);return s}if("object"==typeof e&&!(e instanceof Date)){for(var a in s={},e)s[a]=u(e[a],t);return s}return e}t.deconstructPacket=function(e){var t=[],n=e.data,r=e;return r.data=u(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],n);else if("object"==typeof t)for(var s in t)t[s]=e(t[s],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,s=e;!function e(u,c,d){if(!u)return u;if(i&&u instanceof Blob||a&&u instanceof File){n++;var l=new FileReader;l.onload=function(){d?d[c]=this.result:s=this.result,--n||t(s)},l.readAsArrayBuffer(u)}else if(r(u))for(var h=0;h<u.length;h++)e(u[h],h,u);else if("object"==typeof u&&!o(u))for(var f in u)e(u[f],f,u)}(s),n||t(s)}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/index.js":function(e,t,n){var r=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/node_modules/debug/src/browser.js")("socket.io-parser"),o=n("../notebook-dds/node_modules/component-emitter/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/binary.js"),i=n("../notebook-dds/node_modules/isarray/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/is-buffer.js");function u(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=u,t.Decoder=l;var c=t.ERROR+'"encode error"';function d(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===o)return c;n+=o}return r("encoded %j as %s",e,n),n}function l(){this.reconstructor=null}function h(e){this.reconPack=e,this.buffers=[]}function f(e){return{type:t.ERROR,data:"parser error: "+e}}u.prototype.encode=function(e,n){r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){s.removeBlobs(e,(function(e){var n=s.deconstructPacket(e),r=d(n.packet),o=n.buffers;o.unshift(r),t(o)}))}(e,n):n([d(e)])},o(l.prototype),l.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return f("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var s=n+1;"-"!==e.charAt(++n)&&n!=e.length;);var a=e.substring(s,n);if(a!=Number(a)||"-"!==e.charAt(n))throw new Error("Illegal attachments");o.attachments=Number(a)}if("/"===e.charAt(n+1)){for(s=n+1;++n&&","!==(c=e.charAt(n))&&n!==e.length;);o.nsp=e.substring(s,n)}else o.nsp="/";var u=e.charAt(n+1);if(""!==u&&Number(u)==u){for(s=n+1;++n;){var c;if(null==(c=e.charAt(n))||Number(c)!=c){--n;break}if(n===e.length)break}o.id=Number(e.substring(s,n+1))}if(e.charAt(++n)){var d=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!1===d||o.type!==t.ERROR&&!i(d))return f("invalid payload");o.data=d}return r("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new h(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=s.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/is-buffer.js":function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||r&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,r="function"==typeof ArrayBuffer}).call(this,n("./node_modules/buffer/index.js").Buffer)},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/node_modules/debug/src/browser.js":function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).DEBUG),e}(t=e.exports=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/node_modules/debug/src/debug.js")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(s=o))})),e.splice(s,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/socket.io-parser/node_modules/debug/src/debug.js":function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,s=o-(n||o);e.diff=s,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var o=t.formatters[r];if("function"==typeof o){var s=i[u];n=o.call(e,s),i.splice(u,1),u--}return n})),t.formatArgs.call(e,i);var c=r.log||t.log||console.log.bind(console);c.apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/node_modules/ms/index.js"),t.instances=[],t.names=[],t.skips=[],t.formatters={}},"../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/agent.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IAgentScheduler=t.ITaskManager=void 0,t.ITaskManager="ITaskManager",t.IAgentScheduler="IAgentScheduler"},"../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/dataStoreContext.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlushMode=void 0,function(e){e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual"}(t.FlushMode||(t.FlushMode={}))},"../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/dataStoreFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidDataStoreFactory=void 0,t.IFluidDataStoreFactory="IFluidDataStoreFactory"},"../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/dataStoreRegistry.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidDataStoreRegistry=void 0,t.IFluidDataStoreRegistry="IFluidDataStoreRegistry"},"../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/garbageCollection.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gcBlobKey=void 0,t.gcBlobKey="gc"},"../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/agent.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/dataStoreFactory.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/dataStoreRegistry.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/dataStoreContext.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/garbageCollection.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/protocol.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/summary.js"),t)},"../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/protocol.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/summary.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.channelsTreeName=t.CreateSummarizerNodeSource=void 0,function(e){e[e.FromSummary=0]="FromSummary",e[e.FromAttach=1]="FromAttach",e[e.Local=2]="Local"}(t.CreateSummarizerNodeSource||(t.CreateSummarizerNodeSource={})),t.channelsTreeName=".channels"},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/alfred/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.configureWebSocketServices=void 0;const a=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/index.js"),u=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js"),c=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/index.js"),d=i(n("../notebook-dds/node_modules/json-stringify-safe/stringify.js")),l=s(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/node_modules/semver/semver.js")),h=s(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js")),f=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/index.js");function m(e){return`${e.tenantId}/${e.documentId}`}const p=["^0.4.0","^0.3.0","^0.2.0","^0.1.0"];function g(e,t,n){if(!e)return;const r={key:t,weight:1,eventName:"throttling"};try{null==n||n.info("Incrementing throttle count: "+t,{messageMetaData:r}),e.incrementCount(t)}catch(e){if(e instanceof h.ThrottlingError)return null==n||n.info("Throttled: "+t,{messageMetaData:Object.assign(Object.assign({},r),{reason:e.message,retryAfterInSeconds:e.retryAfter})}),e;null==n||n.error("Throttle increment failed: "+d.default(e,void 0,2),{messageMetaData:r})}}t.configureWebSocketServices=function(e,t,n,r,o,s,i,b=1e6,v=3600,y=!1,_,w){e.on("connection",e=>{const k=new Map,S=new Map,j=new Map;let C;const x=e=>c.canWrite(e)||c.canSummarize(e);function O(){void 0!==C&&(clearTimeout(C),C=void 0)}async function E(s){const a=g(_,s.tenantId+"_OpenSocketConn",i);if(a)return Promise.reject(a);if(!s.token)return Promise.reject("Must provide an authorization token");const u=s.token,w=c.validateTokenClaims(u,s.id,s.tenantId,v,y);if(!w)return Promise.reject("Invalid claims");try{await n.verifyToken(w.tenantId,u)}catch(e){return Promise.reject("Invalid token")}const E=f.generateClientId(),I={tenantId:w.tenantId,documentId:w.documentId};await Promise.all([e.join(m(I)),e.join("client#"+E)]);const A=s.client?s.client:{};A.user=w.user,A.scopes=w.scopes,j.set(E,A.scopes),S.set(E,I);const N=s.versions?s.versions:["^0.1.0"],T=function(e){let t=null;for(const n of e)for(const e of p)if(l.intersects(e,n))return t=e,t}(N);if(!T)return Promise.reject(`Unsupported client protocol.Server: ${p}. Client: ${JSON.stringify(N)}`);const F=r.getOrCreateDocument(w.tenantId,w.documentId),P=o.getClients(w.tenantId,w.documentId),[R,D]=await Promise.all([F,P]);if(D.length>b)return Promise.reject({code:400,message:"Too many clients are already connected to this document.",retryAfter:300});if(await o.addClient(w.tenantId,w.documentId,E,A),y&&w.exp){const t=1e3*w.exp-Math.round((new Date).getTime());if(!(t>0))return Promise.reject("Invalid token expiry");M=t,O(),C=setTimeout(()=>{e.disconnect(!0)},M)}var M;let L;if(B=A.scopes,q=R.existing,z=s.mode,!x(B)||q&&"write"!==z)L={claims:w,clientId:E,existing:R.existing,maxMessageSize:1024,mode:"read",parentBranch:null,serviceConfiguration:{blockSize:h.DefaultServiceConfiguration.blockSize,maxMessageSize:h.DefaultServiceConfiguration.maxMessageSize,summary:h.DefaultServiceConfiguration.summary},initialClients:D,initialMessages:[],initialSignals:[],supportedVersions:p,version:T};else{const n=await t.getOrderer(w.tenantId,w.documentId),r=await n.connect(e,E,A,R);r.connect(),k.set(E,r),r.once("error",t=>{const n={documentId:r.documentId,tenantId:r.tenantId};i.error("Disconnecting socket on connection error: "+d.default(t,void 0,2),{messageMetaData:n}),O(),e.disconnect(!0)}),L={claims:w,clientId:E,existing:R.existing,maxMessageSize:r.maxMessageSize,mode:"write",parentBranch:null,serviceConfiguration:{blockSize:r.serviceConfiguration.blockSize,maxMessageSize:r.serviceConfiguration.maxMessageSize,summary:r.serviceConfiguration.summary},initialClients:D,initialMessages:[],initialSignals:[],supportedVersions:p,version:T}}var B,q,z;return{connection:L,connectVersions:N,details:A}}e.on("connect_document",async t=>{E(t).then(t=>{e.emit("connect_document_success",t.connection),e.emitToRoom(m(S.get(t.connection.clientId)),"signal",f.createRoomJoinMessage(t.connection.clientId,t.details))},n=>{const r={documentId:t.id,tenantId:t.tenantId};i.error("Connect Document error: "+d.default(n,void 0,2),{messageMetaData:r}),e.emit("connect_document_error",n)})}),e.on("submitOp",(t,n)=>{const r=g(w,(e=>e+"_SubmitOp")(t),i);if(r){const t=f.createNackMessage(r.code,u.NackErrorType.ThrottlingError,r.message,r.retryAfter);e.emit("nack","",[t])}else if(k.has(t)){const e=k.get(t);n.forEach(t=>{const n=(Array.isArray(t)?t:[t]).filter(e=>e.type!==u.MessageType.RoundTrip||(s.writeLatencyMetric("latency",e.traces).catch(e=>{i.error(e.stack)}),!1)).map(e=>function(e){e.operation&&e.operation.traces&&0===f.getRandomInt(100)&&e.operation.traces.push({action:"start",service:"alfred",timestamp:Date.now()});const t={clientSequenceNumber:e.clientSequenceNumber,contents:e.contents,metadata:e.metadata,referenceSequenceNumber:e.referenceSequenceNumber,traces:e.traces,type:e.type};if(a.isSystemType(t.type)){const n=t;return n.data=e.data,n}return t}(e));n.length>0&&e.order(n)})}else{let n;n=x(j.get(t))?f.createNackMessage(400,u.NackErrorType.BadRequestError,"Readonly client"):S.has(t)?f.createNackMessage(403,u.NackErrorType.InvalidScopeError,"Invalid scope"):f.createNackMessage(400,u.NackErrorType.BadRequestError,"Nonexistent client"),e.emit("nack","",[n])}}),e.on("submitSignal",(t,n)=>{if(S.has(t))n.forEach(n=>{const r=Array.isArray(n)?n:[n];for(const n of r){const r={clientId:t,content:n};e.emitToRoom(m(S.get(t)),"signal",r)}});else{const t=f.createNackMessage(400,u.NackErrorType.BadRequestError,"Nonexistent client");e.emit("nack","",[t])}}),e.on("disconnect",async()=>{O();for(const[e,t]of k){const n={documentId:t.documentId,tenantId:t.tenantId};i.info("Disconnect of "+e,{messageMetaData:n}),t.disconnect()}const t=[];for(const[n,r]of S){const s={documentId:r.documentId,tenantId:r.tenantId};i.info(`Disconnect of ${n} from room`,{messageMetaData:s}),t.push(o.removeClient(r.tenantId,r.documentId,n)),e.emitToRoom(m(r),"signal",f.createRoomLeaveMessage(n))}await Promise.all(t)})})}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/broadcaster/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/broadcaster/lambda.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/broadcaster/lambdaFactory.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/broadcaster/lambda.js":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.BroadcasterLambda=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js");class o{constructor(e,t,n){this.documentId=e,this.tenantId=t,this.event=n,this.messages=[]}}const s="function"==typeof e?e:setTimeout;t.BroadcasterLambda=class{constructor(e,t){this.publisher=e,this.context=t,this.pending=new Map,this.current=new Map,this.isMessageSending=!1}handler(e){const t=r.extractBoxcar(e);for(const e of t.contents){let t,n;if(e.type===r.SequencedOperationType){const r=e;t=`${r.tenantId}/${r.documentId}`,n="op"}else e.type===r.NackOperationType&&(t="client#"+e.clientId,n="nack");if(t){const r=e;this.pending.has(t)||this.pending.set(t,new o(r.documentId,r.tenantId,n)),this.pending.get(t).messages.push(r.operation)}}this.pendingOffset=e,this.sendPending()}close(){this.pending.clear(),this.current.clear()}hasPendingWork(){return 0!==this.pending.size||0!==this.current.size}sendPending(){0===this.pending.size||this.isMessageSending||(this.isMessageSending=!0,s(()=>{const e=this.pendingOffset;this.current=this.pending,this.pending=new Map,this.isMessageSending=!1,this.current.forEach((e,t)=>{this.publisher.to(t).emit(e.event,e.documentId,e.messages)}),this.context.checkpoint(e),this.current.clear(),this.sendPending()}))}}}).call(this,n("./node_modules/timers-browserify/main.js").setImmediate)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/broadcaster/lambdaFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BroadcasterLambdaFactory=void 0;const r=n("./node_modules/events/events.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/broadcaster/lambda.js");class s extends r.EventEmitter{constructor(e){super(),this.publisher=e,this.publisher.on("error",e=>{this.emit("error",e)})}async create(e,t){return new o.BroadcasterLambda(this.publisher,t)}async dispose(){await this.publisher.close()}}t.BroadcasterLambdaFactory=s},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/copier/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/copier/lambda.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/copier/lambdaFactory.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/copier/lambda.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopierLambda=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js");t.CopierLambda=class{constructor(e,t){this.rawOpCollection=e,this.context=t,this.pendingJobs=new Map,this.currentJobs=new Map}handler(e){const t=r.extractBoxcar(e),n=t.contents,o=`${t.tenantId}/${t.documentId}`,s={index:e.offset,documentId:t.documentId,tenantId:t.tenantId,contents:n.map(e=>e)};this.pendingJobs.has(o)||this.pendingJobs.set(o,[]),this.pendingJobs.get(o).push(s),this.pendingOffset=e,this.sendPending()}close(){this.pendingJobs.clear(),this.currentJobs.clear()}sendPending(){if(this.currentJobs.size>0||0===this.pendingJobs.size)return;const e=this.currentJobs;this.currentJobs=this.pendingJobs,this.pendingJobs=e;const t=this.pendingOffset,n=[];for(const[,e]of this.currentJobs){const t=this.processMongoCore(e);n.push(t)}Promise.all(n).then(()=>{this.currentJobs.clear(),this.context.checkpoint(t),this.sendPending()},e=>{this.context.error(e,{restart:!0})})}async processMongoCore(e){await this.rawOpCollection.insertMany(e,!1).catch(e=>{if(11e3!==e.code)return Promise.reject(e)})}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/copier/lambdaFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopierLambdaFactory=void 0;const r=n("./node_modules/events/events.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/copier/lambda.js");class s extends r.EventEmitter{constructor(e,t){super(),this.mongoManager=e,this.rawOpCollection=t}async create(e,t){return new o.CopierLambda(this.rawOpCollection,t)}async dispose(){await this.mongoManager.close()}}t.CopierLambdaFactory=s},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/checkpointContext.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckpointContext=void 0,t.CheckpointContext=class{constructor(e,t,n,r){this.tenantId=e,this.id=t,this.checkpointManager=n,this.context=r,this.closed=!1}checkpoint(e){this.closed||(this.pendingUpdateP?this.pendingCheckpoint=e:(this.pendingUpdateP=this.checkpointCore(e),this.pendingUpdateP.then(()=>{if(this.context.checkpoint(e.queuedMessage),this.pendingUpdateP=null,this.pendingCheckpoint){const e=this.pendingCheckpoint;this.pendingCheckpoint=null,this.checkpoint(e)}},e=>{const t={documentId:this.id,tenantId:this.tenantId};this.context.log.error("Error writing checkpoint to MongoDB: "+JSON.stringify(e),{messageMetaData:t})})))}close(){this.closed=!0}checkpointCore(e){if(this.closed)return;let t;if(e.clear)t=this.checkpointManager.deleteCheckpoint(e);else{const n={branchMap:e.branchMap,clients:e.clients,durableSequenceNumber:e.durableSequenceNumber,logOffset:e.logOffset,sequenceNumber:e.sequenceNumber,epoch:e.epoch,term:e.term};t=this.checkpointManager.writeCheckpoint(n)}return t.catch(t=>{const n={documentId:this.id,tenantId:this.tenantId};return this.context.log.error("Error writing checkpoint to MongoDB: "+JSON.stringify(t),{messageMetaData:n}),new Promise((t,n)=>{t(this.checkpointCore(e))})})}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/checkpointManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDeliCheckpointManagerFromCollection=void 0,t.createDeliCheckpointManagerFromCollection=function(e,t,n){return{writeCheckpoint:async r=>n.update({documentId:t,tenantId:e},{deli:JSON.stringify(r)},null),deleteCheckpoint:async()=>n.update({documentId:t,tenantId:e},{deli:""},null)}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/clientSeqManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientSequenceNumberManager=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),o={compare:(e,t)=>e.referenceSequenceNumber-t.referenceSequenceNumber,min:{canEvict:!0,clientId:void 0,clientSequenceNumber:0,lastUpdate:-1,nack:!1,referenceSequenceNumber:-1,scopes:[]}};t.ClientSequenceNumberManager=class{constructor(){this.clientNodeMap=new Map,this.clientSeqNumbers=new r.Heap(o)}has(e){return this.clientNodeMap.has(e)}get(e){const t=this.clientNodeMap.get(e);if(void 0!==t)return t.value}count(){return this.clientNodeMap.size}peek(){const e=this.clientSeqNumbers.peek();if(void 0!==e)return e.value}cloneValues(){const e=[];for(const[,t]of this.clientNodeMap){const n=t.value;e.push(Object.assign({},n))}return e}upsertClient(e,t,n,r,o,s=[],i=!1){let a=!1;if(!this.clientNodeMap.has(e)){const u=this.clientSeqNumbers.add({canEvict:o,clientId:e,clientSequenceNumber:t,lastUpdate:r,nack:i,referenceSequenceNumber:n,scopes:s});this.clientNodeMap.set(e,u),a=!0}return this.updateClient(e,r,t,n,i),a}updateClient(e,t,n,r,o){const s=this.clientNodeMap.get(e);s.value.referenceSequenceNumber=r,s.value.clientSequenceNumber=n,s.value.lastUpdate=t,s.value.nack=o,this.clientSeqNumbers.update(s)}removeClient(e){if(!this.clientNodeMap.has(e))return!1;const t=this.clientNodeMap.get(e);return this.clientSeqNumbers.remove(t),this.clientNodeMap.delete(e),!0}getMinimumSequenceNumber(){return this.clientSeqNumbers.count()>0?this.clientSeqNumbers.peek().value.referenceSequenceNumber:-1}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/checkpointManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/lambda.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/lambdaFactory.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/lambda.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DeliLambda=void 0;const o=r(n("./node_modules/assert/assert.js")),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/index.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/index.js"),u=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js"),c=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/checkpointContext.js"),d=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/clientSeqManager.js");var l,h,f;!function(e){e[e.Duplicate=0]="Duplicate",e[e.Gap=1]="Gap",e[e.ConsecutiveOrSystem=2]="ConsecutiveOrSystem"}(l||(l={})),function(e){e[e.Immediate=0]="Immediate",e[e.Later=1]="Later",e[e.Never=2]="Never"}(h||(h={})),function(e){e[e.ClearCache=0]="ClearCache",e[e.NoOp=1]="NoOp"}(f||(f={})),t.DeliLambda=class{constructor(e,t,n,r,o,s,i,a){if(this.context=e,this.tenantId=t,this.documentId=n,this.lastCheckpoint=r,this.forwardProducer=s,this.reverseProducer=i,this.serviceConfiguration=a,this.clientSeqManager=new d.ClientSequenceNumberManager,this.minimumSequenceNumber=0,this.lastSendP=Promise.resolve(),this.lastSentMSN=0,this.lastInstruction=f.NoOp,this.noActiveClients=!1,this.canClose=!1,r.clients)for(const e of r.clients)this.clientSeqManager.upsertClient(e.clientId,e.clientSequenceNumber,e.referenceSequenceNumber,e.lastUpdate,e.canEvict,e.scopes,e.nack);this.sequenceNumber=r.sequenceNumber,this.term=r.term,this.epoch=r.epoch,this.durableSequenceNumber=r.durableSequenceNumber;const u=this.clientSeqManager.getMinimumSequenceNumber();this.minimumSequenceNumber=-1===u?this.sequenceNumber:u,this.logOffset=r.logOffset,this.checkpointContext=new c.CheckpointContext(this.tenantId,this.documentId,o,e)}handler(e){if(e.offset<=this.logOffset)return void this.context.checkpoint(e);this.logOffset=e.offset;const t=u.extractBoxcar(e);for(const e of t.contents){const t=this.ticket(e,this.createTrace("start"));if(t){if(this.lastInstruction=t.instruction,!t.nacked){if(this.checkIdleClients(t),t.type!==i.MessageType.NoClient&&t.type!==i.MessageType.Control&&this.noActiveClients&&this.sendToAlfred(this.createOpMessage(i.MessageType.NoClient)),t.send===h.Never)continue;if(this.clearNoopConsolidationTimer(),t.send===h.Later){this.setNoopConsolidationTimer();continue}}this.lastSentMSN=t.msn,this.lastSendP=this.sendToScriptorium(t.message)}}const n=this.generateCheckpoint(e);this.lastSendP.then(()=>{this.lastInstruction===f.ClearCache&&(n.clear=!0),this.checkpointContext.checkpoint(n)},e=>{const t={documentId:this.documentId,tenantId:this.tenantId};this.context.log.error("Could not send message to scriptorium: "+JSON.stringify(e),{messageMetaData:t}),this.context.error(e,{restart:!0,tenantId:this.tenantId,documentId:this.documentId})}),this.clearIdleTimer(),this.setIdleTimer()}close(){this.checkpointContext.close(),this.clearIdleTimer(),this.clearNoopConsolidationTimer()}ticket(e,t){if(e.type!==u.RawOperationType)return;const n=e,r=this.extractSystemContent(n),s=this.checkOrder(n);if(s===l.Duplicate)return;if(s===l.Gap)return this.createNackMessage(n,400,i.NackErrorType.BadRequestError,"Gap detected in incoming op");if(n.clientId){const e=this.clientSeqManager.get(n.clientId);if(!e||e.nack)return this.createNackMessage(n,400,i.NackErrorType.BadRequestError,"Nonexistent client");if(n.clientId&&-1!==n.operation.referenceSequenceNumber&&n.operation.referenceSequenceNumber<this.minimumSequenceNumber)return this.clientSeqManager.upsertClient(n.clientId,n.operation.clientSequenceNumber,this.minimumSequenceNumber,n.timestamp,!0,[],!0),this.createNackMessage(n,400,i.NackErrorType.BadRequestError,`Refseq ${n.operation.referenceSequenceNumber} < ${this.minimumSequenceNumber}`);if(n.operation.type===i.MessageType.Summarize&&!a.canSummarize(e.scopes))return this.createNackMessage(n,403,i.NackErrorType.InvalidScopeError,`Client ${n.clientId} does not have summary permission`)}else if(n.operation.type===i.MessageType.ClientLeave){if(!this.clientSeqManager.removeClient(r))return}else if(n.operation.type===i.MessageType.ClientJoin){const e=r;if(!this.clientSeqManager.upsertClient(e.clientId,0,this.minimumSequenceNumber,n.timestamp,!0,e.detail.scopes))return;this.canClose=!1}let c=this.sequenceNumber;n.clientId?(n.operation.type!==i.MessageType.NoOp&&(c=this.revSequenceNumber(),-1===n.operation.referenceSequenceNumber&&(n.operation.referenceSequenceNumber=c)),o.default(n.operation.referenceSequenceNumber>=this.minimumSequenceNumber,`${n.operation.referenceSequenceNumber} >= ${this.minimumSequenceNumber}`),this.clientSeqManager.upsertClient(n.clientId,n.operation.clientSequenceNumber,n.operation.referenceSequenceNumber,n.timestamp,!0)):n.operation.type!==i.MessageType.NoOp&&n.operation.type!==i.MessageType.NoClient&&n.operation.type!==i.MessageType.Control&&(c=this.revSequenceNumber());const d=this.clientSeqManager.getMinimumSequenceNumber();-1===d?(this.minimumSequenceNumber=c,this.noActiveClients=!0):(this.minimumSequenceNumber=d,this.noActiveClients=!1);let m=h.Immediate,p=f.NoOp;if(n.operation.type===i.MessageType.NoOp)n.clientId?null===n.operation.contents||this.minimumSequenceNumber<=this.lastSentMSN?m=h.Later:c=this.revSequenceNumber():this.minimumSequenceNumber<=this.lastSentMSN?m=h.Never:c=this.revSequenceNumber();else if(n.operation.type===i.MessageType.NoClient)this.noActiveClients?(c=this.revSequenceNumber(),n.operation.referenceSequenceNumber=c,this.minimumSequenceNumber=c):m=h.Never;else if(n.operation.type===i.MessageType.Control){m=h.Never;const e=r;if(e.type===u.ControlMessageType.UpdateDSN){const t={documentId:this.documentId,tenantId:this.tenantId};this.context.log.info("Update DSN: "+JSON.stringify(e),{messageMetaData:t});const n=e.contents,r=n.durableSequenceNumber;r>=this.durableSequenceNumber&&(n.clearCache&&this.noActiveClients&&(p=f.ClearCache,this.canClose=!0,this.context.log.info("Deli cache will be cleared",{messageMetaData:t})),this.durableSequenceNumber=r)}}n.operation.traces&&n.operation.traces.length>1&&(n.operation.traces.push(t),n.operation.traces.push(this.createTrace("end")));const g=this.createOutputMessage(n,void 0,c,r);return{instruction:p,message:{documentId:n.documentId,operation:g,tenantId:n.tenantId,type:u.SequencedOperationType},msn:this.minimumSequenceNumber,nacked:!1,send:m,timestamp:n.timestamp,type:n.operation.type}}extractSystemContent(e){if(s.isSystemType(e.operation.type)){const t=e.operation;if(t.data)return JSON.parse(t.data)}}createOutputMessage(e,t,n,r){const o={clientId:e.clientId,clientSequenceNumber:e.operation.clientSequenceNumber,contents:e.operation.contents,metadata:e.operation.metadata,serverMetadata:e.operation.serverMetadata,minimumSequenceNumber:this.minimumSequenceNumber,origin:t,referenceSequenceNumber:e.operation.referenceSequenceNumber,sequenceNumber:n,term:this.term,timestamp:e.timestamp,traces:e.operation.traces,type:e.operation.type};if(e.operation.type===i.MessageType.Summarize||e.operation.type===i.MessageType.NoClient){const e=o,t=JSON.stringify(this.generateDeliCheckpoint());return e.additionalContent=t,e}if(void 0!==r){const e=o;return e.data=JSON.stringify(r),e}return o}checkOrder(e){if(!e.clientId)return l.ConsecutiveOrSystem;const t=e.clientId,n=e.operation.clientSequenceNumber,r=this.clientSeqManager.get(t);if(!r)return l.ConsecutiveOrSystem;const o={documentId:this.documentId,tenantId:this.tenantId},s=r.clientSequenceNumber+1;return n===s?l.ConsecutiveOrSystem:n>s?(this.context.log.info(`Gap ${t}:${s} > ${n}`,{messageMetaData:o}),l.Gap):(this.context.log.info(`Duplicate ${t}:${s} < ${n}`,{messageMetaData:o}),l.Duplicate)}sendToScriptorium(e){return this.forwardProducer.send([e],e.tenantId,e.documentId)}sendToAlfred(e){this.reverseProducer.send([e],e.tenantId,e.documentId).catch(e=>{const t={documentId:this.documentId,tenantId:this.tenantId};this.context.log.error("Could not send message to alfred: "+JSON.stringify(e),{messageMetaData:t}),this.context.error(e,{restart:!0,tenantId:this.tenantId,documentId:this.documentId})})}checkIdleClients(e){if(e.type!==i.MessageType.ClientLeave){const t=this.getIdleClient(e.timestamp);if(t){const e=this.createLeaveMessage(t.clientId);this.sendToAlfred(e)}}}createLeaveMessage(e){const t={clientSequenceNumber:-1,contents:null,data:JSON.stringify(e),referenceSequenceNumber:-1,traces:this.serviceConfiguration.enableTraces?[]:void 0,type:i.MessageType.ClientLeave};return{clientId:null,documentId:this.documentId,operation:t,tenantId:this.tenantId,timestamp:Date.now(),type:u.RawOperationType}}createNackMessage(e,t,n,r){const o={clientId:e.clientId,documentId:this.documentId,operation:{content:{code:t,type:n,message:r},operation:e.operation,sequenceNumber:this.minimumSequenceNumber},tenantId:this.tenantId,type:u.NackOperationType};return{instruction:f.NoOp,message:o,msn:this.minimumSequenceNumber,nacked:!0,send:h.Immediate,timestamp:e.timestamp,type:e.operation.type}}createOpMessage(e){return{clientId:null,documentId:this.documentId,operation:{clientSequenceNumber:-1,contents:null,referenceSequenceNumber:-1,traces:this.serviceConfiguration.enableTraces?[]:void 0,type:e},tenantId:this.tenantId,timestamp:Date.now(),type:u.RawOperationType}}createTrace(e){return{action:e,service:"deli",timestamp:Date.now()}}generateCheckpoint(e){const t=this.generateDeliCheckpoint();return t.queuedMessage=e,t}generateDeliCheckpoint(){return{branchMap:this.branchMap?this.branchMap.serialize():void 0,clients:this.clientSeqManager.cloneValues(),durableSequenceNumber:this.durableSequenceNumber,epoch:this.epoch,logOffset:this.logOffset,sequenceNumber:this.sequenceNumber,term:this.term}}revSequenceNumber(){return++this.sequenceNumber}getIdleClient(e){if(this.clientSeqManager.count()>0){const t=this.clientSeqManager.peek();if(t.canEvict&&e-t.lastUpdate>this.serviceConfiguration.deli.clientTimeout)return t}}setIdleTimer(){this.noActiveClients||(this.idleTimer=setTimeout(()=>{if(!this.noActiveClients){const e=this.createOpMessage(i.MessageType.NoOp);this.sendToAlfred(e)}},this.serviceConfiguration.deli.activityTimeout))}clearIdleTimer(){void 0!==this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=void 0)}setNoopConsolidationTimer(){this.noActiveClients||(this.noopTimer=setTimeout(()=>{if(!this.noActiveClients){const e=this.createOpMessage(i.MessageType.NoOp);this.sendToAlfred(e)}},this.serviceConfiguration.deli.noOpConsolidationTimeout))}clearNoopConsolidationTimer(){void 0!==this.noopTimer&&(clearTimeout(this.noopTimer),this.noopTimer=void 0)}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/lambdaFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeliLambdaFactory=void 0;const r=n("./node_modules/events/events.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/index.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/index.js"),u=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/lambda.js"),c=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/checkpointManager.js"),d=e=>({branchMap:void 0,clients:void 0,durableSequenceNumber:0,epoch:e,logOffset:-1,sequenceNumber:0,term:1});class l extends r.EventEmitter{constructor(e,t,n,r,o,s){super(),this.mongoManager=e,this.collection=t,this.tenantManager=n,this.forwardProducer=r,this.reverseProducer=o,this.serviceConfiguration=s}async create(e,t){const n=e.get("documentId"),r=e.get("tenantId"),o=e.get("leaderEpoch"),s=(await this.tenantManager.getTenant(r)).gitManager,i=await this.collection.findOne({documentId:n,tenantId:r});if(!i)return new a.NoOpLambda(t);let l;const h={documentId:n,tenantId:r};void 0===i.deli||null===i.deli?(t.log.info("New document. Setting empty deli checkpoint",{messageMetaData:h}),l=d(o)):""===i.deli?(t.log.info("Existing document. Fetching checkpoint from summary",{messageMetaData:h}),l=await this.loadStateFromSummary(r,n,s,t.log),void 0===l?(t.log.error("Summary cannot be fetched",{messageMetaData:h}),l=d(o)):(l.logOffset=-1,l.epoch=o,t.log.info(JSON.stringify(l)))):l=JSON.parse(i.deli),void 0===l.epoch&&(l.epoch=o,l.term=1);const f=l,m=c.createDeliCheckpointManagerFromCollection(r,n,this.collection);return new u.DeliLambda(t,r,n,f,m,this.forwardProducer,this.reverseProducer,this.serviceConfiguration)}async dispose(){const e=this.mongoManager.close(),t=this.forwardProducer.close(),n=this.reverseProducer.close();await Promise.all([e,t,n])}async loadStateFromSummary(e,t,n,r){const s=await n.getRef(encodeURIComponent(t));if(s)try{const e=await n.getContent(s.object.sha,".serviceProtocol/deli");return JSON.parse(o.toUtf8(e.content,e.encoding))}catch(n){const o={documentId:t,tenantId:e};return r.error("Error fetching deli state from summary",{messageMetaData:o}),void r.error(JSON.stringify(n),{messageMetaData:o})}}async resetCheckpointOnEpochTick(e,t,n,r,o,s){let i=o;if(s!==i.epoch){const o=await this.loadStateFromSummary(e,t,n,r);if(void 0===o)i.epoch=s;else{const a=i.logOffset;i=o,i.epoch=s,++i.term,i.durableSequenceNumber=o.sequenceNumber,i.logOffset=a,await this.createSummaryWithLatestTerm(n,i,t);const u={documentId:t,tenantId:e};r.info("Created a summary on epoch tick",{messageMetaData:u})}}return i}async createSummaryWithLatestTerm(e,t,n){const r=await e.getRef(encodeURIComponent(n)),[a,u]=await Promise.all([e.getCommit(r.object.sha),e.getContent(r.object.sha,".serviceProtocol/scribe")]),c=o.toUtf8(u.content,u.encoding),d=s.generateServiceProtocolEntries(JSON.stringify(t),c),[l,h]=await Promise.all([e.createTree({entries:d}),e.getTree(a.tree.sha,!1)]),f=h.tree.filter(e=>".serviceProtocol"!==e.path).map(e=>({mode:e.mode,path:e.path,sha:e.sha,type:e.type}));f.push({mode:i.FileMode.Directory,path:".serviceProtocol",sha:l.sha,type:"tree"});const m=await e.createGitTree({tree:f}),p={author:{date:(new Date).toISOString(),email:"praguertdev@microsoft.com",name:"Routerlicious Service"},message:`Term Change Summary @T${t.term}S${t.sequenceNumber}`,parents:[a.sha],tree:m.sha},g=await e.createCommit(p);await e.upsertRef(n,g.sha)}}t.DeliLambdaFactory=l},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/foreman/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/foreman/lambda.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/foreman/lambdaFactory.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/foreman/lambda.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ForemanLambda=void 0;const i=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js"),u=s(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js")),c=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/sequencedLambda.js");class d extends c.SequencedLambda{constructor(e,t,n,r,o,s,a){super(o),this.messageSender=e,this.tenantManager=t,this.tokenGenerator=n,this.permissions=r,this.context=o,this.tenantId=s,this.documentId=a,this.taskQueueMap=new Map,this.rateLimiter=new i.RateLimiter(15e3);for(const e in this.permissions)for(const t of this.permissions[e])this.taskQueueMap.set(t,e)}async handlerCore(e){const t=u.extractBoxcar(e);for(const e of t.contents)if(e.type===u.SequencedOperationType){const t=e;if(t.operation.type===a.MessageType.RemoteHelp){let e;const n=JSON.parse(t.operation.data);e=n.version?n.tasks.map(e=>"chain-"+e):n.tasks,await this.trackDocument(t.operation.clientId,t.tenantId,t.documentId,e)}}this.context.checkpoint(e)}async trackDocument(e,t,n,r){const o=await this.tenantManager.getKey(t),s=this.generateQueueTasks(r);for(const r of s){const s=r[0],i=this.rateLimiter.filter(e,r[1]);if(i.length>0){const r=[a.ScopeType.DocRead,a.ScopeType.DocWrite,a.ScopeType.SummaryWrite],u={documentId:n,message:{tasks:i},tenantId:t,token:this.tokenGenerator(t,n,o,r)};this.messageSender.sendTask(s,{content:u,type:"tasks:start"});const c={documentId:n,tenantId:t};this.context.log.info(`Request to ${s}: ${e}:${JSON.stringify(i)}`,{messageMetaData:c})}}}generateQueueTasks(e){const t=new Map;for(const n of e)if(this.taskQueueMap.has(n)){const e=this.taskQueueMap.get(n);t.has(e)||t.set(e,[]),t.get(e).push(n)}return t}}t.ForemanLambda=d},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/foreman/lambdaFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForemanLambdaFactory=void 0;const r=n("./node_modules/events/events.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/foreman/lambda.js");class s extends r.EventEmitter{constructor(e,t,n,r){super(),this.messageSender=e,this.tenantManager=t,this.tokenGenerator=n,this.permissions=r,this.messageSender.on("error",e=>{this.emit("error",e)})}async create(e,t){const n=e.get("tenantId"),r=e.get("documentId");return new o.ForemanLambda(this.messageSender,this.tenantManager,this.tokenGenerator,this.permissions,t,n,r)}async dispose(){await this.messageSender.close()}}t.ForemanLambdaFactory=s},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/alfred/index.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/broadcaster/index.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/copier/index.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/deli/index.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/foreman/index.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/index.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scriptorium/index.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/sequencedLambda.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/index.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/checkpointManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckpointManager=void 0,t.CheckpointManager=class{constructor(e,t,n,r){this.tenantId=e,this.documentId=t,this.documentCollection=n,this.opCollection=r}async write(e,t,n){const r=n.map(e=>Object.assign(Object.assign({},e),{mongoTimestamp:new Date(e.operation.timestamp)}));r.length>0&&await this.opCollection.insertMany(r,!1).catch(e=>{if(11e3!==e.code)return Promise.reject(e)}),await this.documentCollection.update({documentId:this.documentId,tenantId:this.tenantId},{scribe:JSON.stringify(e)},null),await this.opCollection.deleteMany({documentId:this.documentId,"operation.sequenceNumber":{$lte:t},tenantId:this.tenantId})}async delete(e,t){await this.documentCollection.update({documentId:this.documentId,tenantId:this.tenantId},{scribe:""},null),await this.opCollection.deleteMany({documentId:this.documentId,"operation.sequenceNumber":t?{$lte:e}:{$gte:e},tenantId:this.tenantId})}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/checkpointManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/interfaces.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/lambda.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/lambdaFactory.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/summaryReader.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/summaryWriter.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/interfaces.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/lambda.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScribeLambda=void 0;const a=i(n("./node_modules/assert/assert.js")),u=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js"),c=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js"),d=i(n("../notebook-dds/node_modules/double-ended-queue/js/deque.js")),l=s(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/node_modules/lodash/lodash.js")),h=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/sequencedLambda.js"),f=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/utils.js");class m extends h.SequencedLambda{constructor(e,t,n,r,o,s,i,a,u,c,l,h,f){super(e),this.context=e,this.tenantId=t,this.documentId=n,this.summaryWriter=r,this.summaryReader=o,this.checkpointManager=s,this.serviceConfiguration=a,this.producer=u,this.protocolHandler=c,this.term=l,this.protocolHead=h,this.pendingCheckpointMessages=new d.default,this.sequenceNumber=0,this.minSequenceNumber=0,this.clearCache=!1,this.closed=!1,this.lastOffset=i.logOffset,this.setStateFromCheckpoint(i),this.pendingMessages=new d.default(f.filter(e=>e.sequenceNumber>i.protocolState.sequenceNumber))}async handlerCore(e){if(e.offset<=this.lastOffset)return void this.context.checkpoint(e);const t=c.extractBoxcar(e);for(const e of t.contents)if(e.type===c.SequencedOperationType){const t=e;if(this.term&&t.operation.term){if(t.operation.term<this.term)continue;if(t.operation.term>this.term){const e=await this.summaryReader.readLastSummary();if(!e.fromSummary)throw Error("Required summary can't be fetched");this.term=e.term;const t=JSON.parse(e.scribe);this.protocolHead=e.protocolHead,this.protocolHandler=f.initializeProtocol(t.protocolState,this.term),this.setStateFromCheckpoint(t),this.pendingMessages=new d.default(e.messages.filter(e=>e.sequenceNumber>t.protocolState.sequenceNumber)),this.pendingP=void 0,this.pendingCheckpointScribe=void 0,this.pendingCheckpointOffset=void 0,await this.checkpointManager.delete(t.sequenceNumber+1,!1)}}if(t.operation.sequenceNumber<=this.sequenceNumber)continue;if(this.pendingMessages.length>0&&t.operation.sequenceNumber<=this.pendingMessages.peekBack().sequenceNumber)continue;this.pendingMessages.push(t.operation),this.pendingCheckpointMessages.push(t);const n=this.minSequenceNumber!==t.operation.minimumSequenceNumber;this.sequenceNumber=t.operation.sequenceNumber,this.minSequenceNumber=t.operation.minimumSequenceNumber,n&&this.processFromPending(this.minSequenceNumber);const r={documentId:this.documentId,tenantId:this.tenantId};if(this.clearCache=!1,t.operation.type===u.MessageType.Summarize){const e={protocolState:this.protocolHandler.getProtocolState(),pendingOps:this.pendingMessages.toArray()};if(this.processFromPending(t.operation.referenceSequenceNumber),this.protocolHead<this.protocolHandler.sequenceNumber)try{const n=this.generateCheckpoint(this.lastOffset),o=t.operation,s=await this.summaryWriter.writeClientSummary(o,this.lastClientSummaryHead,this.protocolHandler.minimumSequenceNumber,this.protocolHandler.sequenceNumber,this.protocolHandler.quorum.snapshot(),n,this.pendingCheckpointMessages.toArray());this.summaryWriter.isExternal||(s.status?(await this.sendSummaryAck(s.message),await this.sendSummaryConfirmationMessage(o.sequenceNumber,!1),this.protocolHead=this.protocolHandler.sequenceNumber,this.context.log.info("Client summary success @"+t.operation.sequenceNumber,{messageMetaData:r})):(await this.sendSummaryNack(s.message),this.context.log.error("Client summary failure @"+t.operation.sequenceNumber,{messageMetaData:r}),this.revertProtocolState(e.protocolState,e.pendingOps)))}catch(n){if(this.revertProtocolState(e.protocolState,e.pendingOps),!this.serviceConfiguration.scribe.ignoreStorageException)throw n;await this.sendSummaryNack({errorMessage:"Failed to summarize the document.",summaryProposal:{summarySequenceNumber:t.operation.sequenceNumber}})}}else if(t.operation.type===u.MessageType.NoClient){if(a.default(t.operation.referenceSequenceNumber===t.operation.sequenceNumber,`${t.operation.referenceSequenceNumber} != ${t.operation.sequenceNumber}`),a.default(t.operation.minimumSequenceNumber===t.operation.sequenceNumber,`${t.operation.minimumSequenceNumber} != ${t.operation.sequenceNumber}`),this.serviceConfiguration.scribe.generateServiceSummary){const e=t.operation,n=this.generateCheckpoint(this.lastOffset);try{await this.summaryWriter.writeServiceSummary(e,this.protocolHead,n,this.pendingCheckpointMessages.toArray())&&(this.serviceConfiguration.scribe.clearCacheAfterServiceSummary&&(this.clearCache=!0),await this.sendSummaryConfirmationMessage(e.sequenceNumber,this.serviceConfiguration.scribe.clearCacheAfterServiceSummary),this.context.log.info("Service summary success @"+e.sequenceNumber,{messageMetaData:r}))}catch(t){if(!this.serviceConfiguration.scribe.ignoreStorageException)throw t;this.context.log.error("Service summary failure @"+e.sequenceNumber,{messageMetaData:r})}}}else if(t.operation.type===u.MessageType.SummaryAck){const e=t.operation.contents;this.lastClientSummaryHead=e.handle,this.summaryWriter.isExternal&&(this.protocolHead=e.summaryProposal.summarySequenceNumber)}}const n=this.generateCheckpoint(e.offset);this.checkpointCore(n,e,this.clearCache),this.lastOffset=e.offset}close(){this.closed=!0,this.protocolHandler.close()}processFromPending(e){for(;this.pendingMessages.length>0&&this.pendingMessages.peekFront().sequenceNumber<=e;){const e=this.pendingMessages.shift();try{if(e.contents&&"string"==typeof e.contents&&e.type!==u.MessageType.ClientLeave){const t=l.cloneDeep(e);t.contents=JSON.parse(t.contents),this.protocolHandler.processMessage(t,!1)}else this.protocolHandler.processMessage(e,!1)}catch(e){this.context.log.error("Protocol error "+e,{documentId:this.documentId,tenantId:this.tenantId})}}}revertProtocolState(e,t){this.protocolHandler=f.initializeProtocol(e,this.term),this.pendingMessages=new d.default(t)}generateCheckpoint(e){const t=this.protocolHandler.getProtocolState();return{lastClientSummaryHead:this.lastClientSummaryHead,logOffset:e,minimumSequenceNumber:this.minSequenceNumber,protocolState:t,sequenceNumber:this.sequenceNumber}}checkpointCore(e,t,n){if(!this.closed){if(this.pendingP)return this.pendingCheckpointScribe=e,void(this.pendingCheckpointOffset=t);this.pendingP=n?this.checkpointManager.delete(this.protocolHead,!0):this.writeCheckpoint(e),this.pendingP.then(()=>{if(this.pendingP=void 0,this.context.checkpoint(t),this.pendingCheckpointScribe){const e=this.pendingCheckpointScribe,t=this.pendingCheckpointOffset;this.pendingCheckpointScribe=void 0,this.pendingCheckpointOffset=void 0,this.checkpointCore(e,t,n)}},e=>{this.context.error(e,{restart:!0,tenantId:this.tenantId,documentId:this.documentId})})}}async writeCheckpoint(e){const t=this.pendingCheckpointMessages.toArray();if(await this.checkpointManager.write(e,this.protocolHead,t),t.length>0){const e=t[t.length-1].operation.sequenceNumber;for(;this.pendingCheckpointMessages.length>0&&this.pendingCheckpointMessages.peekFront().operation.sequenceNumber<=e;)this.pendingCheckpointMessages.removeFront()}}async sendSummaryAck(e){const t={clientSequenceNumber:-1,contents:e,referenceSequenceNumber:-1,traces:this.serviceConfiguration.enableTraces?[]:void 0,type:u.MessageType.SummaryAck};return this.sendToDeli(t)}async sendSummaryNack(e){const t={clientSequenceNumber:-1,contents:e,referenceSequenceNumber:-1,traces:this.serviceConfiguration.enableTraces?[]:void 0,type:u.MessageType.SummaryNack};return this.sendToDeli(t)}async sendSummaryConfirmationMessage(e,t){const n={type:c.ControlMessageType.UpdateDSN,contents:{durableSequenceNumber:e,clearCache:t}},r={clientSequenceNumber:-1,contents:null,data:JSON.stringify(n),referenceSequenceNumber:-1,traces:this.serviceConfiguration.enableTraces?[]:void 0,type:u.MessageType.Control};return this.sendToDeli(r)}sendToDeli(e){const t={clientId:null,documentId:this.documentId,operation:e,tenantId:this.tenantId,timestamp:Date.now(),type:c.RawOperationType};if(!this.producer)throw new Error("Invalid producer");return this.producer.send([t],this.tenantId,this.documentId)}setStateFromCheckpoint(e){this.sequenceNumber=e.sequenceNumber,this.minSequenceNumber=e.minimumSequenceNumber,this.lastClientSummaryHead=e.lastClientSummaryHead}}t.ScribeLambda=m},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/lambdaFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScribeLambdaFactory=void 0;const r=n("./node_modules/events/events.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/checkpointManager.js"),i=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/lambda.js"),a=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/summaryReader.js"),u=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/summaryWriter.js"),c=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/utils.js"),d={lastClientSummaryHead:void 0,logOffset:-1,minimumSequenceNumber:0,protocolState:{members:[],minimumSequenceNumber:0,proposals:[],sequenceNumber:0,values:[]},sequenceNumber:0};class l extends r.EventEmitter{constructor(e,t,n,r,o,s){super(),this.mongoManager=e,this.documentCollection=t,this.messageCollection=n,this.producer=r,this.tenantManager=o,this.serviceConfiguration=s}async create(e,t){const n=e.get("tenantId"),r=e.get("documentId"),l=(await this.tenantManager.getTenant(n)).gitManager,h=new a.SummaryReader(r,l),[f,m]=await Promise.all([h.readLastSummary(),this.documentCollection.findOne({documentId:r,tenantId:n})]),p={documentId:r,tenantId:n};if(!m)return t.log.info("Creating NoOpLambda due to missing",{messageMetaData:p}),new o.NoOpLambda(t);let g,b=(await this.messageCollection.find({documentId:r,tenantId:n},{"operation.sequenceNumber":1})).map(e=>e.operation);void 0===m.scribe||null===m.scribe?(t.log.info("New document. Setting empty scribe checkpoint",{messageMetaData:p}),g=d,b=[]):""===m.scribe?(t.log.info("Existing document. Fetching checkpoint from summary",{messageMetaData:p}),f.fromSummary?(g=JSON.parse(f.scribe),b=f.messages,g.logOffset=-1,t.log.info(JSON.stringify(g))):(t.log.error("Summary can't be fetched",{messageMetaData:p}),g=d,b=[])):g=JSON.parse(m.scribe);const v=c.initializeProtocol(g.protocolState,f.term),y=new u.SummaryWriter(n,r,l,this.messageCollection),_=new s.CheckpointManager(n,r,this.documentCollection,this.messageCollection);return new i.ScribeLambda(t,m.tenantId,m.documentId,y,h,_,g,this.serviceConfiguration,this.producer,v,f.term,f.protocolHead,b)}async dispose(){await this.mongoManager.close()}}t.ScribeLambdaFactory=l},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/summaryReader.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SummaryReader=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js");t.SummaryReader=class{constructor(e,t){this.documentId=e,this.summaryStorage=t}async readLastSummary(){try{const e=await this.summaryStorage.getRef(encodeURIComponent(this.documentId)),[t,n,o,s]=await Promise.all([this.summaryStorage.getContent(e.object.sha,".protocol/attributes"),this.summaryStorage.getContent(e.object.sha,".serviceProtocol/scribe"),this.summaryStorage.getContent(e.object.sha,".serviceProtocol/deli"),this.summaryStorage.getContent(e.object.sha,".logTail/logTail")]),i=JSON.parse(r.toUtf8(t.content,t.encoding)),a=r.toUtf8(n.content,n.encoding),u=JSON.parse(r.toUtf8(o.content,o.encoding)).term,c=JSON.parse(r.toUtf8(s.content,s.encoding));return{term:u,protocolHead:i.sequenceNumber,scribe:a,messages:c,fromSummary:!0}}catch(e){return{term:1,protocolHead:0,scribe:"",messages:[],fromSummary:!1}}}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/summaryWriter.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SummaryWriter=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js");t.SummaryWriter=class{constructor(e,t,n,r){this.tenantId=e,this.documentId=t,this.summaryStorage=n,this.opStorage=r}get isExternal(){return!1}async writeClientSummary(e,t,n,s,i,a,u){var c;const d=JSON.parse(e.contents),l=await this.summaryStorage.getRef(encodeURIComponent(this.documentId));if(d.head){if(!l||t!==d.head&&l.object.sha!==d.head)return{message:{errorMessage:`Proposed parent summary "${d.head}" does not match actual parent summary "${l?l.object.sha:"n/a"}".`,summaryProposal:{summarySequenceNumber:e.sequenceNumber}},status:!1}}else if(l)return{message:{errorMessage:`Proposed parent summary "${d.head}" does not match actual parent summary "${l.object.sha}".`,summaryProposal:{summarySequenceNumber:e.sequenceNumber}},status:!1};try{await Promise.all(d.parents.map(e=>this.summaryStorage.getCommit(e)))}catch(t){return{message:{errorMessage:"One or more parent summaries are invalid.",summaryProposal:{summarySequenceNumber:e.sequenceNumber}},status:!1}}if(e.referenceSequenceNumber<s)return{message:{errorMessage:`Proposed summary reference sequence number ${e.referenceSequenceNumber} is less than current sequence number ${e.sequenceNumber}`,summaryProposal:{summarySequenceNumber:e.sequenceNumber}},status:!1};const h=r.getQuorumTreeEntries(this.documentId,n,s,null!==(c=e.term)&&void 0!==c?c:1,i),f=await this.generateLogtailEntries(s,e.sequenceNumber+1,u),m=r.generateServiceProtocolEntries(e.additionalContent,JSON.stringify(a)),[p,g,b,v]=await Promise.all([this.summaryStorage.createTree({entries:f}),this.summaryStorage.createTree({entries:h}),this.summaryStorage.createTree({entries:m}),this.summaryStorage.getTree(d.handle,!1)]),y=r.mergeAppAndProtocolTree(v,g);y.push({mode:o.FileMode.Directory,path:".logTail",sha:p.sha,type:"tree"}),y.push({mode:o.FileMode.Directory,path:".serviceProtocol",sha:b.sha,type:"tree"});const _=await this.summaryStorage.createGitTree({tree:y}),w={author:{date:(new Date).toISOString(),email:"praguertdev@microsoft.com",name:"Routerlicious Service"},message:d.message,parents:d.parents,tree:_.sha},k=await this.summaryStorage.createCommit(w);return l?await this.summaryStorage.upsertRef(this.documentId,k.sha):await this.summaryStorage.createRef(this.documentId,k.sha),{message:{handle:k.sha,summaryProposal:{summarySequenceNumber:e.sequenceNumber}},status:!0}}async writeServiceSummary(e,t,n,s){const i=await this.summaryStorage.getRef(encodeURIComponent(this.documentId));if(!i)return!1;const a=await this.generateLogtailEntries(t,e.sequenceNumber+1,s),u=r.generateServiceProtocolEntries(e.additionalContent,JSON.stringify(n)),c=await this.summaryStorage.getCommit(i.object.sha),[d,l,h]=await Promise.all([this.summaryStorage.createTree({entries:a}),this.summaryStorage.createTree({entries:u}),this.summaryStorage.getTree(c.tree.sha,!1)]),f=h.tree.map(e=>({mode:e.mode,path:e.path,sha:e.sha,type:e.type}));f.push({mode:o.FileMode.Directory,path:".logTail",sha:d.sha,type:"tree"}),f.push({mode:o.FileMode.Directory,path:".serviceProtocol",sha:l.sha,type:"tree"});const m=await this.summaryStorage.createGitTree({tree:f}),p={author:{date:(new Date).toISOString(),email:"praguertdev@microsoft.com",name:"Routerlicious Service"},message:"Service Summary @"+e.sequenceNumber,parents:[c.sha],tree:m.sha},g=await this.summaryStorage.createCommit(p);return await this.summaryStorage.upsertRef(this.documentId,g.sha),!0}async generateLogtailEntries(e,t,n){const r=await this.getLogTail(e,t,n);return[{mode:o.FileMode.File,path:"logTail",type:o.TreeEntry.Blob,value:{contents:JSON.stringify(r),encoding:"utf-8"}}]}async getLogTail(e,t,n){if(t-e<=1)return[];{const r={documentId:this.documentId,tenantId:this.tenantId,"operation.sequenceNumber":{$gt:e,$lt:t}},o=await this.opStorage.find(r,{"operation.sequenceNumber":1});if(o.length!==t-e-1){const r=0===o.length?e:o[o.length-1].operation.sequenceNumber+1;for(const e of n)e.operation.sequenceNumber>=r&&e.operation.sequenceNumber<t&&o.push(e)}return o.map(e=>e.operation)}}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scribe/utils.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeProtocol=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/index.js");t.initializeProtocol=(e,t)=>new r.ProtocolOpHandler(e.minimumSequenceNumber,e.sequenceNumber,t,e.members,e.proposals,e.values,()=>-1,()=>{})},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scriptorium/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scriptorium/lambda.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scriptorium/lambdaFactory.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scriptorium/lambda.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScriptoriumLambda=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js");t.ScriptoriumLambda=class{constructor(e,t){this.opCollection=e,this.context=t,this.pending=new Map,this.current=new Map}handler(e){const t=r.extractBoxcar(e);for(const e of t.contents)if(e.type===r.SequencedOperationType){const t=e;t.operation.traces=[];const n=`${t.tenantId}/${t.documentId}`;this.pending.has(n)||this.pending.set(n,[]),this.pending.get(n).push(t)}this.pendingOffset=e,this.sendPending()}close(){this.pending.clear(),this.current.clear()}sendPending(){if(this.current.size>0||0===this.pending.size)return;const e=this.current;this.current=this.pending,this.pending=e;const t=this.pendingOffset,n=[];for(const[,e]of this.current){const t=this.processMongoCore(e);n.push(t)}Promise.all(n).then(()=>{this.current.clear(),this.context.checkpoint(t),this.sendPending()},e=>{this.context.error(e,{restart:!0})})}async processMongoCore(e){return this.insertOp(e)}async insertOp(e){const t=e.map(e=>Object.assign(Object.assign({},e),{mongoTimestamp:new Date(e.operation.timestamp)}));return this.opCollection.insertMany(t,!1).catch(async e=>{if(11e3!==e.code)return Promise.reject(e)})}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scriptorium/lambdaFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScriptoriumLambdaFactory=void 0;const r=n("./node_modules/events/events.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/scriptorium/lambda.js");class s extends r.EventEmitter{constructor(e,t){super(),this.mongoManager=e,this.opCollection=t}async create(e,t){return new o.ScriptoriumLambda(this.opCollection,t)}async dispose(){await this.mongoManager.close()}}t.ScriptoriumLambdaFactory=s},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/sequencedLambda.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SequencedLambda=void 0;const r=n("../notebook-dds/node_modules/async/dist/async.js");t.SequencedLambda=class{constructor(e){this.context=e,this.q=r.queue((e,t)=>{this.handlerCore(e).then(()=>{t()},e=>{t(e)})},1),this.q.error=t=>{e.error(t,{restart:!0,tenantId:this.tenantId,documentId:this.documentId})}}handler(e){this.q.push(e)}close(){this.q.kill()}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/clientIdGenerator.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateClientId=void 0;const r=n("../notebook-dds/node_modules/uuid/dist/esm-browser/index.js");t.generateClientId=()=>r.v4()},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/clientIdGenerator.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/messageGenerator.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/noOpLambda.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/random.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/messageGenerator.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRoomLeaveMessage=t.createRoomJoinMessage=t.createNackMessage=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js");t.createNackMessage=(e,t,n,r)=>({operation:void 0,sequenceNumber:-1,content:{code:e,type:t,message:n,retryAfter:r}}),t.createRoomJoinMessage=function(e,t){const n={clientId:e,client:t};return{clientId:null,content:JSON.stringify({type:r.MessageType.ClientJoin,content:n})}},t.createRoomLeaveMessage=e=>({clientId:null,content:JSON.stringify({type:r.MessageType.ClientLeave,content:e})})},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/noOpLambda.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoOpLambda=void 0,t.NoOpLambda=class{constructor(e){this.context=e}handler(e){this.context.checkpoint(e)}close(){}}},"../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/utils/random.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomInt=void 0,t.getRandomInt=e=>Math.floor(Math.random()*e)},"../notebook-dds/node_modules/@fluidframework/server-lambdas/node_modules/lodash/lodash.js":function(e,t,n){(function(e,r){var o;(function(){var s,i="Expected a function",a="__lodash_hash_undefined__",u="__lodash_placeholder__",c=32,d=128,l=1/0,h=9007199254740991,f=NaN,m=4294967295,p=[["ary",d],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",c],["partialRight",64],["rearg",256]],g="[object Arguments]",b="[object Array]",v="[object Boolean]",y="[object Date]",_="[object Error]",w="[object Function]",k="[object GeneratorFunction]",S="[object Map]",j="[object Number]",C="[object Object]",x="[object Promise]",O="[object RegExp]",E="[object Set]",I="[object String]",A="[object Symbol]",N="[object WeakMap]",T="[object ArrayBuffer]",F="[object DataView]",P="[object Float32Array]",R="[object Float64Array]",D="[object Int8Array]",M="[object Int16Array]",L="[object Int32Array]",B="[object Uint8Array]",q="[object Uint8ClampedArray]",z="[object Uint16Array]",H="[object Uint32Array]",U=/\b__p \+= '';/g,V=/\b(__p \+=) '' \+/g,$=/(__e\(.*?\)|\b__t\)) \+\n'';/g,W=/&(?:amp|lt|gt|quot|#39);/g,K=/[&<>"']/g,G=RegExp(W.source),J=RegExp(K.source),Z=/<%-([\s\S]+?)%>/g,X=/<%([\s\S]+?)%>/g,Y=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ee=/^\w*$/,te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ne=/[\\^$.*+?()[\]{}|]/g,re=RegExp(ne.source),oe=/^\s+|\s+$/g,se=/^\s+/,ie=/\s+$/,ae=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ue=/\{\n\/\* \[wrapped with (.+)\] \*/,ce=/,? & /,de=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,le=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,me=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,be=/^0o[0-7]+$/i,ve=/^(?:0|[1-9]\d*)$/,ye=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_e=/($^)/,we=/['\n\r\u2028\u2029\\]/g,ke="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Se="a-z\\xdf-\\xf6\\xf8-\\xff",je="A-Z\\xc0-\\xd6\\xd8-\\xde",Ce="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",xe="["+Ce+"]",Oe="["+ke+"]",Ee="\\d+",Ie="["+Se+"]",Ae="[^\\ud800-\\udfff"+Ce+Ee+"\\u2700-\\u27bf"+Se+je+"]",Ne="\\ud83c[\\udffb-\\udfff]",Te="[^\\ud800-\\udfff]",Fe="(?:\\ud83c[\\udde6-\\uddff]){2}",Pe="[\\ud800-\\udbff][\\udc00-\\udfff]",Re="["+je+"]",De="(?:"+Ie+"|"+Ae+")",Me="(?:"+Re+"|"+Ae+")",Le="(?:['](?:d|ll|m|re|s|t|ve))?",Be="(?:['](?:D|LL|M|RE|S|T|VE))?",qe="(?:"+Oe+"|"+Ne+")?",ze="[\\ufe0e\\ufe0f]?",He=ze+qe+"(?:\\u200d(?:"+[Te,Fe,Pe].join("|")+")"+ze+qe+")*",Ue="(?:"+["[\\u2700-\\u27bf]",Fe,Pe].join("|")+")"+He,Ve="(?:"+[Te+Oe+"?",Oe,Fe,Pe,"[\\ud800-\\udfff]"].join("|")+")",$e=RegExp("[']","g"),We=RegExp(Oe,"g"),Ke=RegExp(Ne+"(?="+Ne+")|"+Ve+He,"g"),Ge=RegExp([Re+"?"+Ie+"+"+Le+"(?="+[xe,Re,"$"].join("|")+")",Me+"+"+Be+"(?="+[xe,Re+De,"$"].join("|")+")",Re+"?"+De+"+"+Le,Re+"+"+Be,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ee,Ue].join("|"),"g"),Je=RegExp("[\\u200d\\ud800-\\udfff"+ke+"\\ufe0e\\ufe0f]"),Ze=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ye=-1,Qe={};Qe[P]=Qe[R]=Qe[D]=Qe[M]=Qe[L]=Qe[B]=Qe[q]=Qe[z]=Qe[H]=!0,Qe[g]=Qe[b]=Qe[T]=Qe[v]=Qe[F]=Qe[y]=Qe[_]=Qe[w]=Qe[S]=Qe[j]=Qe[C]=Qe[O]=Qe[E]=Qe[I]=Qe[N]=!1;var et={};et[g]=et[b]=et[T]=et[F]=et[v]=et[y]=et[P]=et[R]=et[D]=et[M]=et[L]=et[S]=et[j]=et[C]=et[O]=et[E]=et[I]=et[A]=et[B]=et[q]=et[z]=et[H]=!0,et[_]=et[w]=et[N]=!1;var tt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},nt=parseFloat,rt=parseInt,ot="object"==typeof e&&e&&e.Object===Object&&e,st="object"==typeof self&&self&&self.Object===Object&&self,it=ot||st||Function("return this")(),at=t&&!t.nodeType&&t,ut=at&&"object"==typeof r&&r&&!r.nodeType&&r,ct=ut&&ut.exports===at,dt=ct&&ot.process,lt=function(){try{return ut&&ut.require&&ut.require("util").types||dt&&dt.binding&&dt.binding("util")}catch(e){}}(),ht=lt&&lt.isArrayBuffer,ft=lt&&lt.isDate,mt=lt&&lt.isMap,pt=lt&&lt.isRegExp,gt=lt&&lt.isSet,bt=lt&&lt.isTypedArray;function vt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function yt(e,t,n,r){for(var o=-1,s=null==e?0:e.length;++o<s;){var i=e[o];t(r,i,n(i),e)}return r}function _t(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function wt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function kt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function St(e,t){for(var n=-1,r=null==e?0:e.length,o=0,s=[];++n<r;){var i=e[n];t(i,n,e)&&(s[o++]=i)}return s}function jt(e,t){return!(null==e||!e.length)&&Pt(e,t,0)>-1}function Ct(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}function xt(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}function Ot(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function Et(e,t,n,r){var o=-1,s=null==e?0:e.length;for(r&&s&&(n=e[++o]);++o<s;)n=t(n,e[o],o,e);return n}function It(e,t,n,r){var o=null==e?0:e.length;for(r&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}function At(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Nt=Lt("length");function Tt(e,t,n){var r;return n(e,(function(e,n,o){if(t(e,n,o))return r=n,!1})),r}function Ft(e,t,n,r){for(var o=e.length,s=n+(r?1:-1);r?s--:++s<o;)if(t(e[s],s,e))return s;return-1}function Pt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t,n):Ft(e,Dt,n)}function Rt(e,t,n,r){for(var o=n-1,s=e.length;++o<s;)if(r(e[o],t))return o;return-1}function Dt(e){return e!=e}function Mt(e,t){var n=null==e?0:e.length;return n?zt(e,t)/n:f}function Lt(e){return function(t){return null==t?s:t[e]}}function Bt(e){return function(t){return null==e?s:e[t]}}function qt(e,t,n,r,o){return o(e,(function(e,o,s){n=r?(r=!1,e):t(n,e,o,s)})),n}function zt(e,t){for(var n,r=-1,o=e.length;++r<o;){var i=t(e[r]);i!==s&&(n=n===s?i:n+i)}return n}function Ht(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Ut(e){return function(t){return e(t)}}function Vt(e,t){return xt(t,(function(t){return e[t]}))}function $t(e,t){return e.has(t)}function Wt(e,t){for(var n=-1,r=e.length;++n<r&&Pt(t,e[n],0)>-1;);return n}function Kt(e,t){for(var n=e.length;n--&&Pt(t,e[n],0)>-1;);return n}function Gt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Jt=Bt({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),Zt=Bt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Xt(e){return"\\"+tt[e]}function Yt(e){return Je.test(e)}function Qt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function en(e,t){return function(n){return e(t(n))}}function tn(e,t){for(var n=-1,r=e.length,o=0,s=[];++n<r;){var i=e[n];i!==t&&i!==u||(e[n]=u,s[o++]=n)}return s}function nn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function rn(e){return Yt(e)?function(e){for(var t=Ke.lastIndex=0;Ke.test(e);)++t;return t}(e):Nt(e)}function on(e){return Yt(e)?function(e){return e.match(Ke)||[]}(e):function(e){return e.split("")}(e)}var sn=Bt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),an=function e(t){var n=(t=null==t?it:an.defaults(it.Object(),t,an.pick(it,Xe))).Array,r=t.Date,o=t.Error,ke=t.Function,Se=t.Math,je=t.Object,Ce=t.RegExp,xe=t.String,Oe=t.TypeError,Ee=n.prototype,Ie=ke.prototype,Ae=je.prototype,Ne=t["__core-js_shared__"],Te=Ie.toString,Fe=Ae.hasOwnProperty,Pe=0,Re=function(){var e=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),De=Ae.toString,Me=Te.call(je),Le=it._,Be=Ce("^"+Te.call(Fe).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=ct?t.Buffer:s,ze=t.Symbol,He=t.Uint8Array,Ue=qe?qe.allocUnsafe:s,Ve=en(je.getPrototypeOf,je),Ke=je.create,Je=Ae.propertyIsEnumerable,tt=Ee.splice,ot=ze?ze.isConcatSpreadable:s,st=ze?ze.iterator:s,at=ze?ze.toStringTag:s,ut=function(){try{var e=as(je,"defineProperty");return e({},"",{}),e}catch(e){}}(),dt=t.clearTimeout!==it.clearTimeout&&t.clearTimeout,lt=r&&r.now!==it.Date.now&&r.now,Nt=t.setTimeout!==it.setTimeout&&t.setTimeout,Bt=Se.ceil,un=Se.floor,cn=je.getOwnPropertySymbols,dn=qe?qe.isBuffer:s,ln=t.isFinite,hn=Ee.join,fn=en(je.keys,je),mn=Se.max,pn=Se.min,gn=r.now,bn=t.parseInt,vn=Se.random,yn=Ee.reverse,_n=as(t,"DataView"),wn=as(t,"Map"),kn=as(t,"Promise"),Sn=as(t,"Set"),jn=as(t,"WeakMap"),Cn=as(je,"create"),xn=jn&&new jn,On={},En=Ps(_n),In=Ps(wn),An=Ps(kn),Nn=Ps(Sn),Tn=Ps(jn),Fn=ze?ze.prototype:s,Pn=Fn?Fn.valueOf:s,Rn=Fn?Fn.toString:s;function Dn(e){if(Xi(e)&&!qi(e)&&!(e instanceof qn)){if(e instanceof Bn)return e;if(Fe.call(e,"__wrapped__"))return Rs(e)}return new Bn(e)}var Mn=function(){function e(){}return function(t){if(!Zi(t))return{};if(Ke)return Ke(t);e.prototype=t;var n=new e;return e.prototype=s,n}}();function Ln(){}function Bn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=s}function qn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=m,this.__views__=[]}function zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Un(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Un;++t<n;)this.add(e[t])}function $n(e){var t=this.__data__=new Hn(e);this.size=t.size}function Wn(e,t){var n=qi(e),r=!n&&Bi(e),o=!n&&!r&&Vi(e),s=!n&&!r&&!o&&sa(e),i=n||r||o||s,a=i?Ht(e.length,xe):[],u=a.length;for(var c in e)!t&&!Fe.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ms(c,u))||a.push(c);return a}function Kn(e){var t=e.length;return t?e[Ur(0,t-1)]:s}function Gn(e,t){return Ns(Co(e),rr(t,0,e.length))}function Jn(e){return Ns(Co(e))}function Zn(e,t,n){(n!==s&&!Di(e[t],n)||n===s&&!(t in e))&&tr(e,t,n)}function Xn(e,t,n){var r=e[t];Fe.call(e,t)&&Di(r,n)&&(n!==s||t in e)||tr(e,t,n)}function Yn(e,t){for(var n=e.length;n--;)if(Di(e[n][0],t))return n;return-1}function Qn(e,t,n,r){return ur(e,(function(e,o,s){t(r,e,n(e),s)})),r}function er(e,t){return e&&xo(t,Oa(t),e)}function tr(e,t,n){"__proto__"==t&&ut?ut(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function nr(e,t){for(var r=-1,o=t.length,i=n(o),a=null==e;++r<o;)i[r]=a?s:ka(e,t[r]);return i}function rr(e,t,n){return e==e&&(n!==s&&(e=e<=n?e:n),t!==s&&(e=e>=t?e:t)),e}function or(e,t,n,r,o,i){var a,u=1&t,c=2&t,d=4&t;if(n&&(a=o?n(e,r,o,i):n(e)),a!==s)return a;if(!Zi(e))return e;var l=qi(e);if(l){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Fe.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!u)return Co(e,a)}else{var h=ds(e),f=h==w||h==k;if(Vi(e))return yo(e,u);if(h==C||h==g||f&&!o){if(a=c||f?{}:hs(e),!u)return c?function(e,t){return xo(e,cs(e),t)}(e,function(e,t){return e&&xo(t,Ea(t),e)}(a,e)):function(e,t){return xo(e,us(e),t)}(e,er(a,e))}else{if(!et[h])return o?e:{};a=function(e,t,n){var r,o=e.constructor;switch(t){case T:return _o(e);case v:case y:return new o(+e);case F:return function(e,t){var n=t?_o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case P:case R:case D:case M:case L:case B:case q:case z:case H:return wo(e,n);case S:return new o;case j:case I:return new o(e);case O:return function(e){var t=new e.constructor(e.source,fe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case E:return new o;case A:return r=e,Pn?je(Pn.call(r)):{}}}(e,h,u)}}i||(i=new $n);var m=i.get(e);if(m)return m;i.set(e,a),na(e)?e.forEach((function(r){a.add(or(r,t,n,r,e,i))})):Yi(e)&&e.forEach((function(r,o){a.set(o,or(r,t,n,o,e,i))}));var p=l?s:(d?c?es:Qo:c?Ea:Oa)(e);return _t(p||e,(function(r,o){p&&(r=e[o=r]),Xn(a,o,or(r,t,n,o,e,i))})),a}function sr(e,t,n){var r=n.length;if(null==e)return!r;for(e=je(e);r--;){var o=n[r],i=t[o],a=e[o];if(a===s&&!(o in e)||!i(a))return!1}return!0}function ir(e,t,n){if("function"!=typeof e)throw new Oe(i);return Os((function(){e.apply(s,n)}),t)}function ar(e,t,n,r){var o=-1,s=jt,i=!0,a=e.length,u=[],c=t.length;if(!a)return u;n&&(t=xt(t,Ut(n))),r?(s=Ct,i=!1):t.length>=200&&(s=$t,i=!1,t=new Vn(t));e:for(;++o<a;){var d=e[o],l=null==n?d:n(d);if(d=r||0!==d?d:0,i&&l==l){for(var h=c;h--;)if(t[h]===l)continue e;u.push(d)}else s(t,l,r)||u.push(d)}return u}Dn.templateSettings={escape:Z,evaluate:X,interpolate:Y,variable:"",imports:{_:Dn}},Dn.prototype=Ln.prototype,Dn.prototype.constructor=Dn,Bn.prototype=Mn(Ln.prototype),Bn.prototype.constructor=Bn,qn.prototype=Mn(Ln.prototype),qn.prototype.constructor=qn,zn.prototype.clear=function(){this.__data__=Cn?Cn(null):{},this.size=0},zn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},zn.prototype.get=function(e){var t=this.__data__;if(Cn){var n=t[e];return n===a?s:n}return Fe.call(t,e)?t[e]:s},zn.prototype.has=function(e){var t=this.__data__;return Cn?t[e]!==s:Fe.call(t,e)},zn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Cn&&t===s?a:t,this},Hn.prototype.clear=function(){this.__data__=[],this.size=0},Hn.prototype.delete=function(e){var t=this.__data__,n=Yn(t,e);return!(n<0||(n==t.length-1?t.pop():tt.call(t,n,1),--this.size,0))},Hn.prototype.get=function(e){var t=this.__data__,n=Yn(t,e);return n<0?s:t[n][1]},Hn.prototype.has=function(e){return Yn(this.__data__,e)>-1},Hn.prototype.set=function(e,t){var n=this.__data__,r=Yn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Un.prototype.clear=function(){this.size=0,this.__data__={hash:new zn,map:new(wn||Hn),string:new zn}},Un.prototype.delete=function(e){var t=ss(this,e).delete(e);return this.size-=t?1:0,t},Un.prototype.get=function(e){return ss(this,e).get(e)},Un.prototype.has=function(e){return ss(this,e).has(e)},Un.prototype.set=function(e,t){var n=ss(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Vn.prototype.add=Vn.prototype.push=function(e){return this.__data__.set(e,a),this},Vn.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.clear=function(){this.__data__=new Hn,this.size=0},$n.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},$n.prototype.get=function(e){return this.__data__.get(e)},$n.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Hn){var r=n.__data__;if(!wn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Un(r)}return n.set(e,t),this.size=n.size,this};var ur=Io(gr),cr=Io(br,!0);function dr(e,t){var n=!0;return ur(e,(function(e,r,o){return n=!!t(e,r,o)})),n}function lr(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(null!=a&&(u===s?a==a&&!oa(a):n(a,u)))var u=a,c=i}return c}function hr(e,t){var n=[];return ur(e,(function(e,r,o){t(e,r,o)&&n.push(e)})),n}function fr(e,t,n,r,o){var s=-1,i=e.length;for(n||(n=fs),o||(o=[]);++s<i;){var a=e[s];t>0&&n(a)?t>1?fr(a,t-1,n,r,o):Ot(o,a):r||(o[o.length]=a)}return o}var mr=Ao(),pr=Ao(!0);function gr(e,t){return e&&mr(e,t,Oa)}function br(e,t){return e&&pr(e,t,Oa)}function vr(e,t){return St(t,(function(t){return Ki(e[t])}))}function yr(e,t){for(var n=0,r=(t=po(t,e)).length;null!=e&&n<r;)e=e[Fs(t[n++])];return n&&n==r?e:s}function _r(e,t,n){var r=t(e);return qi(e)?r:Ot(r,n(e))}function wr(e){return null==e?e===s?"[object Undefined]":"[object Null]":at&&at in je(e)?function(e){var t=Fe.call(e,at),n=e[at];try{e[at]=s;var r=!0}catch(e){}var o=De.call(e);return r&&(t?e[at]=n:delete e[at]),o}(e):function(e){return De.call(e)}(e)}function kr(e,t){return e>t}function Sr(e,t){return null!=e&&Fe.call(e,t)}function jr(e,t){return null!=e&&t in je(e)}function Cr(e,t,r){for(var o=r?Ct:jt,i=e[0].length,a=e.length,u=a,c=n(a),d=1/0,l=[];u--;){var h=e[u];u&&t&&(h=xt(h,Ut(t))),d=pn(h.length,d),c[u]=!r&&(t||i>=120&&h.length>=120)?new Vn(u&&h):s}h=e[0];var f=-1,m=c[0];e:for(;++f<i&&l.length<d;){var p=h[f],g=t?t(p):p;if(p=r||0!==p?p:0,!(m?$t(m,g):o(l,g,r))){for(u=a;--u;){var b=c[u];if(!(b?$t(b,g):o(e[u],g,r)))continue e}m&&m.push(g),l.push(p)}}return l}function xr(e,t,n){var r=null==(e=Ss(e,t=po(t,e)))?e:e[Fs(Ws(t))];return null==r?s:vt(r,e,n)}function Or(e){return Xi(e)&&wr(e)==g}function Er(e,t,n,r,o){return e===t||(null==e||null==t||!Xi(e)&&!Xi(t)?e!=e&&t!=t:function(e,t,n,r,o,i){var a=qi(e),u=qi(t),c=a?b:ds(e),d=u?b:ds(t),l=(c=c==g?C:c)==C,h=(d=d==g?C:d)==C,f=c==d;if(f&&Vi(e)){if(!Vi(t))return!1;a=!0,l=!1}if(f&&!l)return i||(i=new $n),a||sa(e)?Xo(e,t,n,r,o,i):function(e,t,n,r,o,s,i){switch(n){case F:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!s(new He(e),new He(t)));case v:case y:case j:return Di(+e,+t);case _:return e.name==t.name&&e.message==t.message;case O:case I:return e==t+"";case S:var a=Qt;case E:var u=1&r;if(a||(a=nn),e.size!=t.size&&!u)return!1;var c=i.get(e);if(c)return c==t;r|=2,i.set(e,t);var d=Xo(a(e),a(t),r,o,s,i);return i.delete(e),d;case A:if(Pn)return Pn.call(e)==Pn.call(t)}return!1}(e,t,c,n,r,o,i);if(!(1&n)){var m=l&&Fe.call(e,"__wrapped__"),p=h&&Fe.call(t,"__wrapped__");if(m||p){var w=m?e.value():e,k=p?t.value():t;return i||(i=new $n),o(w,k,n,r,i)}}return!!f&&(i||(i=new $n),function(e,t,n,r,o,i){var a=1&n,u=Qo(e),c=u.length;if(c!=Qo(t).length&&!a)return!1;for(var d=c;d--;){var l=u[d];if(!(a?l in t:Fe.call(t,l)))return!1}var h=i.get(e),f=i.get(t);if(h&&f)return h==t&&f==e;var m=!0;i.set(e,t),i.set(t,e);for(var p=a;++d<c;){var g=e[l=u[d]],b=t[l];if(r)var v=a?r(b,g,l,t,e,i):r(g,b,l,e,t,i);if(!(v===s?g===b||o(g,b,n,r,i):v)){m=!1;break}p||(p="constructor"==l)}if(m&&!p){var y=e.constructor,_=t.constructor;y==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _||(m=!1)}return i.delete(e),i.delete(t),m}(e,t,n,r,o,i))}(e,t,n,r,Er,o))}function Ir(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=je(e);o--;){var u=n[o];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<i;){var c=(u=n[o])[0],d=e[c],l=u[1];if(a&&u[2]){if(d===s&&!(c in e))return!1}else{var h=new $n;if(r)var f=r(d,l,c,e,t,h);if(!(f===s?Er(l,d,3,r,h):f))return!1}}return!0}function Ar(e){return!(!Zi(e)||(t=e,Re&&Re in t))&&(Ki(e)?Be:ge).test(Ps(e));var t}function Nr(e){return"function"==typeof e?e:null==e?Qa:"object"==typeof e?qi(e)?Dr(e[0],e[1]):Rr(e):uu(e)}function Tr(e){if(!ys(e))return fn(e);var t=[];for(var n in je(e))Fe.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Fr(e,t){return e<t}function Pr(e,t){var r=-1,o=Hi(e)?n(e.length):[];return ur(e,(function(e,n,s){o[++r]=t(e,n,s)})),o}function Rr(e){var t=is(e);return 1==t.length&&t[0][2]?ws(t[0][0],t[0][1]):function(n){return n===e||Ir(n,e,t)}}function Dr(e,t){return gs(e)&&_s(t)?ws(Fs(e),t):function(n){var r=ka(n,e);return r===s&&r===t?Sa(n,e):Er(t,r,3)}}function Mr(e,t,n,r,o){e!==t&&mr(t,(function(i,a){if(o||(o=new $n),Zi(i))!function(e,t,n,r,o,i,a){var u=Cs(e,n),c=Cs(t,n),d=a.get(c);if(d)Zn(e,n,d);else{var l=i?i(u,c,n+"",e,t,a):s,h=l===s;if(h){var f=qi(c),m=!f&&Vi(c),p=!f&&!m&&sa(c);l=c,f||m||p?qi(u)?l=u:Ui(u)?l=Co(u):m?(h=!1,l=yo(c,!0)):p?(h=!1,l=wo(c,!0)):l=[]:ea(c)||Bi(c)?(l=u,Bi(u)?l=fa(u):Zi(u)&&!Ki(u)||(l=hs(c))):h=!1}h&&(a.set(c,l),o(l,c,r,i,a),a.delete(c)),Zn(e,n,l)}}(e,t,a,n,Mr,r,o);else{var u=r?r(Cs(e,a),i,a+"",e,t,o):s;u===s&&(u=i),Zn(e,a,u)}}),Ea)}function Lr(e,t){var n=e.length;if(n)return ms(t+=t<0?n:0,n)?e[t]:s}function Br(e,t,n){t=t.length?xt(t,(function(e){return qi(e)?function(t){return yr(t,1===e.length?e[0]:e)}:e})):[Qa];var r=-1;return t=xt(t,Ut(os())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Pr(e,(function(e,n,o){return{criteria:xt(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){for(var r=-1,o=e.criteria,s=t.criteria,i=o.length,a=n.length;++r<i;){var u=ko(o[r],s[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function qr(e,t,n){for(var r=-1,o=t.length,s={};++r<o;){var i=t[r],a=yr(e,i);n(a,i)&&Gr(s,po(i,e),a)}return s}function zr(e,t,n,r){var o=r?Rt:Pt,s=-1,i=t.length,a=e;for(e===t&&(t=Co(t)),n&&(a=xt(e,Ut(n)));++s<i;)for(var u=0,c=t[s],d=n?n(c):c;(u=o(a,d,u,r))>-1;)a!==e&&tt.call(a,u,1),tt.call(e,u,1);return e}function Hr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o=t[n];if(n==r||o!==s){var s=o;ms(o)?tt.call(e,o,1):io(e,o)}}return e}function Ur(e,t){return e+un(vn()*(t-e+1))}function Vr(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=un(t/2))&&(e+=e)}while(t);return n}function $r(e,t){return Es(ks(e,t,Qa),e+"")}function Wr(e){return Kn(Da(e))}function Kr(e,t){var n=Da(e);return Ns(n,rr(t,0,n.length))}function Gr(e,t,n,r){if(!Zi(e))return e;for(var o=-1,i=(t=po(t,e)).length,a=i-1,u=e;null!=u&&++o<i;){var c=Fs(t[o]),d=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var l=u[c];(d=r?r(l,c,u):s)===s&&(d=Zi(l)?l:ms(t[o+1])?[]:{})}Xn(u,c,d),u=u[c]}return e}var Jr=xn?function(e,t){return xn.set(e,t),e}:Qa,Zr=ut?function(e,t){return ut(e,"toString",{configurable:!0,enumerable:!1,value:Za(t),writable:!0})}:Qa;function Xr(e){return Ns(Da(e))}function Yr(e,t,r){var o=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(r=r>s?s:r)<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var i=n(s);++o<s;)i[o]=e[o+t];return i}function Qr(e,t){var n;return ur(e,(function(e,r,o){return!(n=t(e,r,o))})),!!n}function eo(e,t,n){var r=0,o=null==e?r:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;r<o;){var s=r+o>>>1,i=e[s];null!==i&&!oa(i)&&(n?i<=t:i<t)?r=s+1:o=s}return o}return to(e,t,Qa,n)}function to(e,t,n,r){var o=0,i=null==e?0:e.length;if(0===i)return 0;for(var a=(t=n(t))!==t,u=null===t,c=oa(t),d=t===s;o<i;){var l=un((o+i)/2),h=n(e[l]),f=h!==s,m=null===h,p=h==h,g=oa(h);if(a)var b=r||p;else b=d?p&&(r||f):u?p&&f&&(r||!m):c?p&&f&&!m&&(r||!g):!m&&!g&&(r?h<=t:h<t);b?o=l+1:i=l}return pn(i,4294967294)}function no(e,t){for(var n=-1,r=e.length,o=0,s=[];++n<r;){var i=e[n],a=t?t(i):i;if(!n||!Di(a,u)){var u=a;s[o++]=0===i?0:i}}return s}function ro(e){return"number"==typeof e?e:oa(e)?f:+e}function oo(e){if("string"==typeof e)return e;if(qi(e))return xt(e,oo)+"";if(oa(e))return Rn?Rn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function so(e,t,n){var r=-1,o=jt,s=e.length,i=!0,a=[],u=a;if(n)i=!1,o=Ct;else if(s>=200){var c=t?null:$o(e);if(c)return nn(c);i=!1,o=$t,u=new Vn}else u=t?[]:a;e:for(;++r<s;){var d=e[r],l=t?t(d):d;if(d=n||0!==d?d:0,i&&l==l){for(var h=u.length;h--;)if(u[h]===l)continue e;t&&u.push(l),a.push(d)}else o(u,l,n)||(u!==a&&u.push(l),a.push(d))}return a}function io(e,t){return null==(e=Ss(e,t=po(t,e)))||delete e[Fs(Ws(t))]}function ao(e,t,n,r){return Gr(e,t,n(yr(e,t)),r)}function uo(e,t,n,r){for(var o=e.length,s=r?o:-1;(r?s--:++s<o)&&t(e[s],s,e););return n?Yr(e,r?0:s,r?s+1:o):Yr(e,r?s+1:0,r?o:s)}function co(e,t){var n=e;return n instanceof qn&&(n=n.value()),Et(t,(function(e,t){return t.func.apply(t.thisArg,Ot([e],t.args))}),n)}function lo(e,t,r){var o=e.length;if(o<2)return o?so(e[0]):[];for(var s=-1,i=n(o);++s<o;)for(var a=e[s],u=-1;++u<o;)u!=s&&(i[s]=ar(i[s]||a,e[u],t,r));return so(fr(i,1),t,r)}function ho(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var u=r<i?t[r]:s;n(a,e[r],u)}return a}function fo(e){return Ui(e)?e:[]}function mo(e){return"function"==typeof e?e:Qa}function po(e,t){return qi(e)?e:gs(e,t)?[e]:Ts(ma(e))}var go=$r;function bo(e,t,n){var r=e.length;return n=n===s?r:n,!t&&n>=r?e:Yr(e,t,n)}var vo=dt||function(e){return it.clearTimeout(e)};function yo(e,t){if(t)return e.slice();var n=e.length,r=Ue?Ue(n):new e.constructor(n);return e.copy(r),r}function _o(e){var t=new e.constructor(e.byteLength);return new He(t).set(new He(e)),t}function wo(e,t){var n=t?_o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ko(e,t){if(e!==t){var n=e!==s,r=null===e,o=e==e,i=oa(e),a=t!==s,u=null===t,c=t==t,d=oa(t);if(!u&&!d&&!i&&e>t||i&&a&&c&&!u&&!d||r&&a&&c||!n&&c||!o)return 1;if(!r&&!i&&!d&&e<t||d&&n&&o&&!r&&!i||u&&n&&o||!a&&o||!c)return-1}return 0}function So(e,t,r,o){for(var s=-1,i=e.length,a=r.length,u=-1,c=t.length,d=mn(i-a,0),l=n(c+d),h=!o;++u<c;)l[u]=t[u];for(;++s<a;)(h||s<i)&&(l[r[s]]=e[s]);for(;d--;)l[u++]=e[s++];return l}function jo(e,t,r,o){for(var s=-1,i=e.length,a=-1,u=r.length,c=-1,d=t.length,l=mn(i-u,0),h=n(l+d),f=!o;++s<l;)h[s]=e[s];for(var m=s;++c<d;)h[m+c]=t[c];for(;++a<u;)(f||s<i)&&(h[m+r[a]]=e[s++]);return h}function Co(e,t){var r=-1,o=e.length;for(t||(t=n(o));++r<o;)t[r]=e[r];return t}function xo(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var u=t[i],c=r?r(n[u],e[u],u,n,e):s;c===s&&(c=e[u]),o?tr(n,u,c):Xn(n,u,c)}return n}function Oo(e,t){return function(n,r){var o=qi(n)?yt:Qn,s=t?t():{};return o(n,e,os(r,2),s)}}function Eo(e){return $r((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:s,a=o>2?n[2]:s;for(i=e.length>3&&"function"==typeof i?(o--,i):s,a&&ps(n[0],n[1],a)&&(i=o<3?s:i,o=1),t=je(t);++r<o;){var u=n[r];u&&e(t,u,r,i)}return t}))}function Io(e,t){return function(n,r){if(null==n)return n;if(!Hi(n))return e(n,r);for(var o=n.length,s=t?o:-1,i=je(n);(t?s--:++s<o)&&!1!==r(i[s],s,i););return n}}function Ao(e){return function(t,n,r){for(var o=-1,s=je(t),i=r(t),a=i.length;a--;){var u=i[e?a:++o];if(!1===n(s[u],u,s))break}return t}}function No(e){return function(t){var n=Yt(t=ma(t))?on(t):s,r=n?n[0]:t.charAt(0),o=n?bo(n,1).join(""):t.slice(1);return r[e]()+o}}function To(e){return function(t){return Et(Ka(Ba(t).replace($e,"")),e,"")}}function Fo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Mn(e.prototype),r=e.apply(n,t);return Zi(r)?r:n}}function Po(e){return function(t,n,r){var o=je(t);if(!Hi(t)){var i=os(n,3);t=Oa(t),n=function(e){return i(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[i?t[a]:a]:s}}function Ro(e){return Yo((function(t){var n=t.length,r=n,o=Bn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Oe(i);if(o&&!u&&"wrapper"==ns(a))var u=new Bn([],!0)}for(r=u?r:n;++r<n;){var c=ns(a=t[r]),d="wrapper"==c?ts(a):s;u=d&&bs(d[0])&&424==d[1]&&!d[4].length&&1==d[9]?u[ns(d[0])].apply(u,d[3]):1==a.length&&bs(a)?u[c]():u.thru(a)}return function(){var e=arguments,r=e[0];if(u&&1==e.length&&qi(r))return u.plant(r).value();for(var o=0,s=n?t[o].apply(this,e):r;++o<n;)s=t[o].call(this,s);return s}}))}function Do(e,t,r,o,i,a,u,c,l,h){var f=t&d,m=1&t,p=2&t,g=24&t,b=512&t,v=p?s:Fo(e);return function s(){for(var d=arguments.length,y=n(d),_=d;_--;)y[_]=arguments[_];if(g)var w=rs(s),k=Gt(y,w);if(o&&(y=So(y,o,i,g)),a&&(y=jo(y,a,u,g)),d-=k,g&&d<h){var S=tn(y,w);return Uo(e,t,Do,s.placeholder,r,y,S,c,l,h-d)}var j=m?r:this,C=p?j[e]:e;return d=y.length,c?y=js(y,c):b&&d>1&&y.reverse(),f&&l<d&&(y.length=l),this&&this!==it&&this instanceof s&&(C=v||Fo(C)),C.apply(j,y)}}function Mo(e,t){return function(n,r){return function(e,t,n,r){return gr(e,(function(e,o,s){t(r,n(e),o,s)})),r}(n,e,t(r),{})}}function Lo(e,t){return function(n,r){var o;if(n===s&&r===s)return t;if(n!==s&&(o=n),r!==s){if(o===s)return r;"string"==typeof n||"string"==typeof r?(n=oo(n),r=oo(r)):(n=ro(n),r=ro(r)),o=e(n,r)}return o}}function Bo(e){return Yo((function(t){return t=xt(t,Ut(os())),$r((function(n){var r=this;return e(t,(function(e){return vt(e,r,n)}))}))}))}function qo(e,t){var n=(t=t===s?" ":oo(t)).length;if(n<2)return n?Vr(t,e):t;var r=Vr(t,Bt(e/rn(t)));return Yt(t)?bo(on(r),0,e).join(""):r.slice(0,e)}function zo(e){return function(t,r,o){return o&&"number"!=typeof o&&ps(t,r,o)&&(r=o=s),t=ca(t),r===s?(r=t,t=0):r=ca(r),function(e,t,r,o){for(var s=-1,i=mn(Bt((t-e)/(r||1)),0),a=n(i);i--;)a[o?i:++s]=e,e+=r;return a}(t,r,o=o===s?t<r?1:-1:ca(o),e)}}function Ho(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ha(t),n=ha(n)),e(t,n)}}function Uo(e,t,n,r,o,i,a,u,d,l){var h=8&t;t|=h?c:64,4&(t&=~(h?64:c))||(t&=-4);var f=[e,t,o,h?i:s,h?a:s,h?s:i,h?s:a,u,d,l],m=n.apply(s,f);return bs(e)&&xs(m,f),m.placeholder=r,Is(m,e,t)}function Vo(e){var t=Se[e];return function(e,n){if(e=ha(e),(n=null==n?0:pn(da(n),292))&&ln(e)){var r=(ma(e)+"e").split("e");return+((r=(ma(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var $o=Sn&&1/nn(new Sn([,-0]))[1]==l?function(e){return new Sn(e)}:ou;function Wo(e){return function(t){var n=ds(t);return n==S?Qt(t):n==E?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return xt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Ko(e,t,r,o,a,l,h,f){var m=2&t;if(!m&&"function"!=typeof e)throw new Oe(i);var p=o?o.length:0;if(p||(t&=-97,o=a=s),h=h===s?h:mn(da(h),0),f=f===s?f:da(f),p-=a?a.length:0,64&t){var g=o,b=a;o=a=s}var v=m?s:ts(e),y=[e,t,r,o,a,g,b,l,h,f];if(v&&function(e,t){var n=e[1],r=t[1],o=n|r,s=o<131,i=r==d&&8==n||r==d&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!s&&!i)return e;1&r&&(e[2]=t[2],o|=1&n?0:4);var a=t[3];if(a){var c=e[3];e[3]=c?So(c,a,t[4]):a,e[4]=c?tn(e[3],u):t[4]}(a=t[5])&&(c=e[5],e[5]=c?jo(c,a,t[6]):a,e[6]=c?tn(e[5],u):t[6]),(a=t[7])&&(e[7]=a),r&d&&(e[8]=null==e[8]?t[8]:pn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o}(y,v),e=y[0],t=y[1],r=y[2],o=y[3],a=y[4],!(f=y[9]=y[9]===s?m?0:e.length:mn(y[9]-p,0))&&24&t&&(t&=-25),t&&1!=t)_=8==t||16==t?function(e,t,r){var o=Fo(e);return function i(){for(var a=arguments.length,u=n(a),c=a,d=rs(i);c--;)u[c]=arguments[c];var l=a<3&&u[0]!==d&&u[a-1]!==d?[]:tn(u,d);return(a-=l.length)<r?Uo(e,t,Do,i.placeholder,s,u,l,s,s,r-a):vt(this&&this!==it&&this instanceof i?o:e,this,u)}}(e,t,f):t!=c&&33!=t||a.length?Do.apply(s,y):function(e,t,r,o){var s=1&t,i=Fo(e);return function t(){for(var a=-1,u=arguments.length,c=-1,d=o.length,l=n(d+u),h=this&&this!==it&&this instanceof t?i:e;++c<d;)l[c]=o[c];for(;u--;)l[c++]=arguments[++a];return vt(h,s?r:this,l)}}(e,t,r,o);else var _=function(e,t,n){var r=1&t,o=Fo(e);return function t(){return(this&&this!==it&&this instanceof t?o:e).apply(r?n:this,arguments)}}(e,t,r);return Is((v?Jr:xs)(_,y),e,t)}function Go(e,t,n,r){return e===s||Di(e,Ae[n])&&!Fe.call(r,n)?t:e}function Jo(e,t,n,r,o,i){return Zi(e)&&Zi(t)&&(i.set(t,e),Mr(e,t,s,Jo,i),i.delete(t)),e}function Zo(e){return ea(e)?s:e}function Xo(e,t,n,r,o,i){var a=1&n,u=e.length,c=t.length;if(u!=c&&!(a&&c>u))return!1;var d=i.get(e),l=i.get(t);if(d&&l)return d==t&&l==e;var h=-1,f=!0,m=2&n?new Vn:s;for(i.set(e,t),i.set(t,e);++h<u;){var p=e[h],g=t[h];if(r)var b=a?r(g,p,h,t,e,i):r(p,g,h,e,t,i);if(b!==s){if(b)continue;f=!1;break}if(m){if(!At(t,(function(e,t){if(!$t(m,t)&&(p===e||o(p,e,n,r,i)))return m.push(t)}))){f=!1;break}}else if(p!==g&&!o(p,g,n,r,i)){f=!1;break}}return i.delete(e),i.delete(t),f}function Yo(e){return Es(ks(e,s,zs),e+"")}function Qo(e){return _r(e,Oa,us)}function es(e){return _r(e,Ea,cs)}var ts=xn?function(e){return xn.get(e)}:ou;function ns(e){for(var t=e.name+"",n=On[t],r=Fe.call(On,t)?n.length:0;r--;){var o=n[r],s=o.func;if(null==s||s==e)return o.name}return t}function rs(e){return(Fe.call(Dn,"placeholder")?Dn:e).placeholder}function os(){var e=Dn.iteratee||eu;return e=e===eu?Nr:e,arguments.length?e(arguments[0],arguments[1]):e}function ss(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function is(e){for(var t=Oa(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,_s(o)]}return t}function as(e,t){var n=function(e,t){return null==e?s:e[t]}(e,t);return Ar(n)?n:s}var us=cn?function(e){return null==e?[]:(e=je(e),St(cn(e),(function(t){return Je.call(e,t)})))}:lu,cs=cn?function(e){for(var t=[];e;)Ot(t,us(e)),e=Ve(e);return t}:lu,ds=wr;function ls(e,t,n){for(var r=-1,o=(t=po(t,e)).length,s=!1;++r<o;){var i=Fs(t[r]);if(!(s=null!=e&&n(e,i)))break;e=e[i]}return s||++r!=o?s:!!(o=null==e?0:e.length)&&Ji(o)&&ms(i,o)&&(qi(e)||Bi(e))}function hs(e){return"function"!=typeof e.constructor||ys(e)?{}:Mn(Ve(e))}function fs(e){return qi(e)||Bi(e)||!!(ot&&e&&e[ot])}function ms(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&ve.test(e))&&e>-1&&e%1==0&&e<t}function ps(e,t,n){if(!Zi(n))return!1;var r=typeof t;return!!("number"==r?Hi(n)&&ms(t,n.length):"string"==r&&t in n)&&Di(n[t],e)}function gs(e,t){if(qi(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!oa(e))||ee.test(e)||!Q.test(e)||null!=t&&e in je(t)}function bs(e){var t=ns(e),n=Dn[t];if("function"!=typeof n||!(t in qn.prototype))return!1;if(e===n)return!0;var r=ts(n);return!!r&&e===r[0]}(_n&&ds(new _n(new ArrayBuffer(1)))!=F||wn&&ds(new wn)!=S||kn&&ds(kn.resolve())!=x||Sn&&ds(new Sn)!=E||jn&&ds(new jn)!=N)&&(ds=function(e){var t=wr(e),n=t==C?e.constructor:s,r=n?Ps(n):"";if(r)switch(r){case En:return F;case In:return S;case An:return x;case Nn:return E;case Tn:return N}return t});var vs=Ne?Ki:hu;function ys(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ae)}function _s(e){return e==e&&!Zi(e)}function ws(e,t){return function(n){return null!=n&&n[e]===t&&(t!==s||e in je(n))}}function ks(e,t,r){return t=mn(t===s?e.length-1:t,0),function(){for(var o=arguments,s=-1,i=mn(o.length-t,0),a=n(i);++s<i;)a[s]=o[t+s];s=-1;for(var u=n(t+1);++s<t;)u[s]=o[s];return u[t]=r(a),vt(e,this,u)}}function Ss(e,t){return t.length<2?e:yr(e,Yr(t,0,-1))}function js(e,t){for(var n=e.length,r=pn(t.length,n),o=Co(e);r--;){var i=t[r];e[r]=ms(i,n)?o[i]:s}return e}function Cs(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var xs=As(Jr),Os=Nt||function(e,t){return it.setTimeout(e,t)},Es=As(Zr);function Is(e,t,n){var r=t+"";return Es(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ae,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return _t(p,(function(n){var r="_."+n[0];t&n[1]&&!jt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ue);return t?t[1].split(ce):[]}(r),n)))}function As(e){var t=0,n=0;return function(){var r=gn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(s,arguments)}}function Ns(e,t){var n=-1,r=e.length,o=r-1;for(t=t===s?r:t;++n<t;){var i=Ur(n,o),a=e[i];e[i]=e[n],e[n]=a}return e.length=t,e}var Ts=function(e){var t=Ai((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(te,(function(e,n,r,o){t.push(r?o.replace(le,"$1"):n||e)})),t}),(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}();function Fs(e){if("string"==typeof e||oa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ps(e){if(null!=e){try{return Te.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Rs(e){if(e instanceof qn)return e.clone();var t=new Bn(e.__wrapped__,e.__chain__);return t.__actions__=Co(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ds=$r((function(e,t){return Ui(e)?ar(e,fr(t,1,Ui,!0)):[]})),Ms=$r((function(e,t){var n=Ws(t);return Ui(n)&&(n=s),Ui(e)?ar(e,fr(t,1,Ui,!0),os(n,2)):[]})),Ls=$r((function(e,t){var n=Ws(t);return Ui(n)&&(n=s),Ui(e)?ar(e,fr(t,1,Ui,!0),s,n):[]}));function Bs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:da(n);return o<0&&(o=mn(r+o,0)),Ft(e,os(t,3),o)}function qs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==s&&(o=da(n),o=n<0?mn(r+o,0):pn(o,r-1)),Ft(e,os(t,3),o,!0)}function zs(e){return null!=e&&e.length?fr(e,1):[]}function Hs(e){return e&&e.length?e[0]:s}var Us=$r((function(e){var t=xt(e,fo);return t.length&&t[0]===e[0]?Cr(t):[]})),Vs=$r((function(e){var t=Ws(e),n=xt(e,fo);return t===Ws(n)?t=s:n.pop(),n.length&&n[0]===e[0]?Cr(n,os(t,2)):[]})),$s=$r((function(e){var t=Ws(e),n=xt(e,fo);return(t="function"==typeof t?t:s)&&n.pop(),n.length&&n[0]===e[0]?Cr(n,s,t):[]}));function Ws(e){var t=null==e?0:e.length;return t?e[t-1]:s}var Ks=$r(Gs);function Gs(e,t){return e&&e.length&&t&&t.length?zr(e,t):e}var Js=Yo((function(e,t){var n=null==e?0:e.length,r=nr(e,t);return Hr(e,xt(t,(function(e){return ms(e,n)?+e:e})).sort(ko)),r}));function Zs(e){return null==e?e:yn.call(e)}var Xs=$r((function(e){return so(fr(e,1,Ui,!0))})),Ys=$r((function(e){var t=Ws(e);return Ui(t)&&(t=s),so(fr(e,1,Ui,!0),os(t,2))})),Qs=$r((function(e){var t=Ws(e);return t="function"==typeof t?t:s,so(fr(e,1,Ui,!0),s,t)}));function ei(e){if(!e||!e.length)return[];var t=0;return e=St(e,(function(e){if(Ui(e))return t=mn(e.length,t),!0})),Ht(t,(function(t){return xt(e,Lt(t))}))}function ti(e,t){if(!e||!e.length)return[];var n=ei(e);return null==t?n:xt(n,(function(e){return vt(t,s,e)}))}var ni=$r((function(e,t){return Ui(e)?ar(e,t):[]})),ri=$r((function(e){return lo(St(e,Ui))})),oi=$r((function(e){var t=Ws(e);return Ui(t)&&(t=s),lo(St(e,Ui),os(t,2))})),si=$r((function(e){var t=Ws(e);return t="function"==typeof t?t:s,lo(St(e,Ui),s,t)})),ii=$r(ei),ai=$r((function(e){var t=e.length,n=t>1?e[t-1]:s;return n="function"==typeof n?(e.pop(),n):s,ti(e,n)}));function ui(e){var t=Dn(e);return t.__chain__=!0,t}function ci(e,t){return t(e)}var di=Yo((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return nr(t,e)};return!(t>1||this.__actions__.length)&&r instanceof qn&&ms(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ci,args:[o],thisArg:s}),new Bn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(s),e}))):this.thru(o)})),li=Oo((function(e,t,n){Fe.call(e,n)?++e[n]:tr(e,n,1)})),hi=Po(Bs),fi=Po(qs);function mi(e,t){return(qi(e)?_t:ur)(e,os(t,3))}function pi(e,t){return(qi(e)?wt:cr)(e,os(t,3))}var gi=Oo((function(e,t,n){Fe.call(e,n)?e[n].push(t):tr(e,n,[t])})),bi=$r((function(e,t,r){var o=-1,s="function"==typeof t,i=Hi(e)?n(e.length):[];return ur(e,(function(e){i[++o]=s?vt(t,e,r):xr(e,t,r)})),i})),vi=Oo((function(e,t,n){tr(e,n,t)}));function yi(e,t){return(qi(e)?xt:Pr)(e,os(t,3))}var _i=Oo((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),wi=$r((function(e,t){if(null==e)return[];var n=t.length;return n>1&&ps(e,t[0],t[1])?t=[]:n>2&&ps(t[0],t[1],t[2])&&(t=[t[0]]),Br(e,fr(t,1),[])})),ki=lt||function(){return it.Date.now()};function Si(e,t,n){return t=n?s:t,t=e&&null==t?e.length:t,Ko(e,d,s,s,s,s,t)}function ji(e,t){var n;if("function"!=typeof t)throw new Oe(i);return e=da(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=s),n}}var Ci=$r((function(e,t,n){var r=1;if(n.length){var o=tn(n,rs(Ci));r|=c}return Ko(e,r,t,n,o)})),xi=$r((function(e,t,n){var r=3;if(n.length){var o=tn(n,rs(xi));r|=c}return Ko(t,r,e,n,o)}));function Oi(e,t,n){var r,o,a,u,c,d,l=0,h=!1,f=!1,m=!0;if("function"!=typeof e)throw new Oe(i);function p(t){var n=r,i=o;return r=o=s,l=t,u=e.apply(i,n)}function g(e){return l=e,c=Os(v,t),h?p(e):u}function b(e){var n=e-d;return d===s||n>=t||n<0||f&&e-l>=a}function v(){var e=ki();if(b(e))return y(e);c=Os(v,function(e){var n=t-(e-d);return f?pn(n,a-(e-l)):n}(e))}function y(e){return c=s,m&&r?p(e):(r=o=s,u)}function _(){var e=ki(),n=b(e);if(r=arguments,o=this,d=e,n){if(c===s)return g(d);if(f)return vo(c),c=Os(v,t),p(d)}return c===s&&(c=Os(v,t)),u}return t=ha(t)||0,Zi(n)&&(h=!!n.leading,a=(f="maxWait"in n)?mn(ha(n.maxWait)||0,t):a,m="trailing"in n?!!n.trailing:m),_.cancel=function(){c!==s&&vo(c),l=0,r=d=o=c=s},_.flush=function(){return c===s?u:y(ki())},_}var Ei=$r((function(e,t){return ir(e,1,t)})),Ii=$r((function(e,t,n){return ir(e,ha(t)||0,n)}));function Ai(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Oe(i);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],s=n.cache;if(s.has(o))return s.get(o);var i=e.apply(this,r);return n.cache=s.set(o,i)||s,i};return n.cache=new(Ai.Cache||Un),n}function Ni(e){if("function"!=typeof e)throw new Oe(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ai.Cache=Un;var Ti=go((function(e,t){var n=(t=1==t.length&&qi(t[0])?xt(t[0],Ut(os())):xt(fr(t,1),Ut(os()))).length;return $r((function(r){for(var o=-1,s=pn(r.length,n);++o<s;)r[o]=t[o].call(this,r[o]);return vt(e,this,r)}))})),Fi=$r((function(e,t){var n=tn(t,rs(Fi));return Ko(e,c,s,t,n)})),Pi=$r((function(e,t){var n=tn(t,rs(Pi));return Ko(e,64,s,t,n)})),Ri=Yo((function(e,t){return Ko(e,256,s,s,s,t)}));function Di(e,t){return e===t||e!=e&&t!=t}var Mi=Ho(kr),Li=Ho((function(e,t){return e>=t})),Bi=Or(function(){return arguments}())?Or:function(e){return Xi(e)&&Fe.call(e,"callee")&&!Je.call(e,"callee")},qi=n.isArray,zi=ht?Ut(ht):function(e){return Xi(e)&&wr(e)==T};function Hi(e){return null!=e&&Ji(e.length)&&!Ki(e)}function Ui(e){return Xi(e)&&Hi(e)}var Vi=dn||hu,$i=ft?Ut(ft):function(e){return Xi(e)&&wr(e)==y};function Wi(e){if(!Xi(e))return!1;var t=wr(e);return t==_||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ea(e)}function Ki(e){if(!Zi(e))return!1;var t=wr(e);return t==w||t==k||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Gi(e){return"number"==typeof e&&e==da(e)}function Ji(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function Zi(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Xi(e){return null!=e&&"object"==typeof e}var Yi=mt?Ut(mt):function(e){return Xi(e)&&ds(e)==S};function Qi(e){return"number"==typeof e||Xi(e)&&wr(e)==j}function ea(e){if(!Xi(e)||wr(e)!=C)return!1;var t=Ve(e);if(null===t)return!0;var n=Fe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Te.call(n)==Me}var ta=pt?Ut(pt):function(e){return Xi(e)&&wr(e)==O},na=gt?Ut(gt):function(e){return Xi(e)&&ds(e)==E};function ra(e){return"string"==typeof e||!qi(e)&&Xi(e)&&wr(e)==I}function oa(e){return"symbol"==typeof e||Xi(e)&&wr(e)==A}var sa=bt?Ut(bt):function(e){return Xi(e)&&Ji(e.length)&&!!Qe[wr(e)]},ia=Ho(Fr),aa=Ho((function(e,t){return e<=t}));function ua(e){if(!e)return[];if(Hi(e))return ra(e)?on(e):Co(e);if(st&&e[st])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[st]());var t=ds(e);return(t==S?Qt:t==E?nn:Da)(e)}function ca(e){return e?(e=ha(e))===l||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function da(e){var t=ca(e),n=t%1;return t==t?n?t-n:t:0}function la(e){return e?rr(da(e),0,m):0}function ha(e){if("number"==typeof e)return e;if(oa(e))return f;if(Zi(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Zi(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(oe,"");var n=pe.test(e);return n||be.test(e)?rt(e.slice(2),n?2:8):me.test(e)?f:+e}function fa(e){return xo(e,Ea(e))}function ma(e){return null==e?"":oo(e)}var pa=Eo((function(e,t){if(ys(t)||Hi(t))xo(t,Oa(t),e);else for(var n in t)Fe.call(t,n)&&Xn(e,n,t[n])})),ga=Eo((function(e,t){xo(t,Ea(t),e)})),ba=Eo((function(e,t,n,r){xo(t,Ea(t),e,r)})),va=Eo((function(e,t,n,r){xo(t,Oa(t),e,r)})),ya=Yo(nr),_a=$r((function(e,t){e=je(e);var n=-1,r=t.length,o=r>2?t[2]:s;for(o&&ps(t[0],t[1],o)&&(r=1);++n<r;)for(var i=t[n],a=Ea(i),u=-1,c=a.length;++u<c;){var d=a[u],l=e[d];(l===s||Di(l,Ae[d])&&!Fe.call(e,d))&&(e[d]=i[d])}return e})),wa=$r((function(e){return e.push(s,Jo),vt(Aa,s,e)}));function ka(e,t,n){var r=null==e?s:yr(e,t);return r===s?n:r}function Sa(e,t){return null!=e&&ls(e,t,jr)}var ja=Mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=De.call(t)),e[t]=n}),Za(Qa)),Ca=Mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=De.call(t)),Fe.call(e,t)?e[t].push(n):e[t]=[n]}),os),xa=$r(xr);function Oa(e){return Hi(e)?Wn(e):Tr(e)}function Ea(e){return Hi(e)?Wn(e,!0):function(e){if(!Zi(e))return function(e){var t=[];if(null!=e)for(var n in je(e))t.push(n);return t}(e);var t=ys(e),n=[];for(var r in e)("constructor"!=r||!t&&Fe.call(e,r))&&n.push(r);return n}(e)}var Ia=Eo((function(e,t,n){Mr(e,t,n)})),Aa=Eo((function(e,t,n,r){Mr(e,t,n,r)})),Na=Yo((function(e,t){var n={};if(null==e)return n;var r=!1;t=xt(t,(function(t){return t=po(t,e),r||(r=t.length>1),t})),xo(e,es(e),n),r&&(n=or(n,7,Zo));for(var o=t.length;o--;)io(n,t[o]);return n})),Ta=Yo((function(e,t){return null==e?{}:function(e,t){return qr(e,t,(function(t,n){return Sa(e,n)}))}(e,t)}));function Fa(e,t){if(null==e)return{};var n=xt(es(e),(function(e){return[e]}));return t=os(t),qr(e,n,(function(e,n){return t(e,n[0])}))}var Pa=Wo(Oa),Ra=Wo(Ea);function Da(e){return null==e?[]:Vt(e,Oa(e))}var Ma=To((function(e,t,n){return t=t.toLowerCase(),e+(n?La(t):t)}));function La(e){return Wa(ma(e).toLowerCase())}function Ba(e){return(e=ma(e))&&e.replace(ye,Jt).replace(We,"")}var qa=To((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),za=To((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ha=No("toLowerCase"),Ua=To((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Va=To((function(e,t,n){return e+(n?" ":"")+Wa(t)})),$a=To((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Wa=No("toUpperCase");function Ka(e,t,n){return e=ma(e),(t=n?s:t)===s?function(e){return Ze.test(e)}(e)?function(e){return e.match(Ge)||[]}(e):function(e){return e.match(de)||[]}(e):e.match(t)||[]}var Ga=$r((function(e,t){try{return vt(e,s,t)}catch(e){return Wi(e)?e:new o(e)}})),Ja=Yo((function(e,t){return _t(t,(function(t){t=Fs(t),tr(e,t,Ci(e[t],e))})),e}));function Za(e){return function(){return e}}var Xa=Ro(),Ya=Ro(!0);function Qa(e){return e}function eu(e){return Nr("function"==typeof e?e:or(e,1))}var tu=$r((function(e,t){return function(n){return xr(n,e,t)}})),nu=$r((function(e,t){return function(n){return xr(e,n,t)}}));function ru(e,t,n){var r=Oa(t),o=vr(t,r);null!=n||Zi(t)&&(o.length||!r.length)||(n=t,t=e,e=this,o=vr(t,Oa(t)));var s=!(Zi(n)&&"chain"in n&&!n.chain),i=Ki(e);return _t(o,(function(n){var r=t[n];e[n]=r,i&&(e.prototype[n]=function(){var t=this.__chain__;if(s||t){var n=e(this.__wrapped__),o=n.__actions__=Co(this.__actions__);return o.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Ot([this.value()],arguments))})})),e}function ou(){}var su=Bo(xt),iu=Bo(kt),au=Bo(At);function uu(e){return gs(e)?Lt(Fs(e)):function(e){return function(t){return yr(t,e)}}(e)}var cu=zo(),du=zo(!0);function lu(){return[]}function hu(){return!1}var fu=Lo((function(e,t){return e+t}),0),mu=Vo("ceil"),pu=Lo((function(e,t){return e/t}),1),gu=Vo("floor"),bu=Lo((function(e,t){return e*t}),1),vu=Vo("round"),yu=Lo((function(e,t){return e-t}),0);return Dn.after=function(e,t){if("function"!=typeof t)throw new Oe(i);return e=da(e),function(){if(--e<1)return t.apply(this,arguments)}},Dn.ary=Si,Dn.assign=pa,Dn.assignIn=ga,Dn.assignInWith=ba,Dn.assignWith=va,Dn.at=ya,Dn.before=ji,Dn.bind=Ci,Dn.bindAll=Ja,Dn.bindKey=xi,Dn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return qi(e)?e:[e]},Dn.chain=ui,Dn.chunk=function(e,t,r){t=(r?ps(e,t,r):t===s)?1:mn(da(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var i=0,a=0,u=n(Bt(o/t));i<o;)u[a++]=Yr(e,i,i+=t);return u},Dn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var s=e[t];s&&(o[r++]=s)}return o},Dn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],o=e;o--;)t[o-1]=arguments[o];return Ot(qi(r)?Co(r):[r],fr(t,1))},Dn.cond=function(e){var t=null==e?0:e.length,n=os();return e=t?xt(e,(function(e){if("function"!=typeof e[1])throw new Oe(i);return[n(e[0]),e[1]]})):[],$r((function(n){for(var r=-1;++r<t;){var o=e[r];if(vt(o[0],this,n))return vt(o[1],this,n)}}))},Dn.conforms=function(e){return function(e){var t=Oa(e);return function(n){return sr(n,e,t)}}(or(e,1))},Dn.constant=Za,Dn.countBy=li,Dn.create=function(e,t){var n=Mn(e);return null==t?n:er(n,t)},Dn.curry=function e(t,n,r){var o=Ko(t,8,s,s,s,s,s,n=r?s:n);return o.placeholder=e.placeholder,o},Dn.curryRight=function e(t,n,r){var o=Ko(t,16,s,s,s,s,s,n=r?s:n);return o.placeholder=e.placeholder,o},Dn.debounce=Oi,Dn.defaults=_a,Dn.defaultsDeep=wa,Dn.defer=Ei,Dn.delay=Ii,Dn.difference=Ds,Dn.differenceBy=Ms,Dn.differenceWith=Ls,Dn.drop=function(e,t,n){var r=null==e?0:e.length;return r?Yr(e,(t=n||t===s?1:da(t))<0?0:t,r):[]},Dn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Yr(e,0,(t=r-(t=n||t===s?1:da(t)))<0?0:t):[]},Dn.dropRightWhile=function(e,t){return e&&e.length?uo(e,os(t,3),!0,!0):[]},Dn.dropWhile=function(e,t){return e&&e.length?uo(e,os(t,3),!0):[]},Dn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&ps(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=da(n))<0&&(n=-n>o?0:o+n),(r=r===s||r>o?o:da(r))<0&&(r+=o),r=n>r?0:la(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Dn.filter=function(e,t){return(qi(e)?St:hr)(e,os(t,3))},Dn.flatMap=function(e,t){return fr(yi(e,t),1)},Dn.flatMapDeep=function(e,t){return fr(yi(e,t),l)},Dn.flatMapDepth=function(e,t,n){return n=n===s?1:da(n),fr(yi(e,t),n)},Dn.flatten=zs,Dn.flattenDeep=function(e){return null!=e&&e.length?fr(e,l):[]},Dn.flattenDepth=function(e,t){return null!=e&&e.length?fr(e,t=t===s?1:da(t)):[]},Dn.flip=function(e){return Ko(e,512)},Dn.flow=Xa,Dn.flowRight=Ya,Dn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var o=e[t];r[o[0]]=o[1]}return r},Dn.functions=function(e){return null==e?[]:vr(e,Oa(e))},Dn.functionsIn=function(e){return null==e?[]:vr(e,Ea(e))},Dn.groupBy=gi,Dn.initial=function(e){return null!=e&&e.length?Yr(e,0,-1):[]},Dn.intersection=Us,Dn.intersectionBy=Vs,Dn.intersectionWith=$s,Dn.invert=ja,Dn.invertBy=Ca,Dn.invokeMap=bi,Dn.iteratee=eu,Dn.keyBy=vi,Dn.keys=Oa,Dn.keysIn=Ea,Dn.map=yi,Dn.mapKeys=function(e,t){var n={};return t=os(t,3),gr(e,(function(e,r,o){tr(n,t(e,r,o),e)})),n},Dn.mapValues=function(e,t){var n={};return t=os(t,3),gr(e,(function(e,r,o){tr(n,r,t(e,r,o))})),n},Dn.matches=function(e){return Rr(or(e,1))},Dn.matchesProperty=function(e,t){return Dr(e,or(t,1))},Dn.memoize=Ai,Dn.merge=Ia,Dn.mergeWith=Aa,Dn.method=tu,Dn.methodOf=nu,Dn.mixin=ru,Dn.negate=Ni,Dn.nthArg=function(e){return e=da(e),$r((function(t){return Lr(t,e)}))},Dn.omit=Na,Dn.omitBy=function(e,t){return Fa(e,Ni(os(t)))},Dn.once=function(e){return ji(2,e)},Dn.orderBy=function(e,t,n,r){return null==e?[]:(qi(t)||(t=null==t?[]:[t]),qi(n=r?s:n)||(n=null==n?[]:[n]),Br(e,t,n))},Dn.over=su,Dn.overArgs=Ti,Dn.overEvery=iu,Dn.overSome=au,Dn.partial=Fi,Dn.partialRight=Pi,Dn.partition=_i,Dn.pick=Ta,Dn.pickBy=Fa,Dn.property=uu,Dn.propertyOf=function(e){return function(t){return null==e?s:yr(e,t)}},Dn.pull=Ks,Dn.pullAll=Gs,Dn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?zr(e,t,os(n,2)):e},Dn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?zr(e,t,s,n):e},Dn.pullAt=Js,Dn.range=cu,Dn.rangeRight=du,Dn.rearg=Ri,Dn.reject=function(e,t){return(qi(e)?St:hr)(e,Ni(os(t,3)))},Dn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,o=[],s=e.length;for(t=os(t,3);++r<s;){var i=e[r];t(i,r,e)&&(n.push(i),o.push(r))}return Hr(e,o),n},Dn.rest=function(e,t){if("function"!=typeof e)throw new Oe(i);return $r(e,t=t===s?t:da(t))},Dn.reverse=Zs,Dn.sampleSize=function(e,t,n){return t=(n?ps(e,t,n):t===s)?1:da(t),(qi(e)?Gn:Kr)(e,t)},Dn.set=function(e,t,n){return null==e?e:Gr(e,t,n)},Dn.setWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:Gr(e,t,n,r)},Dn.shuffle=function(e){return(qi(e)?Jn:Xr)(e)},Dn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&ps(e,t,n)?(t=0,n=r):(t=null==t?0:da(t),n=n===s?r:da(n)),Yr(e,t,n)):[]},Dn.sortBy=wi,Dn.sortedUniq=function(e){return e&&e.length?no(e):[]},Dn.sortedUniqBy=function(e,t){return e&&e.length?no(e,os(t,2)):[]},Dn.split=function(e,t,n){return n&&"number"!=typeof n&&ps(e,t,n)&&(t=n=s),(n=n===s?m:n>>>0)?(e=ma(e))&&("string"==typeof t||null!=t&&!ta(t))&&!(t=oo(t))&&Yt(e)?bo(on(e),0,n):e.split(t,n):[]},Dn.spread=function(e,t){if("function"!=typeof e)throw new Oe(i);return t=null==t?0:mn(da(t),0),$r((function(n){var r=n[t],o=bo(n,0,t);return r&&Ot(o,r),vt(e,this,o)}))},Dn.tail=function(e){var t=null==e?0:e.length;return t?Yr(e,1,t):[]},Dn.take=function(e,t,n){return e&&e.length?Yr(e,0,(t=n||t===s?1:da(t))<0?0:t):[]},Dn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Yr(e,(t=r-(t=n||t===s?1:da(t)))<0?0:t,r):[]},Dn.takeRightWhile=function(e,t){return e&&e.length?uo(e,os(t,3),!1,!0):[]},Dn.takeWhile=function(e,t){return e&&e.length?uo(e,os(t,3)):[]},Dn.tap=function(e,t){return t(e),e},Dn.throttle=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new Oe(i);return Zi(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Oi(e,t,{leading:r,maxWait:t,trailing:o})},Dn.thru=ci,Dn.toArray=ua,Dn.toPairs=Pa,Dn.toPairsIn=Ra,Dn.toPath=function(e){return qi(e)?xt(e,Fs):oa(e)?[e]:Co(Ts(ma(e)))},Dn.toPlainObject=fa,Dn.transform=function(e,t,n){var r=qi(e),o=r||Vi(e)||sa(e);if(t=os(t,4),null==n){var s=e&&e.constructor;n=o?r?new s:[]:Zi(e)&&Ki(s)?Mn(Ve(e)):{}}return(o?_t:gr)(e,(function(e,r,o){return t(n,e,r,o)})),n},Dn.unary=function(e){return Si(e,1)},Dn.union=Xs,Dn.unionBy=Ys,Dn.unionWith=Qs,Dn.uniq=function(e){return e&&e.length?so(e):[]},Dn.uniqBy=function(e,t){return e&&e.length?so(e,os(t,2)):[]},Dn.uniqWith=function(e,t){return t="function"==typeof t?t:s,e&&e.length?so(e,s,t):[]},Dn.unset=function(e,t){return null==e||io(e,t)},Dn.unzip=ei,Dn.unzipWith=ti,Dn.update=function(e,t,n){return null==e?e:ao(e,t,mo(n))},Dn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:ao(e,t,mo(n),r)},Dn.values=Da,Dn.valuesIn=function(e){return null==e?[]:Vt(e,Ea(e))},Dn.without=ni,Dn.words=Ka,Dn.wrap=function(e,t){return Fi(mo(t),e)},Dn.xor=ri,Dn.xorBy=oi,Dn.xorWith=si,Dn.zip=ii,Dn.zipObject=function(e,t){return ho(e||[],t||[],Xn)},Dn.zipObjectDeep=function(e,t){return ho(e||[],t||[],Gr)},Dn.zipWith=ai,Dn.entries=Pa,Dn.entriesIn=Ra,Dn.extend=ga,Dn.extendWith=ba,ru(Dn,Dn),Dn.add=fu,Dn.attempt=Ga,Dn.camelCase=Ma,Dn.capitalize=La,Dn.ceil=mu,Dn.clamp=function(e,t,n){return n===s&&(n=t,t=s),n!==s&&(n=(n=ha(n))===n?n:0),t!==s&&(t=(t=ha(t))===t?t:0),rr(ha(e),t,n)},Dn.clone=function(e){return or(e,4)},Dn.cloneDeep=function(e){return or(e,5)},Dn.cloneDeepWith=function(e,t){return or(e,5,t="function"==typeof t?t:s)},Dn.cloneWith=function(e,t){return or(e,4,t="function"==typeof t?t:s)},Dn.conformsTo=function(e,t){return null==t||sr(e,t,Oa(t))},Dn.deburr=Ba,Dn.defaultTo=function(e,t){return null==e||e!=e?t:e},Dn.divide=pu,Dn.endsWith=function(e,t,n){e=ma(e),t=oo(t);var r=e.length,o=n=n===s?r:rr(da(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Dn.eq=Di,Dn.escape=function(e){return(e=ma(e))&&J.test(e)?e.replace(K,Zt):e},Dn.escapeRegExp=function(e){return(e=ma(e))&&re.test(e)?e.replace(ne,"\\$&"):e},Dn.every=function(e,t,n){var r=qi(e)?kt:dr;return n&&ps(e,t,n)&&(t=s),r(e,os(t,3))},Dn.find=hi,Dn.findIndex=Bs,Dn.findKey=function(e,t){return Tt(e,os(t,3),gr)},Dn.findLast=fi,Dn.findLastIndex=qs,Dn.findLastKey=function(e,t){return Tt(e,os(t,3),br)},Dn.floor=gu,Dn.forEach=mi,Dn.forEachRight=pi,Dn.forIn=function(e,t){return null==e?e:mr(e,os(t,3),Ea)},Dn.forInRight=function(e,t){return null==e?e:pr(e,os(t,3),Ea)},Dn.forOwn=function(e,t){return e&&gr(e,os(t,3))},Dn.forOwnRight=function(e,t){return e&&br(e,os(t,3))},Dn.get=ka,Dn.gt=Mi,Dn.gte=Li,Dn.has=function(e,t){return null!=e&&ls(e,t,Sr)},Dn.hasIn=Sa,Dn.head=Hs,Dn.identity=Qa,Dn.includes=function(e,t,n,r){e=Hi(e)?e:Da(e),n=n&&!r?da(n):0;var o=e.length;return n<0&&(n=mn(o+n,0)),ra(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&Pt(e,t,n)>-1},Dn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:da(n);return o<0&&(o=mn(r+o,0)),Pt(e,t,o)},Dn.inRange=function(e,t,n){return t=ca(t),n===s?(n=t,t=0):n=ca(n),function(e,t,n){return e>=pn(t,n)&&e<mn(t,n)}(e=ha(e),t,n)},Dn.invoke=xa,Dn.isArguments=Bi,Dn.isArray=qi,Dn.isArrayBuffer=zi,Dn.isArrayLike=Hi,Dn.isArrayLikeObject=Ui,Dn.isBoolean=function(e){return!0===e||!1===e||Xi(e)&&wr(e)==v},Dn.isBuffer=Vi,Dn.isDate=$i,Dn.isElement=function(e){return Xi(e)&&1===e.nodeType&&!ea(e)},Dn.isEmpty=function(e){if(null==e)return!0;if(Hi(e)&&(qi(e)||"string"==typeof e||"function"==typeof e.splice||Vi(e)||sa(e)||Bi(e)))return!e.length;var t=ds(e);if(t==S||t==E)return!e.size;if(ys(e))return!Tr(e).length;for(var n in e)if(Fe.call(e,n))return!1;return!0},Dn.isEqual=function(e,t){return Er(e,t)},Dn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:s)?n(e,t):s;return r===s?Er(e,t,s,n):!!r},Dn.isError=Wi,Dn.isFinite=function(e){return"number"==typeof e&&ln(e)},Dn.isFunction=Ki,Dn.isInteger=Gi,Dn.isLength=Ji,Dn.isMap=Yi,Dn.isMatch=function(e,t){return e===t||Ir(e,t,is(t))},Dn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:s,Ir(e,t,is(t),n)},Dn.isNaN=function(e){return Qi(e)&&e!=+e},Dn.isNative=function(e){if(vs(e))throw new o("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ar(e)},Dn.isNil=function(e){return null==e},Dn.isNull=function(e){return null===e},Dn.isNumber=Qi,Dn.isObject=Zi,Dn.isObjectLike=Xi,Dn.isPlainObject=ea,Dn.isRegExp=ta,Dn.isSafeInteger=function(e){return Gi(e)&&e>=-9007199254740991&&e<=h},Dn.isSet=na,Dn.isString=ra,Dn.isSymbol=oa,Dn.isTypedArray=sa,Dn.isUndefined=function(e){return e===s},Dn.isWeakMap=function(e){return Xi(e)&&ds(e)==N},Dn.isWeakSet=function(e){return Xi(e)&&"[object WeakSet]"==wr(e)},Dn.join=function(e,t){return null==e?"":hn.call(e,t)},Dn.kebabCase=qa,Dn.last=Ws,Dn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==s&&(o=(o=da(n))<0?mn(r+o,0):pn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Ft(e,Dt,o,!0)},Dn.lowerCase=za,Dn.lowerFirst=Ha,Dn.lt=ia,Dn.lte=aa,Dn.max=function(e){return e&&e.length?lr(e,Qa,kr):s},Dn.maxBy=function(e,t){return e&&e.length?lr(e,os(t,2),kr):s},Dn.mean=function(e){return Mt(e,Qa)},Dn.meanBy=function(e,t){return Mt(e,os(t,2))},Dn.min=function(e){return e&&e.length?lr(e,Qa,Fr):s},Dn.minBy=function(e,t){return e&&e.length?lr(e,os(t,2),Fr):s},Dn.stubArray=lu,Dn.stubFalse=hu,Dn.stubObject=function(){return{}},Dn.stubString=function(){return""},Dn.stubTrue=function(){return!0},Dn.multiply=bu,Dn.nth=function(e,t){return e&&e.length?Lr(e,da(t)):s},Dn.noConflict=function(){return it._===this&&(it._=Le),this},Dn.noop=ou,Dn.now=ki,Dn.pad=function(e,t,n){e=ma(e);var r=(t=da(t))?rn(e):0;if(!t||r>=t)return e;var o=(t-r)/2;return qo(un(o),n)+e+qo(Bt(o),n)},Dn.padEnd=function(e,t,n){e=ma(e);var r=(t=da(t))?rn(e):0;return t&&r<t?e+qo(t-r,n):e},Dn.padStart=function(e,t,n){e=ma(e);var r=(t=da(t))?rn(e):0;return t&&r<t?qo(t-r,n)+e:e},Dn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),bn(ma(e).replace(se,""),t||0)},Dn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&ps(e,t,n)&&(t=n=s),n===s&&("boolean"==typeof t?(n=t,t=s):"boolean"==typeof e&&(n=e,e=s)),e===s&&t===s?(e=0,t=1):(e=ca(e),t===s?(t=e,e=0):t=ca(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=vn();return pn(e+o*(t-e+nt("1e-"+((o+"").length-1))),t)}return Ur(e,t)},Dn.reduce=function(e,t,n){var r=qi(e)?Et:qt,o=arguments.length<3;return r(e,os(t,4),n,o,ur)},Dn.reduceRight=function(e,t,n){var r=qi(e)?It:qt,o=arguments.length<3;return r(e,os(t,4),n,o,cr)},Dn.repeat=function(e,t,n){return t=(n?ps(e,t,n):t===s)?1:da(t),Vr(ma(e),t)},Dn.replace=function(){var e=arguments,t=ma(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Dn.result=function(e,t,n){var r=-1,o=(t=po(t,e)).length;for(o||(o=1,e=s);++r<o;){var i=null==e?s:e[Fs(t[r])];i===s&&(r=o,i=n),e=Ki(i)?i.call(e):i}return e},Dn.round=vu,Dn.runInContext=e,Dn.sample=function(e){return(qi(e)?Kn:Wr)(e)},Dn.size=function(e){if(null==e)return 0;if(Hi(e))return ra(e)?rn(e):e.length;var t=ds(e);return t==S||t==E?e.size:Tr(e).length},Dn.snakeCase=Ua,Dn.some=function(e,t,n){var r=qi(e)?At:Qr;return n&&ps(e,t,n)&&(t=s),r(e,os(t,3))},Dn.sortedIndex=function(e,t){return eo(e,t)},Dn.sortedIndexBy=function(e,t,n){return to(e,t,os(n,2))},Dn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=eo(e,t);if(r<n&&Di(e[r],t))return r}return-1},Dn.sortedLastIndex=function(e,t){return eo(e,t,!0)},Dn.sortedLastIndexBy=function(e,t,n){return to(e,t,os(n,2),!0)},Dn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=eo(e,t,!0)-1;if(Di(e[n],t))return n}return-1},Dn.startCase=Va,Dn.startsWith=function(e,t,n){return e=ma(e),n=null==n?0:rr(da(n),0,e.length),t=oo(t),e.slice(n,n+t.length)==t},Dn.subtract=yu,Dn.sum=function(e){return e&&e.length?zt(e,Qa):0},Dn.sumBy=function(e,t){return e&&e.length?zt(e,os(t,2)):0},Dn.template=function(e,t,n){var r=Dn.templateSettings;n&&ps(e,t,n)&&(t=s),e=ma(e),t=ba({},t,r,Go);var o,i,a=ba({},t.imports,r.imports,Go),u=Oa(a),c=Vt(a,u),d=0,l=t.interpolate||_e,h="__p += '",f=Ce((t.escape||_e).source+"|"+l.source+"|"+(l===Y?he:_e).source+"|"+(t.evaluate||_e).source+"|$","g"),m="//# sourceURL="+(Fe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ye+"]")+"\n";e.replace(f,(function(t,n,r,s,a,u){return r||(r=s),h+=e.slice(d,u).replace(we,Xt),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),a&&(i=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),d=u+t.length,t})),h+="';\n";var p=Fe.call(t,"variable")&&t.variable;p||(h="with (obj) {\n"+h+"\n}\n"),h=(i?h.replace(U,""):h).replace(V,"$1").replace($,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=Ga((function(){return ke(u,m+"return "+h).apply(s,c)}));if(g.source=h,Wi(g))throw g;return g},Dn.times=function(e,t){if((e=da(e))<1||e>h)return[];var n=m,r=pn(e,m);t=os(t),e-=m;for(var o=Ht(r,t);++n<e;)t(n);return o},Dn.toFinite=ca,Dn.toInteger=da,Dn.toLength=la,Dn.toLower=function(e){return ma(e).toLowerCase()},Dn.toNumber=ha,Dn.toSafeInteger=function(e){return e?rr(da(e),-9007199254740991,h):0===e?e:0},Dn.toString=ma,Dn.toUpper=function(e){return ma(e).toUpperCase()},Dn.trim=function(e,t,n){if((e=ma(e))&&(n||t===s))return e.replace(oe,"");if(!e||!(t=oo(t)))return e;var r=on(e),o=on(t);return bo(r,Wt(r,o),Kt(r,o)+1).join("")},Dn.trimEnd=function(e,t,n){if((e=ma(e))&&(n||t===s))return e.replace(ie,"");if(!e||!(t=oo(t)))return e;var r=on(e);return bo(r,0,Kt(r,on(t))+1).join("")},Dn.trimStart=function(e,t,n){if((e=ma(e))&&(n||t===s))return e.replace(se,"");if(!e||!(t=oo(t)))return e;var r=on(e);return bo(r,Wt(r,on(t))).join("")},Dn.truncate=function(e,t){var n=30,r="...";if(Zi(t)){var o="separator"in t?t.separator:o;n="length"in t?da(t.length):n,r="omission"in t?oo(t.omission):r}var i=(e=ma(e)).length;if(Yt(e)){var a=on(e);i=a.length}if(n>=i)return e;var u=n-rn(r);if(u<1)return r;var c=a?bo(a,0,u).join(""):e.slice(0,u);if(o===s)return c+r;if(a&&(u+=c.length-u),ta(o)){if(e.slice(u).search(o)){var d,l=c;for(o.global||(o=Ce(o.source,ma(fe.exec(o))+"g")),o.lastIndex=0;d=o.exec(l);)var h=d.index;c=c.slice(0,h===s?u:h)}}else if(e.indexOf(oo(o),u)!=u){var f=c.lastIndexOf(o);f>-1&&(c=c.slice(0,f))}return c+r},Dn.unescape=function(e){return(e=ma(e))&&G.test(e)?e.replace(W,sn):e},Dn.uniqueId=function(e){var t=++Pe;return ma(e)+t},Dn.upperCase=$a,Dn.upperFirst=Wa,Dn.each=mi,Dn.eachRight=pi,Dn.first=Hs,ru(Dn,function(){var e={};return gr(Dn,(function(t,n){Fe.call(Dn.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),Dn.VERSION="4.17.20",_t(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Dn[e].placeholder=Dn})),_t(["drop","take"],(function(e,t){qn.prototype[e]=function(n){n=n===s?1:mn(da(n),0);var r=this.__filtered__&&!t?new qn(this):this.clone();return r.__filtered__?r.__takeCount__=pn(n,r.__takeCount__):r.__views__.push({size:pn(n,m),type:e+(r.__dir__<0?"Right":"")}),r},qn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),_t(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;qn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:os(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),_t(["head","last"],(function(e,t){var n="take"+(t?"Right":"");qn.prototype[e]=function(){return this[n](1).value()[0]}})),_t(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");qn.prototype[e]=function(){return this.__filtered__?new qn(this):this[n](1)}})),qn.prototype.compact=function(){return this.filter(Qa)},qn.prototype.find=function(e){return this.filter(e).head()},qn.prototype.findLast=function(e){return this.reverse().find(e)},qn.prototype.invokeMap=$r((function(e,t){return"function"==typeof e?new qn(this):this.map((function(n){return xr(n,e,t)}))})),qn.prototype.reject=function(e){return this.filter(Ni(os(e)))},qn.prototype.slice=function(e,t){e=da(e);var n=this;return n.__filtered__&&(e>0||t<0)?new qn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==s&&(n=(t=da(t))<0?n.dropRight(-t):n.take(t-e)),n)},qn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},qn.prototype.toArray=function(){return this.take(m)},gr(qn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Dn[r?"take"+("last"==t?"Right":""):t],i=r||/^find/.test(t);o&&(Dn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,u=t instanceof qn,c=a[0],d=u||qi(t),l=function(e){var t=o.apply(Dn,Ot([e],a));return r&&h?t[0]:t};d&&n&&"function"==typeof c&&1!=c.length&&(u=d=!1);var h=this.__chain__,f=!!this.__actions__.length,m=i&&!h,p=u&&!f;if(!i&&d){t=p?t:new qn(this);var g=e.apply(t,a);return g.__actions__.push({func:ci,args:[l],thisArg:s}),new Bn(g,h)}return m&&p?e.apply(this,a):(g=this.thru(l),m?r?g.value()[0]:g.value():g)})})),_t(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ee[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Dn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(qi(o)?o:[],e)}return this[n]((function(n){return t.apply(qi(n)?n:[],e)}))}})),gr(qn.prototype,(function(e,t){var n=Dn[t];if(n){var r=n.name+"";Fe.call(On,r)||(On[r]=[]),On[r].push({name:t,func:n})}})),On[Do(s,2).name]=[{name:"wrapper",func:s}],qn.prototype.clone=function(){var e=new qn(this.__wrapped__);return e.__actions__=Co(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Co(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Co(this.__views__),e},qn.prototype.reverse=function(){if(this.__filtered__){var e=new qn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},qn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=qi(e),r=t<0,o=n?e.length:0,s=function(e,t,n){for(var r=-1,o=n.length;++r<o;){var s=n[r],i=s.size;switch(s.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=pn(t,e+i);break;case"takeRight":e=mn(e,t-i)}}return{start:e,end:t}}(0,o,this.__views__),i=s.start,a=s.end,u=a-i,c=r?a:i-1,d=this.__iteratees__,l=d.length,h=0,f=pn(u,this.__takeCount__);if(!n||!r&&o==u&&f==u)return co(e,this.__actions__);var m=[];e:for(;u--&&h<f;){for(var p=-1,g=e[c+=t];++p<l;){var b=d[p],v=b.iteratee,y=b.type,_=v(g);if(2==y)g=_;else if(!_){if(1==y)continue e;break e}}m[h++]=g}return m},Dn.prototype.at=di,Dn.prototype.chain=function(){return ui(this)},Dn.prototype.commit=function(){return new Bn(this.value(),this.__chain__)},Dn.prototype.next=function(){this.__values__===s&&(this.__values__=ua(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?s:this.__values__[this.__index__++]}},Dn.prototype.plant=function(e){for(var t,n=this;n instanceof Ln;){var r=Rs(n);r.__index__=0,r.__values__=s,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Dn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof qn){var t=e;return this.__actions__.length&&(t=new qn(this)),(t=t.reverse()).__actions__.push({func:ci,args:[Zs],thisArg:s}),new Bn(t,this.__chain__)}return this.thru(Zs)},Dn.prototype.toJSON=Dn.prototype.valueOf=Dn.prototype.value=function(){return co(this.__wrapped__,this.__actions__)},Dn.prototype.first=Dn.prototype.head,st&&(Dn.prototype[st]=function(){return this}),Dn}();it._=an,(o=function(){return an}.call(t,n,t,r))===s||(r.exports=o)}).call(this)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/server-lambdas/node_modules/semver/semver.js":function(e,t,n){(function(n){var r;t=e.exports=h,r="object"==typeof n&&Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"})&&Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var o=Number.MAX_SAFE_INTEGER||9007199254740991,s=t.re=[],i=t.src=[],a=t.tokens={},u=0;function c(e){a[e]=u++}c("NUMERICIDENTIFIER"),i[a.NUMERICIDENTIFIER]="0|[1-9]\\d*",c("NUMERICIDENTIFIERLOOSE"),i[a.NUMERICIDENTIFIERLOOSE]="[0-9]+",c("NONNUMERICIDENTIFIER"),i[a.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",c("MAINVERSION"),i[a.MAINVERSION]="("+i[a.NUMERICIDENTIFIER]+")\\.("+i[a.NUMERICIDENTIFIER]+")\\.("+i[a.NUMERICIDENTIFIER]+")",c("MAINVERSIONLOOSE"),i[a.MAINVERSIONLOOSE]="("+i[a.NUMERICIDENTIFIERLOOSE]+")\\.("+i[a.NUMERICIDENTIFIERLOOSE]+")\\.("+i[a.NUMERICIDENTIFIERLOOSE]+")",c("PRERELEASEIDENTIFIER"),i[a.PRERELEASEIDENTIFIER]="(?:"+i[a.NUMERICIDENTIFIER]+"|"+i[a.NONNUMERICIDENTIFIER]+")",c("PRERELEASEIDENTIFIERLOOSE"),i[a.PRERELEASEIDENTIFIERLOOSE]="(?:"+i[a.NUMERICIDENTIFIERLOOSE]+"|"+i[a.NONNUMERICIDENTIFIER]+")",c("PRERELEASE"),i[a.PRERELEASE]="(?:-("+i[a.PRERELEASEIDENTIFIER]+"(?:\\."+i[a.PRERELEASEIDENTIFIER]+")*))",c("PRERELEASELOOSE"),i[a.PRERELEASELOOSE]="(?:-?("+i[a.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+i[a.PRERELEASEIDENTIFIERLOOSE]+")*))",c("BUILDIDENTIFIER"),i[a.BUILDIDENTIFIER]="[0-9A-Za-z-]+",c("BUILD"),i[a.BUILD]="(?:\\+("+i[a.BUILDIDENTIFIER]+"(?:\\."+i[a.BUILDIDENTIFIER]+")*))",c("FULL"),c("FULLPLAIN"),i[a.FULLPLAIN]="v?"+i[a.MAINVERSION]+i[a.PRERELEASE]+"?"+i[a.BUILD]+"?",i[a.FULL]="^"+i[a.FULLPLAIN]+"$",c("LOOSEPLAIN"),i[a.LOOSEPLAIN]="[v=\\s]*"+i[a.MAINVERSIONLOOSE]+i[a.PRERELEASELOOSE]+"?"+i[a.BUILD]+"?",c("LOOSE"),i[a.LOOSE]="^"+i[a.LOOSEPLAIN]+"$",c("GTLT"),i[a.GTLT]="((?:<|>)?=?)",c("XRANGEIDENTIFIERLOOSE"),i[a.XRANGEIDENTIFIERLOOSE]=i[a.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",c("XRANGEIDENTIFIER"),i[a.XRANGEIDENTIFIER]=i[a.NUMERICIDENTIFIER]+"|x|X|\\*",c("XRANGEPLAIN"),i[a.XRANGEPLAIN]="[v=\\s]*("+i[a.XRANGEIDENTIFIER]+")(?:\\.("+i[a.XRANGEIDENTIFIER]+")(?:\\.("+i[a.XRANGEIDENTIFIER]+")(?:"+i[a.PRERELEASE]+")?"+i[a.BUILD]+"?)?)?",c("XRANGEPLAINLOOSE"),i[a.XRANGEPLAINLOOSE]="[v=\\s]*("+i[a.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+i[a.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+i[a.XRANGEIDENTIFIERLOOSE]+")(?:"+i[a.PRERELEASELOOSE]+")?"+i[a.BUILD]+"?)?)?",c("XRANGE"),i[a.XRANGE]="^"+i[a.GTLT]+"\\s*"+i[a.XRANGEPLAIN]+"$",c("XRANGELOOSE"),i[a.XRANGELOOSE]="^"+i[a.GTLT]+"\\s*"+i[a.XRANGEPLAINLOOSE]+"$",c("COERCE"),i[a.COERCE]="(^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])",c("COERCERTL"),s[a.COERCERTL]=new RegExp(i[a.COERCE],"g"),c("LONETILDE"),i[a.LONETILDE]="(?:~>?)",c("TILDETRIM"),i[a.TILDETRIM]="(\\s*)"+i[a.LONETILDE]+"\\s+",s[a.TILDETRIM]=new RegExp(i[a.TILDETRIM],"g"),c("TILDE"),i[a.TILDE]="^"+i[a.LONETILDE]+i[a.XRANGEPLAIN]+"$",c("TILDELOOSE"),i[a.TILDELOOSE]="^"+i[a.LONETILDE]+i[a.XRANGEPLAINLOOSE]+"$",c("LONECARET"),i[a.LONECARET]="(?:\\^)",c("CARETTRIM"),i[a.CARETTRIM]="(\\s*)"+i[a.LONECARET]+"\\s+",s[a.CARETTRIM]=new RegExp(i[a.CARETTRIM],"g"),c("CARET"),i[a.CARET]="^"+i[a.LONECARET]+i[a.XRANGEPLAIN]+"$",c("CARETLOOSE"),i[a.CARETLOOSE]="^"+i[a.LONECARET]+i[a.XRANGEPLAINLOOSE]+"$",c("COMPARATORLOOSE"),i[a.COMPARATORLOOSE]="^"+i[a.GTLT]+"\\s*("+i[a.LOOSEPLAIN]+")$|^$",c("COMPARATOR"),i[a.COMPARATOR]="^"+i[a.GTLT]+"\\s*("+i[a.FULLPLAIN]+")$|^$",c("COMPARATORTRIM"),i[a.COMPARATORTRIM]="(\\s*)"+i[a.GTLT]+"\\s*("+i[a.LOOSEPLAIN]+"|"+i[a.XRANGEPLAIN]+")",s[a.COMPARATORTRIM]=new RegExp(i[a.COMPARATORTRIM],"g"),c("HYPHENRANGE"),i[a.HYPHENRANGE]="^\\s*("+i[a.XRANGEPLAIN]+")\\s+-\\s+("+i[a.XRANGEPLAIN]+")\\s*$",c("HYPHENRANGELOOSE"),i[a.HYPHENRANGELOOSE]="^\\s*("+i[a.XRANGEPLAINLOOSE]+")\\s+-\\s+("+i[a.XRANGEPLAINLOOSE]+")\\s*$",c("STAR"),i[a.STAR]="(<|>)?=?\\s*\\*";for(var d=0;d<u;d++)r(d,i[d]),s[d]||(s[d]=new RegExp(i[d]));function l(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof h)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?s[a.LOOSE]:s[a.FULL]).test(e))return null;try{return new h(e,t)}catch(e){return null}}function h(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof h){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof h))return new h(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var n=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}t.parse=l,t.valid=function(e,t){var n=l(e,t);return n?n.version:null},t.clean=function(e,t){var n=l(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null},t.SemVer=h,h.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},h.prototype.toString=function(){return this.version},h.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof h||(e=new h(e,this.options)),this.compareMain(e)||this.comparePre(e)},h.prototype.compareMain=function(e){return e instanceof h||(e=new h(e,this.options)),m(this.major,e.major)||m(this.minor,e.minor)||m(this.patch,e.patch)},h.prototype.comparePre=function(e){if(e instanceof h||(e=new h(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],o=e.prerelease[t];if(r("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return m(n,o)}while(++t)},h.prototype.compareBuild=function(e){e instanceof h||(e=new h(e,this.options));var t=0;do{var n=this.build[t],o=e.build[t];if(r("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return m(n,o)}while(++t)},h.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,n,r){"string"==typeof n&&(r=n,n=void 0);try{return new h(e,n).inc(t,r).version}catch(e){return null}},t.diff=function(e,t){if(v(e,t))return null;var n=l(e),r=l(t),o="";if(n.prerelease.length||r.prerelease.length){o="pre";var s="prerelease"}for(var i in n)if(("major"===i||"minor"===i||"patch"===i)&&n[i]!==r[i])return o+i;return s},t.compareIdentifiers=m;var f=/^[0-9]+$/;function m(e,t){var n=f.test(e),r=f.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1}function p(e,t,n){return new h(e,n).compare(new h(t,n))}function g(e,t,n){return p(e,t,n)>0}function b(e,t,n){return p(e,t,n)<0}function v(e,t,n){return 0===p(e,t,n)}function y(e,t,n){return 0!==p(e,t,n)}function _(e,t,n){return p(e,t,n)>=0}function w(e,t,n){return p(e,t,n)<=0}function k(e,t,n,r){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return v(e,n,r);case"!=":return y(e,n,r);case">":return g(e,n,r);case">=":return _(e,n,r);case"<":return b(e,n,r);case"<=":return w(e,n,r);default:throw new TypeError("Invalid operator: "+t)}}function S(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof S){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof S))return new S(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===j?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return m(t,e)},t.major=function(e,t){return new h(e,t).major},t.minor=function(e,t){return new h(e,t).minor},t.patch=function(e,t){return new h(e,t).patch},t.compare=p,t.compareLoose=function(e,t){return p(e,t,!0)},t.compareBuild=function(e,t,n){var r=new h(e,n),o=new h(t,n);return r.compare(o)||r.compareBuild(o)},t.rcompare=function(e,t,n){return p(t,e,n)},t.sort=function(e,n){return e.sort((function(e,r){return t.compareBuild(e,r,n)}))},t.rsort=function(e,n){return e.sort((function(e,r){return t.compareBuild(r,e,n)}))},t.gt=g,t.lt=b,t.eq=v,t.neq=y,t.gte=_,t.lte=w,t.cmp=k,t.Comparator=S;var j={};function C(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof C)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new C(e.raw,t);if(e instanceof S)return new C(e.value,t);if(!(this instanceof C))return new C(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function x(e,t){for(var n=!0,r=e.slice(),o=r.pop();n&&r.length;)n=r.every((function(e){return o.intersects(e,t)})),o=r.pop();return n}function O(e){return!e||"x"===e.toLowerCase()||"*"===e}function E(e,t,n,r,o,s,i,a,u,c,d,l,h){return((t=O(n)?"":O(r)?">="+n+".0.0":O(o)?">="+n+"."+r+".0":">="+t)+" "+(a=O(u)?"":O(c)?"<"+(+u+1)+".0.0":O(d)?"<"+u+"."+(+c+1)+".0":l?"<="+u+"."+c+"."+d+"-"+l:"<="+a)).trim()}function I(e,t,n){for(var o=0;o<e.length;o++)if(!e[o].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(o=0;o<e.length;o++)if(r(e[o].semver),e[o].semver!==j&&e[o].semver.prerelease.length>0){var s=e[o].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}function A(e,t,n){try{t=new C(t,n)}catch(e){return!1}return t.test(e)}function N(e,t,n,r){var o,s,i,a,u;switch(e=new h(e,r),t=new C(t,r),n){case">":o=g,s=w,i=b,a=">",u=">=";break;case"<":o=b,s=_,i=g,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(A(e,t,r))return!1;for(var c=0;c<t.set.length;++c){var d=t.set[c],l=null,f=null;if(d.forEach((function(e){e.semver===j&&(e=new S(">=0.0.0")),l=l||e,f=f||e,o(e.semver,l.semver,r)?l=e:i(e.semver,f.semver,r)&&(f=e)})),l.operator===a||l.operator===u)return!1;if((!f.operator||f.operator===a)&&s(e,f.semver))return!1;if(f.operator===u&&i(e,f.semver))return!1}return!0}S.prototype.parse=function(e){var t=this.options.loose?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new h(n[2],this.options.loose):this.semver=j},S.prototype.toString=function(){return this.value},S.prototype.test=function(e){if(r("Comparator.test",e,this.options.loose),this.semver===j||e===j)return!0;if("string"==typeof e)try{e=new h(e,this.options)}catch(e){return!1}return k(e,this.operator,this.semver,this.options)},S.prototype.intersects=function(e,t){if(!(e instanceof S))throw new TypeError("a Comparator is required");var n;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(n=new C(e.value,t),A(this.value,n,t));if(""===e.operator)return""===e.value||(n=new C(this.value,t),A(e.semver,n,t));var r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,i=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=k(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),u=k(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||o||s&&i||a||u},t.Range=C,C.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},C.prototype.toString=function(){return this.range},C.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?s[a.HYPHENRANGELOOSE]:s[a.HYPHENRANGE];e=e.replace(n,E),r("hyphen replace",e),e=e.replace(s[a.COMPARATORTRIM],"$1$2$3"),r("comparator trim",e,s[a.COMPARATORTRIM]),e=(e=(e=e.replace(s[a.TILDETRIM],"$1~")).replace(s[a.CARETTRIM],"$1^")).split(/\s+/).join(" ");var o=t?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],i=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?s[a.CARETLOOSE]:s[a.CARET];return e.replace(n,(function(t,n,o,s,i){var a;return r("caret",e,t,n,o,s,i),O(n)?a="":O(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":O(s)?a="0"===n?">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":">="+n+"."+o+".0 <"+(+n+1)+".0.0":i?(r("replaceCaret pr",i),a="0"===n?"0"===o?">="+n+"."+o+"."+s+"-"+i+" <"+n+"."+o+"."+(+s+1):">="+n+"."+o+"."+s+"-"+i+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+s+"-"+i+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===o?">="+n+"."+o+"."+s+" <"+n+"."+o+"."+(+s+1):">="+n+"."+o+"."+s+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+s+" <"+(+n+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?s[a.TILDELOOSE]:s[a.TILDE];return e.replace(n,(function(t,n,o,s,i){var a;return r("tilde",e,t,n,o,s,i),O(n)?a="":O(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":O(s)?a=">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":i?(r("replaceTilde pr",i),a=">="+n+"."+o+"."+s+"-"+i+" <"+n+"."+(+o+1)+".0"):a=">="+n+"."+o+"."+s+" <"+n+"."+(+o+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?s[a.XRANGELOOSE]:s[a.XRANGE];return e.replace(n,(function(n,o,s,i,a,u){r("xRange",e,n,o,s,i,a,u);var c=O(s),d=c||O(i),l=d||O(a),h=l;return"="===o&&h&&(o=""),u=t.includePrerelease?"-0":"",c?n=">"===o||"<"===o?"<0.0.0-0":"*":o&&h?(d&&(i=0),a=0,">"===o?(o=">=",d?(s=+s+1,i=0,a=0):(i=+i+1,a=0)):"<="===o&&(o="<",d?s=+s+1:i=+i+1),n=o+s+"."+i+"."+a+u):d?n=">="+s+".0.0"+u+" <"+(+s+1)+".0.0"+u:l&&(n=">="+s+"."+i+".0"+u+" <"+s+"."+(+i+1)+".0"+u),r("xRange return",n),n}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(s[a.STAR],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter((function(e){return!!e.match(o)}))),i.map((function(e){return new S(e,this.options)}),this)},C.prototype.intersects=function(e,t){if(!(e instanceof C))throw new TypeError("a Range is required");return this.set.some((function(n){return x(n,t)&&e.set.some((function(e){return x(e,t)&&n.every((function(n){return e.every((function(e){return n.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new C(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},C.prototype.test=function(e){if(!e)return!1;if("string"==typeof e)try{e=new h(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(I(this.set[t],e,this.options))return!0;return!1},t.satisfies=A,t.maxSatisfying=function(e,t,n){var r=null,o=null;try{var s=new C(t,n)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(r&&-1!==o.compare(e)||(o=new h(r=e,n)))})),r},t.minSatisfying=function(e,t,n){var r=null,o=null;try{var s=new C(t,n)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(r&&1!==o.compare(e)||(o=new h(r=e,n)))})),r},t.minVersion=function(e,t){e=new C(e,t);var n=new h("0.0.0");if(e.test(n))return n;if(n=new h("0.0.0-0"),e.test(n))return n;n=null;for(var r=0;r<e.set.length;++r)e.set[r].forEach((function(e){var t=new h(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!g(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}));return n&&e.test(n)?n:null},t.validRange=function(e,t){try{return new C(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,n){return N(e,t,"<",n)},t.gtr=function(e,t,n){return N(e,t,">",n)},t.outside=N,t.prerelease=function(e,t){var n=l(e,t);return n&&n.prerelease.length?n.prerelease:null},t.intersects=function(e,t,n){return e=new C(e,n),t=new C(t,n),e.intersects(t)},t.coerce=function(e,t){if(e instanceof h)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;var n=null;if((t=t||{}).rtl){for(var r;(r=s[a.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&r.index+r[0].length===n.index+n[0].length||(n=r),s[a.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;s[a.COERCERTL].lastIndex=-1}else n=e.match(s[a.COERCE]);return null===n?null:l(n[2]+"."+(n[3]||"0")+"."+(n[4]||"0"),t)}}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/debug.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0;const o=r(n("../notebook-dds/node_modules/debug/src/browser.js")),s=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/packageVersion.js");t.debug=o.default("fluid:memory-orderer"),t.debug(`Package: ${s.pkgName} - Version: ${s.pkgVersion}`)},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/interfaces.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localContext.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localKafka.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localLambdaController.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localNodeFactory.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localOrderer.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localOrderManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/nodeManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/pubsub.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/reservationManager.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/interfaces.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localContext.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalContext=void 0,t.LocalContext=class{constructor(e){this.log=e}checkpoint(e){}error(e,t){}}},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localKafka.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalKafka=void 0;const o=r(n("../notebook-dds/node_modules/double-ended-queue/js/deque.js")),s=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localKafkaSubscription.js");t.LocalKafka=class{constructor(e=0){this.messageOffset=e,this.subscriptions=[],this.qeueue=new o.default,this.minimumQueueOffset=0}subscribe(e){const t=new s.LocalKafkaSubscription(e,this.qeueue);t.on("processed",e=>{if(this.minimumQueueOffset>=e)return;for(const t of this.subscriptions)if(t.queueOffset<e)return;const t=e-this.minimumQueueOffset;this.minimumQueueOffset=e;for(let e=0;e<t;e++)this.qeueue.shift();for(const e of this.subscriptions)e.queueOffset-=t}),this.subscriptions.push(t)}async send(e,t){for(const n of e){const e={offset:this.messageOffset,partition:0,topic:t,value:JSON.stringify(n)};this.messageOffset++,this.qeueue.push(e)}for(const e of this.subscriptions)e.process()}async close(){this.qeueue.clear();for(const e of this.subscriptions)e.close();this.subscriptions.length=0}on(e,t){return this}once(e,t){return this}}},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localKafkaSubscription.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalKafkaSubscription=void 0;const r=n("./node_modules/events/events.js");class o extends r.EventEmitter{constructor(e,t){super(),this.subscriber=e,this.queue=t,this.queueOffset=0,this.closed=!1,this.processing=!1}close(){this.closed=!0,this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=void 0),this.removeAllListeners()}process(){if(this.queue.length<=this.queueOffset||this.processing||void 0!==this.retryTimer||this.closed)return;const e=this.queue.get(this.queueOffset);try{this.processing=!0,this.subscriber.process(e),this.queueOffset++,this.emit("processed",this.queueOffset)}catch(e){return this.subscriber.context.error(e,{restart:!1}),void(this.retryTimer=setTimeout(()=>{this.retryTimer=void 0,this.process()},500))}finally{this.processing=!1}this.process()}}t.LocalKafkaSubscription=o},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localLambdaController.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalLambdaController=void 0;const r=n("./node_modules/events/events.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js");class s extends r.EventEmitter{constructor(e,t,n,r){super(),this.kafaka=e,this.setup=t,this.context=n,this.starter=r,this._state="created",this.kafaka.subscribe(this)}get state(){return this._state}async start(){if("closed"!==this._state)try{this.lambda=await this.starter(this.setup,this.context),"created"===this._state&&(this._state="started"),this.emit("started",this.lambda),"closed"===this._state&&this.close()}catch(e){this.context.error(e,{restart:!0}),this.startTimer=setTimeout(()=>{this.start()},5e3)}}close(){this._state="closed",this.lambda&&(this.lambda.close(o.LambdaCloseType.Stop),this.lambda=void 0),void 0!==this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=void 0),this.removeAllListeners()}process(e){if(!this.lambda)throw new Error("The lambda has not started yet");this.lambda.handler(e)}}t.LocalLambdaController=s},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localNode.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalNode=void 0;const a=i(n("./node_modules/assert/assert.js")),u=n("./node_modules/events/events.js"),c=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js"),d=s(n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/node_modules/lodash/lodash.js")),l=s(n("../notebook-dds/node_modules/@fluidframework/server-services-client/dist/generateNames.js")),h=n("../notebook-dds/node_modules/uuid/dist/esm-browser/index.js"),f=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/debug.js"),m=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localOrderer.js"),p=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/socket.js");class g{constructor(e){this.socket=e,this.id=h.v4()}send(e,t,...n){const r={cid:-1,payload:{data:n,op:t,topic:e},type:"op"};this.socket.send(r)}}class b extends u.EventEmitter{constructor(e,t,n,r,o,s,i,u,d,h,m){super(),this.webSocketServerFactory=e,this.node=t,this.storage=n,this.databaseManager=r,this.timeoutLength=o,this.taskMessageSender=s,this.tenantManager=i,this.permission=u,this.maxMessageSize=d,this.tokenGenerator=h,this.logger=m,this.orderMap=new Map,this.connectionMap=new Map,this.scheduleHeartbeat(),this.webSocketServer=this.webSocketServerFactory(),this.webSocketServer.on("connection",(e,t)=>{f.debug("New inbound web socket connection "+t.url);const n=new p.Socket(e),r=new g(n);n.on("message",e=>{switch(e.type){case"connect":{const t=e.payload,o=`${t.tenantId}/${t.documentId}`,s=this.orderMap.get(o);a.default(s);const i=s.connectInternal(r,l.choose(),t.client);i.connect(),this.connectionMap.set(e.cid,i);const u={clientId:i.clientId,existing:i.existing,maxMessageSize:this.maxMessageSize,parentBranch:null,serviceConfiguration:c.DefaultServiceConfiguration};n.send({cid:e.cid,type:"connected",payload:u});break}case"disconnect":{const t=this.connectionMap.get(e.cid);a.default(t),t.disconnect(),this.connectionMap.delete(e.cid);break}case"order":{const t=e.payload,n=this.connectionMap.get(e.cid);a.default(n),n.order([t]);break}}})}),this.webSocketServer.on("error",e=>{f.debug("wss error",e)})}static async connect(e,t,n,r,o,s,i,a,u,c,d,l){const h=await b.create(e,t,r,o);return new b(s,h,n,r,o,i,a,u,c,d,l)}static async create(e,t,n,r){f.debug("Creating node",e);const o=await n.getNodeCollection(),s={_id:e,address:t,expiration:Date.now()+r};return await o.insertOne(s),s}static async updateExpiration(e,t,n){const r=await t.getNodeCollection(),o=Date.now()+n;await r.update({_id:e._id,expiration:e.expiration},{expiration:o},null);const s=d.clone(e);return s.expiration=o,s}get id(){return this.node._id}get valid(){return!0}async connectOrderer(e,t){const n=`${e}/${t}`;f.debug(`${this.id} Becoming leader for ${n}`);const r=await m.LocalOrderer.load(this.storage,this.databaseManager,e,t,this.taskMessageSender,this.tenantManager,this.permission,this.tokenGenerator,this.logger);return a.default(!this.orderMap.has(n)),this.orderMap.set(n,r),r}scheduleHeartbeat(){if(Date.now()>this.node.expiration)f.debug(this.node._id+" did not renew before expiration"),this.emit("expired");else{const e=this.node.expiration-this.timeoutLength/2,t=Math.max(0,e-Date.now());setTimeout(()=>{b.updateExpiration(this.node,this.databaseManager,this.timeoutLength).then(e=>{this.node=e,this.scheduleHeartbeat()},e=>{f.debug("Failed to renew expiration for "+this.node._id,e),this.scheduleHeartbeat()})},t)}}}t.LocalNode=b},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localNodeFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalNodeFactory=void 0;const r=n("../notebook-dds/node_modules/uuid/dist/esm-browser/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localNode.js");t.LocalNodeFactory=class{constructor(e,t,n,r,o,s,i,a,u,c,d,l){this.hostname=e,this.address=t,this.storage=n,this.databaseManager=r,this.timeoutLength=o,this.webSocketServerFactory=s,this.taskMessageSender=i,this.tenantManager=a,this.permission=u,this.maxMessageSize=c,this.tokenGenerator=d,this.logger=l}async create(){return o.LocalNode.connect(`${this.hostname}-${r.v4()}`,this.address,this.storage,this.databaseManager,this.timeoutLength,this.webSocketServerFactory,this.taskMessageSender,this.tenantManager,this.permission,this.maxMessageSize,this.tokenGenerator,this.logger)}}},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localOrderManager.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalOrderManager=void 0;const o=r(n("./node_modules/assert/assert.js"));t.LocalOrderManager=class{constructor(e,t){this.nodeFactory=e,this.reservationManager=t,this.localOrderers=new Map,this.createLocalNode()}async get(e,t){const n=this.getKey(e,t);let r=this.localOrderers.get(n);return r||(r=this.getCore(e,t),this.localOrderers.set(n,r)),r}async remove(e,t){const n=this.getKey(e,t),r=this.localOrderers.get(n);if(r){this.localOrderers.delete(n);const e=await r;await e.close()}}async getCore(e,t){const n=await this.localNodeP,r=this.getKey(e,t),s=await this.reservationManager.getOrReserve(r,n);return o.default(s.valid),await s.connectOrderer(e,t)}createLocalNode(){this.localNodeP=this.nodeFactory.create(),this.localNodeP.then(e=>{e.on("error",e=>{})},e=>{})}getKey(e,t){return`${e}/${t}`}}},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localOrderer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalOrderer=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/node_modules/lodash/lodash.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/index.js"),i=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localContext.js"),u=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localKafka.js"),c=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localLambdaController.js"),d=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localOrdererConnection.js"),l=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localOrdererSetup.js"),h=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/pubsub.js"),f={lastClientSummaryHead:void 0,logOffset:-1,minimumSequenceNumber:-1,protocolState:void 0,sequenceNumber:-1},m={branchMap:void 0,clients:void 0,durableSequenceNumber:0,epoch:0,logOffset:-1,sequenceNumber:0,term:1};class p{constructor(e){this.publisher=e}on(e,t){}to(e){return{emit:(t,...n)=>this.publisher.publish(e,t,...n)}}async close(){}}class g{constructor(e,t,n,r,o,s,i,a,u,c,d,l,h,f,m,g){this.setup=e,this.details=t,this.tenantId=n,this.documentId=r,this.taskMessageSender=o,this.tenantManager=s,this.gitManager=i,this.permission=a,this.foremanTokenGenrator=u,this.pubSub=c,this.broadcasterContext=d,this.scriptoriumContext=l,this.foremanContext=h,this.scribeContext=f,this.deliContext=m,this.serviceConfiguration=g,this.existing=t.existing,this.dbObject=this.getDeliState(),this.socketPublisher=new p(this.pubSub),this.setupKafkas(),this.setupLambdas(),this.startLambdas()}static async load(e,t,n,o,s,u,c,d,f,m,p=new l.LocalOrdererSetup(n,o,e,t,m),b=new h.PubSub,v=new a.LocalContext(f),y=new a.LocalContext(f),_=new a.LocalContext(f),w=new a.LocalContext(f),k=new a.LocalContext(f),S={}){const j=await p.documentP();return new g(p,j,n,o,s,u,m,c,d,b,v,y,_,w,k,r.merge({},i.DefaultServiceConfiguration,S))}async connect(e,t,n){const r=new h.WebSocketSubscriber(e);return this.connectInternal(r,t,n)}connectInternal(e,t,n){const r=new d.LocalOrdererConnection(e,this.existing,this.details.value,this.rawDeltasKafka,this.tenantId,this.documentId,t,n,this.serviceConfiguration);return this.existing=!0,r}async close(){await this.closeKafkas(),this.closeLambdas()}hasPendingWork(){return!(!this.broadcasterLambda||!this.broadcasterLambda.lambda)&&this.broadcasterLambda.lambda.hasPendingWork()}setupKafkas(){const e=JSON.parse(this.dbObject.deli);this.rawDeltasKafka=new u.LocalKafka(e.logOffset+1),this.deltasKafka=new u.LocalKafka}setupLambdas(){this.scriptoriumLambda=new c.LocalLambdaController(this.deltasKafka,this.setup,this.scriptoriumContext,async(e,t)=>{const n=await e.deltaCollectionP();return new s.ScriptoriumLambda(n,t)}),this.broadcasterLambda=new c.LocalLambdaController(this.deltasKafka,this.setup,this.broadcasterContext,async(e,t)=>new s.BroadcasterLambda(this.socketPublisher,t)),this.foremanLambda=new c.LocalLambdaController(this.deltasKafka,this.setup,this.foremanContext,async(e,t)=>new s.ForemanLambda(this.taskMessageSender,this.tenantManager,this.foremanTokenGenrator,this.permission,t,this.tenantId,this.documentId)),this.gitManager&&(this.scribeLambda=new c.LocalLambdaController(this.deltasKafka,this.setup,this.scribeContext,(e,t)=>this.startScribeLambda(e,t))),this.deliLambda=new c.LocalLambdaController(this.rawDeltasKafka,this.setup,this.deliContext,async(e,t)=>{const n=await e.documentCollectionP(),r=JSON.parse(this.dbObject.deli),o=s.createDeliCheckpointManagerFromCollection(this.tenantId,this.documentId,n);return new s.DeliLambda(t,this.tenantId,this.documentId,r,o,this.deltasKafka,this.rawDeltasKafka,this.serviceConfiguration)})}async startScribeLambda(e,t){const[n,r,i,a]=await Promise.all([e.documentCollectionP(),e.scribeDeltaCollectionP(),e.protocolHeadP(),e.scribeMessagesP()]),u=this.getScribeState(),c=u.protocolState?u.protocolState:{members:[],proposals:[],values:[]},d=new o.ProtocolOpHandler(u.minimumSequenceNumber,u.sequenceNumber,1,c.members,c.proposals,c.values,()=>-1,()=>{}),l=new s.SummaryWriter(this.tenantId,this.documentId,this.gitManager,r),h=new s.SummaryReader(this.documentId,this.gitManager),f=new s.CheckpointManager(this.tenantId,this.documentId,n,r);return new s.ScribeLambda(t,this.tenantId,this.documentId,l,h,f,u,this.serviceConfiguration,this.rawDeltasKafka,d,1,i,a.map(e=>e.operation))}startLambdas(){this.deliLambda&&this.deliLambda.start(),this.scriptoriumLambda&&this.scriptoriumLambda.start(),this.foremanLambda&&this.foremanLambda.start(),this.scribeLambda&&this.scribeLambda.start(),this.broadcasterLambda&&this.broadcasterLambda.start()}async closeKafkas(){await Promise.all([this.rawDeltasKafka.close(),this.deltasKafka.close()])}closeLambdas(){this.deliLambda&&(this.deliLambda.close(),this.deliLambda=void 0),this.scriptoriumLambda&&(this.scriptoriumLambda.close(),this.scriptoriumLambda=void 0),this.foremanLambda&&(this.foremanLambda.close(),this.foremanLambda=void 0),this.scribeLambda&&(this.scribeLambda.close(),this.scribeLambda=void 0),this.broadcasterLambda&&(this.broadcasterLambda.close(),this.broadcasterLambda=void 0)}getDeliState(){const e=this.details.value;return void 0!==e.deli&&null!==e.deli||(e.deli=JSON.stringify(m)),e}getScribeState(){const e=this.details.value;return void 0===e.scribe||null===e.scribe?f:"string"==typeof this.details.value.scribe?JSON.parse(this.details.value.scribe):this.details.value.scribe}}t.LocalOrderer=g},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localOrdererConnection.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalOrdererConnection=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js");t.LocalOrdererConnection=class{constructor(e,t,n,r,o,s,i,a,u){this.socket=e,this.existing=t,this.producer=r,this.tenantId=o,this.documentId=s,this.clientId=i,this.client=a,this.serviceConfiguration=u,this.parentBranch=null,this.maxMessageSize=u.maxMessageSize}async connect(e){const t={clientId:this.clientId,detail:this.client},n={clientSequenceNumber:-1,contents:null,data:JSON.stringify(t),referenceSequenceNumber:-1,traces:this.serviceConfiguration.enableTraces?[]:void 0,type:o.MessageType.ClientJoin,serverMetadata:e},r={clientId:null,documentId:this.documentId,operation:n,tenantId:this.tenantId,timestamp:Date.now(),type:s.RawOperationType};this.submitRawOperation([r])}async order(e){const t=e.map(e=>({clientId:this.clientId,documentId:this.documentId,operation:e,tenantId:this.tenantId,timestamp:Date.now(),type:s.RawOperationType}));this.submitRawOperation(t)}async disconnect(){const e={clientSequenceNumber:-1,contents:null,data:JSON.stringify(this.clientId),referenceSequenceNumber:-1,traces:this.serviceConfiguration.enableTraces?[]:void 0,type:o.MessageType.ClientLeave},t={clientId:null,documentId:this.documentId,operation:e,tenantId:this.tenantId,timestamp:Date.now(),type:s.RawOperationType};this.submitRawOperation([t])}once(e,t){this.producer.once(e,t)}submitRawOperation(e){this.serviceConfiguration.enableTraces&&e.forEach(e=>{const t=e.operation;t&&t.traces&&t.traces.push({action:"start",service:"alfred",timestamp:r.performance.now()})});const t={contents:e,documentId:this.documentId,tenantId:this.tenantId,type:s.BoxcarType};this.producer.send([t],this.tenantId,this.documentId)}}},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/localOrdererSetup.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalOrdererSetup=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js");t.LocalOrdererSetup=class{constructor(e,t,n,r,o){this.tenantId=e,this.documentId=t,this.storage=n,this.databaseManager=r,this.gitManager=o}documentP(){return this.storage.getOrCreateDocument(this.tenantId,this.documentId)}documentCollectionP(){return this.databaseManager.getDocumentCollection()}deltaCollectionP(){return this.databaseManager.getDeltaCollection(this.tenantId,this.documentId)}scribeDeltaCollectionP(){return this.databaseManager.getScribeDeltaCollection(this.tenantId,this.documentId)}async protocolHeadP(){if(!this.gitManager)return 0;const e=await this.gitManager.getRef(encodeURIComponent(this.documentId));if(!e)return-1;const t=await this.gitManager.getContent(e.object.sha,".protocol/attributes");return JSON.parse(r.fromBase64ToUtf8(t.content)).sequenceNumber}async scribeMessagesP(){return(await this.scribeDeltaCollectionP()).find({documentId:this.documentId,tenantId:this.tenantId},{"operation.sequenceNumber":1})}}},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/nodeManager.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeManager=void 0;const o=r(n("./node_modules/assert/assert.js")),s=n("./node_modules/events/events.js"),i=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/remoteNode.js");class a extends s.EventEmitter{constructor(e,t){super(),this.mongoManager=e,this.nodeCollectionName=t,this.nodes=new Map,this.pendingNodes=new Map}registerLocal(e){o.default(!this.nodes.has(e.id)),o.default(!this.pendingNodes.has(e.id)),this.nodes.set(e.id,e)}loadRemote(e){if(this.nodes.has(e))return Promise.resolve(this.nodes.get(e));if(this.pendingNodes.has(e))return this.pendingNodes.get(e);const t=this.getNode(e);return this.pendingNodes.set(e,t),t}async getNode(e){const t=await i.RemoteNode.connect(e,this.mongoManager,this.nodeCollectionName);return this.nodes.set(e,t),t}}t.NodeManager=a},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/packageVersion.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pkgVersion=t.pkgName=void 0,t.pkgName="@fluidframework/server-memory-orderer",t.pkgVersion="0.1019.0"},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/proxyOrderer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyOrderer=void 0,t.ProxyOrderer=class{constructor(e){this.factory=e}async connect(e,t,n){return await this.factory.connect(e,n)}close(){return Promise.resolve()}}},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/pubsub.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PubSub=t.WebSocketSubscriber=void 0;const o=r(n("./node_modules/assert/assert.js"));t.WebSocketSubscriber=class{constructor(e){this.webSocket=e}get id(){return this.webSocket.id}send(e,t,...n){this.webSocket.emit(t,...n)}},t.PubSub=class{constructor(){this.topics=new Map}publish(e,t,...n){const r=this.topics.get(e);if(r)for(const[,o]of r)o.subscriber.send(e,t,...n)}subscribe(e,t){this.topics.has(e)||this.topics.set(e,new Map);const n=this.topics.get(e);n.has(t.id)||n.set(t.id,{subscriber:t,count:0}),n.get(t.id).count++}unsubscribe(e,t){o.default(this.topics.has(e));const n=this.topics.get(e);o.default(n.has(t.id));const r=n.get(t.id);r.count--,0===r.count&&n.delete(t.id),0===n.size&&this.topics.delete(e)}}},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/remoteNode.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteNode=void 0;const o=r(n("./node_modules/assert/assert.js")),s=n("./node_modules/events/events.js"),i=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),a=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/debug.js"),u=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/proxyOrderer.js"),c=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/socket.js");class d{constructor(e,t,n,r,o,s){this.tenantId=e,this.documentId=t,this.socket=n,this.node=r,this.cid=o,this.details=s}get clientId(){return this.details.clientId}get existing(){return this.details.existing}get parentBranch(){return null}get maxMessageSize(){return this.details.maxMessageSize}get serviceConfiguration(){return this.details.serviceConfiguration}async connect(){}async order(e){this.node.send(this.cid,"order",e)}async disconnect(){this.node.send(this.cid,"disconnect",null)}emit(e,t,...n){this.socket.emit(e,t,...n)}once(e,t){}}class l{constructor(e,t,n){this.node=e,this.tenantId=t,this.documentId=n}async connect(e,t){return this.node.connect(e,this.tenantId,this.documentId,t)}}class h extends s.EventEmitter{constructor(e,t){super(),this._id=e,this.socket=t,this.connectMap=new Map,this.orderers=new Map,this.topicMap=new Map,this.cid=0,this.socket.on("message",e=>{switch(e.type){case"op":this.route(e.payload);break;case"connected":const t=this.connectMap.get(e.cid);o.default(t),this.connectMap.delete(e.cid);const n=new d(t.tenantId,t.documentId,t.socket,this,e.cid,e.payload);this.topicMap.set("client#"+n.clientId,[n]);const r=`${t.tenantId}/${t.documentId}`;this.topicMap.has(r)||this.topicMap.set(r,[]),this.topicMap.get(r).push(n),t.deferred.resolve(n)}})}static async connect(e,t,n){const r=(await t.getDatabase()).collection(n),o=await r.findOne({_id:e}),s=o.expiration>=Date.now()?await c.Socket.connect(o.address,e):null;return new h(e,s)}get id(){return this._id}get valid(){return null!==this.socket}async connectOrderer(e,t){const n=`${e}/${t}`;o.default(!this.orderers.has(n)),a.debug(`Connecting to ${n}:${this.id}`);const r=new u.ProxyOrderer(new l(this,e,t));return this.orderers.set(n,r),r}send(e,t,n){this.socket.send({cid:e,payload:n,type:t})}async connect(e,t,n,r){const o=this.getNextCid(),s={client:r,documentId:n,tenantId:t},a=new i.Deferred;return this.connectMap.set(o,{socket:e,deferred:a,tenantId:t,documentId:n}),this.send(o,"connect",s),a.promise}route(e){const t=this.topicMap.get(e.topic);for(const n of t)n.emit(e.op,e.data[0],...e.data.slice(1))}getNextCid(){return this.cid++}}t.RemoteNode=h},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/reservationManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReservationManager=void 0;const r=n("./node_modules/events/events.js");class o extends r.EventEmitter{constructor(e,t,n){super(),this.nodeTracker=e,this.mongoManager=t,this.reservationColletionName=n}async getOrReserve(e,t){const n=await this.getReservationsCollection(),r=await n.findOne({_id:e});if(null===r)return await this.makeReservation(t,e,null,n),t;{const o=await this.nodeTracker.loadRemote(r.node);return o.valid?o:(await this.makeReservation(t,e,r,n),t)}}async makeReservation(e,t,n,r){const o={_id:t,node:e.id};n?await r.update({_id:t,node:n.node},o,null):await r.insertOne(o)}async getReservationsCollection(){return(await this.mongoManager.getDatabase()).collection(this.reservationColletionName)}}t.ReservationManager=o},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/socket.js":function(e,t,n){"use strict";(function(e){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0;const o=n("./node_modules/events/events.js"),s=r(n("../notebook-dds/node_modules/ws/browser.js")),i=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/debug.js");class a extends o.EventEmitter{constructor(e){super(),this.socket=e,this.pending=[],this.sendScheduled=!1,this.socket.on("error",t=>{i.debug("ws error on connection to "+e.url,t),this.emit("error",t)}),this.socket.on("close",(t,n)=>{i.debug(`ws to ${e.url} close ${t} ${n}`),this.emit("close",t,n)}),this.socket.on("message",e=>{const t=JSON.parse(e);for(const e of t)this.emit("message",e)})}static async connect(e,t){const n=new s.default(`ws://${e}/${t}`);return await new Promise((e,t)=>{const r=e=>t(e);n.on("error",r),n.on("open",()=>{n.removeListener("error",r),e()})}),new a(n)}send(t){this.pending.push(t),this.sendScheduled||(this.sendScheduled=!0,e(()=>{i.debug(`Sending ${this.pending.length} messages`),this.sendBuffers(this.pending),this.pending=[],this.sendScheduled=!1}))}on(e,t){return super.on(e,t),this}sendBuffers(e){this.socket.send(JSON.stringify(e))}}t.Socket=a}).call(this,n("./node_modules/timers-browserify/main.js").setImmediate)},"../notebook-dds/node_modules/@fluidframework/server-memory-orderer/node_modules/lodash/lodash.js":function(e,t,n){(function(e,r){var o;(function(){var s,i="Expected a function",a="__lodash_hash_undefined__",u="__lodash_placeholder__",c=32,d=128,l=1/0,h=9007199254740991,f=NaN,m=4294967295,p=[["ary",d],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",c],["partialRight",64],["rearg",256]],g="[object Arguments]",b="[object Array]",v="[object Boolean]",y="[object Date]",_="[object Error]",w="[object Function]",k="[object GeneratorFunction]",S="[object Map]",j="[object Number]",C="[object Object]",x="[object Promise]",O="[object RegExp]",E="[object Set]",I="[object String]",A="[object Symbol]",N="[object WeakMap]",T="[object ArrayBuffer]",F="[object DataView]",P="[object Float32Array]",R="[object Float64Array]",D="[object Int8Array]",M="[object Int16Array]",L="[object Int32Array]",B="[object Uint8Array]",q="[object Uint8ClampedArray]",z="[object Uint16Array]",H="[object Uint32Array]",U=/\b__p \+= '';/g,V=/\b(__p \+=) '' \+/g,$=/(__e\(.*?\)|\b__t\)) \+\n'';/g,W=/&(?:amp|lt|gt|quot|#39);/g,K=/[&<>"']/g,G=RegExp(W.source),J=RegExp(K.source),Z=/<%-([\s\S]+?)%>/g,X=/<%([\s\S]+?)%>/g,Y=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ee=/^\w*$/,te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ne=/[\\^$.*+?()[\]{}|]/g,re=RegExp(ne.source),oe=/^\s+|\s+$/g,se=/^\s+/,ie=/\s+$/,ae=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ue=/\{\n\/\* \[wrapped with (.+)\] \*/,ce=/,? & /,de=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,le=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,me=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,be=/^0o[0-7]+$/i,ve=/^(?:0|[1-9]\d*)$/,ye=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_e=/($^)/,we=/['\n\r\u2028\u2029\\]/g,ke="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Se="a-z\\xdf-\\xf6\\xf8-\\xff",je="A-Z\\xc0-\\xd6\\xd8-\\xde",Ce="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",xe="["+Ce+"]",Oe="["+ke+"]",Ee="\\d+",Ie="["+Se+"]",Ae="[^\\ud800-\\udfff"+Ce+Ee+"\\u2700-\\u27bf"+Se+je+"]",Ne="\\ud83c[\\udffb-\\udfff]",Te="[^\\ud800-\\udfff]",Fe="(?:\\ud83c[\\udde6-\\uddff]){2}",Pe="[\\ud800-\\udbff][\\udc00-\\udfff]",Re="["+je+"]",De="(?:"+Ie+"|"+Ae+")",Me="(?:"+Re+"|"+Ae+")",Le="(?:['](?:d|ll|m|re|s|t|ve))?",Be="(?:['](?:D|LL|M|RE|S|T|VE))?",qe="(?:"+Oe+"|"+Ne+")?",ze="[\\ufe0e\\ufe0f]?",He=ze+qe+"(?:\\u200d(?:"+[Te,Fe,Pe].join("|")+")"+ze+qe+")*",Ue="(?:"+["[\\u2700-\\u27bf]",Fe,Pe].join("|")+")"+He,Ve="(?:"+[Te+Oe+"?",Oe,Fe,Pe,"[\\ud800-\\udfff]"].join("|")+")",$e=RegExp("[']","g"),We=RegExp(Oe,"g"),Ke=RegExp(Ne+"(?="+Ne+")|"+Ve+He,"g"),Ge=RegExp([Re+"?"+Ie+"+"+Le+"(?="+[xe,Re,"$"].join("|")+")",Me+"+"+Be+"(?="+[xe,Re+De,"$"].join("|")+")",Re+"?"+De+"+"+Le,Re+"+"+Be,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ee,Ue].join("|"),"g"),Je=RegExp("[\\u200d\\ud800-\\udfff"+ke+"\\ufe0e\\ufe0f]"),Ze=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ye=-1,Qe={};Qe[P]=Qe[R]=Qe[D]=Qe[M]=Qe[L]=Qe[B]=Qe[q]=Qe[z]=Qe[H]=!0,Qe[g]=Qe[b]=Qe[T]=Qe[v]=Qe[F]=Qe[y]=Qe[_]=Qe[w]=Qe[S]=Qe[j]=Qe[C]=Qe[O]=Qe[E]=Qe[I]=Qe[N]=!1;var et={};et[g]=et[b]=et[T]=et[F]=et[v]=et[y]=et[P]=et[R]=et[D]=et[M]=et[L]=et[S]=et[j]=et[C]=et[O]=et[E]=et[I]=et[A]=et[B]=et[q]=et[z]=et[H]=!0,et[_]=et[w]=et[N]=!1;var tt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},nt=parseFloat,rt=parseInt,ot="object"==typeof e&&e&&e.Object===Object&&e,st="object"==typeof self&&self&&self.Object===Object&&self,it=ot||st||Function("return this")(),at=t&&!t.nodeType&&t,ut=at&&"object"==typeof r&&r&&!r.nodeType&&r,ct=ut&&ut.exports===at,dt=ct&&ot.process,lt=function(){try{return ut&&ut.require&&ut.require("util").types||dt&&dt.binding&&dt.binding("util")}catch(e){}}(),ht=lt&&lt.isArrayBuffer,ft=lt&&lt.isDate,mt=lt&&lt.isMap,pt=lt&&lt.isRegExp,gt=lt&&lt.isSet,bt=lt&&lt.isTypedArray;function vt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function yt(e,t,n,r){for(var o=-1,s=null==e?0:e.length;++o<s;){var i=e[o];t(r,i,n(i),e)}return r}function _t(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function wt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function kt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function St(e,t){for(var n=-1,r=null==e?0:e.length,o=0,s=[];++n<r;){var i=e[n];t(i,n,e)&&(s[o++]=i)}return s}function jt(e,t){return!(null==e||!e.length)&&Pt(e,t,0)>-1}function Ct(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}function xt(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}function Ot(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function Et(e,t,n,r){var o=-1,s=null==e?0:e.length;for(r&&s&&(n=e[++o]);++o<s;)n=t(n,e[o],o,e);return n}function It(e,t,n,r){var o=null==e?0:e.length;for(r&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}function At(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Nt=Lt("length");function Tt(e,t,n){var r;return n(e,(function(e,n,o){if(t(e,n,o))return r=n,!1})),r}function Ft(e,t,n,r){for(var o=e.length,s=n+(r?1:-1);r?s--:++s<o;)if(t(e[s],s,e))return s;return-1}function Pt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t,n):Ft(e,Dt,n)}function Rt(e,t,n,r){for(var o=n-1,s=e.length;++o<s;)if(r(e[o],t))return o;return-1}function Dt(e){return e!=e}function Mt(e,t){var n=null==e?0:e.length;return n?zt(e,t)/n:f}function Lt(e){return function(t){return null==t?s:t[e]}}function Bt(e){return function(t){return null==e?s:e[t]}}function qt(e,t,n,r,o){return o(e,(function(e,o,s){n=r?(r=!1,e):t(n,e,o,s)})),n}function zt(e,t){for(var n,r=-1,o=e.length;++r<o;){var i=t(e[r]);i!==s&&(n=n===s?i:n+i)}return n}function Ht(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Ut(e){return function(t){return e(t)}}function Vt(e,t){return xt(t,(function(t){return e[t]}))}function $t(e,t){return e.has(t)}function Wt(e,t){for(var n=-1,r=e.length;++n<r&&Pt(t,e[n],0)>-1;);return n}function Kt(e,t){for(var n=e.length;n--&&Pt(t,e[n],0)>-1;);return n}function Gt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Jt=Bt({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),Zt=Bt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Xt(e){return"\\"+tt[e]}function Yt(e){return Je.test(e)}function Qt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function en(e,t){return function(n){return e(t(n))}}function tn(e,t){for(var n=-1,r=e.length,o=0,s=[];++n<r;){var i=e[n];i!==t&&i!==u||(e[n]=u,s[o++]=n)}return s}function nn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function rn(e){return Yt(e)?function(e){for(var t=Ke.lastIndex=0;Ke.test(e);)++t;return t}(e):Nt(e)}function on(e){return Yt(e)?function(e){return e.match(Ke)||[]}(e):function(e){return e.split("")}(e)}var sn=Bt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),an=function e(t){var n=(t=null==t?it:an.defaults(it.Object(),t,an.pick(it,Xe))).Array,r=t.Date,o=t.Error,ke=t.Function,Se=t.Math,je=t.Object,Ce=t.RegExp,xe=t.String,Oe=t.TypeError,Ee=n.prototype,Ie=ke.prototype,Ae=je.prototype,Ne=t["__core-js_shared__"],Te=Ie.toString,Fe=Ae.hasOwnProperty,Pe=0,Re=function(){var e=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),De=Ae.toString,Me=Te.call(je),Le=it._,Be=Ce("^"+Te.call(Fe).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=ct?t.Buffer:s,ze=t.Symbol,He=t.Uint8Array,Ue=qe?qe.allocUnsafe:s,Ve=en(je.getPrototypeOf,je),Ke=je.create,Je=Ae.propertyIsEnumerable,tt=Ee.splice,ot=ze?ze.isConcatSpreadable:s,st=ze?ze.iterator:s,at=ze?ze.toStringTag:s,ut=function(){try{var e=as(je,"defineProperty");return e({},"",{}),e}catch(e){}}(),dt=t.clearTimeout!==it.clearTimeout&&t.clearTimeout,lt=r&&r.now!==it.Date.now&&r.now,Nt=t.setTimeout!==it.setTimeout&&t.setTimeout,Bt=Se.ceil,un=Se.floor,cn=je.getOwnPropertySymbols,dn=qe?qe.isBuffer:s,ln=t.isFinite,hn=Ee.join,fn=en(je.keys,je),mn=Se.max,pn=Se.min,gn=r.now,bn=t.parseInt,vn=Se.random,yn=Ee.reverse,_n=as(t,"DataView"),wn=as(t,"Map"),kn=as(t,"Promise"),Sn=as(t,"Set"),jn=as(t,"WeakMap"),Cn=as(je,"create"),xn=jn&&new jn,On={},En=Ps(_n),In=Ps(wn),An=Ps(kn),Nn=Ps(Sn),Tn=Ps(jn),Fn=ze?ze.prototype:s,Pn=Fn?Fn.valueOf:s,Rn=Fn?Fn.toString:s;function Dn(e){if(Xi(e)&&!qi(e)&&!(e instanceof qn)){if(e instanceof Bn)return e;if(Fe.call(e,"__wrapped__"))return Rs(e)}return new Bn(e)}var Mn=function(){function e(){}return function(t){if(!Zi(t))return{};if(Ke)return Ke(t);e.prototype=t;var n=new e;return e.prototype=s,n}}();function Ln(){}function Bn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=s}function qn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=m,this.__views__=[]}function zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Un(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Un;++t<n;)this.add(e[t])}function $n(e){var t=this.__data__=new Hn(e);this.size=t.size}function Wn(e,t){var n=qi(e),r=!n&&Bi(e),o=!n&&!r&&Vi(e),s=!n&&!r&&!o&&sa(e),i=n||r||o||s,a=i?Ht(e.length,xe):[],u=a.length;for(var c in e)!t&&!Fe.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ms(c,u))||a.push(c);return a}function Kn(e){var t=e.length;return t?e[Ur(0,t-1)]:s}function Gn(e,t){return Ns(Co(e),rr(t,0,e.length))}function Jn(e){return Ns(Co(e))}function Zn(e,t,n){(n!==s&&!Di(e[t],n)||n===s&&!(t in e))&&tr(e,t,n)}function Xn(e,t,n){var r=e[t];Fe.call(e,t)&&Di(r,n)&&(n!==s||t in e)||tr(e,t,n)}function Yn(e,t){for(var n=e.length;n--;)if(Di(e[n][0],t))return n;return-1}function Qn(e,t,n,r){return ur(e,(function(e,o,s){t(r,e,n(e),s)})),r}function er(e,t){return e&&xo(t,Oa(t),e)}function tr(e,t,n){"__proto__"==t&&ut?ut(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function nr(e,t){for(var r=-1,o=t.length,i=n(o),a=null==e;++r<o;)i[r]=a?s:ka(e,t[r]);return i}function rr(e,t,n){return e==e&&(n!==s&&(e=e<=n?e:n),t!==s&&(e=e>=t?e:t)),e}function or(e,t,n,r,o,i){var a,u=1&t,c=2&t,d=4&t;if(n&&(a=o?n(e,r,o,i):n(e)),a!==s)return a;if(!Zi(e))return e;var l=qi(e);if(l){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Fe.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!u)return Co(e,a)}else{var h=ds(e),f=h==w||h==k;if(Vi(e))return yo(e,u);if(h==C||h==g||f&&!o){if(a=c||f?{}:hs(e),!u)return c?function(e,t){return xo(e,cs(e),t)}(e,function(e,t){return e&&xo(t,Ea(t),e)}(a,e)):function(e,t){return xo(e,us(e),t)}(e,er(a,e))}else{if(!et[h])return o?e:{};a=function(e,t,n){var r,o=e.constructor;switch(t){case T:return _o(e);case v:case y:return new o(+e);case F:return function(e,t){var n=t?_o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case P:case R:case D:case M:case L:case B:case q:case z:case H:return wo(e,n);case S:return new o;case j:case I:return new o(e);case O:return function(e){var t=new e.constructor(e.source,fe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case E:return new o;case A:return r=e,Pn?je(Pn.call(r)):{}}}(e,h,u)}}i||(i=new $n);var m=i.get(e);if(m)return m;i.set(e,a),na(e)?e.forEach((function(r){a.add(or(r,t,n,r,e,i))})):Yi(e)&&e.forEach((function(r,o){a.set(o,or(r,t,n,o,e,i))}));var p=l?s:(d?c?es:Qo:c?Ea:Oa)(e);return _t(p||e,(function(r,o){p&&(r=e[o=r]),Xn(a,o,or(r,t,n,o,e,i))})),a}function sr(e,t,n){var r=n.length;if(null==e)return!r;for(e=je(e);r--;){var o=n[r],i=t[o],a=e[o];if(a===s&&!(o in e)||!i(a))return!1}return!0}function ir(e,t,n){if("function"!=typeof e)throw new Oe(i);return Os((function(){e.apply(s,n)}),t)}function ar(e,t,n,r){var o=-1,s=jt,i=!0,a=e.length,u=[],c=t.length;if(!a)return u;n&&(t=xt(t,Ut(n))),r?(s=Ct,i=!1):t.length>=200&&(s=$t,i=!1,t=new Vn(t));e:for(;++o<a;){var d=e[o],l=null==n?d:n(d);if(d=r||0!==d?d:0,i&&l==l){for(var h=c;h--;)if(t[h]===l)continue e;u.push(d)}else s(t,l,r)||u.push(d)}return u}Dn.templateSettings={escape:Z,evaluate:X,interpolate:Y,variable:"",imports:{_:Dn}},Dn.prototype=Ln.prototype,Dn.prototype.constructor=Dn,Bn.prototype=Mn(Ln.prototype),Bn.prototype.constructor=Bn,qn.prototype=Mn(Ln.prototype),qn.prototype.constructor=qn,zn.prototype.clear=function(){this.__data__=Cn?Cn(null):{},this.size=0},zn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},zn.prototype.get=function(e){var t=this.__data__;if(Cn){var n=t[e];return n===a?s:n}return Fe.call(t,e)?t[e]:s},zn.prototype.has=function(e){var t=this.__data__;return Cn?t[e]!==s:Fe.call(t,e)},zn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Cn&&t===s?a:t,this},Hn.prototype.clear=function(){this.__data__=[],this.size=0},Hn.prototype.delete=function(e){var t=this.__data__,n=Yn(t,e);return!(n<0||(n==t.length-1?t.pop():tt.call(t,n,1),--this.size,0))},Hn.prototype.get=function(e){var t=this.__data__,n=Yn(t,e);return n<0?s:t[n][1]},Hn.prototype.has=function(e){return Yn(this.__data__,e)>-1},Hn.prototype.set=function(e,t){var n=this.__data__,r=Yn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Un.prototype.clear=function(){this.size=0,this.__data__={hash:new zn,map:new(wn||Hn),string:new zn}},Un.prototype.delete=function(e){var t=ss(this,e).delete(e);return this.size-=t?1:0,t},Un.prototype.get=function(e){return ss(this,e).get(e)},Un.prototype.has=function(e){return ss(this,e).has(e)},Un.prototype.set=function(e,t){var n=ss(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Vn.prototype.add=Vn.prototype.push=function(e){return this.__data__.set(e,a),this},Vn.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.clear=function(){this.__data__=new Hn,this.size=0},$n.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},$n.prototype.get=function(e){return this.__data__.get(e)},$n.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Hn){var r=n.__data__;if(!wn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Un(r)}return n.set(e,t),this.size=n.size,this};var ur=Io(gr),cr=Io(br,!0);function dr(e,t){var n=!0;return ur(e,(function(e,r,o){return n=!!t(e,r,o)})),n}function lr(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(null!=a&&(u===s?a==a&&!oa(a):n(a,u)))var u=a,c=i}return c}function hr(e,t){var n=[];return ur(e,(function(e,r,o){t(e,r,o)&&n.push(e)})),n}function fr(e,t,n,r,o){var s=-1,i=e.length;for(n||(n=fs),o||(o=[]);++s<i;){var a=e[s];t>0&&n(a)?t>1?fr(a,t-1,n,r,o):Ot(o,a):r||(o[o.length]=a)}return o}var mr=Ao(),pr=Ao(!0);function gr(e,t){return e&&mr(e,t,Oa)}function br(e,t){return e&&pr(e,t,Oa)}function vr(e,t){return St(t,(function(t){return Ki(e[t])}))}function yr(e,t){for(var n=0,r=(t=po(t,e)).length;null!=e&&n<r;)e=e[Fs(t[n++])];return n&&n==r?e:s}function _r(e,t,n){var r=t(e);return qi(e)?r:Ot(r,n(e))}function wr(e){return null==e?e===s?"[object Undefined]":"[object Null]":at&&at in je(e)?function(e){var t=Fe.call(e,at),n=e[at];try{e[at]=s;var r=!0}catch(e){}var o=De.call(e);return r&&(t?e[at]=n:delete e[at]),o}(e):function(e){return De.call(e)}(e)}function kr(e,t){return e>t}function Sr(e,t){return null!=e&&Fe.call(e,t)}function jr(e,t){return null!=e&&t in je(e)}function Cr(e,t,r){for(var o=r?Ct:jt,i=e[0].length,a=e.length,u=a,c=n(a),d=1/0,l=[];u--;){var h=e[u];u&&t&&(h=xt(h,Ut(t))),d=pn(h.length,d),c[u]=!r&&(t||i>=120&&h.length>=120)?new Vn(u&&h):s}h=e[0];var f=-1,m=c[0];e:for(;++f<i&&l.length<d;){var p=h[f],g=t?t(p):p;if(p=r||0!==p?p:0,!(m?$t(m,g):o(l,g,r))){for(u=a;--u;){var b=c[u];if(!(b?$t(b,g):o(e[u],g,r)))continue e}m&&m.push(g),l.push(p)}}return l}function xr(e,t,n){var r=null==(e=Ss(e,t=po(t,e)))?e:e[Fs(Ws(t))];return null==r?s:vt(r,e,n)}function Or(e){return Xi(e)&&wr(e)==g}function Er(e,t,n,r,o){return e===t||(null==e||null==t||!Xi(e)&&!Xi(t)?e!=e&&t!=t:function(e,t,n,r,o,i){var a=qi(e),u=qi(t),c=a?b:ds(e),d=u?b:ds(t),l=(c=c==g?C:c)==C,h=(d=d==g?C:d)==C,f=c==d;if(f&&Vi(e)){if(!Vi(t))return!1;a=!0,l=!1}if(f&&!l)return i||(i=new $n),a||sa(e)?Xo(e,t,n,r,o,i):function(e,t,n,r,o,s,i){switch(n){case F:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!s(new He(e),new He(t)));case v:case y:case j:return Di(+e,+t);case _:return e.name==t.name&&e.message==t.message;case O:case I:return e==t+"";case S:var a=Qt;case E:var u=1&r;if(a||(a=nn),e.size!=t.size&&!u)return!1;var c=i.get(e);if(c)return c==t;r|=2,i.set(e,t);var d=Xo(a(e),a(t),r,o,s,i);return i.delete(e),d;case A:if(Pn)return Pn.call(e)==Pn.call(t)}return!1}(e,t,c,n,r,o,i);if(!(1&n)){var m=l&&Fe.call(e,"__wrapped__"),p=h&&Fe.call(t,"__wrapped__");if(m||p){var w=m?e.value():e,k=p?t.value():t;return i||(i=new $n),o(w,k,n,r,i)}}return!!f&&(i||(i=new $n),function(e,t,n,r,o,i){var a=1&n,u=Qo(e),c=u.length;if(c!=Qo(t).length&&!a)return!1;for(var d=c;d--;){var l=u[d];if(!(a?l in t:Fe.call(t,l)))return!1}var h=i.get(e),f=i.get(t);if(h&&f)return h==t&&f==e;var m=!0;i.set(e,t),i.set(t,e);for(var p=a;++d<c;){var g=e[l=u[d]],b=t[l];if(r)var v=a?r(b,g,l,t,e,i):r(g,b,l,e,t,i);if(!(v===s?g===b||o(g,b,n,r,i):v)){m=!1;break}p||(p="constructor"==l)}if(m&&!p){var y=e.constructor,_=t.constructor;y==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _||(m=!1)}return i.delete(e),i.delete(t),m}(e,t,n,r,o,i))}(e,t,n,r,Er,o))}function Ir(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=je(e);o--;){var u=n[o];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<i;){var c=(u=n[o])[0],d=e[c],l=u[1];if(a&&u[2]){if(d===s&&!(c in e))return!1}else{var h=new $n;if(r)var f=r(d,l,c,e,t,h);if(!(f===s?Er(l,d,3,r,h):f))return!1}}return!0}function Ar(e){return!(!Zi(e)||(t=e,Re&&Re in t))&&(Ki(e)?Be:ge).test(Ps(e));var t}function Nr(e){return"function"==typeof e?e:null==e?Qa:"object"==typeof e?qi(e)?Dr(e[0],e[1]):Rr(e):uu(e)}function Tr(e){if(!ys(e))return fn(e);var t=[];for(var n in je(e))Fe.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Fr(e,t){return e<t}function Pr(e,t){var r=-1,o=Hi(e)?n(e.length):[];return ur(e,(function(e,n,s){o[++r]=t(e,n,s)})),o}function Rr(e){var t=is(e);return 1==t.length&&t[0][2]?ws(t[0][0],t[0][1]):function(n){return n===e||Ir(n,e,t)}}function Dr(e,t){return gs(e)&&_s(t)?ws(Fs(e),t):function(n){var r=ka(n,e);return r===s&&r===t?Sa(n,e):Er(t,r,3)}}function Mr(e,t,n,r,o){e!==t&&mr(t,(function(i,a){if(o||(o=new $n),Zi(i))!function(e,t,n,r,o,i,a){var u=Cs(e,n),c=Cs(t,n),d=a.get(c);if(d)Zn(e,n,d);else{var l=i?i(u,c,n+"",e,t,a):s,h=l===s;if(h){var f=qi(c),m=!f&&Vi(c),p=!f&&!m&&sa(c);l=c,f||m||p?qi(u)?l=u:Ui(u)?l=Co(u):m?(h=!1,l=yo(c,!0)):p?(h=!1,l=wo(c,!0)):l=[]:ea(c)||Bi(c)?(l=u,Bi(u)?l=fa(u):Zi(u)&&!Ki(u)||(l=hs(c))):h=!1}h&&(a.set(c,l),o(l,c,r,i,a),a.delete(c)),Zn(e,n,l)}}(e,t,a,n,Mr,r,o);else{var u=r?r(Cs(e,a),i,a+"",e,t,o):s;u===s&&(u=i),Zn(e,a,u)}}),Ea)}function Lr(e,t){var n=e.length;if(n)return ms(t+=t<0?n:0,n)?e[t]:s}function Br(e,t,n){t=t.length?xt(t,(function(e){return qi(e)?function(t){return yr(t,1===e.length?e[0]:e)}:e})):[Qa];var r=-1;return t=xt(t,Ut(os())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Pr(e,(function(e,n,o){return{criteria:xt(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){for(var r=-1,o=e.criteria,s=t.criteria,i=o.length,a=n.length;++r<i;){var u=ko(o[r],s[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function qr(e,t,n){for(var r=-1,o=t.length,s={};++r<o;){var i=t[r],a=yr(e,i);n(a,i)&&Gr(s,po(i,e),a)}return s}function zr(e,t,n,r){var o=r?Rt:Pt,s=-1,i=t.length,a=e;for(e===t&&(t=Co(t)),n&&(a=xt(e,Ut(n)));++s<i;)for(var u=0,c=t[s],d=n?n(c):c;(u=o(a,d,u,r))>-1;)a!==e&&tt.call(a,u,1),tt.call(e,u,1);return e}function Hr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o=t[n];if(n==r||o!==s){var s=o;ms(o)?tt.call(e,o,1):io(e,o)}}return e}function Ur(e,t){return e+un(vn()*(t-e+1))}function Vr(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=un(t/2))&&(e+=e)}while(t);return n}function $r(e,t){return Es(ks(e,t,Qa),e+"")}function Wr(e){return Kn(Da(e))}function Kr(e,t){var n=Da(e);return Ns(n,rr(t,0,n.length))}function Gr(e,t,n,r){if(!Zi(e))return e;for(var o=-1,i=(t=po(t,e)).length,a=i-1,u=e;null!=u&&++o<i;){var c=Fs(t[o]),d=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var l=u[c];(d=r?r(l,c,u):s)===s&&(d=Zi(l)?l:ms(t[o+1])?[]:{})}Xn(u,c,d),u=u[c]}return e}var Jr=xn?function(e,t){return xn.set(e,t),e}:Qa,Zr=ut?function(e,t){return ut(e,"toString",{configurable:!0,enumerable:!1,value:Za(t),writable:!0})}:Qa;function Xr(e){return Ns(Da(e))}function Yr(e,t,r){var o=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(r=r>s?s:r)<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var i=n(s);++o<s;)i[o]=e[o+t];return i}function Qr(e,t){var n;return ur(e,(function(e,r,o){return!(n=t(e,r,o))})),!!n}function eo(e,t,n){var r=0,o=null==e?r:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;r<o;){var s=r+o>>>1,i=e[s];null!==i&&!oa(i)&&(n?i<=t:i<t)?r=s+1:o=s}return o}return to(e,t,Qa,n)}function to(e,t,n,r){var o=0,i=null==e?0:e.length;if(0===i)return 0;for(var a=(t=n(t))!==t,u=null===t,c=oa(t),d=t===s;o<i;){var l=un((o+i)/2),h=n(e[l]),f=h!==s,m=null===h,p=h==h,g=oa(h);if(a)var b=r||p;else b=d?p&&(r||f):u?p&&f&&(r||!m):c?p&&f&&!m&&(r||!g):!m&&!g&&(r?h<=t:h<t);b?o=l+1:i=l}return pn(i,4294967294)}function no(e,t){for(var n=-1,r=e.length,o=0,s=[];++n<r;){var i=e[n],a=t?t(i):i;if(!n||!Di(a,u)){var u=a;s[o++]=0===i?0:i}}return s}function ro(e){return"number"==typeof e?e:oa(e)?f:+e}function oo(e){if("string"==typeof e)return e;if(qi(e))return xt(e,oo)+"";if(oa(e))return Rn?Rn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function so(e,t,n){var r=-1,o=jt,s=e.length,i=!0,a=[],u=a;if(n)i=!1,o=Ct;else if(s>=200){var c=t?null:$o(e);if(c)return nn(c);i=!1,o=$t,u=new Vn}else u=t?[]:a;e:for(;++r<s;){var d=e[r],l=t?t(d):d;if(d=n||0!==d?d:0,i&&l==l){for(var h=u.length;h--;)if(u[h]===l)continue e;t&&u.push(l),a.push(d)}else o(u,l,n)||(u!==a&&u.push(l),a.push(d))}return a}function io(e,t){return null==(e=Ss(e,t=po(t,e)))||delete e[Fs(Ws(t))]}function ao(e,t,n,r){return Gr(e,t,n(yr(e,t)),r)}function uo(e,t,n,r){for(var o=e.length,s=r?o:-1;(r?s--:++s<o)&&t(e[s],s,e););return n?Yr(e,r?0:s,r?s+1:o):Yr(e,r?s+1:0,r?o:s)}function co(e,t){var n=e;return n instanceof qn&&(n=n.value()),Et(t,(function(e,t){return t.func.apply(t.thisArg,Ot([e],t.args))}),n)}function lo(e,t,r){var o=e.length;if(o<2)return o?so(e[0]):[];for(var s=-1,i=n(o);++s<o;)for(var a=e[s],u=-1;++u<o;)u!=s&&(i[s]=ar(i[s]||a,e[u],t,r));return so(fr(i,1),t,r)}function ho(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var u=r<i?t[r]:s;n(a,e[r],u)}return a}function fo(e){return Ui(e)?e:[]}function mo(e){return"function"==typeof e?e:Qa}function po(e,t){return qi(e)?e:gs(e,t)?[e]:Ts(ma(e))}var go=$r;function bo(e,t,n){var r=e.length;return n=n===s?r:n,!t&&n>=r?e:Yr(e,t,n)}var vo=dt||function(e){return it.clearTimeout(e)};function yo(e,t){if(t)return e.slice();var n=e.length,r=Ue?Ue(n):new e.constructor(n);return e.copy(r),r}function _o(e){var t=new e.constructor(e.byteLength);return new He(t).set(new He(e)),t}function wo(e,t){var n=t?_o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ko(e,t){if(e!==t){var n=e!==s,r=null===e,o=e==e,i=oa(e),a=t!==s,u=null===t,c=t==t,d=oa(t);if(!u&&!d&&!i&&e>t||i&&a&&c&&!u&&!d||r&&a&&c||!n&&c||!o)return 1;if(!r&&!i&&!d&&e<t||d&&n&&o&&!r&&!i||u&&n&&o||!a&&o||!c)return-1}return 0}function So(e,t,r,o){for(var s=-1,i=e.length,a=r.length,u=-1,c=t.length,d=mn(i-a,0),l=n(c+d),h=!o;++u<c;)l[u]=t[u];for(;++s<a;)(h||s<i)&&(l[r[s]]=e[s]);for(;d--;)l[u++]=e[s++];return l}function jo(e,t,r,o){for(var s=-1,i=e.length,a=-1,u=r.length,c=-1,d=t.length,l=mn(i-u,0),h=n(l+d),f=!o;++s<l;)h[s]=e[s];for(var m=s;++c<d;)h[m+c]=t[c];for(;++a<u;)(f||s<i)&&(h[m+r[a]]=e[s++]);return h}function Co(e,t){var r=-1,o=e.length;for(t||(t=n(o));++r<o;)t[r]=e[r];return t}function xo(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var u=t[i],c=r?r(n[u],e[u],u,n,e):s;c===s&&(c=e[u]),o?tr(n,u,c):Xn(n,u,c)}return n}function Oo(e,t){return function(n,r){var o=qi(n)?yt:Qn,s=t?t():{};return o(n,e,os(r,2),s)}}function Eo(e){return $r((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:s,a=o>2?n[2]:s;for(i=e.length>3&&"function"==typeof i?(o--,i):s,a&&ps(n[0],n[1],a)&&(i=o<3?s:i,o=1),t=je(t);++r<o;){var u=n[r];u&&e(t,u,r,i)}return t}))}function Io(e,t){return function(n,r){if(null==n)return n;if(!Hi(n))return e(n,r);for(var o=n.length,s=t?o:-1,i=je(n);(t?s--:++s<o)&&!1!==r(i[s],s,i););return n}}function Ao(e){return function(t,n,r){for(var o=-1,s=je(t),i=r(t),a=i.length;a--;){var u=i[e?a:++o];if(!1===n(s[u],u,s))break}return t}}function No(e){return function(t){var n=Yt(t=ma(t))?on(t):s,r=n?n[0]:t.charAt(0),o=n?bo(n,1).join(""):t.slice(1);return r[e]()+o}}function To(e){return function(t){return Et(Ka(Ba(t).replace($e,"")),e,"")}}function Fo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Mn(e.prototype),r=e.apply(n,t);return Zi(r)?r:n}}function Po(e){return function(t,n,r){var o=je(t);if(!Hi(t)){var i=os(n,3);t=Oa(t),n=function(e){return i(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[i?t[a]:a]:s}}function Ro(e){return Yo((function(t){var n=t.length,r=n,o=Bn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Oe(i);if(o&&!u&&"wrapper"==ns(a))var u=new Bn([],!0)}for(r=u?r:n;++r<n;){var c=ns(a=t[r]),d="wrapper"==c?ts(a):s;u=d&&bs(d[0])&&424==d[1]&&!d[4].length&&1==d[9]?u[ns(d[0])].apply(u,d[3]):1==a.length&&bs(a)?u[c]():u.thru(a)}return function(){var e=arguments,r=e[0];if(u&&1==e.length&&qi(r))return u.plant(r).value();for(var o=0,s=n?t[o].apply(this,e):r;++o<n;)s=t[o].call(this,s);return s}}))}function Do(e,t,r,o,i,a,u,c,l,h){var f=t&d,m=1&t,p=2&t,g=24&t,b=512&t,v=p?s:Fo(e);return function s(){for(var d=arguments.length,y=n(d),_=d;_--;)y[_]=arguments[_];if(g)var w=rs(s),k=Gt(y,w);if(o&&(y=So(y,o,i,g)),a&&(y=jo(y,a,u,g)),d-=k,g&&d<h){var S=tn(y,w);return Uo(e,t,Do,s.placeholder,r,y,S,c,l,h-d)}var j=m?r:this,C=p?j[e]:e;return d=y.length,c?y=js(y,c):b&&d>1&&y.reverse(),f&&l<d&&(y.length=l),this&&this!==it&&this instanceof s&&(C=v||Fo(C)),C.apply(j,y)}}function Mo(e,t){return function(n,r){return function(e,t,n,r){return gr(e,(function(e,o,s){t(r,n(e),o,s)})),r}(n,e,t(r),{})}}function Lo(e,t){return function(n,r){var o;if(n===s&&r===s)return t;if(n!==s&&(o=n),r!==s){if(o===s)return r;"string"==typeof n||"string"==typeof r?(n=oo(n),r=oo(r)):(n=ro(n),r=ro(r)),o=e(n,r)}return o}}function Bo(e){return Yo((function(t){return t=xt(t,Ut(os())),$r((function(n){var r=this;return e(t,(function(e){return vt(e,r,n)}))}))}))}function qo(e,t){var n=(t=t===s?" ":oo(t)).length;if(n<2)return n?Vr(t,e):t;var r=Vr(t,Bt(e/rn(t)));return Yt(t)?bo(on(r),0,e).join(""):r.slice(0,e)}function zo(e){return function(t,r,o){return o&&"number"!=typeof o&&ps(t,r,o)&&(r=o=s),t=ca(t),r===s?(r=t,t=0):r=ca(r),function(e,t,r,o){for(var s=-1,i=mn(Bt((t-e)/(r||1)),0),a=n(i);i--;)a[o?i:++s]=e,e+=r;return a}(t,r,o=o===s?t<r?1:-1:ca(o),e)}}function Ho(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ha(t),n=ha(n)),e(t,n)}}function Uo(e,t,n,r,o,i,a,u,d,l){var h=8&t;t|=h?c:64,4&(t&=~(h?64:c))||(t&=-4);var f=[e,t,o,h?i:s,h?a:s,h?s:i,h?s:a,u,d,l],m=n.apply(s,f);return bs(e)&&xs(m,f),m.placeholder=r,Is(m,e,t)}function Vo(e){var t=Se[e];return function(e,n){if(e=ha(e),(n=null==n?0:pn(da(n),292))&&ln(e)){var r=(ma(e)+"e").split("e");return+((r=(ma(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var $o=Sn&&1/nn(new Sn([,-0]))[1]==l?function(e){return new Sn(e)}:ou;function Wo(e){return function(t){var n=ds(t);return n==S?Qt(t):n==E?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return xt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Ko(e,t,r,o,a,l,h,f){var m=2&t;if(!m&&"function"!=typeof e)throw new Oe(i);var p=o?o.length:0;if(p||(t&=-97,o=a=s),h=h===s?h:mn(da(h),0),f=f===s?f:da(f),p-=a?a.length:0,64&t){var g=o,b=a;o=a=s}var v=m?s:ts(e),y=[e,t,r,o,a,g,b,l,h,f];if(v&&function(e,t){var n=e[1],r=t[1],o=n|r,s=o<131,i=r==d&&8==n||r==d&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!s&&!i)return e;1&r&&(e[2]=t[2],o|=1&n?0:4);var a=t[3];if(a){var c=e[3];e[3]=c?So(c,a,t[4]):a,e[4]=c?tn(e[3],u):t[4]}(a=t[5])&&(c=e[5],e[5]=c?jo(c,a,t[6]):a,e[6]=c?tn(e[5],u):t[6]),(a=t[7])&&(e[7]=a),r&d&&(e[8]=null==e[8]?t[8]:pn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o}(y,v),e=y[0],t=y[1],r=y[2],o=y[3],a=y[4],!(f=y[9]=y[9]===s?m?0:e.length:mn(y[9]-p,0))&&24&t&&(t&=-25),t&&1!=t)_=8==t||16==t?function(e,t,r){var o=Fo(e);return function i(){for(var a=arguments.length,u=n(a),c=a,d=rs(i);c--;)u[c]=arguments[c];var l=a<3&&u[0]!==d&&u[a-1]!==d?[]:tn(u,d);return(a-=l.length)<r?Uo(e,t,Do,i.placeholder,s,u,l,s,s,r-a):vt(this&&this!==it&&this instanceof i?o:e,this,u)}}(e,t,f):t!=c&&33!=t||a.length?Do.apply(s,y):function(e,t,r,o){var s=1&t,i=Fo(e);return function t(){for(var a=-1,u=arguments.length,c=-1,d=o.length,l=n(d+u),h=this&&this!==it&&this instanceof t?i:e;++c<d;)l[c]=o[c];for(;u--;)l[c++]=arguments[++a];return vt(h,s?r:this,l)}}(e,t,r,o);else var _=function(e,t,n){var r=1&t,o=Fo(e);return function t(){return(this&&this!==it&&this instanceof t?o:e).apply(r?n:this,arguments)}}(e,t,r);return Is((v?Jr:xs)(_,y),e,t)}function Go(e,t,n,r){return e===s||Di(e,Ae[n])&&!Fe.call(r,n)?t:e}function Jo(e,t,n,r,o,i){return Zi(e)&&Zi(t)&&(i.set(t,e),Mr(e,t,s,Jo,i),i.delete(t)),e}function Zo(e){return ea(e)?s:e}function Xo(e,t,n,r,o,i){var a=1&n,u=e.length,c=t.length;if(u!=c&&!(a&&c>u))return!1;var d=i.get(e),l=i.get(t);if(d&&l)return d==t&&l==e;var h=-1,f=!0,m=2&n?new Vn:s;for(i.set(e,t),i.set(t,e);++h<u;){var p=e[h],g=t[h];if(r)var b=a?r(g,p,h,t,e,i):r(p,g,h,e,t,i);if(b!==s){if(b)continue;f=!1;break}if(m){if(!At(t,(function(e,t){if(!$t(m,t)&&(p===e||o(p,e,n,r,i)))return m.push(t)}))){f=!1;break}}else if(p!==g&&!o(p,g,n,r,i)){f=!1;break}}return i.delete(e),i.delete(t),f}function Yo(e){return Es(ks(e,s,zs),e+"")}function Qo(e){return _r(e,Oa,us)}function es(e){return _r(e,Ea,cs)}var ts=xn?function(e){return xn.get(e)}:ou;function ns(e){for(var t=e.name+"",n=On[t],r=Fe.call(On,t)?n.length:0;r--;){var o=n[r],s=o.func;if(null==s||s==e)return o.name}return t}function rs(e){return(Fe.call(Dn,"placeholder")?Dn:e).placeholder}function os(){var e=Dn.iteratee||eu;return e=e===eu?Nr:e,arguments.length?e(arguments[0],arguments[1]):e}function ss(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function is(e){for(var t=Oa(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,_s(o)]}return t}function as(e,t){var n=function(e,t){return null==e?s:e[t]}(e,t);return Ar(n)?n:s}var us=cn?function(e){return null==e?[]:(e=je(e),St(cn(e),(function(t){return Je.call(e,t)})))}:lu,cs=cn?function(e){for(var t=[];e;)Ot(t,us(e)),e=Ve(e);return t}:lu,ds=wr;function ls(e,t,n){for(var r=-1,o=(t=po(t,e)).length,s=!1;++r<o;){var i=Fs(t[r]);if(!(s=null!=e&&n(e,i)))break;e=e[i]}return s||++r!=o?s:!!(o=null==e?0:e.length)&&Ji(o)&&ms(i,o)&&(qi(e)||Bi(e))}function hs(e){return"function"!=typeof e.constructor||ys(e)?{}:Mn(Ve(e))}function fs(e){return qi(e)||Bi(e)||!!(ot&&e&&e[ot])}function ms(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&ve.test(e))&&e>-1&&e%1==0&&e<t}function ps(e,t,n){if(!Zi(n))return!1;var r=typeof t;return!!("number"==r?Hi(n)&&ms(t,n.length):"string"==r&&t in n)&&Di(n[t],e)}function gs(e,t){if(qi(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!oa(e))||ee.test(e)||!Q.test(e)||null!=t&&e in je(t)}function bs(e){var t=ns(e),n=Dn[t];if("function"!=typeof n||!(t in qn.prototype))return!1;if(e===n)return!0;var r=ts(n);return!!r&&e===r[0]}(_n&&ds(new _n(new ArrayBuffer(1)))!=F||wn&&ds(new wn)!=S||kn&&ds(kn.resolve())!=x||Sn&&ds(new Sn)!=E||jn&&ds(new jn)!=N)&&(ds=function(e){var t=wr(e),n=t==C?e.constructor:s,r=n?Ps(n):"";if(r)switch(r){case En:return F;case In:return S;case An:return x;case Nn:return E;case Tn:return N}return t});var vs=Ne?Ki:hu;function ys(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ae)}function _s(e){return e==e&&!Zi(e)}function ws(e,t){return function(n){return null!=n&&n[e]===t&&(t!==s||e in je(n))}}function ks(e,t,r){return t=mn(t===s?e.length-1:t,0),function(){for(var o=arguments,s=-1,i=mn(o.length-t,0),a=n(i);++s<i;)a[s]=o[t+s];s=-1;for(var u=n(t+1);++s<t;)u[s]=o[s];return u[t]=r(a),vt(e,this,u)}}function Ss(e,t){return t.length<2?e:yr(e,Yr(t,0,-1))}function js(e,t){for(var n=e.length,r=pn(t.length,n),o=Co(e);r--;){var i=t[r];e[r]=ms(i,n)?o[i]:s}return e}function Cs(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var xs=As(Jr),Os=Nt||function(e,t){return it.setTimeout(e,t)},Es=As(Zr);function Is(e,t,n){var r=t+"";return Es(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ae,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return _t(p,(function(n){var r="_."+n[0];t&n[1]&&!jt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ue);return t?t[1].split(ce):[]}(r),n)))}function As(e){var t=0,n=0;return function(){var r=gn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(s,arguments)}}function Ns(e,t){var n=-1,r=e.length,o=r-1;for(t=t===s?r:t;++n<t;){var i=Ur(n,o),a=e[i];e[i]=e[n],e[n]=a}return e.length=t,e}var Ts=function(e){var t=Ai((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(te,(function(e,n,r,o){t.push(r?o.replace(le,"$1"):n||e)})),t}),(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}();function Fs(e){if("string"==typeof e||oa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ps(e){if(null!=e){try{return Te.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Rs(e){if(e instanceof qn)return e.clone();var t=new Bn(e.__wrapped__,e.__chain__);return t.__actions__=Co(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ds=$r((function(e,t){return Ui(e)?ar(e,fr(t,1,Ui,!0)):[]})),Ms=$r((function(e,t){var n=Ws(t);return Ui(n)&&(n=s),Ui(e)?ar(e,fr(t,1,Ui,!0),os(n,2)):[]})),Ls=$r((function(e,t){var n=Ws(t);return Ui(n)&&(n=s),Ui(e)?ar(e,fr(t,1,Ui,!0),s,n):[]}));function Bs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:da(n);return o<0&&(o=mn(r+o,0)),Ft(e,os(t,3),o)}function qs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==s&&(o=da(n),o=n<0?mn(r+o,0):pn(o,r-1)),Ft(e,os(t,3),o,!0)}function zs(e){return null!=e&&e.length?fr(e,1):[]}function Hs(e){return e&&e.length?e[0]:s}var Us=$r((function(e){var t=xt(e,fo);return t.length&&t[0]===e[0]?Cr(t):[]})),Vs=$r((function(e){var t=Ws(e),n=xt(e,fo);return t===Ws(n)?t=s:n.pop(),n.length&&n[0]===e[0]?Cr(n,os(t,2)):[]})),$s=$r((function(e){var t=Ws(e),n=xt(e,fo);return(t="function"==typeof t?t:s)&&n.pop(),n.length&&n[0]===e[0]?Cr(n,s,t):[]}));function Ws(e){var t=null==e?0:e.length;return t?e[t-1]:s}var Ks=$r(Gs);function Gs(e,t){return e&&e.length&&t&&t.length?zr(e,t):e}var Js=Yo((function(e,t){var n=null==e?0:e.length,r=nr(e,t);return Hr(e,xt(t,(function(e){return ms(e,n)?+e:e})).sort(ko)),r}));function Zs(e){return null==e?e:yn.call(e)}var Xs=$r((function(e){return so(fr(e,1,Ui,!0))})),Ys=$r((function(e){var t=Ws(e);return Ui(t)&&(t=s),so(fr(e,1,Ui,!0),os(t,2))})),Qs=$r((function(e){var t=Ws(e);return t="function"==typeof t?t:s,so(fr(e,1,Ui,!0),s,t)}));function ei(e){if(!e||!e.length)return[];var t=0;return e=St(e,(function(e){if(Ui(e))return t=mn(e.length,t),!0})),Ht(t,(function(t){return xt(e,Lt(t))}))}function ti(e,t){if(!e||!e.length)return[];var n=ei(e);return null==t?n:xt(n,(function(e){return vt(t,s,e)}))}var ni=$r((function(e,t){return Ui(e)?ar(e,t):[]})),ri=$r((function(e){return lo(St(e,Ui))})),oi=$r((function(e){var t=Ws(e);return Ui(t)&&(t=s),lo(St(e,Ui),os(t,2))})),si=$r((function(e){var t=Ws(e);return t="function"==typeof t?t:s,lo(St(e,Ui),s,t)})),ii=$r(ei),ai=$r((function(e){var t=e.length,n=t>1?e[t-1]:s;return n="function"==typeof n?(e.pop(),n):s,ti(e,n)}));function ui(e){var t=Dn(e);return t.__chain__=!0,t}function ci(e,t){return t(e)}var di=Yo((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return nr(t,e)};return!(t>1||this.__actions__.length)&&r instanceof qn&&ms(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ci,args:[o],thisArg:s}),new Bn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(s),e}))):this.thru(o)})),li=Oo((function(e,t,n){Fe.call(e,n)?++e[n]:tr(e,n,1)})),hi=Po(Bs),fi=Po(qs);function mi(e,t){return(qi(e)?_t:ur)(e,os(t,3))}function pi(e,t){return(qi(e)?wt:cr)(e,os(t,3))}var gi=Oo((function(e,t,n){Fe.call(e,n)?e[n].push(t):tr(e,n,[t])})),bi=$r((function(e,t,r){var o=-1,s="function"==typeof t,i=Hi(e)?n(e.length):[];return ur(e,(function(e){i[++o]=s?vt(t,e,r):xr(e,t,r)})),i})),vi=Oo((function(e,t,n){tr(e,n,t)}));function yi(e,t){return(qi(e)?xt:Pr)(e,os(t,3))}var _i=Oo((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),wi=$r((function(e,t){if(null==e)return[];var n=t.length;return n>1&&ps(e,t[0],t[1])?t=[]:n>2&&ps(t[0],t[1],t[2])&&(t=[t[0]]),Br(e,fr(t,1),[])})),ki=lt||function(){return it.Date.now()};function Si(e,t,n){return t=n?s:t,t=e&&null==t?e.length:t,Ko(e,d,s,s,s,s,t)}function ji(e,t){var n;if("function"!=typeof t)throw new Oe(i);return e=da(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=s),n}}var Ci=$r((function(e,t,n){var r=1;if(n.length){var o=tn(n,rs(Ci));r|=c}return Ko(e,r,t,n,o)})),xi=$r((function(e,t,n){var r=3;if(n.length){var o=tn(n,rs(xi));r|=c}return Ko(t,r,e,n,o)}));function Oi(e,t,n){var r,o,a,u,c,d,l=0,h=!1,f=!1,m=!0;if("function"!=typeof e)throw new Oe(i);function p(t){var n=r,i=o;return r=o=s,l=t,u=e.apply(i,n)}function g(e){return l=e,c=Os(v,t),h?p(e):u}function b(e){var n=e-d;return d===s||n>=t||n<0||f&&e-l>=a}function v(){var e=ki();if(b(e))return y(e);c=Os(v,function(e){var n=t-(e-d);return f?pn(n,a-(e-l)):n}(e))}function y(e){return c=s,m&&r?p(e):(r=o=s,u)}function _(){var e=ki(),n=b(e);if(r=arguments,o=this,d=e,n){if(c===s)return g(d);if(f)return vo(c),c=Os(v,t),p(d)}return c===s&&(c=Os(v,t)),u}return t=ha(t)||0,Zi(n)&&(h=!!n.leading,a=(f="maxWait"in n)?mn(ha(n.maxWait)||0,t):a,m="trailing"in n?!!n.trailing:m),_.cancel=function(){c!==s&&vo(c),l=0,r=d=o=c=s},_.flush=function(){return c===s?u:y(ki())},_}var Ei=$r((function(e,t){return ir(e,1,t)})),Ii=$r((function(e,t,n){return ir(e,ha(t)||0,n)}));function Ai(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Oe(i);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],s=n.cache;if(s.has(o))return s.get(o);var i=e.apply(this,r);return n.cache=s.set(o,i)||s,i};return n.cache=new(Ai.Cache||Un),n}function Ni(e){if("function"!=typeof e)throw new Oe(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ai.Cache=Un;var Ti=go((function(e,t){var n=(t=1==t.length&&qi(t[0])?xt(t[0],Ut(os())):xt(fr(t,1),Ut(os()))).length;return $r((function(r){for(var o=-1,s=pn(r.length,n);++o<s;)r[o]=t[o].call(this,r[o]);return vt(e,this,r)}))})),Fi=$r((function(e,t){var n=tn(t,rs(Fi));return Ko(e,c,s,t,n)})),Pi=$r((function(e,t){var n=tn(t,rs(Pi));return Ko(e,64,s,t,n)})),Ri=Yo((function(e,t){return Ko(e,256,s,s,s,t)}));function Di(e,t){return e===t||e!=e&&t!=t}var Mi=Ho(kr),Li=Ho((function(e,t){return e>=t})),Bi=Or(function(){return arguments}())?Or:function(e){return Xi(e)&&Fe.call(e,"callee")&&!Je.call(e,"callee")},qi=n.isArray,zi=ht?Ut(ht):function(e){return Xi(e)&&wr(e)==T};function Hi(e){return null!=e&&Ji(e.length)&&!Ki(e)}function Ui(e){return Xi(e)&&Hi(e)}var Vi=dn||hu,$i=ft?Ut(ft):function(e){return Xi(e)&&wr(e)==y};function Wi(e){if(!Xi(e))return!1;var t=wr(e);return t==_||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ea(e)}function Ki(e){if(!Zi(e))return!1;var t=wr(e);return t==w||t==k||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Gi(e){return"number"==typeof e&&e==da(e)}function Ji(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function Zi(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Xi(e){return null!=e&&"object"==typeof e}var Yi=mt?Ut(mt):function(e){return Xi(e)&&ds(e)==S};function Qi(e){return"number"==typeof e||Xi(e)&&wr(e)==j}function ea(e){if(!Xi(e)||wr(e)!=C)return!1;var t=Ve(e);if(null===t)return!0;var n=Fe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Te.call(n)==Me}var ta=pt?Ut(pt):function(e){return Xi(e)&&wr(e)==O},na=gt?Ut(gt):function(e){return Xi(e)&&ds(e)==E};function ra(e){return"string"==typeof e||!qi(e)&&Xi(e)&&wr(e)==I}function oa(e){return"symbol"==typeof e||Xi(e)&&wr(e)==A}var sa=bt?Ut(bt):function(e){return Xi(e)&&Ji(e.length)&&!!Qe[wr(e)]},ia=Ho(Fr),aa=Ho((function(e,t){return e<=t}));function ua(e){if(!e)return[];if(Hi(e))return ra(e)?on(e):Co(e);if(st&&e[st])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[st]());var t=ds(e);return(t==S?Qt:t==E?nn:Da)(e)}function ca(e){return e?(e=ha(e))===l||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function da(e){var t=ca(e),n=t%1;return t==t?n?t-n:t:0}function la(e){return e?rr(da(e),0,m):0}function ha(e){if("number"==typeof e)return e;if(oa(e))return f;if(Zi(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Zi(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(oe,"");var n=pe.test(e);return n||be.test(e)?rt(e.slice(2),n?2:8):me.test(e)?f:+e}function fa(e){return xo(e,Ea(e))}function ma(e){return null==e?"":oo(e)}var pa=Eo((function(e,t){if(ys(t)||Hi(t))xo(t,Oa(t),e);else for(var n in t)Fe.call(t,n)&&Xn(e,n,t[n])})),ga=Eo((function(e,t){xo(t,Ea(t),e)})),ba=Eo((function(e,t,n,r){xo(t,Ea(t),e,r)})),va=Eo((function(e,t,n,r){xo(t,Oa(t),e,r)})),ya=Yo(nr),_a=$r((function(e,t){e=je(e);var n=-1,r=t.length,o=r>2?t[2]:s;for(o&&ps(t[0],t[1],o)&&(r=1);++n<r;)for(var i=t[n],a=Ea(i),u=-1,c=a.length;++u<c;){var d=a[u],l=e[d];(l===s||Di(l,Ae[d])&&!Fe.call(e,d))&&(e[d]=i[d])}return e})),wa=$r((function(e){return e.push(s,Jo),vt(Aa,s,e)}));function ka(e,t,n){var r=null==e?s:yr(e,t);return r===s?n:r}function Sa(e,t){return null!=e&&ls(e,t,jr)}var ja=Mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=De.call(t)),e[t]=n}),Za(Qa)),Ca=Mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=De.call(t)),Fe.call(e,t)?e[t].push(n):e[t]=[n]}),os),xa=$r(xr);function Oa(e){return Hi(e)?Wn(e):Tr(e)}function Ea(e){return Hi(e)?Wn(e,!0):function(e){if(!Zi(e))return function(e){var t=[];if(null!=e)for(var n in je(e))t.push(n);return t}(e);var t=ys(e),n=[];for(var r in e)("constructor"!=r||!t&&Fe.call(e,r))&&n.push(r);return n}(e)}var Ia=Eo((function(e,t,n){Mr(e,t,n)})),Aa=Eo((function(e,t,n,r){Mr(e,t,n,r)})),Na=Yo((function(e,t){var n={};if(null==e)return n;var r=!1;t=xt(t,(function(t){return t=po(t,e),r||(r=t.length>1),t})),xo(e,es(e),n),r&&(n=or(n,7,Zo));for(var o=t.length;o--;)io(n,t[o]);return n})),Ta=Yo((function(e,t){return null==e?{}:function(e,t){return qr(e,t,(function(t,n){return Sa(e,n)}))}(e,t)}));function Fa(e,t){if(null==e)return{};var n=xt(es(e),(function(e){return[e]}));return t=os(t),qr(e,n,(function(e,n){return t(e,n[0])}))}var Pa=Wo(Oa),Ra=Wo(Ea);function Da(e){return null==e?[]:Vt(e,Oa(e))}var Ma=To((function(e,t,n){return t=t.toLowerCase(),e+(n?La(t):t)}));function La(e){return Wa(ma(e).toLowerCase())}function Ba(e){return(e=ma(e))&&e.replace(ye,Jt).replace(We,"")}var qa=To((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),za=To((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ha=No("toLowerCase"),Ua=To((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Va=To((function(e,t,n){return e+(n?" ":"")+Wa(t)})),$a=To((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Wa=No("toUpperCase");function Ka(e,t,n){return e=ma(e),(t=n?s:t)===s?function(e){return Ze.test(e)}(e)?function(e){return e.match(Ge)||[]}(e):function(e){return e.match(de)||[]}(e):e.match(t)||[]}var Ga=$r((function(e,t){try{return vt(e,s,t)}catch(e){return Wi(e)?e:new o(e)}})),Ja=Yo((function(e,t){return _t(t,(function(t){t=Fs(t),tr(e,t,Ci(e[t],e))})),e}));function Za(e){return function(){return e}}var Xa=Ro(),Ya=Ro(!0);function Qa(e){return e}function eu(e){return Nr("function"==typeof e?e:or(e,1))}var tu=$r((function(e,t){return function(n){return xr(n,e,t)}})),nu=$r((function(e,t){return function(n){return xr(e,n,t)}}));function ru(e,t,n){var r=Oa(t),o=vr(t,r);null!=n||Zi(t)&&(o.length||!r.length)||(n=t,t=e,e=this,o=vr(t,Oa(t)));var s=!(Zi(n)&&"chain"in n&&!n.chain),i=Ki(e);return _t(o,(function(n){var r=t[n];e[n]=r,i&&(e.prototype[n]=function(){var t=this.__chain__;if(s||t){var n=e(this.__wrapped__),o=n.__actions__=Co(this.__actions__);return o.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Ot([this.value()],arguments))})})),e}function ou(){}var su=Bo(xt),iu=Bo(kt),au=Bo(At);function uu(e){return gs(e)?Lt(Fs(e)):function(e){return function(t){return yr(t,e)}}(e)}var cu=zo(),du=zo(!0);function lu(){return[]}function hu(){return!1}var fu=Lo((function(e,t){return e+t}),0),mu=Vo("ceil"),pu=Lo((function(e,t){return e/t}),1),gu=Vo("floor"),bu=Lo((function(e,t){return e*t}),1),vu=Vo("round"),yu=Lo((function(e,t){return e-t}),0);return Dn.after=function(e,t){if("function"!=typeof t)throw new Oe(i);return e=da(e),function(){if(--e<1)return t.apply(this,arguments)}},Dn.ary=Si,Dn.assign=pa,Dn.assignIn=ga,Dn.assignInWith=ba,Dn.assignWith=va,Dn.at=ya,Dn.before=ji,Dn.bind=Ci,Dn.bindAll=Ja,Dn.bindKey=xi,Dn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return qi(e)?e:[e]},Dn.chain=ui,Dn.chunk=function(e,t,r){t=(r?ps(e,t,r):t===s)?1:mn(da(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var i=0,a=0,u=n(Bt(o/t));i<o;)u[a++]=Yr(e,i,i+=t);return u},Dn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var s=e[t];s&&(o[r++]=s)}return o},Dn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],o=e;o--;)t[o-1]=arguments[o];return Ot(qi(r)?Co(r):[r],fr(t,1))},Dn.cond=function(e){var t=null==e?0:e.length,n=os();return e=t?xt(e,(function(e){if("function"!=typeof e[1])throw new Oe(i);return[n(e[0]),e[1]]})):[],$r((function(n){for(var r=-1;++r<t;){var o=e[r];if(vt(o[0],this,n))return vt(o[1],this,n)}}))},Dn.conforms=function(e){return function(e){var t=Oa(e);return function(n){return sr(n,e,t)}}(or(e,1))},Dn.constant=Za,Dn.countBy=li,Dn.create=function(e,t){var n=Mn(e);return null==t?n:er(n,t)},Dn.curry=function e(t,n,r){var o=Ko(t,8,s,s,s,s,s,n=r?s:n);return o.placeholder=e.placeholder,o},Dn.curryRight=function e(t,n,r){var o=Ko(t,16,s,s,s,s,s,n=r?s:n);return o.placeholder=e.placeholder,o},Dn.debounce=Oi,Dn.defaults=_a,Dn.defaultsDeep=wa,Dn.defer=Ei,Dn.delay=Ii,Dn.difference=Ds,Dn.differenceBy=Ms,Dn.differenceWith=Ls,Dn.drop=function(e,t,n){var r=null==e?0:e.length;return r?Yr(e,(t=n||t===s?1:da(t))<0?0:t,r):[]},Dn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Yr(e,0,(t=r-(t=n||t===s?1:da(t)))<0?0:t):[]},Dn.dropRightWhile=function(e,t){return e&&e.length?uo(e,os(t,3),!0,!0):[]},Dn.dropWhile=function(e,t){return e&&e.length?uo(e,os(t,3),!0):[]},Dn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&ps(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=da(n))<0&&(n=-n>o?0:o+n),(r=r===s||r>o?o:da(r))<0&&(r+=o),r=n>r?0:la(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Dn.filter=function(e,t){return(qi(e)?St:hr)(e,os(t,3))},Dn.flatMap=function(e,t){return fr(yi(e,t),1)},Dn.flatMapDeep=function(e,t){return fr(yi(e,t),l)},Dn.flatMapDepth=function(e,t,n){return n=n===s?1:da(n),fr(yi(e,t),n)},Dn.flatten=zs,Dn.flattenDeep=function(e){return null!=e&&e.length?fr(e,l):[]},Dn.flattenDepth=function(e,t){return null!=e&&e.length?fr(e,t=t===s?1:da(t)):[]},Dn.flip=function(e){return Ko(e,512)},Dn.flow=Xa,Dn.flowRight=Ya,Dn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var o=e[t];r[o[0]]=o[1]}return r},Dn.functions=function(e){return null==e?[]:vr(e,Oa(e))},Dn.functionsIn=function(e){return null==e?[]:vr(e,Ea(e))},Dn.groupBy=gi,Dn.initial=function(e){return null!=e&&e.length?Yr(e,0,-1):[]},Dn.intersection=Us,Dn.intersectionBy=Vs,Dn.intersectionWith=$s,Dn.invert=ja,Dn.invertBy=Ca,Dn.invokeMap=bi,Dn.iteratee=eu,Dn.keyBy=vi,Dn.keys=Oa,Dn.keysIn=Ea,Dn.map=yi,Dn.mapKeys=function(e,t){var n={};return t=os(t,3),gr(e,(function(e,r,o){tr(n,t(e,r,o),e)})),n},Dn.mapValues=function(e,t){var n={};return t=os(t,3),gr(e,(function(e,r,o){tr(n,r,t(e,r,o))})),n},Dn.matches=function(e){return Rr(or(e,1))},Dn.matchesProperty=function(e,t){return Dr(e,or(t,1))},Dn.memoize=Ai,Dn.merge=Ia,Dn.mergeWith=Aa,Dn.method=tu,Dn.methodOf=nu,Dn.mixin=ru,Dn.negate=Ni,Dn.nthArg=function(e){return e=da(e),$r((function(t){return Lr(t,e)}))},Dn.omit=Na,Dn.omitBy=function(e,t){return Fa(e,Ni(os(t)))},Dn.once=function(e){return ji(2,e)},Dn.orderBy=function(e,t,n,r){return null==e?[]:(qi(t)||(t=null==t?[]:[t]),qi(n=r?s:n)||(n=null==n?[]:[n]),Br(e,t,n))},Dn.over=su,Dn.overArgs=Ti,Dn.overEvery=iu,Dn.overSome=au,Dn.partial=Fi,Dn.partialRight=Pi,Dn.partition=_i,Dn.pick=Ta,Dn.pickBy=Fa,Dn.property=uu,Dn.propertyOf=function(e){return function(t){return null==e?s:yr(e,t)}},Dn.pull=Ks,Dn.pullAll=Gs,Dn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?zr(e,t,os(n,2)):e},Dn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?zr(e,t,s,n):e},Dn.pullAt=Js,Dn.range=cu,Dn.rangeRight=du,Dn.rearg=Ri,Dn.reject=function(e,t){return(qi(e)?St:hr)(e,Ni(os(t,3)))},Dn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,o=[],s=e.length;for(t=os(t,3);++r<s;){var i=e[r];t(i,r,e)&&(n.push(i),o.push(r))}return Hr(e,o),n},Dn.rest=function(e,t){if("function"!=typeof e)throw new Oe(i);return $r(e,t=t===s?t:da(t))},Dn.reverse=Zs,Dn.sampleSize=function(e,t,n){return t=(n?ps(e,t,n):t===s)?1:da(t),(qi(e)?Gn:Kr)(e,t)},Dn.set=function(e,t,n){return null==e?e:Gr(e,t,n)},Dn.setWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:Gr(e,t,n,r)},Dn.shuffle=function(e){return(qi(e)?Jn:Xr)(e)},Dn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&ps(e,t,n)?(t=0,n=r):(t=null==t?0:da(t),n=n===s?r:da(n)),Yr(e,t,n)):[]},Dn.sortBy=wi,Dn.sortedUniq=function(e){return e&&e.length?no(e):[]},Dn.sortedUniqBy=function(e,t){return e&&e.length?no(e,os(t,2)):[]},Dn.split=function(e,t,n){return n&&"number"!=typeof n&&ps(e,t,n)&&(t=n=s),(n=n===s?m:n>>>0)?(e=ma(e))&&("string"==typeof t||null!=t&&!ta(t))&&!(t=oo(t))&&Yt(e)?bo(on(e),0,n):e.split(t,n):[]},Dn.spread=function(e,t){if("function"!=typeof e)throw new Oe(i);return t=null==t?0:mn(da(t),0),$r((function(n){var r=n[t],o=bo(n,0,t);return r&&Ot(o,r),vt(e,this,o)}))},Dn.tail=function(e){var t=null==e?0:e.length;return t?Yr(e,1,t):[]},Dn.take=function(e,t,n){return e&&e.length?Yr(e,0,(t=n||t===s?1:da(t))<0?0:t):[]},Dn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Yr(e,(t=r-(t=n||t===s?1:da(t)))<0?0:t,r):[]},Dn.takeRightWhile=function(e,t){return e&&e.length?uo(e,os(t,3),!1,!0):[]},Dn.takeWhile=function(e,t){return e&&e.length?uo(e,os(t,3)):[]},Dn.tap=function(e,t){return t(e),e},Dn.throttle=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new Oe(i);return Zi(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Oi(e,t,{leading:r,maxWait:t,trailing:o})},Dn.thru=ci,Dn.toArray=ua,Dn.toPairs=Pa,Dn.toPairsIn=Ra,Dn.toPath=function(e){return qi(e)?xt(e,Fs):oa(e)?[e]:Co(Ts(ma(e)))},Dn.toPlainObject=fa,Dn.transform=function(e,t,n){var r=qi(e),o=r||Vi(e)||sa(e);if(t=os(t,4),null==n){var s=e&&e.constructor;n=o?r?new s:[]:Zi(e)&&Ki(s)?Mn(Ve(e)):{}}return(o?_t:gr)(e,(function(e,r,o){return t(n,e,r,o)})),n},Dn.unary=function(e){return Si(e,1)},Dn.union=Xs,Dn.unionBy=Ys,Dn.unionWith=Qs,Dn.uniq=function(e){return e&&e.length?so(e):[]},Dn.uniqBy=function(e,t){return e&&e.length?so(e,os(t,2)):[]},Dn.uniqWith=function(e,t){return t="function"==typeof t?t:s,e&&e.length?so(e,s,t):[]},Dn.unset=function(e,t){return null==e||io(e,t)},Dn.unzip=ei,Dn.unzipWith=ti,Dn.update=function(e,t,n){return null==e?e:ao(e,t,mo(n))},Dn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:ao(e,t,mo(n),r)},Dn.values=Da,Dn.valuesIn=function(e){return null==e?[]:Vt(e,Ea(e))},Dn.without=ni,Dn.words=Ka,Dn.wrap=function(e,t){return Fi(mo(t),e)},Dn.xor=ri,Dn.xorBy=oi,Dn.xorWith=si,Dn.zip=ii,Dn.zipObject=function(e,t){return ho(e||[],t||[],Xn)},Dn.zipObjectDeep=function(e,t){return ho(e||[],t||[],Gr)},Dn.zipWith=ai,Dn.entries=Pa,Dn.entriesIn=Ra,Dn.extend=ga,Dn.extendWith=ba,ru(Dn,Dn),Dn.add=fu,Dn.attempt=Ga,Dn.camelCase=Ma,Dn.capitalize=La,Dn.ceil=mu,Dn.clamp=function(e,t,n){return n===s&&(n=t,t=s),n!==s&&(n=(n=ha(n))===n?n:0),t!==s&&(t=(t=ha(t))===t?t:0),rr(ha(e),t,n)},Dn.clone=function(e){return or(e,4)},Dn.cloneDeep=function(e){return or(e,5)},Dn.cloneDeepWith=function(e,t){return or(e,5,t="function"==typeof t?t:s)},Dn.cloneWith=function(e,t){return or(e,4,t="function"==typeof t?t:s)},Dn.conformsTo=function(e,t){return null==t||sr(e,t,Oa(t))},Dn.deburr=Ba,Dn.defaultTo=function(e,t){return null==e||e!=e?t:e},Dn.divide=pu,Dn.endsWith=function(e,t,n){e=ma(e),t=oo(t);var r=e.length,o=n=n===s?r:rr(da(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Dn.eq=Di,Dn.escape=function(e){return(e=ma(e))&&J.test(e)?e.replace(K,Zt):e},Dn.escapeRegExp=function(e){return(e=ma(e))&&re.test(e)?e.replace(ne,"\\$&"):e},Dn.every=function(e,t,n){var r=qi(e)?kt:dr;return n&&ps(e,t,n)&&(t=s),r(e,os(t,3))},Dn.find=hi,Dn.findIndex=Bs,Dn.findKey=function(e,t){return Tt(e,os(t,3),gr)},Dn.findLast=fi,Dn.findLastIndex=qs,Dn.findLastKey=function(e,t){return Tt(e,os(t,3),br)},Dn.floor=gu,Dn.forEach=mi,Dn.forEachRight=pi,Dn.forIn=function(e,t){return null==e?e:mr(e,os(t,3),Ea)},Dn.forInRight=function(e,t){return null==e?e:pr(e,os(t,3),Ea)},Dn.forOwn=function(e,t){return e&&gr(e,os(t,3))},Dn.forOwnRight=function(e,t){return e&&br(e,os(t,3))},Dn.get=ka,Dn.gt=Mi,Dn.gte=Li,Dn.has=function(e,t){return null!=e&&ls(e,t,Sr)},Dn.hasIn=Sa,Dn.head=Hs,Dn.identity=Qa,Dn.includes=function(e,t,n,r){e=Hi(e)?e:Da(e),n=n&&!r?da(n):0;var o=e.length;return n<0&&(n=mn(o+n,0)),ra(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&Pt(e,t,n)>-1},Dn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:da(n);return o<0&&(o=mn(r+o,0)),Pt(e,t,o)},Dn.inRange=function(e,t,n){return t=ca(t),n===s?(n=t,t=0):n=ca(n),function(e,t,n){return e>=pn(t,n)&&e<mn(t,n)}(e=ha(e),t,n)},Dn.invoke=xa,Dn.isArguments=Bi,Dn.isArray=qi,Dn.isArrayBuffer=zi,Dn.isArrayLike=Hi,Dn.isArrayLikeObject=Ui,Dn.isBoolean=function(e){return!0===e||!1===e||Xi(e)&&wr(e)==v},Dn.isBuffer=Vi,Dn.isDate=$i,Dn.isElement=function(e){return Xi(e)&&1===e.nodeType&&!ea(e)},Dn.isEmpty=function(e){if(null==e)return!0;if(Hi(e)&&(qi(e)||"string"==typeof e||"function"==typeof e.splice||Vi(e)||sa(e)||Bi(e)))return!e.length;var t=ds(e);if(t==S||t==E)return!e.size;if(ys(e))return!Tr(e).length;for(var n in e)if(Fe.call(e,n))return!1;return!0},Dn.isEqual=function(e,t){return Er(e,t)},Dn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:s)?n(e,t):s;return r===s?Er(e,t,s,n):!!r},Dn.isError=Wi,Dn.isFinite=function(e){return"number"==typeof e&&ln(e)},Dn.isFunction=Ki,Dn.isInteger=Gi,Dn.isLength=Ji,Dn.isMap=Yi,Dn.isMatch=function(e,t){return e===t||Ir(e,t,is(t))},Dn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:s,Ir(e,t,is(t),n)},Dn.isNaN=function(e){return Qi(e)&&e!=+e},Dn.isNative=function(e){if(vs(e))throw new o("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ar(e)},Dn.isNil=function(e){return null==e},Dn.isNull=function(e){return null===e},Dn.isNumber=Qi,Dn.isObject=Zi,Dn.isObjectLike=Xi,Dn.isPlainObject=ea,Dn.isRegExp=ta,Dn.isSafeInteger=function(e){return Gi(e)&&e>=-9007199254740991&&e<=h},Dn.isSet=na,Dn.isString=ra,Dn.isSymbol=oa,Dn.isTypedArray=sa,Dn.isUndefined=function(e){return e===s},Dn.isWeakMap=function(e){return Xi(e)&&ds(e)==N},Dn.isWeakSet=function(e){return Xi(e)&&"[object WeakSet]"==wr(e)},Dn.join=function(e,t){return null==e?"":hn.call(e,t)},Dn.kebabCase=qa,Dn.last=Ws,Dn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==s&&(o=(o=da(n))<0?mn(r+o,0):pn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Ft(e,Dt,o,!0)},Dn.lowerCase=za,Dn.lowerFirst=Ha,Dn.lt=ia,Dn.lte=aa,Dn.max=function(e){return e&&e.length?lr(e,Qa,kr):s},Dn.maxBy=function(e,t){return e&&e.length?lr(e,os(t,2),kr):s},Dn.mean=function(e){return Mt(e,Qa)},Dn.meanBy=function(e,t){return Mt(e,os(t,2))},Dn.min=function(e){return e&&e.length?lr(e,Qa,Fr):s},Dn.minBy=function(e,t){return e&&e.length?lr(e,os(t,2),Fr):s},Dn.stubArray=lu,Dn.stubFalse=hu,Dn.stubObject=function(){return{}},Dn.stubString=function(){return""},Dn.stubTrue=function(){return!0},Dn.multiply=bu,Dn.nth=function(e,t){return e&&e.length?Lr(e,da(t)):s},Dn.noConflict=function(){return it._===this&&(it._=Le),this},Dn.noop=ou,Dn.now=ki,Dn.pad=function(e,t,n){e=ma(e);var r=(t=da(t))?rn(e):0;if(!t||r>=t)return e;var o=(t-r)/2;return qo(un(o),n)+e+qo(Bt(o),n)},Dn.padEnd=function(e,t,n){e=ma(e);var r=(t=da(t))?rn(e):0;return t&&r<t?e+qo(t-r,n):e},Dn.padStart=function(e,t,n){e=ma(e);var r=(t=da(t))?rn(e):0;return t&&r<t?qo(t-r,n)+e:e},Dn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),bn(ma(e).replace(se,""),t||0)},Dn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&ps(e,t,n)&&(t=n=s),n===s&&("boolean"==typeof t?(n=t,t=s):"boolean"==typeof e&&(n=e,e=s)),e===s&&t===s?(e=0,t=1):(e=ca(e),t===s?(t=e,e=0):t=ca(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=vn();return pn(e+o*(t-e+nt("1e-"+((o+"").length-1))),t)}return Ur(e,t)},Dn.reduce=function(e,t,n){var r=qi(e)?Et:qt,o=arguments.length<3;return r(e,os(t,4),n,o,ur)},Dn.reduceRight=function(e,t,n){var r=qi(e)?It:qt,o=arguments.length<3;return r(e,os(t,4),n,o,cr)},Dn.repeat=function(e,t,n){return t=(n?ps(e,t,n):t===s)?1:da(t),Vr(ma(e),t)},Dn.replace=function(){var e=arguments,t=ma(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Dn.result=function(e,t,n){var r=-1,o=(t=po(t,e)).length;for(o||(o=1,e=s);++r<o;){var i=null==e?s:e[Fs(t[r])];i===s&&(r=o,i=n),e=Ki(i)?i.call(e):i}return e},Dn.round=vu,Dn.runInContext=e,Dn.sample=function(e){return(qi(e)?Kn:Wr)(e)},Dn.size=function(e){if(null==e)return 0;if(Hi(e))return ra(e)?rn(e):e.length;var t=ds(e);return t==S||t==E?e.size:Tr(e).length},Dn.snakeCase=Ua,Dn.some=function(e,t,n){var r=qi(e)?At:Qr;return n&&ps(e,t,n)&&(t=s),r(e,os(t,3))},Dn.sortedIndex=function(e,t){return eo(e,t)},Dn.sortedIndexBy=function(e,t,n){return to(e,t,os(n,2))},Dn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=eo(e,t);if(r<n&&Di(e[r],t))return r}return-1},Dn.sortedLastIndex=function(e,t){return eo(e,t,!0)},Dn.sortedLastIndexBy=function(e,t,n){return to(e,t,os(n,2),!0)},Dn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=eo(e,t,!0)-1;if(Di(e[n],t))return n}return-1},Dn.startCase=Va,Dn.startsWith=function(e,t,n){return e=ma(e),n=null==n?0:rr(da(n),0,e.length),t=oo(t),e.slice(n,n+t.length)==t},Dn.subtract=yu,Dn.sum=function(e){return e&&e.length?zt(e,Qa):0},Dn.sumBy=function(e,t){return e&&e.length?zt(e,os(t,2)):0},Dn.template=function(e,t,n){var r=Dn.templateSettings;n&&ps(e,t,n)&&(t=s),e=ma(e),t=ba({},t,r,Go);var o,i,a=ba({},t.imports,r.imports,Go),u=Oa(a),c=Vt(a,u),d=0,l=t.interpolate||_e,h="__p += '",f=Ce((t.escape||_e).source+"|"+l.source+"|"+(l===Y?he:_e).source+"|"+(t.evaluate||_e).source+"|$","g"),m="//# sourceURL="+(Fe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ye+"]")+"\n";e.replace(f,(function(t,n,r,s,a,u){return r||(r=s),h+=e.slice(d,u).replace(we,Xt),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),a&&(i=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),d=u+t.length,t})),h+="';\n";var p=Fe.call(t,"variable")&&t.variable;p||(h="with (obj) {\n"+h+"\n}\n"),h=(i?h.replace(U,""):h).replace(V,"$1").replace($,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=Ga((function(){return ke(u,m+"return "+h).apply(s,c)}));if(g.source=h,Wi(g))throw g;return g},Dn.times=function(e,t){if((e=da(e))<1||e>h)return[];var n=m,r=pn(e,m);t=os(t),e-=m;for(var o=Ht(r,t);++n<e;)t(n);return o},Dn.toFinite=ca,Dn.toInteger=da,Dn.toLength=la,Dn.toLower=function(e){return ma(e).toLowerCase()},Dn.toNumber=ha,Dn.toSafeInteger=function(e){return e?rr(da(e),-9007199254740991,h):0===e?e:0},Dn.toString=ma,Dn.toUpper=function(e){return ma(e).toUpperCase()},Dn.trim=function(e,t,n){if((e=ma(e))&&(n||t===s))return e.replace(oe,"");if(!e||!(t=oo(t)))return e;var r=on(e),o=on(t);return bo(r,Wt(r,o),Kt(r,o)+1).join("")},Dn.trimEnd=function(e,t,n){if((e=ma(e))&&(n||t===s))return e.replace(ie,"");if(!e||!(t=oo(t)))return e;var r=on(e);return bo(r,0,Kt(r,on(t))+1).join("")},Dn.trimStart=function(e,t,n){if((e=ma(e))&&(n||t===s))return e.replace(se,"");if(!e||!(t=oo(t)))return e;var r=on(e);return bo(r,Wt(r,on(t))).join("")},Dn.truncate=function(e,t){var n=30,r="...";if(Zi(t)){var o="separator"in t?t.separator:o;n="length"in t?da(t.length):n,r="omission"in t?oo(t.omission):r}var i=(e=ma(e)).length;if(Yt(e)){var a=on(e);i=a.length}if(n>=i)return e;var u=n-rn(r);if(u<1)return r;var c=a?bo(a,0,u).join(""):e.slice(0,u);if(o===s)return c+r;if(a&&(u+=c.length-u),ta(o)){if(e.slice(u).search(o)){var d,l=c;for(o.global||(o=Ce(o.source,ma(fe.exec(o))+"g")),o.lastIndex=0;d=o.exec(l);)var h=d.index;c=c.slice(0,h===s?u:h)}}else if(e.indexOf(oo(o),u)!=u){var f=c.lastIndexOf(o);f>-1&&(c=c.slice(0,f))}return c+r},Dn.unescape=function(e){return(e=ma(e))&&G.test(e)?e.replace(W,sn):e},Dn.uniqueId=function(e){var t=++Pe;return ma(e)+t},Dn.upperCase=$a,Dn.upperFirst=Wa,Dn.each=mi,Dn.eachRight=pi,Dn.first=Hs,ru(Dn,function(){var e={};return gr(Dn,(function(t,n){Fe.call(Dn.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),Dn.VERSION="4.17.20",_t(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Dn[e].placeholder=Dn})),_t(["drop","take"],(function(e,t){qn.prototype[e]=function(n){n=n===s?1:mn(da(n),0);var r=this.__filtered__&&!t?new qn(this):this.clone();return r.__filtered__?r.__takeCount__=pn(n,r.__takeCount__):r.__views__.push({size:pn(n,m),type:e+(r.__dir__<0?"Right":"")}),r},qn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),_t(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;qn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:os(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),_t(["head","last"],(function(e,t){var n="take"+(t?"Right":"");qn.prototype[e]=function(){return this[n](1).value()[0]}})),_t(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");qn.prototype[e]=function(){return this.__filtered__?new qn(this):this[n](1)}})),qn.prototype.compact=function(){return this.filter(Qa)},qn.prototype.find=function(e){return this.filter(e).head()},qn.prototype.findLast=function(e){return this.reverse().find(e)},qn.prototype.invokeMap=$r((function(e,t){return"function"==typeof e?new qn(this):this.map((function(n){return xr(n,e,t)}))})),qn.prototype.reject=function(e){return this.filter(Ni(os(e)))},qn.prototype.slice=function(e,t){e=da(e);var n=this;return n.__filtered__&&(e>0||t<0)?new qn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==s&&(n=(t=da(t))<0?n.dropRight(-t):n.take(t-e)),n)},qn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},qn.prototype.toArray=function(){return this.take(m)},gr(qn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Dn[r?"take"+("last"==t?"Right":""):t],i=r||/^find/.test(t);o&&(Dn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,u=t instanceof qn,c=a[0],d=u||qi(t),l=function(e){var t=o.apply(Dn,Ot([e],a));return r&&h?t[0]:t};d&&n&&"function"==typeof c&&1!=c.length&&(u=d=!1);var h=this.__chain__,f=!!this.__actions__.length,m=i&&!h,p=u&&!f;if(!i&&d){t=p?t:new qn(this);var g=e.apply(t,a);return g.__actions__.push({func:ci,args:[l],thisArg:s}),new Bn(g,h)}return m&&p?e.apply(this,a):(g=this.thru(l),m?r?g.value()[0]:g.value():g)})})),_t(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ee[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Dn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(qi(o)?o:[],e)}return this[n]((function(n){return t.apply(qi(n)?n:[],e)}))}})),gr(qn.prototype,(function(e,t){var n=Dn[t];if(n){var r=n.name+"";Fe.call(On,r)||(On[r]=[]),On[r].push({name:t,func:n})}})),On[Do(s,2).name]=[{name:"wrapper",func:s}],qn.prototype.clone=function(){var e=new qn(this.__wrapped__);return e.__actions__=Co(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Co(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Co(this.__views__),e},qn.prototype.reverse=function(){if(this.__filtered__){var e=new qn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},qn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=qi(e),r=t<0,o=n?e.length:0,s=function(e,t,n){for(var r=-1,o=n.length;++r<o;){var s=n[r],i=s.size;switch(s.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=pn(t,e+i);break;case"takeRight":e=mn(e,t-i)}}return{start:e,end:t}}(0,o,this.__views__),i=s.start,a=s.end,u=a-i,c=r?a:i-1,d=this.__iteratees__,l=d.length,h=0,f=pn(u,this.__takeCount__);if(!n||!r&&o==u&&f==u)return co(e,this.__actions__);var m=[];e:for(;u--&&h<f;){for(var p=-1,g=e[c+=t];++p<l;){var b=d[p],v=b.iteratee,y=b.type,_=v(g);if(2==y)g=_;else if(!_){if(1==y)continue e;break e}}m[h++]=g}return m},Dn.prototype.at=di,Dn.prototype.chain=function(){return ui(this)},Dn.prototype.commit=function(){return new Bn(this.value(),this.__chain__)},Dn.prototype.next=function(){this.__values__===s&&(this.__values__=ua(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?s:this.__values__[this.__index__++]}},Dn.prototype.plant=function(e){for(var t,n=this;n instanceof Ln;){var r=Rs(n);r.__index__=0,r.__values__=s,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Dn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof qn){var t=e;return this.__actions__.length&&(t=new qn(this)),(t=t.reverse()).__actions__.push({func:ci,args:[Zs],thisArg:s}),new Bn(t,this.__chain__)}return this.thru(Zs)},Dn.prototype.toJSON=Dn.prototype.valueOf=Dn.prototype.value=function(){return co(this.__wrapped__,this.__actions__)},Dn.prototype.first=Dn.prototype.head,st&&(Dn.prototype[st]=function(){return this}),Dn}();it._=an,(o=function(){return an}.call(t,n,t,r))===s||(r.exports=o)}).call(this)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/server-services-client/dist/generateNames.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.choose=t.getRandomName=void 0;const o=r(n("../notebook-dds/node_modules/sillyname/index.js"));function s(e="_",t=!1){let[n,r]=o.default().split(" ");return t||(n=n.toLowerCase(),r=r.toLowerCase()),`${n}${e}${r}`}t.getRandomName=s,t.choose=()=>s()},"../notebook-dds/node_modules/@fluidframework/server-services-client/lib/auth.js":function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n("../notebook-dds/node_modules/jsrsasign/lib/jsrsasign.js");function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidCharacterError";var s="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new o("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,s=0,i=0,a="";r=t.charAt(i++);~r&&(n=s%4?64*n+r:r,s++%4)?a+=String.fromCharCode(255&n>>(-2*s&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return a};function i(e){this.message=e}i.prototype=new Error,i.prototype.name="InvalidTokenError";var a=function(e,t){if("string"!=typeof e)throw new i("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(s(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return s(t)}}(e.split(".")[n]))}catch(e){throw new i("Invalid token specified: "+e.message)}},u=n("../notebook-dds/node_modules/uuid/dist/esm-browser/v4.js");function c(e,t,n,r,o){const s=a(e);if(s&&s.documentId===t&&s.tenantId===n&&void 0!==s.scopes&&0!==s.scopes.length){if(o&&s.exp&&s.iat&&(Math.round((new Date).getTime()/1e3)>=s.exp||s.exp-s.iat>r))return;return s}}function d(e,t,n,o,s,i=3600,a="1.0"){""!==(s=s||l()).id&&void 0!==s.id||(s=l());const u=Math.round((new Date).getTime()/1e3),c={documentId:t,scopes:o,tenantId:e,user:s,iat:u,exp:u+i,ver:a},d={utf8:n};return r.KJUR.jws.JWS.sign(null,JSON.stringify({alg:"HS256",typ:"JWT"}),c,d)}function l(){return{id:Object(u.a)(),name:Object(u.a)()}}},"../notebook-dds/node_modules/@fluidframework/server-services-client/lib/debug.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("../notebook-dds/node_modules/debug/src/browser.js");const o=n.n(r)()("fluid:services-client");o("Package: @fluidframework/server-services-client - Version: 0.1019.0")},"../notebook-dds/node_modules/@fluidframework/server-services-client/lib/gitManager.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("./node_modules/assert/assert.js"),o=n.n(r),s=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/blobs.js"),i=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/storage.js"),a=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/debug.js");class u{constructor(e){this.historian=e,this.blobCache=new Map,this.commitCache=new Map,this.treeCache=new Map,this.refCache=new Map}async getHeader(e,t){const n=await this.historian.getHeader(t);for(const e of n.blobs)this.blobCache.set(e.sha,e);return Object(s.f)(n.tree)}async getFullTree(e){return this.historian.getFullTree(e)}async getCommit(e){return this.commitCache.has(e)?(Object(a.a)("Cache hit on "+e),this.commitCache.get(e)):this.historian.getCommit(e)}async getCommits(e,t){let n=e;if(this.refCache.has(e)&&(Object(a.a)("Commit cache hit on "+e),n=this.refCache.get(e),this.refCache.delete(e),!n))return[];if(this.commitCache.has(n)){const e=this.commitCache.get(n);return[{commit:{author:e.author,committer:e.committer,message:e.message,tree:e.tree,url:e.url},parents:e.parents,sha:e.sha,url:e.url}]}return this.historian.getCommits(n,t)}async getTree(e,t=!0){return this.treeCache.has(e)?(Object(a.a)("Tree cache hit on "+e),this.treeCache.get(e)):this.historian.getTree(e,t)}async getBlob(e){return this.blobCache.has(e)?(Object(a.a)("Blob cache hit on "+e),this.blobCache.get(e)):this.historian.getBlob(e)}getRawUrl(e){return`${this.historian.endpoint}/git/blobs/raw/${e}`}getContent(e,t){return this.historian.getContent(t,e)}createBlob(e,t){const n={content:e,encoding:t};return this.historian.createBlob(n)}createGitTree(e){return this.historian.createTree(e)}createTree(e){return this.createTreeCore(e,0)}async createCommit(e){return this.historian.createCommit(e)}async getRef(e){return this.historian.getRef("heads/"+e).catch(e=>400===e||404===e?null:Promise.reject(e))}async createRef(e,t){const n={ref:"refs/heads/"+e,sha:t,config:{enabled:!0}};return this.historian.createRef(n)}async upsertRef(e,t){const n={force:!0,sha:t,config:{enabled:!0}};return this.historian.updateRef("heads/"+e,n)}addRef(e,t){this.refCache.set(e,t)}addCommit(e){this.commitCache.set(e.sha,e)}addTree(e){this.treeCache.set(e.sha,e)}addBlob(e){this.blobCache.set(e.sha,e)}async write(e,t,n,r){const o=await this.createTree(t),s={author:{date:(new Date).toISOString(),email:"kurtb@microsoft.com",name:"Kurt Berglund"},message:r,parents:n,tree:o.sha},i=await this.historian.createCommit(s);return await this.getRef(e)?await this.upsertRef(e,i.sha):await this.createRef(e,i.sha),i}async createTreeCore(e,t){if(e.id)return this.getTree(e.id);const n=[];for(const r of e.entries)switch(i.b[r.type]){case i.b.Blob:const e=r.value;r.mode===i.a.Symlink&&(e.contents=this.translateSymlink(e.contents,t));const o=this.createBlob(e.contents,e.encoding);n.push(o);break;case i.b.Tree:const s=r.value,a=this.createTreeCore(s,t+1);n.push(a);break;case i.b.Commit:n.push(Promise.resolve({sha:r.value,url:""}));break;default:return Promise.reject(new Error("Unknown entry type"))}const r=await Promise.all(n),s=[];o()(r.length===e.entries.length);for(let t=0;t<e.entries.length;t++){const n=e.entries[t].type===i.b.Tree?"tree":e.entries[t].type===i.b.Blob?"blob":"commit";s.push({mode:e.entries[t].mode,path:e.entries[t].path,sha:r[t].sha,type:n})}const a={tree:s};return this.historian.createTree(a)}translateSymlink(e,t){let n="";for(let e=0;e<=t;e++)n+="../";return`${n}${e}`}}},"../notebook-dds/node_modules/@fluidframework/server-services-client/lib/historian.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/base64Encoding.js"),o=n("../notebook-dds/node_modules/uuid/dist/esm-browser/v4.js"),s=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/restWrapper.js");function i(e,t){for(const n of t)if(e.endsWith(n))return!0;return!1}class a{constructor(e,t,n,i,a){this.endpoint=e,this.historianApi=t,this.disableCache=n;const u={};let c=!1;this.disableCache&&this.historianApi?u.disableCache=this.disableCache:this.disableCache&&(c=!0),i&&(u.token=Object(r.b)(""+i.user));const d=i?{Authorization:"Basic "+Object(r.b)(`${i.user}:${i.password}`)}:{};a&&(d["x-correlation-id"]=a()||o.a()),this.restWrapper=new s.a(e,d,u,c)}getHeader(e){return this.historianApi?this.restWrapper.get("/headers/"+encodeURIComponent(e)):this.getHeaderDirect(e)}getFullTree(e){return this.restWrapper.get("/tree/"+encodeURIComponent(e))}getBlob(e){return this.restWrapper.get("/git/blobs/"+encodeURIComponent(e))}createBlob(e){return this.restWrapper.post("/git/blobs",e)}getContent(e,t){return this.restWrapper.get("/contents/"+e,{ref:t})}getCommits(e,t){return this.restWrapper.get("/commits",{count:t,sha:e}).catch(e=>400===e||404===e?[]:Promise.reject(e))}getCommit(e){return this.restWrapper.get("/git/commits/"+encodeURIComponent(e))}createCommit(e){return this.restWrapper.post("/git/commits",e)}getRefs(){return this.restWrapper.get("/git/refs")}getRef(e){return this.restWrapper.get("/git/refs/"+e)}createRef(e){return this.restWrapper.post("/git/refs",e)}updateRef(e,t){return this.restWrapper.patch("/git/refs/"+e,t)}async deleteRef(e){await this.restWrapper.delete("/git/refs/"+e)}createTag(e){return this.restWrapper.post("/git/tags",e)}getTag(e){return this.restWrapper.get("/git/tags/"+e)}createTree(e){return this.restWrapper.post("/git/trees",e)}getTree(e,t){return this.restWrapper.get("/git/trees/"+encodeURIComponent(e),{recursive:t?1:0})}async getHeaderDirect(e){const t=await this.getTree(e,!0),n=[".attributes",".blobs",".messages","header"],r=[];for(const e of t.tree)if("blob"===e.type&&i(e.path,n)){const t=this.getBlob(e.sha);r.push(t)}return{blobs:await Promise.all(r),tree:t}}}},"../notebook-dds/node_modules/@fluidframework/server-services-client/lib/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"validateTokenClaims",(function(){return r.c})),n.d(t,"generateToken",(function(){return r.a})),n.d(t,"generateUser",(function(){return r.b})),n.d(t,"getRandomName",(function(){return i})),n.d(t,"choose",(function(){return a})),n.d(t,"GitManager",(function(){return u.a})),n.d(t,"Historian",(function(){return c.a})),n.d(t,"RestWrapper",(function(){return d.a})),n.d(t,"getOrCreateRepository",(function(){return f})),n.d(t,"canRead",(function(){return p})),n.d(t,"canWrite",(function(){return g})),n.d(t,"canSummarize",(function(){return b})),n.d(t,"promiseTimeout",(function(){return v}));var r=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/auth.js"),o=n("../notebook-dds/node_modules/sillyname/index.js"),s=n.n(o);function i(e="_",t=!1){let[n,r]=s()().split(" ");return t||(n=n.toLowerCase(),r=r.toLowerCase()),`${n}${e}${r}`}const a=()=>i();var u=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/gitManager.js"),c=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/historian.js"),d=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/restWrapper.js"),l=n("../notebook-dds/node_modules/axios/index.js"),h=n.n(l);async function f(e,t,n){console.log(`Get Repo: ${e}/${t}/${n}`);const r=await h.a.get(`${e}/repos/${t}/${n}`).catch(e=>e.response&&400===e.response.status?null:Promise.reject(e));if(!r||400===r.status){console.log(`Create Repo: ${e}/${t}/${n}`);const r={name:n};await h.a.post(`${e}/${t}/repos`,r)}}var m=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/scopes.js");const p=e=>e.includes(m.a.DocRead),g=e=>e.includes(m.a.DocWrite),b=e=>e.includes(m.a.SummaryWrite);async function v(e,t){const n=new Promise((t,n)=>{const r=setTimeout(()=>{clearTimeout(r),n(new Error(`Timed out in ${e} milliseconds.`))},e)});return Promise.race([t,n])}},"../notebook-dds/node_modules/@fluidframework/server-services-client/lib/restWrapper.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("./node_modules/querystring-es3/index.js"),o=n("../notebook-dds/node_modules/axios/index.js"),s=n.n(o),i=n("../notebook-dds/node_modules/uuid/dist/esm-browser/v4.js"),a=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/debug.js");class u{constructor(e,t,n,r=!1,o=1048576e3,i=s.a){this.baseurl=e,this.defaultHeaders=t,this.defaultQueryString=n,this.cacheBust=r,this.maxContentLength=o,this.axios=i}async get(e,t,n){const r={baseURL:this.baseurl,headers:n,maxContentLength:this.maxContentLength,method:"GET",url:`${e}${this.generateQueryString(t)}`};return this.request(r,200)}async post(e,t,n,r){const o={baseURL:this.baseurl,data:t,headers:r,maxContentLength:this.maxContentLength,method:"POST",url:`${e}${this.generateQueryString(n)}`};return this.request(o,201)}async delete(e,t,n){const r={baseURL:this.baseurl,headers:n,maxContentLength:this.maxContentLength,method:"DELETE",url:`${e}${this.generateQueryString(t)}`};return this.request(r,204)}async patch(e,t,n,r){const o={baseURL:this.baseurl,data:t,headers:r,maxContentLength:this.maxContentLength,method:"PATCH",url:`${e}${this.generateQueryString(n)}`};return this.request(o,200)}async request(e,t){var n;return this.defaultHeaders&&(e.headers=Object.assign(Object.assign({},this.defaultHeaders),e.headers)),(null===(n=e.headers)||void 0===n?void 0:n["x-correlation-id"])||(e.headers=Object.assign({"x-correlation-id":i.a()},e.headers)),new Promise((n,r)=>{this.axios.request(e).then(e=>{n(e.data)}).catch(o=>{var s,i,u;o&&o.config?Object(a.a)(`[${o.config.method}] request to [${o.config.url}] failed with [${o.code}] [${o.message}]`):Object(a.a)(`request to ${e.url} failed ${o?o.message:""}`),429===(null===(s=null==o?void 0:o.response)||void 0===s?void 0:s.status)&&(null===(u=null===(i=null==o?void 0:o.response)||void 0===i?void 0:i.data)||void 0===u?void 0:u.retryAfter)>0?setTimeout(()=>{this.request(e,t).then(n).catch(r)},1e3*o.response.data.retryAfter):o.response&&o.response.status!==t?r(o.response.status):r(o)})})}generateQueryString(e){if(this.defaultQueryString||e){const t=this.cacheBust?Object.assign(Object.assign(Object.assign({},this.defaultQueryString),e),{cacheBust:Date.now()}):Object.assign(Object.assign({},this.defaultQueryString),e),n=r.stringify(t);if(""!==n)return"?"+n}return""}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/cache.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/celaNames.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chooseCelaName=void 0;const r=["Elliot Woodward","Miguel Garcia","Robert Tolbert","Henry Brill","Cecil Folk","Isaac Fielder","Erik Nason","Tim Deboer","Mauricio August","Allan Munger","Kevin Sturgis","Carlos Slattery","Johnnie McConnell","Colin Ballinger","Kat Larsson","Katri Ahokas","Carole Poland","Wanda Howard","Amanda Brady","Ashley McCarthy","Lydia Bauer","Robin Counts","Charlotte Walton","Elvia Atkins","Daisy Phillips","Mona Kane","Kristin Patterson","Celeste Burton"];t.chooseCelaName=()=>r[Math.floor(Math.random()*r.length)]},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/clientManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/combinedContext.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedContext=void 0,t.CombinedContext=class{constructor(e){this.context=e,this.checkpoints=[]}createContext(){const e=this.checkpoints.push(void 0)-1;return{log:this.context.log,checkpoint:t=>this.checkpoint(e,t),error:(t,n)=>this.error(e,t,n)}}checkpoint(e,t){this.checkpoints[e]=t;const n=this.getLowestMessage();void 0!==n&&(void 0===this.currentCheckpoint||this.currentCheckpoint.offset<n.offset)&&(this.currentCheckpoint=n,this.context.checkpoint(n))}error(e,t,n){this.context.error(t,n)}getLowestMessage(){let e;for(const t of this.checkpoints){if(void 0===t)return;(void 0===e||e.offset>t.offset)&&(e=t)}return e}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/combinedLambda.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedLambda=void 0,t.CombinedLambda=class{constructor(e){this.lambdas=e}handler(e){for(const t of this.lambdas)t.handler(e)}close(e){for(const t of this.lambdas)t.close(e)}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/combinedProducer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedProducer=void 0,t.CombinedProducer=class{constructor(e){this.producers=e}async send(e,t,n){const r=[];for(const o of this.producers)r.push(o.send(e,t,n));return Promise.all(r)}async close(){const e=[];for(const t of this.producers)e.push(t.close());await Promise.all(e)}on(e,t){return this}once(e,t){return this}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/configuration.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultServiceConfiguration=void 0,t.DefaultServiceConfiguration={blockSize:64436,maxMessageSize:16384,enableTraces:!0,summary:{idleTime:5e3,maxOps:1e3,maxTime:6e4,maxAckWaitTime:6e5},deli:{clientTimeout:3e5,activityTimeout:3e4,noOpConsolidationTimeout:250},scribe:{generateServiceSummary:!0,clearCacheAfterServiceSummary:!1,ignoreStorageException:!1}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/database.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/debug.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0;const o=r(n("../notebook-dds/node_modules/debug/src/browser.js")),s=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/packageVersion.js");t.debug=o.default("fluid:core"),t.debug(`Package: ${s.pkgName} - Version: ${s.pkgVersion}`)},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/document.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/emptyTaskMessageSender.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyTaskMessageSender=void 0,t.EmptyTaskMessageSender=class{async initialize(){}sendTask(e,t){}on(e,t){return this}async close(){}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/http.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/cache.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/celaNames.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/clientManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/combinedContext.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/combinedLambda.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/combinedProducer.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/configuration.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/database.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/document.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/emptyTaskMessageSender.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/http.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/lambdas.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/messages.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/metricClient.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/mongo.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/mongoDatabaseManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/orderer.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/publisher.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/queue.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/secretManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/taskMessages.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/tenant.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/throttler.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/token.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/zookeeper.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/lambdas.js":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.extractBoxcar=t.LambdaCloseType=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/messages.js");!function(e){e[e.Stop=0]="Stop",e[e.ActivityTimeout=1]="ActivityTimeout",e[e.Rebalance=2]="Rebalance",e[e.Error=3]="Error"}(t.LambdaCloseType||(t.LambdaCloseType={})),t.extractBoxcar=function(t){if("string"!=typeof t.value&&!e.isBuffer(t.value))return t.value;const n=t.value.toString(),s=r.safelyParseJSON(n),i=s;if(!i)return{contents:[],documentId:null,tenantId:null,type:o.BoxcarType};if(i.type===o.BoxcarType){const e=i;return{contents:e.contents.length>0&&"string"==typeof e.contents[0]?e.contents.map(e=>JSON.parse(e)):e.contents,documentId:e.documentId,tenantId:e.tenantId,type:e.type}}return{contents:[i],documentId:s.documentId,tenantId:s.tenantId,type:o.BoxcarType}}}).call(this,n("./node_modules/buffer/index.js").Buffer)},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/messages.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ControlMessageType=t.SystemOperations=t.BoxcarType=t.SystemType=t.NackOperationType=t.SequencedOperationType=t.RawOperationType=void 0,t.RawOperationType="RawOperation",t.SequencedOperationType="SequencedOperation",t.NackOperationType="Nack",t.SystemType="System",t.BoxcarType="boxcar",function(e){e[e.Join=0]="Join",e[e.Leave=1]="Leave"}(t.SystemOperations||(t.SystemOperations={})),function(e){e.UpdateDSN="updateDSN"}(t.ControlMessageType||(t.ControlMessageType={}))},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/metricClient.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMetricClient=void 0,t.DefaultMetricClient=class{writeLatencyMetric(e,t){return Promise.resolve()}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/mongo.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MongoManager=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/debug.js");t.MongoManager=class{constructor(e,t=!0,n=1e3){this.factory=e,this.shouldReconnect=t,this.reconnectDelayMs=n,this.databaseP=this.connect()}getDatabase(){return this.databaseP}async close(){return this.shouldReconnect=!1,(await this.databaseP).close()}connect(){const e=this.factory.connect().then(e=>(e.on("error",e=>{r.debug("DB Error",e),this.reconnect(this.reconnectDelayMs)}),e.on("close",e=>{r.debug("DB Close",e),this.reconnect(this.reconnectDelayMs)}),e));return e.catch(e=>{r.debug("DB Connection Error",e),this.reconnect(this.reconnectDelayMs)}),e}reconnect(e){this.shouldReconnect&&(this.databaseP=new Promise(t=>{setTimeout(()=>{const e=this.connect();t(e)},e)}))}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/mongoDatabaseManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MongoDatabaseManager=void 0,t.MongoDatabaseManager=class{constructor(e,t,n,r,o){this.mongoManager=e,this.nodeCollectionName=t,this.documentsCollectionName=n,this.deltasCollectionName=r,this.scribeDeltasCollectionName=o}async getNodeCollection(){return this.getCollection(this.nodeCollectionName)}async getDocumentCollection(){return this.getCollection(this.documentsCollectionName)}async getDeltaCollection(e,t){return this.getCollection(this.deltasCollectionName)}async getScribeDeltaCollection(e,t){return this.getCollection(this.scribeDeltasCollectionName)}async getCollection(e){return(await this.mongoManager.getDatabase()).collection(e)}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/orderer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/packageVersion.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pkgVersion=t.pkgName=void 0,t.pkgName="@fluidframework/server-services-core",t.pkgVersion="0.1019.0"},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/publisher.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/queue.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/secretManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/taskMessages.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/tenant.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/throttler.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThrottlingError=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js");t.ThrottlingError=class{constructor(e,t){this.message=e,this.retryAfter=t,this.code=429,this.type=r.NackErrorType.ThrottlingError}}},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/token.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-services-core/dist/zookeeper.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/logger.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/messageFactory.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testClientManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testCollection.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testContext.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testDocumentStorage.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testHistorian.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testKafka.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testPublisher.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testTenantManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testThrottleStorageManager.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testThrottlerHelper.js"),t),o(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testThrottler.js"),t)},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/logger.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugLogger=void 0;const o=r(n("../notebook-dds/node_modules/debug/src/browser.js"));class s{constructor(e,t,n){this.debugInfo=e,this.debugErr=t,this.debugWarn=n}static create(e){const t=o.default(e),n=o.default(e);n.log=console.warn.bind(console),n.enabled=!0;const r=o.default(e);return r.log=console.error.bind(console),r.enabled=!0,new s(t,r,n)}info(e){this.debugInfo(e)}warn(e){this.debugWarn(e)}error(e){this.debugErr(e)}}t.DebugLogger=s},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/messageFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageFactory=t.KafkaMessageFactory=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js"),s=n("../notebook-dds/node_modules/string-hash/index.js");t.KafkaMessageFactory=class{constructor(e="test",t=1,n=!0,r=null,o=null){this.topic=e,this.stringify=n,this.tenantId=r,this.documentId=o,this.offsets=[];for(let e=0;e<t;e++)this.offsets.push(0)}sequenceMessage(e,t){const n=this.getPartition(t);return{offset:this.offsets[n]++,partition:n,topic:this.topic,value:this.stringify?JSON.stringify(e):{contents:[e],documentId:this.documentId,tenantId:this.tenantId,type:o.BoxcarType}}}getHeadOffset(e){return this.offsets[this.getPartition(e)]-1}getPartition(e){return s(e)%this.offsets.length}},t.MessageFactory=class{constructor(e,t,n="test"){this.documentId=e,this.clientId=t,this.tenantId=n,this.clientSequenceNumber=0,this.sequenceNumber=0}createDocumentMessage(e=0){return{clientSequenceNumber:++this.clientSequenceNumber,contents:null,metadata:void 0,referenceSequenceNumber:e,traces:[],type:r.MessageType.Operation}}create(e=0,t=Date.now()){const n=this.createDocumentMessage(e);return this.createRawOperation(n,t,this.clientId)}createJoin(e=Date.now()){const t={clientId:this.clientId,detail:{mode:"write",permission:[],scopes:[r.ScopeType.DocRead,r.ScopeType.DocWrite,r.ScopeType.SummaryWrite],details:{capabilities:{interactive:!0}},user:null}},n={clientSequenceNumber:-1,contents:null,data:JSON.stringify(t),referenceSequenceNumber:-1,traces:[],type:r.MessageType.ClientJoin};return this.createRawOperation(n,e,null)}createLeave(e=Date.now()){const t={clientSequenceNumber:-1,contents:null,data:JSON.stringify(this.clientId),referenceSequenceNumber:-1,traces:[],type:r.MessageType.ClientLeave};return this.createRawOperation(t,e,null)}createRawOperation(e,t,n){return{clientId:n,documentId:this.documentId,operation:e,tenantId:this.tenantId,timestamp:t,type:o.RawOperationType}}createSave(){const e={clientSequenceNumber:this.clientSequenceNumber++,contents:"Test Save",referenceSequenceNumber:0,traces:[],type:r.MessageType.Save},t={clientId:this.clientId,clientSequenceNumber:e.clientSequenceNumber,contents:e.contents,metadata:e.metadata,minimumSequenceNumber:0,origin:void 0,referenceSequenceNumber:e.referenceSequenceNumber,sequenceNumber:this.sequenceNumber++,term:1,timestamp:Date.now(),traces:[],type:e.type};return{documentId:this.documentId,operation:t,tenantId:this.tenantId,type:o.SequencedOperationType}}createSequencedOperation(){const e=this.createDocumentMessage(0),t={clientId:this.clientId,clientSequenceNumber:e.clientSequenceNumber,contents:e.contents,metadata:e.metadata,minimumSequenceNumber:0,origin:void 0,referenceSequenceNumber:e.referenceSequenceNumber,sequenceNumber:this.sequenceNumber++,term:1,timestamp:Date.now(),traces:[],type:e.type};return{documentId:this.documentId,operation:t,tenantId:this.tenantId,type:o.SequencedOperationType}}}},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testClientManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestClientManager=void 0,t.TestClientManager=class{constructor(){this.clients=new Map}async addClient(e,t,n,r){this.clients.has(e)||this.clients.set(e,new Map),this.clients.get(e).has(t)||this.clients.get(e).set(t,new Map),this.clients.get(e).get(t).set(n,r)}async removeClient(e,t,n){this.clients.has(e)&&this.clients.get(e).has(t)&&this.clients.get(e).get(t).delete(n)}async getClients(e,t){const n=[];if(this.clients.has(e)&&this.clients.get(e).has(t))for(const[r,o]of this.clients.get(e).get(t))n.push({clientId:r,client:o});return n}}},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testCollection.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TestDbFactory=t.TestDb=t.TestCollection=void 0;const i=n("./node_modules/events/events.js"),a=s(n("../notebook-dds/node_modules/@fluidframework/server-test-utils/node_modules/lodash/lodash.js"));class u{constructor(e){this.collection=e}async find(e,t){return this.findInternal(e,t)}async findAll(){return this.collection}findOne(e){return Promise.resolve(this.findOneInternal(e))}async update(e,t,n){const r=this.findOneInternal(e);if(!r)return Promise.reject(new Error("Not found"));a.extend(r,t)}async upsert(e,t,n){const r=this.findOneInternal(e);r||this.collection.push(t),a.extend(r,t)}async insertOne(e){return null!==this.findOneInternal(e)?Promise.resolve("existing object"):this.insertOneInternal(e)}async findOrCreate(e,t){const n=this.findOneInternal(e);return n?{value:n,existing:!0}:{value:this.insertOneInternal(t),existing:!1}}async insertMany(e,t){e.forEach(e=>{this.collection.push(e)})}async deleteOne(e){const t=this.findOneInternal(e);return this.removeOneInternal(t),t}async deleteMany(e){const t=this.findInternal(e);return t.forEach(e=>{this.removeOneInternal(e)}),t}createIndex(e,t){throw new Error("Method not implemented.")}insertOneInternal(e){return this.collection.push(e),e}removeOneInternal(e){const t=this.collection.indexOf(e);t>=0&&this.collection.splice(t,1)}findOneInternal(e){let t;return t=e._id?this.collection.find(t=>t._id===e._id):this.findInternal(e)[0],void 0===t?null:t}findInternal(e,t){function n(e,t){const n=t.split(".");let r=e;return n.forEach(e=>{r=r[e]}),r}const r=Object.keys(e);let o=this.collection;return r.forEach(t=>{e[t]&&(e[t].$gt>0||e[t].$lt>0?(e[t].$gt>0&&(o=o.filter(r=>n(r,t)>e[t].$gt)),e[t].$lt>0&&(o=o.filter(r=>n(r,t)<e[t].$lt))):o=o.filter(r=>n(r,t)===e[t]))}),t&&1===Object.keys(t).length&&(o=o.sort((function(e,r){const o=Object.keys(t)[0];return 1===t[o]?n(e,o)-n(r,o):n(r,o)-n(e,o)}))),o}}t.TestCollection=u;class c{constructor(e){this.collections=e,this.emitter=new i.EventEmitter}close(){return Promise.resolve()}on(e,t){this.emitter.on(e,t)}collection(e){e in this.collections||(this.collections[e]=[]);const t=this.collections[e];return new u(t)}}t.TestDb=c,t.TestDbFactory=class{constructor(e){this.testDatabase=new c(e)}connect(){return Promise.resolve(this.testDatabase)}}},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testContext.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestContext=void 0;const r=n("./node_modules/assert/assert.js"),o=n("./node_modules/events/events.js"),s=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),i=n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/logger.js");class a extends o.EventEmitter{constructor(e=i.DebugLogger.create("fluid-server:TestContext")){super(),this.log=e,this.offset=Number.NEGATIVE_INFINITY,this.waits=[]}checkpoint(e){r.strict(e.offset>this.offset,`${e.offset} > ${this.offset}`),this.offset=e.offset,this.waits=this.waits.filter(t=>!(t.value<=e.offset&&(t.deferred.resolve(),1)))}error(e,t){this.emit("error",e,t)}waitForOffset(e){if(e<=this.offset)return Promise.resolve();const t=new s.Deferred;return this.waits.push({deferred:t,value:e}),t.promise}}t.TestContext=a},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testDocumentStorage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeSummaryTree=t.TestDocumentStorage=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js");async function s(e,t,n,i){const a=await Promise.all(Object.keys(t.tree).map(async a=>{const u=t.tree[a],c=await async function(e,t,n,r,i,a=""){switch(r.type){case 2:return async function(e,t,n){const{parsedContent:r,encoding:s}="string"==typeof e?{parsedContent:e,encoding:"utf-8"}:{parsedContent:o.Uint8ArrayToString(e,"base64"),encoding:"base64"},i=await o.gitHashFile(o.IsoBuffer.from(r,s));if(!t.has(i)){const e=await n.createBlob(r,s);t.add(e.sha)}return i}(r.content,t,e);case 3:if(void 0===i)throw Error("Parent summary does not exist to reference by handle.");return function(e,t,n){const r=t.split("/").map(e=>decodeURIComponent(e));return""===r[0]&&r.shift(),function e(t,n,r){var o;const s=n[0];if(1===n.length)switch(t){case 2:return r.blobs[s];case 1:return null===(o=r.trees[s])||void 0===o?void 0:o.id;default:throw Error(`Unexpected handle summary object type: "${t}".`)}return e(t,n.slice(1),r)}(e,r,n)}(r.handleType,r.handle,i);case 1:return s(e,r,t,null==i?void 0:i.trees[n]);default:throw Error(`Unexpected summary object type: "${r.type}".`)}}(e,n,a,u,i);return{mode:r.getGitMode(u),path:encodeURIComponent(a),sha:c,type:r.getGitType(u)}}));return(await e.createGitTree({tree:a})).sha}t.TestDocumentStorage=class{constructor(e,t){this.databaseManager=e,this.tenantManager=t}async getDocument(e,t){return(await this.databaseManager.getDocumentCollection()).findOne({documentId:t,tenantId:e})}async getOrCreateDocument(e,t){return this.getOrCreateObject(e,t)}async createDocument(e,t,n,o,i,a){const u=(await this.tenantManager.getTenant(e)).gitManager,c=new Set,d=await s(u,n,c,void 0),l={members:[],proposals:[],values:a},h=r.getQuorumTreeEntries(t,o,o,i,l),[f,m]=await Promise.all([u.createTree({entries:h}),u.getTree(d,!1)]),p=r.mergeAppAndProtocolTree(m,f),g=await u.createGitTree({tree:p}),b={author:{date:(new Date).toISOString(),email:"dummy@microsoft.com",name:"Routerlicious Service"},message:"New document",parents:[],tree:g.sha},v=await u.createCommit(b);await u.createRef(t,v.sha);const y={branchMap:void 0,clients:void 0,durableSequenceNumber:o,logOffset:-1,sequenceNumber:o,epoch:void 0,term:1},_={logOffset:-1,minimumSequenceNumber:o,protocolState:{members:[],minimumSequenceNumber:o,proposals:[],sequenceNumber:o,values:a},sequenceNumber:o,lastClientSummaryHead:void 0},w=await this.databaseManager.getDocumentCollection();return await w.findOrCreate({documentId:t,tenantId:e},{createTime:Date.now(),deli:JSON.stringify(y),documentId:t,scribe:JSON.stringify(_),tenantId:e,version:"0.1"})}async getLatestVersion(e,t){const n=await this.getVersions(e,t,1);if(!n.length)return null;const r=n[0];return{author:r.commit.author,committer:r.commit.committer,message:r.commit.message,parents:r.parents,sha:r.sha,tree:r.commit.tree,url:r.url}}async getVersions(e,t,n){return(await this.tenantManager.getTenant(e)).gitManager.getCommits(t,n)}async getVersion(e,t,n){return(await this.tenantManager.getTenant(e)).gitManager.getCommit(n)}async getFullTree(e,t){throw new Error("Method not implemented.")}async getOrCreateObject(e,t){const n=await this.databaseManager.getDocumentCollection();return await n.findOrCreate({documentId:t,tenantId:e},{createTime:Date.now(),deli:void 0,documentId:t,scribe:void 0,tenantId:e,version:"0.1"})}},t.writeSummaryTree=s},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testHistorian.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestHistorian=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/index.js"),o=n("../notebook-dds/node_modules/uuid/dist/esm-browser/index.js"),s=n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testCollection.js");t.TestHistorian=class{constructor(e=new s.TestDb({})){this.endpoint="",this.blobs=e.collection("blobs"),this.commits=e.collection("commits"),this.trees=e.collection("trees"),this.refs=e.collection("refs")}async getHeader(e){const t=await this.getTree(e,!0),n=[".attributes",".blobs",".messages","header"],r=[];for(const e of t.tree)if("blob"===e.type&&n.reduce((t,n)=>t||e.path.endsWith(n),!1)){const t=this.getBlob(e.sha);r.push(t)}return{blobs:await Promise.all(r),tree:t}}getFullTree(e){throw new Error("Not Supported")}async getBlob(e){var t,n,o,s,i;const a=await this.blobs.findOne({_id:e});return{content:r.IsoBuffer.from(null!==(t=a.content)&&void 0!==t?t:null===(n=a.value)||void 0===n?void 0:n.content,null!==(o=a.encoding)&&void 0!==o?o:null===(s=a.value)||void 0===s?void 0:s.encoding).toString("base64"),encoding:"base64",sha:a._id,size:void 0!==a.content?a.content.length:null===(i=a.value)||void 0===i?void 0:i.content.length,url:""}}async createBlob(e){const t=await r.gitHashFile(r.IsoBuffer.from(e.content,e.encoding));return await this.blobs.insertOne(Object.assign(Object.assign({_id:t},e),{value:e})),{sha:t,url:""}}async getContent(e,t){const n=await this.getTree(t,!0);for(const t of n.tree)if(t.path===e)return this.getBlob(t.sha)}async getCommits(e,t){const n=await this.getCommit(e);return n?[{commit:{author:n.author,committer:n.committer,message:n.message,tree:n.tree,url:n.url},parents:n.parents,sha:n.sha,url:n.url}]:[]}async getCommit(e){var t,n,r,o,s;let i=await this.commits.findOne({_id:e});if(!i){const t=await this.getRef("refs/heads/"+e);void 0!==t&&(i=await this.commits.findOne({_id:t.object.sha}))}if(i)return{author:{},committer:{},message:null!==(t=i.message)&&void 0!==t?t:null===(n=i.value)||void 0===n?void 0:n.message,parents:void 0!==i.parents?i.parents.map(e=>({sha:e,url:""})):null===(r=i.value)||void 0===r?void 0:r.parents.map(e=>({sha:e,url:""})),sha:i._id,tree:{sha:null!==(o=i.tree)&&void 0!==o?o:null===(s=i.value)||void 0===s?void 0:s.tree,url:""},url:""}}async createCommit(e){const t=e.tree;return await this.commits.insertOne(Object.assign(Object.assign({_id:t},e),{value:e})),this.getCommit(t)}getRefs(){throw new Error("Not Supported")}async getRef(e){var t,n,r,o;const s=e.startsWith("refs/")?e.substr(5):e,i=await this.refs.findOne({_id:s});if(i)return{ref:null!==(t=i.ref)&&void 0!==t?t:null===(n=i.value)||void 0===n?void 0:n.ref,url:"",object:{sha:null!==(r=i.sha)&&void 0!==r?r:null===(o=i.value)||void 0===o?void 0:o.sha,url:"",type:""}}}async createRef(e){const t=e.ref.startsWith("refs/")?e.ref.substr(5):e.ref;return await this.refs.insertOne(Object.assign(Object.assign({_id:t},e),{value:e})),this.getRef(e.ref)}async updateRef(e,t){const n=e.startsWith("refs/")?e.substr(5):e;return t.force?await this.refs.upsert({_id:n},{sha:t.sha,ref:e},{}):await this.refs.update({_id:n},{sha:t.sha,ref:e},{}),this.getRef(e)}async deleteRef(e){throw new Error("Not Supported")}createTag(e){throw new Error("Not Supported")}getTag(e){throw new Error("Not Supported")}async createTree(e){const t=o.v4();return await this.trees.insertOne(Object.assign(Object.assign({_id:t},e),{value:e})),this.getTree(t,!1)}async getTree(e,t){return this.getTreeHelper(e,t)}async getTreeHelper(e,t,n=""){var r,o;const s=await this.trees.findOne({_id:e});if(s){const e={sha:s._id,url:"",tree:[]};for(const i of null!==(r=s.tree)&&void 0!==r?r:null===(o=s.value)||void 0===o?void 0:o.tree){const r=""===n?i.path:`${n}/${i.path}`,o={mode:i.mode,path:r,sha:i.sha,size:0,type:i.type,url:""};if(e.tree.push(o),"tree"===i.type&&t){const n=await this.getTreeHelper(i.sha,t,r);n&&(e.tree=e.tree.concat(n.tree))}}return e}}}},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testKafka.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestKafka=t.TestProducer=t.TestConsumer=void 0;const r=n("./node_modules/assert/assert.js"),o=n("./node_modules/events/events.js"),s=n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testContext.js");class i{constructor(e,t){this.groupId=e,this.topic=t,this.emitter=new o.EventEmitter,this.pausedQueue=null,this.failOnCommit=!1,this.context=new s.TestContext}setFailOnCommit(e){this.failOnCommit=e}async commitCheckpoint(e,t){return r.strict(0===e),this.failOnCommit?Promise.reject(new Error("TestConsumer set to fail on commit")):void this.context.checkpoint(t)}getOffset(){return this.context.offset}async waitForOffset(e){return this.context.waitForOffset(e)}on(e,t){return this.emitter.on(e,t),this}close(){return Promise.resolve()}async pause(){this.pausedQueue||(this.pausedQueue=[])}async resume(){if(!this.pausedQueue)return;const e=this.pausedQueue;this.pausedQueue=null;for(const t of e)this.emit(t)}emitError(e){this.emitter.emit("error",e)}emit(e){this.pausedQueue?this.pausedQueue.push(e):this.emitter.emit("data",e)}rebalance(){this.emitter.emit("rebalancing"),this.emitter.emit("rebalanced",[{topic:this.topic,offset:0,partition:0}])}}t.TestConsumer=i;class a{constructor(e){this.kafka=e}send(e,t){for(const n of e)this.kafka.addMessage(n,t);return Promise.resolve()}close(){return Promise.resolve()}on(e,t){return this}once(e,t){return this}}t.TestProducer=a;class u{constructor(){this.messages=[],this.offset=0,this.consumers=[]}static createdQueuedMessage(e,t){return{topic:"topic",partition:0,offset:e,value:""}}createProducer(){return new a(this)}createConsumer(){const e=new i("test","test");return this.consumers.push(e),e}getRawMessages(){return this.messages}addMessage(e,t){const n=this.offset++,r=u.createdQueuedMessage(n);r.value=e,r.topic=t,this.messages.push(r);for(const e of this.consumers)e.emit(r)}getLastMessage(){return this.getMessage(this.messages.length-1)}getMessage(e){return this.messages[e].value}}t.TestKafka=u},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testPublisher.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestPublisher=t.TestTopic=void 0;const r=n("./node_modules/events/events.js");class o{constructor(){this.events=new Map}emit(e,...t){this.events.has(e)||this.events.set(e,[]),this.events.get(e).push({args:t,event:e})}getEvents(e){return this.events.get(e)}}t.TestTopic=o,t.TestPublisher=class{constructor(){this.events=new r.EventEmitter,this.topics={}}on(e,t){this.events.on(e,t)}to(e){return e in this.topics||(this.topics[e]=new o),this.topics[e]}async close(){}}},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testTenantManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestTenantManager=t.TestTenant=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/index.js"),o=n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testHistorian.js"),s=n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testCollection.js");class i{constructor(e,t,n){this.url=e,this.historianUrl=t,this.owner="test",this.repository="test";const s=new o.TestHistorian(n);this.manager=new r.GitManager(s)}get gitManager(){return this.manager}get storage(){return{historianUrl:this.historianUrl,internalHistorianUrl:this.historianUrl,credentials:null,owner:this.owner,repository:this.repository,url:this.url}}get orderer(){return{type:"kafka",url:this.url}}}t.TestTenant=i,t.TestTenantManager=class{constructor(e="http://test",t="http://historian",n=new s.TestDb({})){this.tenant=new i(e,t,n)}createTenant(e){return Promise.resolve({id:"test-tenant",storage:this.tenant.storage,orderer:this.tenant.orderer,key:"test-tenant-key",customData:{}})}verifyToken(e){return Promise.resolve()}getTenant(e){return Promise.resolve(this.tenant)}getKey(e){return Promise.resolve("test")}}},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testThrottleStorageManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestThrottleStorageManager=void 0,t.TestThrottleStorageManager=class{constructor(){this.cache={}}async setThrottlingMetric(e,t){this.cache[e]=t}async getThrottlingMetric(e){return this.cache[e]}}},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testThrottler.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestThrottler=void 0;const r=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js");t.TestThrottler=class{constructor(e){this.limit=e,this.throttleCounts=new Map}incrementCount(e,t=1){const n=this.throttleCounts.get(e)||0;this.checkThrottled(n);const r=n+t;this.throttleCounts.set(e,r),this.checkThrottled(r)}decrementCount(e,t=1){const n=(this.throttleCounts.get(e)||0)-t;this.throttleCounts.set(e,n)}checkThrottled(e){if(this.limit&&e>this.limit)throw new r.ThrottlingError("throttled",e-this.limit)}}},"../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/testThrottlerHelper.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestThrottlerHelper=void 0,t.TestThrottlerHelper=class{constructor(e){this.opsPerMs=e,this.throttleStorage={}}async updateCount(e,t){const n=Date.now(),r=this.throttleStorage[e]||{count:this.opsPerMs,lastCoolDownAt:n,throttleStatus:!1,throttleReason:void 0,retryAfterInMs:0},o=n-r.lastCoolDownAt;if(r.count+=Math.floor(o*this.opsPerMs),r.lastCoolDownAt=n,r.count-=t,r.count<0){const e=Math.abs(r.count);r.throttleStatus=!0,r.retryAfterInMs=e/this.opsPerMs,r.throttleReason=`Count exceeded by ${e} at ${n}`}else r.throttleStatus=!1,r.retryAfterInMs=0,r.throttleReason=void 0;return this.throttleStorage[e]=r,this.getThrottlerResponseFromThrottlingMetrics(r)}async getThrottleStatus(e){const t=this.throttleStorage[e];if(t)return this.getThrottlerResponseFromThrottlingMetrics(t)}getThrottlerResponseFromThrottlingMetrics(e){return{throttleStatus:e.throttleStatus,throttleReason:e.throttleReason,retryAfterInMs:e.retryAfterInMs}}}},"../notebook-dds/node_modules/@fluidframework/server-test-utils/node_modules/lodash/lodash.js":function(e,t,n){(function(e,r){var o;(function(){var s,i="Expected a function",a="__lodash_hash_undefined__",u="__lodash_placeholder__",c=32,d=128,l=1/0,h=9007199254740991,f=NaN,m=4294967295,p=[["ary",d],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",c],["partialRight",64],["rearg",256]],g="[object Arguments]",b="[object Array]",v="[object Boolean]",y="[object Date]",_="[object Error]",w="[object Function]",k="[object GeneratorFunction]",S="[object Map]",j="[object Number]",C="[object Object]",x="[object Promise]",O="[object RegExp]",E="[object Set]",I="[object String]",A="[object Symbol]",N="[object WeakMap]",T="[object ArrayBuffer]",F="[object DataView]",P="[object Float32Array]",R="[object Float64Array]",D="[object Int8Array]",M="[object Int16Array]",L="[object Int32Array]",B="[object Uint8Array]",q="[object Uint8ClampedArray]",z="[object Uint16Array]",H="[object Uint32Array]",U=/\b__p \+= '';/g,V=/\b(__p \+=) '' \+/g,$=/(__e\(.*?\)|\b__t\)) \+\n'';/g,W=/&(?:amp|lt|gt|quot|#39);/g,K=/[&<>"']/g,G=RegExp(W.source),J=RegExp(K.source),Z=/<%-([\s\S]+?)%>/g,X=/<%([\s\S]+?)%>/g,Y=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ee=/^\w*$/,te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ne=/[\\^$.*+?()[\]{}|]/g,re=RegExp(ne.source),oe=/^\s+|\s+$/g,se=/^\s+/,ie=/\s+$/,ae=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ue=/\{\n\/\* \[wrapped with (.+)\] \*/,ce=/,? & /,de=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,le=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,me=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,be=/^0o[0-7]+$/i,ve=/^(?:0|[1-9]\d*)$/,ye=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_e=/($^)/,we=/['\n\r\u2028\u2029\\]/g,ke="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Se="a-z\\xdf-\\xf6\\xf8-\\xff",je="A-Z\\xc0-\\xd6\\xd8-\\xde",Ce="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",xe="["+Ce+"]",Oe="["+ke+"]",Ee="\\d+",Ie="["+Se+"]",Ae="[^\\ud800-\\udfff"+Ce+Ee+"\\u2700-\\u27bf"+Se+je+"]",Ne="\\ud83c[\\udffb-\\udfff]",Te="[^\\ud800-\\udfff]",Fe="(?:\\ud83c[\\udde6-\\uddff]){2}",Pe="[\\ud800-\\udbff][\\udc00-\\udfff]",Re="["+je+"]",De="(?:"+Ie+"|"+Ae+")",Me="(?:"+Re+"|"+Ae+")",Le="(?:['](?:d|ll|m|re|s|t|ve))?",Be="(?:['](?:D|LL|M|RE|S|T|VE))?",qe="(?:"+Oe+"|"+Ne+")?",ze="[\\ufe0e\\ufe0f]?",He=ze+qe+"(?:\\u200d(?:"+[Te,Fe,Pe].join("|")+")"+ze+qe+")*",Ue="(?:"+["[\\u2700-\\u27bf]",Fe,Pe].join("|")+")"+He,Ve="(?:"+[Te+Oe+"?",Oe,Fe,Pe,"[\\ud800-\\udfff]"].join("|")+")",$e=RegExp("[']","g"),We=RegExp(Oe,"g"),Ke=RegExp(Ne+"(?="+Ne+")|"+Ve+He,"g"),Ge=RegExp([Re+"?"+Ie+"+"+Le+"(?="+[xe,Re,"$"].join("|")+")",Me+"+"+Be+"(?="+[xe,Re+De,"$"].join("|")+")",Re+"?"+De+"+"+Le,Re+"+"+Be,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ee,Ue].join("|"),"g"),Je=RegExp("[\\u200d\\ud800-\\udfff"+ke+"\\ufe0e\\ufe0f]"),Ze=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ye=-1,Qe={};Qe[P]=Qe[R]=Qe[D]=Qe[M]=Qe[L]=Qe[B]=Qe[q]=Qe[z]=Qe[H]=!0,Qe[g]=Qe[b]=Qe[T]=Qe[v]=Qe[F]=Qe[y]=Qe[_]=Qe[w]=Qe[S]=Qe[j]=Qe[C]=Qe[O]=Qe[E]=Qe[I]=Qe[N]=!1;var et={};et[g]=et[b]=et[T]=et[F]=et[v]=et[y]=et[P]=et[R]=et[D]=et[M]=et[L]=et[S]=et[j]=et[C]=et[O]=et[E]=et[I]=et[A]=et[B]=et[q]=et[z]=et[H]=!0,et[_]=et[w]=et[N]=!1;var tt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},nt=parseFloat,rt=parseInt,ot="object"==typeof e&&e&&e.Object===Object&&e,st="object"==typeof self&&self&&self.Object===Object&&self,it=ot||st||Function("return this")(),at=t&&!t.nodeType&&t,ut=at&&"object"==typeof r&&r&&!r.nodeType&&r,ct=ut&&ut.exports===at,dt=ct&&ot.process,lt=function(){try{return ut&&ut.require&&ut.require("util").types||dt&&dt.binding&&dt.binding("util")}catch(e){}}(),ht=lt&&lt.isArrayBuffer,ft=lt&&lt.isDate,mt=lt&&lt.isMap,pt=lt&&lt.isRegExp,gt=lt&&lt.isSet,bt=lt&&lt.isTypedArray;function vt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function yt(e,t,n,r){for(var o=-1,s=null==e?0:e.length;++o<s;){var i=e[o];t(r,i,n(i),e)}return r}function _t(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function wt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function kt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function St(e,t){for(var n=-1,r=null==e?0:e.length,o=0,s=[];++n<r;){var i=e[n];t(i,n,e)&&(s[o++]=i)}return s}function jt(e,t){return!(null==e||!e.length)&&Pt(e,t,0)>-1}function Ct(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}function xt(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}function Ot(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function Et(e,t,n,r){var o=-1,s=null==e?0:e.length;for(r&&s&&(n=e[++o]);++o<s;)n=t(n,e[o],o,e);return n}function It(e,t,n,r){var o=null==e?0:e.length;for(r&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}function At(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Nt=Lt("length");function Tt(e,t,n){var r;return n(e,(function(e,n,o){if(t(e,n,o))return r=n,!1})),r}function Ft(e,t,n,r){for(var o=e.length,s=n+(r?1:-1);r?s--:++s<o;)if(t(e[s],s,e))return s;return-1}function Pt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t,n):Ft(e,Dt,n)}function Rt(e,t,n,r){for(var o=n-1,s=e.length;++o<s;)if(r(e[o],t))return o;return-1}function Dt(e){return e!=e}function Mt(e,t){var n=null==e?0:e.length;return n?zt(e,t)/n:f}function Lt(e){return function(t){return null==t?s:t[e]}}function Bt(e){return function(t){return null==e?s:e[t]}}function qt(e,t,n,r,o){return o(e,(function(e,o,s){n=r?(r=!1,e):t(n,e,o,s)})),n}function zt(e,t){for(var n,r=-1,o=e.length;++r<o;){var i=t(e[r]);i!==s&&(n=n===s?i:n+i)}return n}function Ht(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Ut(e){return function(t){return e(t)}}function Vt(e,t){return xt(t,(function(t){return e[t]}))}function $t(e,t){return e.has(t)}function Wt(e,t){for(var n=-1,r=e.length;++n<r&&Pt(t,e[n],0)>-1;);return n}function Kt(e,t){for(var n=e.length;n--&&Pt(t,e[n],0)>-1;);return n}function Gt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Jt=Bt({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),Zt=Bt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Xt(e){return"\\"+tt[e]}function Yt(e){return Je.test(e)}function Qt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function en(e,t){return function(n){return e(t(n))}}function tn(e,t){for(var n=-1,r=e.length,o=0,s=[];++n<r;){var i=e[n];i!==t&&i!==u||(e[n]=u,s[o++]=n)}return s}function nn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function rn(e){return Yt(e)?function(e){for(var t=Ke.lastIndex=0;Ke.test(e);)++t;return t}(e):Nt(e)}function on(e){return Yt(e)?function(e){return e.match(Ke)||[]}(e):function(e){return e.split("")}(e)}var sn=Bt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),an=function e(t){var n=(t=null==t?it:an.defaults(it.Object(),t,an.pick(it,Xe))).Array,r=t.Date,o=t.Error,ke=t.Function,Se=t.Math,je=t.Object,Ce=t.RegExp,xe=t.String,Oe=t.TypeError,Ee=n.prototype,Ie=ke.prototype,Ae=je.prototype,Ne=t["__core-js_shared__"],Te=Ie.toString,Fe=Ae.hasOwnProperty,Pe=0,Re=function(){var e=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),De=Ae.toString,Me=Te.call(je),Le=it._,Be=Ce("^"+Te.call(Fe).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=ct?t.Buffer:s,ze=t.Symbol,He=t.Uint8Array,Ue=qe?qe.allocUnsafe:s,Ve=en(je.getPrototypeOf,je),Ke=je.create,Je=Ae.propertyIsEnumerable,tt=Ee.splice,ot=ze?ze.isConcatSpreadable:s,st=ze?ze.iterator:s,at=ze?ze.toStringTag:s,ut=function(){try{var e=as(je,"defineProperty");return e({},"",{}),e}catch(e){}}(),dt=t.clearTimeout!==it.clearTimeout&&t.clearTimeout,lt=r&&r.now!==it.Date.now&&r.now,Nt=t.setTimeout!==it.setTimeout&&t.setTimeout,Bt=Se.ceil,un=Se.floor,cn=je.getOwnPropertySymbols,dn=qe?qe.isBuffer:s,ln=t.isFinite,hn=Ee.join,fn=en(je.keys,je),mn=Se.max,pn=Se.min,gn=r.now,bn=t.parseInt,vn=Se.random,yn=Ee.reverse,_n=as(t,"DataView"),wn=as(t,"Map"),kn=as(t,"Promise"),Sn=as(t,"Set"),jn=as(t,"WeakMap"),Cn=as(je,"create"),xn=jn&&new jn,On={},En=Ps(_n),In=Ps(wn),An=Ps(kn),Nn=Ps(Sn),Tn=Ps(jn),Fn=ze?ze.prototype:s,Pn=Fn?Fn.valueOf:s,Rn=Fn?Fn.toString:s;function Dn(e){if(Xi(e)&&!qi(e)&&!(e instanceof qn)){if(e instanceof Bn)return e;if(Fe.call(e,"__wrapped__"))return Rs(e)}return new Bn(e)}var Mn=function(){function e(){}return function(t){if(!Zi(t))return{};if(Ke)return Ke(t);e.prototype=t;var n=new e;return e.prototype=s,n}}();function Ln(){}function Bn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=s}function qn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=m,this.__views__=[]}function zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Un(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Un;++t<n;)this.add(e[t])}function $n(e){var t=this.__data__=new Hn(e);this.size=t.size}function Wn(e,t){var n=qi(e),r=!n&&Bi(e),o=!n&&!r&&Vi(e),s=!n&&!r&&!o&&sa(e),i=n||r||o||s,a=i?Ht(e.length,xe):[],u=a.length;for(var c in e)!t&&!Fe.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ms(c,u))||a.push(c);return a}function Kn(e){var t=e.length;return t?e[Ur(0,t-1)]:s}function Gn(e,t){return Ns(Co(e),rr(t,0,e.length))}function Jn(e){return Ns(Co(e))}function Zn(e,t,n){(n!==s&&!Di(e[t],n)||n===s&&!(t in e))&&tr(e,t,n)}function Xn(e,t,n){var r=e[t];Fe.call(e,t)&&Di(r,n)&&(n!==s||t in e)||tr(e,t,n)}function Yn(e,t){for(var n=e.length;n--;)if(Di(e[n][0],t))return n;return-1}function Qn(e,t,n,r){return ur(e,(function(e,o,s){t(r,e,n(e),s)})),r}function er(e,t){return e&&xo(t,Oa(t),e)}function tr(e,t,n){"__proto__"==t&&ut?ut(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function nr(e,t){for(var r=-1,o=t.length,i=n(o),a=null==e;++r<o;)i[r]=a?s:ka(e,t[r]);return i}function rr(e,t,n){return e==e&&(n!==s&&(e=e<=n?e:n),t!==s&&(e=e>=t?e:t)),e}function or(e,t,n,r,o,i){var a,u=1&t,c=2&t,d=4&t;if(n&&(a=o?n(e,r,o,i):n(e)),a!==s)return a;if(!Zi(e))return e;var l=qi(e);if(l){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Fe.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!u)return Co(e,a)}else{var h=ds(e),f=h==w||h==k;if(Vi(e))return yo(e,u);if(h==C||h==g||f&&!o){if(a=c||f?{}:hs(e),!u)return c?function(e,t){return xo(e,cs(e),t)}(e,function(e,t){return e&&xo(t,Ea(t),e)}(a,e)):function(e,t){return xo(e,us(e),t)}(e,er(a,e))}else{if(!et[h])return o?e:{};a=function(e,t,n){var r,o=e.constructor;switch(t){case T:return _o(e);case v:case y:return new o(+e);case F:return function(e,t){var n=t?_o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case P:case R:case D:case M:case L:case B:case q:case z:case H:return wo(e,n);case S:return new o;case j:case I:return new o(e);case O:return function(e){var t=new e.constructor(e.source,fe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case E:return new o;case A:return r=e,Pn?je(Pn.call(r)):{}}}(e,h,u)}}i||(i=new $n);var m=i.get(e);if(m)return m;i.set(e,a),na(e)?e.forEach((function(r){a.add(or(r,t,n,r,e,i))})):Yi(e)&&e.forEach((function(r,o){a.set(o,or(r,t,n,o,e,i))}));var p=l?s:(d?c?es:Qo:c?Ea:Oa)(e);return _t(p||e,(function(r,o){p&&(r=e[o=r]),Xn(a,o,or(r,t,n,o,e,i))})),a}function sr(e,t,n){var r=n.length;if(null==e)return!r;for(e=je(e);r--;){var o=n[r],i=t[o],a=e[o];if(a===s&&!(o in e)||!i(a))return!1}return!0}function ir(e,t,n){if("function"!=typeof e)throw new Oe(i);return Os((function(){e.apply(s,n)}),t)}function ar(e,t,n,r){var o=-1,s=jt,i=!0,a=e.length,u=[],c=t.length;if(!a)return u;n&&(t=xt(t,Ut(n))),r?(s=Ct,i=!1):t.length>=200&&(s=$t,i=!1,t=new Vn(t));e:for(;++o<a;){var d=e[o],l=null==n?d:n(d);if(d=r||0!==d?d:0,i&&l==l){for(var h=c;h--;)if(t[h]===l)continue e;u.push(d)}else s(t,l,r)||u.push(d)}return u}Dn.templateSettings={escape:Z,evaluate:X,interpolate:Y,variable:"",imports:{_:Dn}},Dn.prototype=Ln.prototype,Dn.prototype.constructor=Dn,Bn.prototype=Mn(Ln.prototype),Bn.prototype.constructor=Bn,qn.prototype=Mn(Ln.prototype),qn.prototype.constructor=qn,zn.prototype.clear=function(){this.__data__=Cn?Cn(null):{},this.size=0},zn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},zn.prototype.get=function(e){var t=this.__data__;if(Cn){var n=t[e];return n===a?s:n}return Fe.call(t,e)?t[e]:s},zn.prototype.has=function(e){var t=this.__data__;return Cn?t[e]!==s:Fe.call(t,e)},zn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Cn&&t===s?a:t,this},Hn.prototype.clear=function(){this.__data__=[],this.size=0},Hn.prototype.delete=function(e){var t=this.__data__,n=Yn(t,e);return!(n<0||(n==t.length-1?t.pop():tt.call(t,n,1),--this.size,0))},Hn.prototype.get=function(e){var t=this.__data__,n=Yn(t,e);return n<0?s:t[n][1]},Hn.prototype.has=function(e){return Yn(this.__data__,e)>-1},Hn.prototype.set=function(e,t){var n=this.__data__,r=Yn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Un.prototype.clear=function(){this.size=0,this.__data__={hash:new zn,map:new(wn||Hn),string:new zn}},Un.prototype.delete=function(e){var t=ss(this,e).delete(e);return this.size-=t?1:0,t},Un.prototype.get=function(e){return ss(this,e).get(e)},Un.prototype.has=function(e){return ss(this,e).has(e)},Un.prototype.set=function(e,t){var n=ss(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Vn.prototype.add=Vn.prototype.push=function(e){return this.__data__.set(e,a),this},Vn.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.clear=function(){this.__data__=new Hn,this.size=0},$n.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},$n.prototype.get=function(e){return this.__data__.get(e)},$n.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Hn){var r=n.__data__;if(!wn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Un(r)}return n.set(e,t),this.size=n.size,this};var ur=Io(gr),cr=Io(br,!0);function dr(e,t){var n=!0;return ur(e,(function(e,r,o){return n=!!t(e,r,o)})),n}function lr(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(null!=a&&(u===s?a==a&&!oa(a):n(a,u)))var u=a,c=i}return c}function hr(e,t){var n=[];return ur(e,(function(e,r,o){t(e,r,o)&&n.push(e)})),n}function fr(e,t,n,r,o){var s=-1,i=e.length;for(n||(n=fs),o||(o=[]);++s<i;){var a=e[s];t>0&&n(a)?t>1?fr(a,t-1,n,r,o):Ot(o,a):r||(o[o.length]=a)}return o}var mr=Ao(),pr=Ao(!0);function gr(e,t){return e&&mr(e,t,Oa)}function br(e,t){return e&&pr(e,t,Oa)}function vr(e,t){return St(t,(function(t){return Ki(e[t])}))}function yr(e,t){for(var n=0,r=(t=po(t,e)).length;null!=e&&n<r;)e=e[Fs(t[n++])];return n&&n==r?e:s}function _r(e,t,n){var r=t(e);return qi(e)?r:Ot(r,n(e))}function wr(e){return null==e?e===s?"[object Undefined]":"[object Null]":at&&at in je(e)?function(e){var t=Fe.call(e,at),n=e[at];try{e[at]=s;var r=!0}catch(e){}var o=De.call(e);return r&&(t?e[at]=n:delete e[at]),o}(e):function(e){return De.call(e)}(e)}function kr(e,t){return e>t}function Sr(e,t){return null!=e&&Fe.call(e,t)}function jr(e,t){return null!=e&&t in je(e)}function Cr(e,t,r){for(var o=r?Ct:jt,i=e[0].length,a=e.length,u=a,c=n(a),d=1/0,l=[];u--;){var h=e[u];u&&t&&(h=xt(h,Ut(t))),d=pn(h.length,d),c[u]=!r&&(t||i>=120&&h.length>=120)?new Vn(u&&h):s}h=e[0];var f=-1,m=c[0];e:for(;++f<i&&l.length<d;){var p=h[f],g=t?t(p):p;if(p=r||0!==p?p:0,!(m?$t(m,g):o(l,g,r))){for(u=a;--u;){var b=c[u];if(!(b?$t(b,g):o(e[u],g,r)))continue e}m&&m.push(g),l.push(p)}}return l}function xr(e,t,n){var r=null==(e=Ss(e,t=po(t,e)))?e:e[Fs(Ws(t))];return null==r?s:vt(r,e,n)}function Or(e){return Xi(e)&&wr(e)==g}function Er(e,t,n,r,o){return e===t||(null==e||null==t||!Xi(e)&&!Xi(t)?e!=e&&t!=t:function(e,t,n,r,o,i){var a=qi(e),u=qi(t),c=a?b:ds(e),d=u?b:ds(t),l=(c=c==g?C:c)==C,h=(d=d==g?C:d)==C,f=c==d;if(f&&Vi(e)){if(!Vi(t))return!1;a=!0,l=!1}if(f&&!l)return i||(i=new $n),a||sa(e)?Xo(e,t,n,r,o,i):function(e,t,n,r,o,s,i){switch(n){case F:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!s(new He(e),new He(t)));case v:case y:case j:return Di(+e,+t);case _:return e.name==t.name&&e.message==t.message;case O:case I:return e==t+"";case S:var a=Qt;case E:var u=1&r;if(a||(a=nn),e.size!=t.size&&!u)return!1;var c=i.get(e);if(c)return c==t;r|=2,i.set(e,t);var d=Xo(a(e),a(t),r,o,s,i);return i.delete(e),d;case A:if(Pn)return Pn.call(e)==Pn.call(t)}return!1}(e,t,c,n,r,o,i);if(!(1&n)){var m=l&&Fe.call(e,"__wrapped__"),p=h&&Fe.call(t,"__wrapped__");if(m||p){var w=m?e.value():e,k=p?t.value():t;return i||(i=new $n),o(w,k,n,r,i)}}return!!f&&(i||(i=new $n),function(e,t,n,r,o,i){var a=1&n,u=Qo(e),c=u.length;if(c!=Qo(t).length&&!a)return!1;for(var d=c;d--;){var l=u[d];if(!(a?l in t:Fe.call(t,l)))return!1}var h=i.get(e),f=i.get(t);if(h&&f)return h==t&&f==e;var m=!0;i.set(e,t),i.set(t,e);for(var p=a;++d<c;){var g=e[l=u[d]],b=t[l];if(r)var v=a?r(b,g,l,t,e,i):r(g,b,l,e,t,i);if(!(v===s?g===b||o(g,b,n,r,i):v)){m=!1;break}p||(p="constructor"==l)}if(m&&!p){var y=e.constructor,_=t.constructor;y==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _||(m=!1)}return i.delete(e),i.delete(t),m}(e,t,n,r,o,i))}(e,t,n,r,Er,o))}function Ir(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=je(e);o--;){var u=n[o];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<i;){var c=(u=n[o])[0],d=e[c],l=u[1];if(a&&u[2]){if(d===s&&!(c in e))return!1}else{var h=new $n;if(r)var f=r(d,l,c,e,t,h);if(!(f===s?Er(l,d,3,r,h):f))return!1}}return!0}function Ar(e){return!(!Zi(e)||(t=e,Re&&Re in t))&&(Ki(e)?Be:ge).test(Ps(e));var t}function Nr(e){return"function"==typeof e?e:null==e?Qa:"object"==typeof e?qi(e)?Dr(e[0],e[1]):Rr(e):uu(e)}function Tr(e){if(!ys(e))return fn(e);var t=[];for(var n in je(e))Fe.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Fr(e,t){return e<t}function Pr(e,t){var r=-1,o=Hi(e)?n(e.length):[];return ur(e,(function(e,n,s){o[++r]=t(e,n,s)})),o}function Rr(e){var t=is(e);return 1==t.length&&t[0][2]?ws(t[0][0],t[0][1]):function(n){return n===e||Ir(n,e,t)}}function Dr(e,t){return gs(e)&&_s(t)?ws(Fs(e),t):function(n){var r=ka(n,e);return r===s&&r===t?Sa(n,e):Er(t,r,3)}}function Mr(e,t,n,r,o){e!==t&&mr(t,(function(i,a){if(o||(o=new $n),Zi(i))!function(e,t,n,r,o,i,a){var u=Cs(e,n),c=Cs(t,n),d=a.get(c);if(d)Zn(e,n,d);else{var l=i?i(u,c,n+"",e,t,a):s,h=l===s;if(h){var f=qi(c),m=!f&&Vi(c),p=!f&&!m&&sa(c);l=c,f||m||p?qi(u)?l=u:Ui(u)?l=Co(u):m?(h=!1,l=yo(c,!0)):p?(h=!1,l=wo(c,!0)):l=[]:ea(c)||Bi(c)?(l=u,Bi(u)?l=fa(u):Zi(u)&&!Ki(u)||(l=hs(c))):h=!1}h&&(a.set(c,l),o(l,c,r,i,a),a.delete(c)),Zn(e,n,l)}}(e,t,a,n,Mr,r,o);else{var u=r?r(Cs(e,a),i,a+"",e,t,o):s;u===s&&(u=i),Zn(e,a,u)}}),Ea)}function Lr(e,t){var n=e.length;if(n)return ms(t+=t<0?n:0,n)?e[t]:s}function Br(e,t,n){t=t.length?xt(t,(function(e){return qi(e)?function(t){return yr(t,1===e.length?e[0]:e)}:e})):[Qa];var r=-1;return t=xt(t,Ut(os())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Pr(e,(function(e,n,o){return{criteria:xt(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){for(var r=-1,o=e.criteria,s=t.criteria,i=o.length,a=n.length;++r<i;){var u=ko(o[r],s[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function qr(e,t,n){for(var r=-1,o=t.length,s={};++r<o;){var i=t[r],a=yr(e,i);n(a,i)&&Gr(s,po(i,e),a)}return s}function zr(e,t,n,r){var o=r?Rt:Pt,s=-1,i=t.length,a=e;for(e===t&&(t=Co(t)),n&&(a=xt(e,Ut(n)));++s<i;)for(var u=0,c=t[s],d=n?n(c):c;(u=o(a,d,u,r))>-1;)a!==e&&tt.call(a,u,1),tt.call(e,u,1);return e}function Hr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o=t[n];if(n==r||o!==s){var s=o;ms(o)?tt.call(e,o,1):io(e,o)}}return e}function Ur(e,t){return e+un(vn()*(t-e+1))}function Vr(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=un(t/2))&&(e+=e)}while(t);return n}function $r(e,t){return Es(ks(e,t,Qa),e+"")}function Wr(e){return Kn(Da(e))}function Kr(e,t){var n=Da(e);return Ns(n,rr(t,0,n.length))}function Gr(e,t,n,r){if(!Zi(e))return e;for(var o=-1,i=(t=po(t,e)).length,a=i-1,u=e;null!=u&&++o<i;){var c=Fs(t[o]),d=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var l=u[c];(d=r?r(l,c,u):s)===s&&(d=Zi(l)?l:ms(t[o+1])?[]:{})}Xn(u,c,d),u=u[c]}return e}var Jr=xn?function(e,t){return xn.set(e,t),e}:Qa,Zr=ut?function(e,t){return ut(e,"toString",{configurable:!0,enumerable:!1,value:Za(t),writable:!0})}:Qa;function Xr(e){return Ns(Da(e))}function Yr(e,t,r){var o=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(r=r>s?s:r)<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var i=n(s);++o<s;)i[o]=e[o+t];return i}function Qr(e,t){var n;return ur(e,(function(e,r,o){return!(n=t(e,r,o))})),!!n}function eo(e,t,n){var r=0,o=null==e?r:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;r<o;){var s=r+o>>>1,i=e[s];null!==i&&!oa(i)&&(n?i<=t:i<t)?r=s+1:o=s}return o}return to(e,t,Qa,n)}function to(e,t,n,r){var o=0,i=null==e?0:e.length;if(0===i)return 0;for(var a=(t=n(t))!==t,u=null===t,c=oa(t),d=t===s;o<i;){var l=un((o+i)/2),h=n(e[l]),f=h!==s,m=null===h,p=h==h,g=oa(h);if(a)var b=r||p;else b=d?p&&(r||f):u?p&&f&&(r||!m):c?p&&f&&!m&&(r||!g):!m&&!g&&(r?h<=t:h<t);b?o=l+1:i=l}return pn(i,4294967294)}function no(e,t){for(var n=-1,r=e.length,o=0,s=[];++n<r;){var i=e[n],a=t?t(i):i;if(!n||!Di(a,u)){var u=a;s[o++]=0===i?0:i}}return s}function ro(e){return"number"==typeof e?e:oa(e)?f:+e}function oo(e){if("string"==typeof e)return e;if(qi(e))return xt(e,oo)+"";if(oa(e))return Rn?Rn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function so(e,t,n){var r=-1,o=jt,s=e.length,i=!0,a=[],u=a;if(n)i=!1,o=Ct;else if(s>=200){var c=t?null:$o(e);if(c)return nn(c);i=!1,o=$t,u=new Vn}else u=t?[]:a;e:for(;++r<s;){var d=e[r],l=t?t(d):d;if(d=n||0!==d?d:0,i&&l==l){for(var h=u.length;h--;)if(u[h]===l)continue e;t&&u.push(l),a.push(d)}else o(u,l,n)||(u!==a&&u.push(l),a.push(d))}return a}function io(e,t){return null==(e=Ss(e,t=po(t,e)))||delete e[Fs(Ws(t))]}function ao(e,t,n,r){return Gr(e,t,n(yr(e,t)),r)}function uo(e,t,n,r){for(var o=e.length,s=r?o:-1;(r?s--:++s<o)&&t(e[s],s,e););return n?Yr(e,r?0:s,r?s+1:o):Yr(e,r?s+1:0,r?o:s)}function co(e,t){var n=e;return n instanceof qn&&(n=n.value()),Et(t,(function(e,t){return t.func.apply(t.thisArg,Ot([e],t.args))}),n)}function lo(e,t,r){var o=e.length;if(o<2)return o?so(e[0]):[];for(var s=-1,i=n(o);++s<o;)for(var a=e[s],u=-1;++u<o;)u!=s&&(i[s]=ar(i[s]||a,e[u],t,r));return so(fr(i,1),t,r)}function ho(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var u=r<i?t[r]:s;n(a,e[r],u)}return a}function fo(e){return Ui(e)?e:[]}function mo(e){return"function"==typeof e?e:Qa}function po(e,t){return qi(e)?e:gs(e,t)?[e]:Ts(ma(e))}var go=$r;function bo(e,t,n){var r=e.length;return n=n===s?r:n,!t&&n>=r?e:Yr(e,t,n)}var vo=dt||function(e){return it.clearTimeout(e)};function yo(e,t){if(t)return e.slice();var n=e.length,r=Ue?Ue(n):new e.constructor(n);return e.copy(r),r}function _o(e){var t=new e.constructor(e.byteLength);return new He(t).set(new He(e)),t}function wo(e,t){var n=t?_o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ko(e,t){if(e!==t){var n=e!==s,r=null===e,o=e==e,i=oa(e),a=t!==s,u=null===t,c=t==t,d=oa(t);if(!u&&!d&&!i&&e>t||i&&a&&c&&!u&&!d||r&&a&&c||!n&&c||!o)return 1;if(!r&&!i&&!d&&e<t||d&&n&&o&&!r&&!i||u&&n&&o||!a&&o||!c)return-1}return 0}function So(e,t,r,o){for(var s=-1,i=e.length,a=r.length,u=-1,c=t.length,d=mn(i-a,0),l=n(c+d),h=!o;++u<c;)l[u]=t[u];for(;++s<a;)(h||s<i)&&(l[r[s]]=e[s]);for(;d--;)l[u++]=e[s++];return l}function jo(e,t,r,o){for(var s=-1,i=e.length,a=-1,u=r.length,c=-1,d=t.length,l=mn(i-u,0),h=n(l+d),f=!o;++s<l;)h[s]=e[s];for(var m=s;++c<d;)h[m+c]=t[c];for(;++a<u;)(f||s<i)&&(h[m+r[a]]=e[s++]);return h}function Co(e,t){var r=-1,o=e.length;for(t||(t=n(o));++r<o;)t[r]=e[r];return t}function xo(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var u=t[i],c=r?r(n[u],e[u],u,n,e):s;c===s&&(c=e[u]),o?tr(n,u,c):Xn(n,u,c)}return n}function Oo(e,t){return function(n,r){var o=qi(n)?yt:Qn,s=t?t():{};return o(n,e,os(r,2),s)}}function Eo(e){return $r((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:s,a=o>2?n[2]:s;for(i=e.length>3&&"function"==typeof i?(o--,i):s,a&&ps(n[0],n[1],a)&&(i=o<3?s:i,o=1),t=je(t);++r<o;){var u=n[r];u&&e(t,u,r,i)}return t}))}function Io(e,t){return function(n,r){if(null==n)return n;if(!Hi(n))return e(n,r);for(var o=n.length,s=t?o:-1,i=je(n);(t?s--:++s<o)&&!1!==r(i[s],s,i););return n}}function Ao(e){return function(t,n,r){for(var o=-1,s=je(t),i=r(t),a=i.length;a--;){var u=i[e?a:++o];if(!1===n(s[u],u,s))break}return t}}function No(e){return function(t){var n=Yt(t=ma(t))?on(t):s,r=n?n[0]:t.charAt(0),o=n?bo(n,1).join(""):t.slice(1);return r[e]()+o}}function To(e){return function(t){return Et(Ka(Ba(t).replace($e,"")),e,"")}}function Fo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Mn(e.prototype),r=e.apply(n,t);return Zi(r)?r:n}}function Po(e){return function(t,n,r){var o=je(t);if(!Hi(t)){var i=os(n,3);t=Oa(t),n=function(e){return i(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[i?t[a]:a]:s}}function Ro(e){return Yo((function(t){var n=t.length,r=n,o=Bn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Oe(i);if(o&&!u&&"wrapper"==ns(a))var u=new Bn([],!0)}for(r=u?r:n;++r<n;){var c=ns(a=t[r]),d="wrapper"==c?ts(a):s;u=d&&bs(d[0])&&424==d[1]&&!d[4].length&&1==d[9]?u[ns(d[0])].apply(u,d[3]):1==a.length&&bs(a)?u[c]():u.thru(a)}return function(){var e=arguments,r=e[0];if(u&&1==e.length&&qi(r))return u.plant(r).value();for(var o=0,s=n?t[o].apply(this,e):r;++o<n;)s=t[o].call(this,s);return s}}))}function Do(e,t,r,o,i,a,u,c,l,h){var f=t&d,m=1&t,p=2&t,g=24&t,b=512&t,v=p?s:Fo(e);return function s(){for(var d=arguments.length,y=n(d),_=d;_--;)y[_]=arguments[_];if(g)var w=rs(s),k=Gt(y,w);if(o&&(y=So(y,o,i,g)),a&&(y=jo(y,a,u,g)),d-=k,g&&d<h){var S=tn(y,w);return Uo(e,t,Do,s.placeholder,r,y,S,c,l,h-d)}var j=m?r:this,C=p?j[e]:e;return d=y.length,c?y=js(y,c):b&&d>1&&y.reverse(),f&&l<d&&(y.length=l),this&&this!==it&&this instanceof s&&(C=v||Fo(C)),C.apply(j,y)}}function Mo(e,t){return function(n,r){return function(e,t,n,r){return gr(e,(function(e,o,s){t(r,n(e),o,s)})),r}(n,e,t(r),{})}}function Lo(e,t){return function(n,r){var o;if(n===s&&r===s)return t;if(n!==s&&(o=n),r!==s){if(o===s)return r;"string"==typeof n||"string"==typeof r?(n=oo(n),r=oo(r)):(n=ro(n),r=ro(r)),o=e(n,r)}return o}}function Bo(e){return Yo((function(t){return t=xt(t,Ut(os())),$r((function(n){var r=this;return e(t,(function(e){return vt(e,r,n)}))}))}))}function qo(e,t){var n=(t=t===s?" ":oo(t)).length;if(n<2)return n?Vr(t,e):t;var r=Vr(t,Bt(e/rn(t)));return Yt(t)?bo(on(r),0,e).join(""):r.slice(0,e)}function zo(e){return function(t,r,o){return o&&"number"!=typeof o&&ps(t,r,o)&&(r=o=s),t=ca(t),r===s?(r=t,t=0):r=ca(r),function(e,t,r,o){for(var s=-1,i=mn(Bt((t-e)/(r||1)),0),a=n(i);i--;)a[o?i:++s]=e,e+=r;return a}(t,r,o=o===s?t<r?1:-1:ca(o),e)}}function Ho(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ha(t),n=ha(n)),e(t,n)}}function Uo(e,t,n,r,o,i,a,u,d,l){var h=8&t;t|=h?c:64,4&(t&=~(h?64:c))||(t&=-4);var f=[e,t,o,h?i:s,h?a:s,h?s:i,h?s:a,u,d,l],m=n.apply(s,f);return bs(e)&&xs(m,f),m.placeholder=r,Is(m,e,t)}function Vo(e){var t=Se[e];return function(e,n){if(e=ha(e),(n=null==n?0:pn(da(n),292))&&ln(e)){var r=(ma(e)+"e").split("e");return+((r=(ma(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var $o=Sn&&1/nn(new Sn([,-0]))[1]==l?function(e){return new Sn(e)}:ou;function Wo(e){return function(t){var n=ds(t);return n==S?Qt(t):n==E?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return xt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Ko(e,t,r,o,a,l,h,f){var m=2&t;if(!m&&"function"!=typeof e)throw new Oe(i);var p=o?o.length:0;if(p||(t&=-97,o=a=s),h=h===s?h:mn(da(h),0),f=f===s?f:da(f),p-=a?a.length:0,64&t){var g=o,b=a;o=a=s}var v=m?s:ts(e),y=[e,t,r,o,a,g,b,l,h,f];if(v&&function(e,t){var n=e[1],r=t[1],o=n|r,s=o<131,i=r==d&&8==n||r==d&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!s&&!i)return e;1&r&&(e[2]=t[2],o|=1&n?0:4);var a=t[3];if(a){var c=e[3];e[3]=c?So(c,a,t[4]):a,e[4]=c?tn(e[3],u):t[4]}(a=t[5])&&(c=e[5],e[5]=c?jo(c,a,t[6]):a,e[6]=c?tn(e[5],u):t[6]),(a=t[7])&&(e[7]=a),r&d&&(e[8]=null==e[8]?t[8]:pn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o}(y,v),e=y[0],t=y[1],r=y[2],o=y[3],a=y[4],!(f=y[9]=y[9]===s?m?0:e.length:mn(y[9]-p,0))&&24&t&&(t&=-25),t&&1!=t)_=8==t||16==t?function(e,t,r){var o=Fo(e);return function i(){for(var a=arguments.length,u=n(a),c=a,d=rs(i);c--;)u[c]=arguments[c];var l=a<3&&u[0]!==d&&u[a-1]!==d?[]:tn(u,d);return(a-=l.length)<r?Uo(e,t,Do,i.placeholder,s,u,l,s,s,r-a):vt(this&&this!==it&&this instanceof i?o:e,this,u)}}(e,t,f):t!=c&&33!=t||a.length?Do.apply(s,y):function(e,t,r,o){var s=1&t,i=Fo(e);return function t(){for(var a=-1,u=arguments.length,c=-1,d=o.length,l=n(d+u),h=this&&this!==it&&this instanceof t?i:e;++c<d;)l[c]=o[c];for(;u--;)l[c++]=arguments[++a];return vt(h,s?r:this,l)}}(e,t,r,o);else var _=function(e,t,n){var r=1&t,o=Fo(e);return function t(){return(this&&this!==it&&this instanceof t?o:e).apply(r?n:this,arguments)}}(e,t,r);return Is((v?Jr:xs)(_,y),e,t)}function Go(e,t,n,r){return e===s||Di(e,Ae[n])&&!Fe.call(r,n)?t:e}function Jo(e,t,n,r,o,i){return Zi(e)&&Zi(t)&&(i.set(t,e),Mr(e,t,s,Jo,i),i.delete(t)),e}function Zo(e){return ea(e)?s:e}function Xo(e,t,n,r,o,i){var a=1&n,u=e.length,c=t.length;if(u!=c&&!(a&&c>u))return!1;var d=i.get(e),l=i.get(t);if(d&&l)return d==t&&l==e;var h=-1,f=!0,m=2&n?new Vn:s;for(i.set(e,t),i.set(t,e);++h<u;){var p=e[h],g=t[h];if(r)var b=a?r(g,p,h,t,e,i):r(p,g,h,e,t,i);if(b!==s){if(b)continue;f=!1;break}if(m){if(!At(t,(function(e,t){if(!$t(m,t)&&(p===e||o(p,e,n,r,i)))return m.push(t)}))){f=!1;break}}else if(p!==g&&!o(p,g,n,r,i)){f=!1;break}}return i.delete(e),i.delete(t),f}function Yo(e){return Es(ks(e,s,zs),e+"")}function Qo(e){return _r(e,Oa,us)}function es(e){return _r(e,Ea,cs)}var ts=xn?function(e){return xn.get(e)}:ou;function ns(e){for(var t=e.name+"",n=On[t],r=Fe.call(On,t)?n.length:0;r--;){var o=n[r],s=o.func;if(null==s||s==e)return o.name}return t}function rs(e){return(Fe.call(Dn,"placeholder")?Dn:e).placeholder}function os(){var e=Dn.iteratee||eu;return e=e===eu?Nr:e,arguments.length?e(arguments[0],arguments[1]):e}function ss(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function is(e){for(var t=Oa(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,_s(o)]}return t}function as(e,t){var n=function(e,t){return null==e?s:e[t]}(e,t);return Ar(n)?n:s}var us=cn?function(e){return null==e?[]:(e=je(e),St(cn(e),(function(t){return Je.call(e,t)})))}:lu,cs=cn?function(e){for(var t=[];e;)Ot(t,us(e)),e=Ve(e);return t}:lu,ds=wr;function ls(e,t,n){for(var r=-1,o=(t=po(t,e)).length,s=!1;++r<o;){var i=Fs(t[r]);if(!(s=null!=e&&n(e,i)))break;e=e[i]}return s||++r!=o?s:!!(o=null==e?0:e.length)&&Ji(o)&&ms(i,o)&&(qi(e)||Bi(e))}function hs(e){return"function"!=typeof e.constructor||ys(e)?{}:Mn(Ve(e))}function fs(e){return qi(e)||Bi(e)||!!(ot&&e&&e[ot])}function ms(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&ve.test(e))&&e>-1&&e%1==0&&e<t}function ps(e,t,n){if(!Zi(n))return!1;var r=typeof t;return!!("number"==r?Hi(n)&&ms(t,n.length):"string"==r&&t in n)&&Di(n[t],e)}function gs(e,t){if(qi(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!oa(e))||ee.test(e)||!Q.test(e)||null!=t&&e in je(t)}function bs(e){var t=ns(e),n=Dn[t];if("function"!=typeof n||!(t in qn.prototype))return!1;if(e===n)return!0;var r=ts(n);return!!r&&e===r[0]}(_n&&ds(new _n(new ArrayBuffer(1)))!=F||wn&&ds(new wn)!=S||kn&&ds(kn.resolve())!=x||Sn&&ds(new Sn)!=E||jn&&ds(new jn)!=N)&&(ds=function(e){var t=wr(e),n=t==C?e.constructor:s,r=n?Ps(n):"";if(r)switch(r){case En:return F;case In:return S;case An:return x;case Nn:return E;case Tn:return N}return t});var vs=Ne?Ki:hu;function ys(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ae)}function _s(e){return e==e&&!Zi(e)}function ws(e,t){return function(n){return null!=n&&n[e]===t&&(t!==s||e in je(n))}}function ks(e,t,r){return t=mn(t===s?e.length-1:t,0),function(){for(var o=arguments,s=-1,i=mn(o.length-t,0),a=n(i);++s<i;)a[s]=o[t+s];s=-1;for(var u=n(t+1);++s<t;)u[s]=o[s];return u[t]=r(a),vt(e,this,u)}}function Ss(e,t){return t.length<2?e:yr(e,Yr(t,0,-1))}function js(e,t){for(var n=e.length,r=pn(t.length,n),o=Co(e);r--;){var i=t[r];e[r]=ms(i,n)?o[i]:s}return e}function Cs(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var xs=As(Jr),Os=Nt||function(e,t){return it.setTimeout(e,t)},Es=As(Zr);function Is(e,t,n){var r=t+"";return Es(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ae,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return _t(p,(function(n){var r="_."+n[0];t&n[1]&&!jt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ue);return t?t[1].split(ce):[]}(r),n)))}function As(e){var t=0,n=0;return function(){var r=gn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(s,arguments)}}function Ns(e,t){var n=-1,r=e.length,o=r-1;for(t=t===s?r:t;++n<t;){var i=Ur(n,o),a=e[i];e[i]=e[n],e[n]=a}return e.length=t,e}var Ts=function(e){var t=Ai((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(te,(function(e,n,r,o){t.push(r?o.replace(le,"$1"):n||e)})),t}),(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}();function Fs(e){if("string"==typeof e||oa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ps(e){if(null!=e){try{return Te.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Rs(e){if(e instanceof qn)return e.clone();var t=new Bn(e.__wrapped__,e.__chain__);return t.__actions__=Co(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ds=$r((function(e,t){return Ui(e)?ar(e,fr(t,1,Ui,!0)):[]})),Ms=$r((function(e,t){var n=Ws(t);return Ui(n)&&(n=s),Ui(e)?ar(e,fr(t,1,Ui,!0),os(n,2)):[]})),Ls=$r((function(e,t){var n=Ws(t);return Ui(n)&&(n=s),Ui(e)?ar(e,fr(t,1,Ui,!0),s,n):[]}));function Bs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:da(n);return o<0&&(o=mn(r+o,0)),Ft(e,os(t,3),o)}function qs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==s&&(o=da(n),o=n<0?mn(r+o,0):pn(o,r-1)),Ft(e,os(t,3),o,!0)}function zs(e){return null!=e&&e.length?fr(e,1):[]}function Hs(e){return e&&e.length?e[0]:s}var Us=$r((function(e){var t=xt(e,fo);return t.length&&t[0]===e[0]?Cr(t):[]})),Vs=$r((function(e){var t=Ws(e),n=xt(e,fo);return t===Ws(n)?t=s:n.pop(),n.length&&n[0]===e[0]?Cr(n,os(t,2)):[]})),$s=$r((function(e){var t=Ws(e),n=xt(e,fo);return(t="function"==typeof t?t:s)&&n.pop(),n.length&&n[0]===e[0]?Cr(n,s,t):[]}));function Ws(e){var t=null==e?0:e.length;return t?e[t-1]:s}var Ks=$r(Gs);function Gs(e,t){return e&&e.length&&t&&t.length?zr(e,t):e}var Js=Yo((function(e,t){var n=null==e?0:e.length,r=nr(e,t);return Hr(e,xt(t,(function(e){return ms(e,n)?+e:e})).sort(ko)),r}));function Zs(e){return null==e?e:yn.call(e)}var Xs=$r((function(e){return so(fr(e,1,Ui,!0))})),Ys=$r((function(e){var t=Ws(e);return Ui(t)&&(t=s),so(fr(e,1,Ui,!0),os(t,2))})),Qs=$r((function(e){var t=Ws(e);return t="function"==typeof t?t:s,so(fr(e,1,Ui,!0),s,t)}));function ei(e){if(!e||!e.length)return[];var t=0;return e=St(e,(function(e){if(Ui(e))return t=mn(e.length,t),!0})),Ht(t,(function(t){return xt(e,Lt(t))}))}function ti(e,t){if(!e||!e.length)return[];var n=ei(e);return null==t?n:xt(n,(function(e){return vt(t,s,e)}))}var ni=$r((function(e,t){return Ui(e)?ar(e,t):[]})),ri=$r((function(e){return lo(St(e,Ui))})),oi=$r((function(e){var t=Ws(e);return Ui(t)&&(t=s),lo(St(e,Ui),os(t,2))})),si=$r((function(e){var t=Ws(e);return t="function"==typeof t?t:s,lo(St(e,Ui),s,t)})),ii=$r(ei),ai=$r((function(e){var t=e.length,n=t>1?e[t-1]:s;return n="function"==typeof n?(e.pop(),n):s,ti(e,n)}));function ui(e){var t=Dn(e);return t.__chain__=!0,t}function ci(e,t){return t(e)}var di=Yo((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return nr(t,e)};return!(t>1||this.__actions__.length)&&r instanceof qn&&ms(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ci,args:[o],thisArg:s}),new Bn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(s),e}))):this.thru(o)})),li=Oo((function(e,t,n){Fe.call(e,n)?++e[n]:tr(e,n,1)})),hi=Po(Bs),fi=Po(qs);function mi(e,t){return(qi(e)?_t:ur)(e,os(t,3))}function pi(e,t){return(qi(e)?wt:cr)(e,os(t,3))}var gi=Oo((function(e,t,n){Fe.call(e,n)?e[n].push(t):tr(e,n,[t])})),bi=$r((function(e,t,r){var o=-1,s="function"==typeof t,i=Hi(e)?n(e.length):[];return ur(e,(function(e){i[++o]=s?vt(t,e,r):xr(e,t,r)})),i})),vi=Oo((function(e,t,n){tr(e,n,t)}));function yi(e,t){return(qi(e)?xt:Pr)(e,os(t,3))}var _i=Oo((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),wi=$r((function(e,t){if(null==e)return[];var n=t.length;return n>1&&ps(e,t[0],t[1])?t=[]:n>2&&ps(t[0],t[1],t[2])&&(t=[t[0]]),Br(e,fr(t,1),[])})),ki=lt||function(){return it.Date.now()};function Si(e,t,n){return t=n?s:t,t=e&&null==t?e.length:t,Ko(e,d,s,s,s,s,t)}function ji(e,t){var n;if("function"!=typeof t)throw new Oe(i);return e=da(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=s),n}}var Ci=$r((function(e,t,n){var r=1;if(n.length){var o=tn(n,rs(Ci));r|=c}return Ko(e,r,t,n,o)})),xi=$r((function(e,t,n){var r=3;if(n.length){var o=tn(n,rs(xi));r|=c}return Ko(t,r,e,n,o)}));function Oi(e,t,n){var r,o,a,u,c,d,l=0,h=!1,f=!1,m=!0;if("function"!=typeof e)throw new Oe(i);function p(t){var n=r,i=o;return r=o=s,l=t,u=e.apply(i,n)}function g(e){return l=e,c=Os(v,t),h?p(e):u}function b(e){var n=e-d;return d===s||n>=t||n<0||f&&e-l>=a}function v(){var e=ki();if(b(e))return y(e);c=Os(v,function(e){var n=t-(e-d);return f?pn(n,a-(e-l)):n}(e))}function y(e){return c=s,m&&r?p(e):(r=o=s,u)}function _(){var e=ki(),n=b(e);if(r=arguments,o=this,d=e,n){if(c===s)return g(d);if(f)return vo(c),c=Os(v,t),p(d)}return c===s&&(c=Os(v,t)),u}return t=ha(t)||0,Zi(n)&&(h=!!n.leading,a=(f="maxWait"in n)?mn(ha(n.maxWait)||0,t):a,m="trailing"in n?!!n.trailing:m),_.cancel=function(){c!==s&&vo(c),l=0,r=d=o=c=s},_.flush=function(){return c===s?u:y(ki())},_}var Ei=$r((function(e,t){return ir(e,1,t)})),Ii=$r((function(e,t,n){return ir(e,ha(t)||0,n)}));function Ai(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Oe(i);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],s=n.cache;if(s.has(o))return s.get(o);var i=e.apply(this,r);return n.cache=s.set(o,i)||s,i};return n.cache=new(Ai.Cache||Un),n}function Ni(e){if("function"!=typeof e)throw new Oe(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ai.Cache=Un;var Ti=go((function(e,t){var n=(t=1==t.length&&qi(t[0])?xt(t[0],Ut(os())):xt(fr(t,1),Ut(os()))).length;return $r((function(r){for(var o=-1,s=pn(r.length,n);++o<s;)r[o]=t[o].call(this,r[o]);return vt(e,this,r)}))})),Fi=$r((function(e,t){var n=tn(t,rs(Fi));return Ko(e,c,s,t,n)})),Pi=$r((function(e,t){var n=tn(t,rs(Pi));return Ko(e,64,s,t,n)})),Ri=Yo((function(e,t){return Ko(e,256,s,s,s,t)}));function Di(e,t){return e===t||e!=e&&t!=t}var Mi=Ho(kr),Li=Ho((function(e,t){return e>=t})),Bi=Or(function(){return arguments}())?Or:function(e){return Xi(e)&&Fe.call(e,"callee")&&!Je.call(e,"callee")},qi=n.isArray,zi=ht?Ut(ht):function(e){return Xi(e)&&wr(e)==T};function Hi(e){return null!=e&&Ji(e.length)&&!Ki(e)}function Ui(e){return Xi(e)&&Hi(e)}var Vi=dn||hu,$i=ft?Ut(ft):function(e){return Xi(e)&&wr(e)==y};function Wi(e){if(!Xi(e))return!1;var t=wr(e);return t==_||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ea(e)}function Ki(e){if(!Zi(e))return!1;var t=wr(e);return t==w||t==k||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Gi(e){return"number"==typeof e&&e==da(e)}function Ji(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function Zi(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Xi(e){return null!=e&&"object"==typeof e}var Yi=mt?Ut(mt):function(e){return Xi(e)&&ds(e)==S};function Qi(e){return"number"==typeof e||Xi(e)&&wr(e)==j}function ea(e){if(!Xi(e)||wr(e)!=C)return!1;var t=Ve(e);if(null===t)return!0;var n=Fe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Te.call(n)==Me}var ta=pt?Ut(pt):function(e){return Xi(e)&&wr(e)==O},na=gt?Ut(gt):function(e){return Xi(e)&&ds(e)==E};function ra(e){return"string"==typeof e||!qi(e)&&Xi(e)&&wr(e)==I}function oa(e){return"symbol"==typeof e||Xi(e)&&wr(e)==A}var sa=bt?Ut(bt):function(e){return Xi(e)&&Ji(e.length)&&!!Qe[wr(e)]},ia=Ho(Fr),aa=Ho((function(e,t){return e<=t}));function ua(e){if(!e)return[];if(Hi(e))return ra(e)?on(e):Co(e);if(st&&e[st])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[st]());var t=ds(e);return(t==S?Qt:t==E?nn:Da)(e)}function ca(e){return e?(e=ha(e))===l||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function da(e){var t=ca(e),n=t%1;return t==t?n?t-n:t:0}function la(e){return e?rr(da(e),0,m):0}function ha(e){if("number"==typeof e)return e;if(oa(e))return f;if(Zi(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Zi(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(oe,"");var n=pe.test(e);return n||be.test(e)?rt(e.slice(2),n?2:8):me.test(e)?f:+e}function fa(e){return xo(e,Ea(e))}function ma(e){return null==e?"":oo(e)}var pa=Eo((function(e,t){if(ys(t)||Hi(t))xo(t,Oa(t),e);else for(var n in t)Fe.call(t,n)&&Xn(e,n,t[n])})),ga=Eo((function(e,t){xo(t,Ea(t),e)})),ba=Eo((function(e,t,n,r){xo(t,Ea(t),e,r)})),va=Eo((function(e,t,n,r){xo(t,Oa(t),e,r)})),ya=Yo(nr),_a=$r((function(e,t){e=je(e);var n=-1,r=t.length,o=r>2?t[2]:s;for(o&&ps(t[0],t[1],o)&&(r=1);++n<r;)for(var i=t[n],a=Ea(i),u=-1,c=a.length;++u<c;){var d=a[u],l=e[d];(l===s||Di(l,Ae[d])&&!Fe.call(e,d))&&(e[d]=i[d])}return e})),wa=$r((function(e){return e.push(s,Jo),vt(Aa,s,e)}));function ka(e,t,n){var r=null==e?s:yr(e,t);return r===s?n:r}function Sa(e,t){return null!=e&&ls(e,t,jr)}var ja=Mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=De.call(t)),e[t]=n}),Za(Qa)),Ca=Mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=De.call(t)),Fe.call(e,t)?e[t].push(n):e[t]=[n]}),os),xa=$r(xr);function Oa(e){return Hi(e)?Wn(e):Tr(e)}function Ea(e){return Hi(e)?Wn(e,!0):function(e){if(!Zi(e))return function(e){var t=[];if(null!=e)for(var n in je(e))t.push(n);return t}(e);var t=ys(e),n=[];for(var r in e)("constructor"!=r||!t&&Fe.call(e,r))&&n.push(r);return n}(e)}var Ia=Eo((function(e,t,n){Mr(e,t,n)})),Aa=Eo((function(e,t,n,r){Mr(e,t,n,r)})),Na=Yo((function(e,t){var n={};if(null==e)return n;var r=!1;t=xt(t,(function(t){return t=po(t,e),r||(r=t.length>1),t})),xo(e,es(e),n),r&&(n=or(n,7,Zo));for(var o=t.length;o--;)io(n,t[o]);return n})),Ta=Yo((function(e,t){return null==e?{}:function(e,t){return qr(e,t,(function(t,n){return Sa(e,n)}))}(e,t)}));function Fa(e,t){if(null==e)return{};var n=xt(es(e),(function(e){return[e]}));return t=os(t),qr(e,n,(function(e,n){return t(e,n[0])}))}var Pa=Wo(Oa),Ra=Wo(Ea);function Da(e){return null==e?[]:Vt(e,Oa(e))}var Ma=To((function(e,t,n){return t=t.toLowerCase(),e+(n?La(t):t)}));function La(e){return Wa(ma(e).toLowerCase())}function Ba(e){return(e=ma(e))&&e.replace(ye,Jt).replace(We,"")}var qa=To((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),za=To((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ha=No("toLowerCase"),Ua=To((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Va=To((function(e,t,n){return e+(n?" ":"")+Wa(t)})),$a=To((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Wa=No("toUpperCase");function Ka(e,t,n){return e=ma(e),(t=n?s:t)===s?function(e){return Ze.test(e)}(e)?function(e){return e.match(Ge)||[]}(e):function(e){return e.match(de)||[]}(e):e.match(t)||[]}var Ga=$r((function(e,t){try{return vt(e,s,t)}catch(e){return Wi(e)?e:new o(e)}})),Ja=Yo((function(e,t){return _t(t,(function(t){t=Fs(t),tr(e,t,Ci(e[t],e))})),e}));function Za(e){return function(){return e}}var Xa=Ro(),Ya=Ro(!0);function Qa(e){return e}function eu(e){return Nr("function"==typeof e?e:or(e,1))}var tu=$r((function(e,t){return function(n){return xr(n,e,t)}})),nu=$r((function(e,t){return function(n){return xr(e,n,t)}}));function ru(e,t,n){var r=Oa(t),o=vr(t,r);null!=n||Zi(t)&&(o.length||!r.length)||(n=t,t=e,e=this,o=vr(t,Oa(t)));var s=!(Zi(n)&&"chain"in n&&!n.chain),i=Ki(e);return _t(o,(function(n){var r=t[n];e[n]=r,i&&(e.prototype[n]=function(){var t=this.__chain__;if(s||t){var n=e(this.__wrapped__),o=n.__actions__=Co(this.__actions__);return o.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Ot([this.value()],arguments))})})),e}function ou(){}var su=Bo(xt),iu=Bo(kt),au=Bo(At);function uu(e){return gs(e)?Lt(Fs(e)):function(e){return function(t){return yr(t,e)}}(e)}var cu=zo(),du=zo(!0);function lu(){return[]}function hu(){return!1}var fu=Lo((function(e,t){return e+t}),0),mu=Vo("ceil"),pu=Lo((function(e,t){return e/t}),1),gu=Vo("floor"),bu=Lo((function(e,t){return e*t}),1),vu=Vo("round"),yu=Lo((function(e,t){return e-t}),0);return Dn.after=function(e,t){if("function"!=typeof t)throw new Oe(i);return e=da(e),function(){if(--e<1)return t.apply(this,arguments)}},Dn.ary=Si,Dn.assign=pa,Dn.assignIn=ga,Dn.assignInWith=ba,Dn.assignWith=va,Dn.at=ya,Dn.before=ji,Dn.bind=Ci,Dn.bindAll=Ja,Dn.bindKey=xi,Dn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return qi(e)?e:[e]},Dn.chain=ui,Dn.chunk=function(e,t,r){t=(r?ps(e,t,r):t===s)?1:mn(da(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var i=0,a=0,u=n(Bt(o/t));i<o;)u[a++]=Yr(e,i,i+=t);return u},Dn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var s=e[t];s&&(o[r++]=s)}return o},Dn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],o=e;o--;)t[o-1]=arguments[o];return Ot(qi(r)?Co(r):[r],fr(t,1))},Dn.cond=function(e){var t=null==e?0:e.length,n=os();return e=t?xt(e,(function(e){if("function"!=typeof e[1])throw new Oe(i);return[n(e[0]),e[1]]})):[],$r((function(n){for(var r=-1;++r<t;){var o=e[r];if(vt(o[0],this,n))return vt(o[1],this,n)}}))},Dn.conforms=function(e){return function(e){var t=Oa(e);return function(n){return sr(n,e,t)}}(or(e,1))},Dn.constant=Za,Dn.countBy=li,Dn.create=function(e,t){var n=Mn(e);return null==t?n:er(n,t)},Dn.curry=function e(t,n,r){var o=Ko(t,8,s,s,s,s,s,n=r?s:n);return o.placeholder=e.placeholder,o},Dn.curryRight=function e(t,n,r){var o=Ko(t,16,s,s,s,s,s,n=r?s:n);return o.placeholder=e.placeholder,o},Dn.debounce=Oi,Dn.defaults=_a,Dn.defaultsDeep=wa,Dn.defer=Ei,Dn.delay=Ii,Dn.difference=Ds,Dn.differenceBy=Ms,Dn.differenceWith=Ls,Dn.drop=function(e,t,n){var r=null==e?0:e.length;return r?Yr(e,(t=n||t===s?1:da(t))<0?0:t,r):[]},Dn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Yr(e,0,(t=r-(t=n||t===s?1:da(t)))<0?0:t):[]},Dn.dropRightWhile=function(e,t){return e&&e.length?uo(e,os(t,3),!0,!0):[]},Dn.dropWhile=function(e,t){return e&&e.length?uo(e,os(t,3),!0):[]},Dn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&ps(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=da(n))<0&&(n=-n>o?0:o+n),(r=r===s||r>o?o:da(r))<0&&(r+=o),r=n>r?0:la(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Dn.filter=function(e,t){return(qi(e)?St:hr)(e,os(t,3))},Dn.flatMap=function(e,t){return fr(yi(e,t),1)},Dn.flatMapDeep=function(e,t){return fr(yi(e,t),l)},Dn.flatMapDepth=function(e,t,n){return n=n===s?1:da(n),fr(yi(e,t),n)},Dn.flatten=zs,Dn.flattenDeep=function(e){return null!=e&&e.length?fr(e,l):[]},Dn.flattenDepth=function(e,t){return null!=e&&e.length?fr(e,t=t===s?1:da(t)):[]},Dn.flip=function(e){return Ko(e,512)},Dn.flow=Xa,Dn.flowRight=Ya,Dn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var o=e[t];r[o[0]]=o[1]}return r},Dn.functions=function(e){return null==e?[]:vr(e,Oa(e))},Dn.functionsIn=function(e){return null==e?[]:vr(e,Ea(e))},Dn.groupBy=gi,Dn.initial=function(e){return null!=e&&e.length?Yr(e,0,-1):[]},Dn.intersection=Us,Dn.intersectionBy=Vs,Dn.intersectionWith=$s,Dn.invert=ja,Dn.invertBy=Ca,Dn.invokeMap=bi,Dn.iteratee=eu,Dn.keyBy=vi,Dn.keys=Oa,Dn.keysIn=Ea,Dn.map=yi,Dn.mapKeys=function(e,t){var n={};return t=os(t,3),gr(e,(function(e,r,o){tr(n,t(e,r,o),e)})),n},Dn.mapValues=function(e,t){var n={};return t=os(t,3),gr(e,(function(e,r,o){tr(n,r,t(e,r,o))})),n},Dn.matches=function(e){return Rr(or(e,1))},Dn.matchesProperty=function(e,t){return Dr(e,or(t,1))},Dn.memoize=Ai,Dn.merge=Ia,Dn.mergeWith=Aa,Dn.method=tu,Dn.methodOf=nu,Dn.mixin=ru,Dn.negate=Ni,Dn.nthArg=function(e){return e=da(e),$r((function(t){return Lr(t,e)}))},Dn.omit=Na,Dn.omitBy=function(e,t){return Fa(e,Ni(os(t)))},Dn.once=function(e){return ji(2,e)},Dn.orderBy=function(e,t,n,r){return null==e?[]:(qi(t)||(t=null==t?[]:[t]),qi(n=r?s:n)||(n=null==n?[]:[n]),Br(e,t,n))},Dn.over=su,Dn.overArgs=Ti,Dn.overEvery=iu,Dn.overSome=au,Dn.partial=Fi,Dn.partialRight=Pi,Dn.partition=_i,Dn.pick=Ta,Dn.pickBy=Fa,Dn.property=uu,Dn.propertyOf=function(e){return function(t){return null==e?s:yr(e,t)}},Dn.pull=Ks,Dn.pullAll=Gs,Dn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?zr(e,t,os(n,2)):e},Dn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?zr(e,t,s,n):e},Dn.pullAt=Js,Dn.range=cu,Dn.rangeRight=du,Dn.rearg=Ri,Dn.reject=function(e,t){return(qi(e)?St:hr)(e,Ni(os(t,3)))},Dn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,o=[],s=e.length;for(t=os(t,3);++r<s;){var i=e[r];t(i,r,e)&&(n.push(i),o.push(r))}return Hr(e,o),n},Dn.rest=function(e,t){if("function"!=typeof e)throw new Oe(i);return $r(e,t=t===s?t:da(t))},Dn.reverse=Zs,Dn.sampleSize=function(e,t,n){return t=(n?ps(e,t,n):t===s)?1:da(t),(qi(e)?Gn:Kr)(e,t)},Dn.set=function(e,t,n){return null==e?e:Gr(e,t,n)},Dn.setWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:Gr(e,t,n,r)},Dn.shuffle=function(e){return(qi(e)?Jn:Xr)(e)},Dn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&ps(e,t,n)?(t=0,n=r):(t=null==t?0:da(t),n=n===s?r:da(n)),Yr(e,t,n)):[]},Dn.sortBy=wi,Dn.sortedUniq=function(e){return e&&e.length?no(e):[]},Dn.sortedUniqBy=function(e,t){return e&&e.length?no(e,os(t,2)):[]},Dn.split=function(e,t,n){return n&&"number"!=typeof n&&ps(e,t,n)&&(t=n=s),(n=n===s?m:n>>>0)?(e=ma(e))&&("string"==typeof t||null!=t&&!ta(t))&&!(t=oo(t))&&Yt(e)?bo(on(e),0,n):e.split(t,n):[]},Dn.spread=function(e,t){if("function"!=typeof e)throw new Oe(i);return t=null==t?0:mn(da(t),0),$r((function(n){var r=n[t],o=bo(n,0,t);return r&&Ot(o,r),vt(e,this,o)}))},Dn.tail=function(e){var t=null==e?0:e.length;return t?Yr(e,1,t):[]},Dn.take=function(e,t,n){return e&&e.length?Yr(e,0,(t=n||t===s?1:da(t))<0?0:t):[]},Dn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Yr(e,(t=r-(t=n||t===s?1:da(t)))<0?0:t,r):[]},Dn.takeRightWhile=function(e,t){return e&&e.length?uo(e,os(t,3),!1,!0):[]},Dn.takeWhile=function(e,t){return e&&e.length?uo(e,os(t,3)):[]},Dn.tap=function(e,t){return t(e),e},Dn.throttle=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new Oe(i);return Zi(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Oi(e,t,{leading:r,maxWait:t,trailing:o})},Dn.thru=ci,Dn.toArray=ua,Dn.toPairs=Pa,Dn.toPairsIn=Ra,Dn.toPath=function(e){return qi(e)?xt(e,Fs):oa(e)?[e]:Co(Ts(ma(e)))},Dn.toPlainObject=fa,Dn.transform=function(e,t,n){var r=qi(e),o=r||Vi(e)||sa(e);if(t=os(t,4),null==n){var s=e&&e.constructor;n=o?r?new s:[]:Zi(e)&&Ki(s)?Mn(Ve(e)):{}}return(o?_t:gr)(e,(function(e,r,o){return t(n,e,r,o)})),n},Dn.unary=function(e){return Si(e,1)},Dn.union=Xs,Dn.unionBy=Ys,Dn.unionWith=Qs,Dn.uniq=function(e){return e&&e.length?so(e):[]},Dn.uniqBy=function(e,t){return e&&e.length?so(e,os(t,2)):[]},Dn.uniqWith=function(e,t){return t="function"==typeof t?t:s,e&&e.length?so(e,s,t):[]},Dn.unset=function(e,t){return null==e||io(e,t)},Dn.unzip=ei,Dn.unzipWith=ti,Dn.update=function(e,t,n){return null==e?e:ao(e,t,mo(n))},Dn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:ao(e,t,mo(n),r)},Dn.values=Da,Dn.valuesIn=function(e){return null==e?[]:Vt(e,Ea(e))},Dn.without=ni,Dn.words=Ka,Dn.wrap=function(e,t){return Fi(mo(t),e)},Dn.xor=ri,Dn.xorBy=oi,Dn.xorWith=si,Dn.zip=ii,Dn.zipObject=function(e,t){return ho(e||[],t||[],Xn)},Dn.zipObjectDeep=function(e,t){return ho(e||[],t||[],Gr)},Dn.zipWith=ai,Dn.entries=Pa,Dn.entriesIn=Ra,Dn.extend=ga,Dn.extendWith=ba,ru(Dn,Dn),Dn.add=fu,Dn.attempt=Ga,Dn.camelCase=Ma,Dn.capitalize=La,Dn.ceil=mu,Dn.clamp=function(e,t,n){return n===s&&(n=t,t=s),n!==s&&(n=(n=ha(n))===n?n:0),t!==s&&(t=(t=ha(t))===t?t:0),rr(ha(e),t,n)},Dn.clone=function(e){return or(e,4)},Dn.cloneDeep=function(e){return or(e,5)},Dn.cloneDeepWith=function(e,t){return or(e,5,t="function"==typeof t?t:s)},Dn.cloneWith=function(e,t){return or(e,4,t="function"==typeof t?t:s)},Dn.conformsTo=function(e,t){return null==t||sr(e,t,Oa(t))},Dn.deburr=Ba,Dn.defaultTo=function(e,t){return null==e||e!=e?t:e},Dn.divide=pu,Dn.endsWith=function(e,t,n){e=ma(e),t=oo(t);var r=e.length,o=n=n===s?r:rr(da(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Dn.eq=Di,Dn.escape=function(e){return(e=ma(e))&&J.test(e)?e.replace(K,Zt):e},Dn.escapeRegExp=function(e){return(e=ma(e))&&re.test(e)?e.replace(ne,"\\$&"):e},Dn.every=function(e,t,n){var r=qi(e)?kt:dr;return n&&ps(e,t,n)&&(t=s),r(e,os(t,3))},Dn.find=hi,Dn.findIndex=Bs,Dn.findKey=function(e,t){return Tt(e,os(t,3),gr)},Dn.findLast=fi,Dn.findLastIndex=qs,Dn.findLastKey=function(e,t){return Tt(e,os(t,3),br)},Dn.floor=gu,Dn.forEach=mi,Dn.forEachRight=pi,Dn.forIn=function(e,t){return null==e?e:mr(e,os(t,3),Ea)},Dn.forInRight=function(e,t){return null==e?e:pr(e,os(t,3),Ea)},Dn.forOwn=function(e,t){return e&&gr(e,os(t,3))},Dn.forOwnRight=function(e,t){return e&&br(e,os(t,3))},Dn.get=ka,Dn.gt=Mi,Dn.gte=Li,Dn.has=function(e,t){return null!=e&&ls(e,t,Sr)},Dn.hasIn=Sa,Dn.head=Hs,Dn.identity=Qa,Dn.includes=function(e,t,n,r){e=Hi(e)?e:Da(e),n=n&&!r?da(n):0;var o=e.length;return n<0&&(n=mn(o+n,0)),ra(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&Pt(e,t,n)>-1},Dn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:da(n);return o<0&&(o=mn(r+o,0)),Pt(e,t,o)},Dn.inRange=function(e,t,n){return t=ca(t),n===s?(n=t,t=0):n=ca(n),function(e,t,n){return e>=pn(t,n)&&e<mn(t,n)}(e=ha(e),t,n)},Dn.invoke=xa,Dn.isArguments=Bi,Dn.isArray=qi,Dn.isArrayBuffer=zi,Dn.isArrayLike=Hi,Dn.isArrayLikeObject=Ui,Dn.isBoolean=function(e){return!0===e||!1===e||Xi(e)&&wr(e)==v},Dn.isBuffer=Vi,Dn.isDate=$i,Dn.isElement=function(e){return Xi(e)&&1===e.nodeType&&!ea(e)},Dn.isEmpty=function(e){if(null==e)return!0;if(Hi(e)&&(qi(e)||"string"==typeof e||"function"==typeof e.splice||Vi(e)||sa(e)||Bi(e)))return!e.length;var t=ds(e);if(t==S||t==E)return!e.size;if(ys(e))return!Tr(e).length;for(var n in e)if(Fe.call(e,n))return!1;return!0},Dn.isEqual=function(e,t){return Er(e,t)},Dn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:s)?n(e,t):s;return r===s?Er(e,t,s,n):!!r},Dn.isError=Wi,Dn.isFinite=function(e){return"number"==typeof e&&ln(e)},Dn.isFunction=Ki,Dn.isInteger=Gi,Dn.isLength=Ji,Dn.isMap=Yi,Dn.isMatch=function(e,t){return e===t||Ir(e,t,is(t))},Dn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:s,Ir(e,t,is(t),n)},Dn.isNaN=function(e){return Qi(e)&&e!=+e},Dn.isNative=function(e){if(vs(e))throw new o("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ar(e)},Dn.isNil=function(e){return null==e},Dn.isNull=function(e){return null===e},Dn.isNumber=Qi,Dn.isObject=Zi,Dn.isObjectLike=Xi,Dn.isPlainObject=ea,Dn.isRegExp=ta,Dn.isSafeInteger=function(e){return Gi(e)&&e>=-9007199254740991&&e<=h},Dn.isSet=na,Dn.isString=ra,Dn.isSymbol=oa,Dn.isTypedArray=sa,Dn.isUndefined=function(e){return e===s},Dn.isWeakMap=function(e){return Xi(e)&&ds(e)==N},Dn.isWeakSet=function(e){return Xi(e)&&"[object WeakSet]"==wr(e)},Dn.join=function(e,t){return null==e?"":hn.call(e,t)},Dn.kebabCase=qa,Dn.last=Ws,Dn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==s&&(o=(o=da(n))<0?mn(r+o,0):pn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Ft(e,Dt,o,!0)},Dn.lowerCase=za,Dn.lowerFirst=Ha,Dn.lt=ia,Dn.lte=aa,Dn.max=function(e){return e&&e.length?lr(e,Qa,kr):s},Dn.maxBy=function(e,t){return e&&e.length?lr(e,os(t,2),kr):s},Dn.mean=function(e){return Mt(e,Qa)},Dn.meanBy=function(e,t){return Mt(e,os(t,2))},Dn.min=function(e){return e&&e.length?lr(e,Qa,Fr):s},Dn.minBy=function(e,t){return e&&e.length?lr(e,os(t,2),Fr):s},Dn.stubArray=lu,Dn.stubFalse=hu,Dn.stubObject=function(){return{}},Dn.stubString=function(){return""},Dn.stubTrue=function(){return!0},Dn.multiply=bu,Dn.nth=function(e,t){return e&&e.length?Lr(e,da(t)):s},Dn.noConflict=function(){return it._===this&&(it._=Le),this},Dn.noop=ou,Dn.now=ki,Dn.pad=function(e,t,n){e=ma(e);var r=(t=da(t))?rn(e):0;if(!t||r>=t)return e;var o=(t-r)/2;return qo(un(o),n)+e+qo(Bt(o),n)},Dn.padEnd=function(e,t,n){e=ma(e);var r=(t=da(t))?rn(e):0;return t&&r<t?e+qo(t-r,n):e},Dn.padStart=function(e,t,n){e=ma(e);var r=(t=da(t))?rn(e):0;return t&&r<t?qo(t-r,n)+e:e},Dn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),bn(ma(e).replace(se,""),t||0)},Dn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&ps(e,t,n)&&(t=n=s),n===s&&("boolean"==typeof t?(n=t,t=s):"boolean"==typeof e&&(n=e,e=s)),e===s&&t===s?(e=0,t=1):(e=ca(e),t===s?(t=e,e=0):t=ca(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=vn();return pn(e+o*(t-e+nt("1e-"+((o+"").length-1))),t)}return Ur(e,t)},Dn.reduce=function(e,t,n){var r=qi(e)?Et:qt,o=arguments.length<3;return r(e,os(t,4),n,o,ur)},Dn.reduceRight=function(e,t,n){var r=qi(e)?It:qt,o=arguments.length<3;return r(e,os(t,4),n,o,cr)},Dn.repeat=function(e,t,n){return t=(n?ps(e,t,n):t===s)?1:da(t),Vr(ma(e),t)},Dn.replace=function(){var e=arguments,t=ma(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Dn.result=function(e,t,n){var r=-1,o=(t=po(t,e)).length;for(o||(o=1,e=s);++r<o;){var i=null==e?s:e[Fs(t[r])];i===s&&(r=o,i=n),e=Ki(i)?i.call(e):i}return e},Dn.round=vu,Dn.runInContext=e,Dn.sample=function(e){return(qi(e)?Kn:Wr)(e)},Dn.size=function(e){if(null==e)return 0;if(Hi(e))return ra(e)?rn(e):e.length;var t=ds(e);return t==S||t==E?e.size:Tr(e).length},Dn.snakeCase=Ua,Dn.some=function(e,t,n){var r=qi(e)?At:Qr;return n&&ps(e,t,n)&&(t=s),r(e,os(t,3))},Dn.sortedIndex=function(e,t){return eo(e,t)},Dn.sortedIndexBy=function(e,t,n){return to(e,t,os(n,2))},Dn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=eo(e,t);if(r<n&&Di(e[r],t))return r}return-1},Dn.sortedLastIndex=function(e,t){return eo(e,t,!0)},Dn.sortedLastIndexBy=function(e,t,n){return to(e,t,os(n,2),!0)},Dn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=eo(e,t,!0)-1;if(Di(e[n],t))return n}return-1},Dn.startCase=Va,Dn.startsWith=function(e,t,n){return e=ma(e),n=null==n?0:rr(da(n),0,e.length),t=oo(t),e.slice(n,n+t.length)==t},Dn.subtract=yu,Dn.sum=function(e){return e&&e.length?zt(e,Qa):0},Dn.sumBy=function(e,t){return e&&e.length?zt(e,os(t,2)):0},Dn.template=function(e,t,n){var r=Dn.templateSettings;n&&ps(e,t,n)&&(t=s),e=ma(e),t=ba({},t,r,Go);var o,i,a=ba({},t.imports,r.imports,Go),u=Oa(a),c=Vt(a,u),d=0,l=t.interpolate||_e,h="__p += '",f=Ce((t.escape||_e).source+"|"+l.source+"|"+(l===Y?he:_e).source+"|"+(t.evaluate||_e).source+"|$","g"),m="//# sourceURL="+(Fe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ye+"]")+"\n";e.replace(f,(function(t,n,r,s,a,u){return r||(r=s),h+=e.slice(d,u).replace(we,Xt),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),a&&(i=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),d=u+t.length,t})),h+="';\n";var p=Fe.call(t,"variable")&&t.variable;p||(h="with (obj) {\n"+h+"\n}\n"),h=(i?h.replace(U,""):h).replace(V,"$1").replace($,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=Ga((function(){return ke(u,m+"return "+h).apply(s,c)}));if(g.source=h,Wi(g))throw g;return g},Dn.times=function(e,t){if((e=da(e))<1||e>h)return[];var n=m,r=pn(e,m);t=os(t),e-=m;for(var o=Ht(r,t);++n<e;)t(n);return o},Dn.toFinite=ca,Dn.toInteger=da,Dn.toLength=la,Dn.toLower=function(e){return ma(e).toLowerCase()},Dn.toNumber=ha,Dn.toSafeInteger=function(e){return e?rr(da(e),-9007199254740991,h):0===e?e:0},Dn.toString=ma,Dn.toUpper=function(e){return ma(e).toUpperCase()},Dn.trim=function(e,t,n){if((e=ma(e))&&(n||t===s))return e.replace(oe,"");if(!e||!(t=oo(t)))return e;var r=on(e),o=on(t);return bo(r,Wt(r,o),Kt(r,o)+1).join("")},Dn.trimEnd=function(e,t,n){if((e=ma(e))&&(n||t===s))return e.replace(ie,"");if(!e||!(t=oo(t)))return e;var r=on(e);return bo(r,0,Kt(r,on(t))+1).join("")},Dn.trimStart=function(e,t,n){if((e=ma(e))&&(n||t===s))return e.replace(se,"");if(!e||!(t=oo(t)))return e;var r=on(e);return bo(r,Wt(r,on(t))).join("")},Dn.truncate=function(e,t){var n=30,r="...";if(Zi(t)){var o="separator"in t?t.separator:o;n="length"in t?da(t.length):n,r="omission"in t?oo(t.omission):r}var i=(e=ma(e)).length;if(Yt(e)){var a=on(e);i=a.length}if(n>=i)return e;var u=n-rn(r);if(u<1)return r;var c=a?bo(a,0,u).join(""):e.slice(0,u);if(o===s)return c+r;if(a&&(u+=c.length-u),ta(o)){if(e.slice(u).search(o)){var d,l=c;for(o.global||(o=Ce(o.source,ma(fe.exec(o))+"g")),o.lastIndex=0;d=o.exec(l);)var h=d.index;c=c.slice(0,h===s?u:h)}}else if(e.indexOf(oo(o),u)!=u){var f=c.lastIndexOf(o);f>-1&&(c=c.slice(0,f))}return c+r},Dn.unescape=function(e){return(e=ma(e))&&G.test(e)?e.replace(W,sn):e},Dn.uniqueId=function(e){var t=++Pe;return ma(e)+t},Dn.upperCase=$a,Dn.upperFirst=Wa,Dn.each=mi,Dn.eachRight=pi,Dn.first=Hs,ru(Dn,function(){var e={};return gr(Dn,(function(t,n){Fe.call(Dn.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),Dn.VERSION="4.17.20",_t(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Dn[e].placeholder=Dn})),_t(["drop","take"],(function(e,t){qn.prototype[e]=function(n){n=n===s?1:mn(da(n),0);var r=this.__filtered__&&!t?new qn(this):this.clone();return r.__filtered__?r.__takeCount__=pn(n,r.__takeCount__):r.__views__.push({size:pn(n,m),type:e+(r.__dir__<0?"Right":"")}),r},qn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),_t(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;qn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:os(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),_t(["head","last"],(function(e,t){var n="take"+(t?"Right":"");qn.prototype[e]=function(){return this[n](1).value()[0]}})),_t(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");qn.prototype[e]=function(){return this.__filtered__?new qn(this):this[n](1)}})),qn.prototype.compact=function(){return this.filter(Qa)},qn.prototype.find=function(e){return this.filter(e).head()},qn.prototype.findLast=function(e){return this.reverse().find(e)},qn.prototype.invokeMap=$r((function(e,t){return"function"==typeof e?new qn(this):this.map((function(n){return xr(n,e,t)}))})),qn.prototype.reject=function(e){return this.filter(Ni(os(e)))},qn.prototype.slice=function(e,t){e=da(e);var n=this;return n.__filtered__&&(e>0||t<0)?new qn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==s&&(n=(t=da(t))<0?n.dropRight(-t):n.take(t-e)),n)},qn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},qn.prototype.toArray=function(){return this.take(m)},gr(qn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Dn[r?"take"+("last"==t?"Right":""):t],i=r||/^find/.test(t);o&&(Dn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,u=t instanceof qn,c=a[0],d=u||qi(t),l=function(e){var t=o.apply(Dn,Ot([e],a));return r&&h?t[0]:t};d&&n&&"function"==typeof c&&1!=c.length&&(u=d=!1);var h=this.__chain__,f=!!this.__actions__.length,m=i&&!h,p=u&&!f;if(!i&&d){t=p?t:new qn(this);var g=e.apply(t,a);return g.__actions__.push({func:ci,args:[l],thisArg:s}),new Bn(g,h)}return m&&p?e.apply(this,a):(g=this.thru(l),m?r?g.value()[0]:g.value():g)})})),_t(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ee[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Dn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(qi(o)?o:[],e)}return this[n]((function(n){return t.apply(qi(n)?n:[],e)}))}})),gr(qn.prototype,(function(e,t){var n=Dn[t];if(n){var r=n.name+"";Fe.call(On,r)||(On[r]=[]),On[r].push({name:t,func:n})}})),On[Do(s,2).name]=[{name:"wrapper",func:s}],qn.prototype.clone=function(){var e=new qn(this.__wrapped__);return e.__actions__=Co(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Co(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Co(this.__views__),e},qn.prototype.reverse=function(){if(this.__filtered__){var e=new qn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},qn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=qi(e),r=t<0,o=n?e.length:0,s=function(e,t,n){for(var r=-1,o=n.length;++r<o;){var s=n[r],i=s.size;switch(s.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=pn(t,e+i);break;case"takeRight":e=mn(e,t-i)}}return{start:e,end:t}}(0,o,this.__views__),i=s.start,a=s.end,u=a-i,c=r?a:i-1,d=this.__iteratees__,l=d.length,h=0,f=pn(u,this.__takeCount__);if(!n||!r&&o==u&&f==u)return co(e,this.__actions__);var m=[];e:for(;u--&&h<f;){for(var p=-1,g=e[c+=t];++p<l;){var b=d[p],v=b.iteratee,y=b.type,_=v(g);if(2==y)g=_;else if(!_){if(1==y)continue e;break e}}m[h++]=g}return m},Dn.prototype.at=di,Dn.prototype.chain=function(){return ui(this)},Dn.prototype.commit=function(){return new Bn(this.value(),this.__chain__)},Dn.prototype.next=function(){this.__values__===s&&(this.__values__=ua(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?s:this.__values__[this.__index__++]}},Dn.prototype.plant=function(e){for(var t,n=this;n instanceof Ln;){var r=Rs(n);r.__index__=0,r.__values__=s,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Dn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof qn){var t=e;return this.__actions__.length&&(t=new qn(this)),(t=t.reverse()).__actions__.push({func:ci,args:[Zs],thisArg:s}),new Bn(t,this.__chain__)}return this.thru(Zs)},Dn.prototype.toJSON=Dn.prototype.valueOf=Dn.prototype.value=function(){return co(this.__wrapped__,this.__actions__)},Dn.prototype.first=Dn.prototype.head,st&&(Dn.prototype[st]=function(){return this}),Dn}();it._=an,(o=function(){return an}.call(t,n,t,r))===s||(r.exports=o)}).call(this)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/@fluidframework/telemetry-utils/lib/logger.js":function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/logger.js"),o=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/performanceBrowser.js");class s{constructor(e,t,n){this.namespace=e,this.properties=t,this.propertyGetters=n}static formatTick(e){return Math.floor(e)}static numberFromString(e){if(null==e)return;const t=Number(e);return Number.isNaN(t)?e:t}static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,n){if(null===t||"object"!=typeof t)e.error=t;else{const n=t;if(e.stack=n.stack,e.error=n.message,t.containsPII)e.error="Error message was removed as it contained PII";else if(t.getTelemetryProperties){const n=t.getTelemetryProperties();for(const t of Object.keys(n))void 0===e[t]&&(e[t]=n[t])}}void 0===e.stack&&n&&(e.stack=s.getStack())}static getStack(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}sendTelemetryEvent(e,t){const n=Object.assign(Object.assign({},e),{category:e.category?e.category:"generic"});void 0!==t&&s.prepareErrorObject(n,t,!1),this.send(n)}sendErrorEvent(e,t){const n=Object.assign(Object.assign({},e),{category:"error"});s.prepareErrorObject(n,t,!0),this.send(n)}sendPerformanceEvent(e,t){const n=Object.assign(Object.assign({},e),{category:e.category?e.category:"performance"});void 0!==t&&s.prepareErrorObject(n,t,!1),e.duration&&(n.duration=s.formatTick(e.duration)),this.send(n)}logGenericError(e,t){this.sendErrorEvent({eventName:e},t)}logException(e,t){this.sendErrorEvent(Object.assign(Object.assign({},e),{isException:!0}),t)}debugAssert(e,t){this.shipAssert(e,t)}shipAssert(e,t){if(!e){const e=void 0===t?{eventName:"Assert"}:t;e.isAssert=!0,e.stack=s.getStack(),this.sendErrorEvent(e)}}prepareEvent(e){const t=Object.assign(Object.assign({},this.properties),e);if(void 0!==this.namespace&&(t.eventName=`${this.namespace}${s.eventNamespaceSeparator}${t.eventName}`),this.propertyGetters)for(const n of Object.keys(this.propertyGetters)){if(void 0!==e[n])continue;const r=(0,this.propertyGetters[n])();void 0!==r&&(t[n]=r)}return t}}s.eventNamespaceSeparator=":";class i extends s{constructor(e,t,n,r){super(t,n,r),this.baseLogger=e}static create(e,t,n,o){if(e instanceof i){const r=void 0===e.properties&&void 0===n?void 0:Object.assign(Object.assign({},e.properties),n),a=void 0===e.propertyGetters&&void 0===o?void 0:Object.assign(Object.assign({},e.propertyGetters),o),u=void 0===e.namespace?t:void 0===t?e.namespace:`${e.namespace}${s.eventNamespaceSeparator}${t}`;return new i(e.baseLogger,u,r,a)}return new i(e||new r.a,t,n,o)}send(e){this.baseLogger.send(this.prepareEvent(e))}}class a extends s{constructor(e,t,n){super(e,t,n),this.loggers=[]}addLogger(e){null!=e&&this.loggers.push(e)}send(e){const t=this.prepareEvent(e);this.loggers.forEach(e=>{e.send(t)})}}class u{constructor(e,t){this.logger=e,this.startTime=o.a.now(),this.event=Object.assign({},t),this.reportEvent("start"),"object"==typeof window&&null!=window&&window.performance&&(this.startMark=t.eventName+"-start",window.performance.mark(this.startMark))}static start(e,t){return new u(e,t)}static timedExec(e,t,n){const r=u.start(e,t);try{const e=n(r);return r.event&&r.end(),e}catch(e){throw r.cancel(void 0,e),e}}static async timedExecAsync(e,t,n){const r=u.start(e,t);try{const e=await n(r);return r.event&&r.end(),e}catch(e){throw r.cancel(void 0,e),e}}reportProgress(e,t="update"){this.reportEvent(t,e)}end(e,t="end"){if(this.reportEvent(t,e)){if(this.startMark&&this.event){const e=`${this.event.eventName}-${t}`;window.performance.mark(e),window.performance.measure(""+this.event.eventName,this.startMark,e),this.startMark=void 0}this.event=void 0}}cancel(e,t){this.reportEvent("cancel",e,t),this.event=void 0}reportEvent(e,t,n){if(!this.event)return!1;const r=Object.assign(Object.assign({},this.event),t);return r.eventName=`${r.eventName}_${e}`,"start"!==e&&(r.duration=o.a.now()-this.startTime),this.logger.sendPerformanceEvent(r,n),!0}}class c extends Error{constructor(e,t){super(e),Object.assign(this,t)}getTelemetryProperties(){const e={};for(const t of Object.getOwnPropertyNames(this))e[t]=this[t];return e}}},"../notebook-dds/node_modules/@nteract/commutable/lib/cells.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeRawCell=t.makeMarkdownCell=t.makeCodeCell=void 0;const r=n("../notebook-dds/node_modules/immutable/dist/immutable.es.js");t.makeCodeCell=r.Record({cell_type:"code",execution_count:null,metadata:r.Map({collapsed:!0,jupyter:r.Map({source_hidden:!1,outputs_hidden:!1}),nteract:r.Map({transient:r.Map({deleting:!1})})}),source:"",outputs:r.List()}),t.makeMarkdownCell=r.Record({cell_type:"markdown",metadata:r.Map({nteract:r.Map({transient:r.Map({deleting:!1})})}),source:""}),t.makeRawCell=r.Record({cell_type:"raw",metadata:r.Map({nteract:r.Map({transient:r.Map({deleting:!1})})}),source:""})},"../notebook-dds/node_modules/@nteract/commutable/lib/index.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("../notebook-dds/node_modules/@nteract/commutable/lib/primitives.js"),t),o(n("../notebook-dds/node_modules/@nteract/commutable/lib/structures.js"),t),o(n("../notebook-dds/node_modules/@nteract/commutable/lib/outputs.js"),t),o(n("../notebook-dds/node_modules/@nteract/commutable/lib/cells.js"),t),o(n("../notebook-dds/node_modules/@nteract/commutable/lib/notebook.js"),t)},"../notebook-dds/node_modules/@nteract/commutable/lib/notebook.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.stringifyNotebook=t.toJS=t.fromJS=t.parseNotebook=void 0;const i=s(n("../notebook-dds/node_modules/@nteract/commutable/lib/v3.js")),a=s(n("../notebook-dds/node_modules/@nteract/commutable/lib/v4.js")),u=n("../notebook-dds/node_modules/immutable/dist/immutable.es.js");function c(e,t){return Object.freeze(t)}t.parseNotebook=function(e){return JSON.parse(e,c)},t.fromJS=function(e){if(u.Record.isRecord(e)){if(e.has("cellOrder")&&e.has("cellMap"))return e;throw new TypeError("\n      commutable was passed an Immutable.Record \n      structure that is not a notebook\n    ")}if(a.isNotebookV4(e)){if(Array.isArray(e.cells)&&"object"==typeof e.metadata)return a.fromJS(e)}else if(i.isNotebookV3(e))return i.fromJS(e);if(e.nbformat)throw new TypeError(`nbformat v${e.nbformat}.${e.nbformat_minor} not recognized`);throw new TypeError("This notebook format is not supported")},t.toJS=function(e){const t=e.get("nbformat_minor",null);if(4===e.get("nbformat")&&"number"==typeof t&&t>=0)return a.toJS(e);throw new TypeError("Only notebook formats 3 and 4 are supported!")},t.stringifyNotebook=function(e){return JSON.stringify(e,null,2)}},"../notebook-dds/node_modules/@nteract/commutable/lib/outputs.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createImmutableOutput=t.makeErrorOutput=t.makeStreamOutput=t.makeDisplayData=t.makeExecuteResult=void 0;const r=n("../notebook-dds/node_modules/immutable/dist/immutable.es.js"),o=n("../notebook-dds/node_modules/@nteract/commutable/lib/primitives.js"),s=Object.freeze({});t.makeExecuteResult=r.Record({data:s,execution_count:null,metadata:r.Map(),output_type:"execute_result"}),t.makeDisplayData=r.Record({data:s,metadata:r.Map(),output_type:"display_data"}),t.makeStreamOutput=r.Record({name:"stdout",output_type:"stream",text:""}),t.makeErrorOutput=r.Record({ename:"",evalue:"",output_type:"error",traceback:r.List()}),t.createImmutableOutput=function(e){switch(e.output_type){case"execute_result":return t.makeExecuteResult({data:o.createFrozenMediaBundle(e.data),execution_count:e.execution_count,metadata:r.fromJS(e.metadata)});case"display_data":return t.makeDisplayData({data:o.createFrozenMediaBundle(e.data),metadata:r.fromJS(e.metadata)});case"stream":return t.makeStreamOutput({name:e.name,text:o.demultiline(e.text)});case"error":return t.makeErrorOutput({ename:e.ename,evalue:e.evalue,output_type:"error",traceback:r.List(e.traceback)});default:if(e.output_type)throw new TypeError(`Output type ${e.output_type} not recognized`);throw new TypeError("Output structure not known: "+JSON.stringify(e))}}},"../notebook-dds/node_modules/@nteract/commutable/lib/primitives.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createOnDiskMediaBundle=t.createFrozenMediaBundle=t.deepFreeze=t.remultiline=t.demultiline=t.createCellId=void 0;const r=n("../notebook-dds/node_modules/@nteract/commutable/node_modules/uuid/dist/esm-browser/index.js");function o(e){return Array.isArray(e)?e.join(""):e}function s(e){return/^application\/(.*\+)json$/.test(e)}function i(e){const t=Object.getOwnPropertyNames(e);for(const n of t){const t=e[n];e[n]=t&&"object"==typeof t?i(t):t}return Object.freeze(e)}t.createCellId=function(){return r.v4()},t.demultiline=o,t.remultiline=function(e){return Array.isArray(e)?e:e.split(/(.*?(?:\r\n|\n))/g).filter(e=>""!==e)},t.deepFreeze=i;const a=/^application\/vnd.vega(.*\+)json$/;t.createFrozenMediaBundle=function(e){const t={};for(const n in e)a.test(n)?t[n]=JSON.stringify(e[n]):"string"==typeof e[n]?t[n]=e[n]:!s(n)&&Array.isArray(e[n])?t[n]=o(e[n]):t[n]=i(e[n]);return Object.freeze(t)},t.createOnDiskMediaBundle=function(e){return e}},"../notebook-dds/node_modules/@nteract/commutable/lib/structures.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.monocellNotebook=t.markCellNotDeleting=t.markCellDeleting=t.deleteCell=t.removeCell=t.insertCellAfter=t.insertCellAt=t.appendCellToNotebook=t.appendCell=t.emptyNotebook=t.createNotebook=t.defaultNotebook=t.makeNotebookRecord=t.emptyMarkdownCell=t.emptyCodeCell=t.createMarkdownCell=t.createCodeCell=void 0;const r=n("../notebook-dds/node_modules/@nteract/commutable/lib/primitives.js"),o=n("../notebook-dds/node_modules/@nteract/commutable/lib/cells.js"),s=n("../notebook-dds/node_modules/immutable/dist/immutable.es.js");function i(e,t,n=r.createCellId()){return{cellOrder:e.cellOrder.push(n),cellMap:e.cellMap.set(n,t)}}function a(e,t){return e.withMutations(e=>{const n={cellOrder:e.get("cellOrder"),cellMap:e.get("cellMap")},{cellOrder:r,cellMap:o}=i(n,t);return e.set("cellOrder",r).set("cellMap",o)})}function u(e,t,n,r){return e.withMutations(e=>e.setIn(["cellMap",n],t).set("cellOrder",e.get("cellOrder").insert(r,n)))}function c(e,t){return e.removeIn(["cellMap",t]).update("cellOrder",e=>e.filterNot(e=>e===t))}t.createCodeCell=o.makeCodeCell,t.createMarkdownCell=o.makeMarkdownCell,t.emptyCodeCell=t.createCodeCell(),t.emptyMarkdownCell=t.createMarkdownCell(),t.makeNotebookRecord=s.Record({cellOrder:s.List(),cellMap:s.Map(),nbformat_minor:0,nbformat:4,metadata:s.Map()}),t.defaultNotebook=t.makeNotebookRecord(),t.createNotebook=t.makeNotebookRecord,t.emptyNotebook=t.makeNotebookRecord(),t.appendCell=i,t.appendCellToNotebook=a,t.insertCellAt=u,t.insertCellAfter=function(e,t,n,r){return u(e,t,n,e.get("cellOrder").indexOf(r)+1)},t.removeCell=function(e,t){return console.log("Deprecation Warning: removeCell() is being deprecated. Please use deleteCell() instead"),c(e,t)},t.deleteCell=c,t.markCellDeleting=function(e,t){return e.withMutations(e=>e.setIn(["cellMap",t],e.getIn(["cellMap",t]).setIn(["metadata","nteract","transient","deleting"],!0)))},t.markCellNotDeleting=function(e,t){return e.withMutations(e=>e.setIn(["cellMap",t],e.getIn(["cellMap",t]).setIn(["metadata","nteract","transient","deleting"],!1)))},t.monocellNotebook=a(t.emptyNotebook,t.emptyCodeCell)},"../notebook-dds/node_modules/@nteract/commutable/lib/v3.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNotebookV3=t.fromJS=void 0;const r=n("../notebook-dds/node_modules/immutable/dist/immutable.es.js"),o=n("../notebook-dds/node_modules/@nteract/commutable/lib/primitives.js"),s=n("../notebook-dds/node_modules/@nteract/commutable/lib/structures.js"),i=n("../notebook-dds/node_modules/@nteract/commutable/lib/cells.js"),a=n("../notebook-dds/node_modules/@nteract/commutable/lib/outputs.js"),u=n("../notebook-dds/node_modules/@nteract/commutable/lib/structures.js"),c={text:"text/plain",latex:"text/latex",png:"image/png",jpeg:"image/jpeg",svg:"image/svg+xml",html:"text/html",javascript:"application/x-javascript",json:"application/javascript",pdf:"application/pdf"};function d(e){const t={};for(const n of Object.keys(e))n in c&&(t[c[n]]=e[n]);return o.createFrozenMediaBundle(t)}function l(e){switch(e.output_type){case"pyout":return a.makeExecuteResult({execution_count:e.prompt_number,data:d(e),metadata:r.fromJS(e.metadata)});case"display_data":return a.makeDisplayData({data:d(e),metadata:r.fromJS(e.metadata)});case"stream":const t="stderr"===e.stream?"stderr":"stdout";return a.makeStreamOutput({name:t,text:o.demultiline(e.text)});case"pyerr":return a.makeErrorOutput({ename:e.ename,evalue:e.evalue,traceback:r.List(e.traceback)});default:throw new TypeError(`Output type ${e.output_type} not recognized`)}}function h(e){return e&&"object"==typeof e&&3===e.nbformat&&e.nbformat_minor>=0}t.fromJS=function(e){if(!h(e))throw e=e,new TypeError(`Notebook is not a valid v3 notebook. v3 notebooks must be of form 3.x\n      It lists nbformat v${e.nbformat}.${e.nbformat_minor}`);const t={cellOrder:r.List().asMutable(),cellMap:r.Map().asMutable()},n=[].concat.apply([],e.worksheets.map(e=>e.cells.reduce((e,t)=>u.appendCell(e,function(e){switch(e.cell_type){case"markdown":return function(e){return i.makeMarkdownCell({cell_type:e.cell_type,source:o.demultiline(e.source),metadata:r.fromJS(e.metadata)})}(e);case"code":return function(e){return i.makeCodeCell({cell_type:e.cell_type,source:o.demultiline(e.input),outputs:r.List(e.outputs.map(l)),execution_count:e.prompt_number,metadata:r.fromJS(e.metadata)})}(e);case"raw":return function(e){return i.makeRawCell({cell_type:e.cell_type,source:o.demultiline(e.source),metadata:r.fromJS(e.metadata)})}(e);case"heading":return function(e){return i.makeMarkdownCell({cell_type:"markdown",source:Array.isArray(e.source)?o.demultiline(e.source.map(t=>Array(e.level).join("#").concat(" ").concat(t))):e.source,metadata:r.fromJS(e.metadata)})}(e);default:throw new TypeError(`Cell type ${e.cell_type} unknown`)}}(t)),t)))[0];return s.makeNotebookRecord({cellOrder:n.cellOrder.asImmutable(),cellMap:n.cellMap.asImmutable(),nbformat_minor:e.nbformat_minor,nbformat:4,metadata:r.fromJS(e.metadata)})},t.isNotebookV3=h},"../notebook-dds/node_modules/@nteract/commutable/lib/v4.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNotebookV4=t.toJS=t.cellToJS=t.outputToJS=t.fromJS=void 0;const r=n("../notebook-dds/node_modules/immutable/dist/immutable.es.js"),o=n("../notebook-dds/node_modules/@nteract/commutable/lib/cells.js"),s=n("../notebook-dds/node_modules/@nteract/commutable/lib/outputs.js"),i=n("../notebook-dds/node_modules/@nteract/commutable/lib/primitives.js"),a=n("../notebook-dds/node_modules/@nteract/commutable/lib/structures.js");function u(e){return r.Map(e).map((e,t)=>"tags"!==t?e:Array.isArray(e)?r.Set(e):r.Set())}function c(e){switch(e.cell_type){case"markdown":return function(e){return o.makeMarkdownCell({cell_type:e.cell_type,source:i.demultiline(e.source),metadata:u(e.metadata)})}(e);case"code":return function(e){return o.makeCodeCell({cell_type:e.cell_type,source:i.demultiline(e.source),outputs:r.List(e.outputs.map(s.createImmutableOutput)),execution_count:e.execution_count,metadata:u(e.metadata)})}(e);case"raw":return function(e){return o.makeRawCell({cell_type:e.cell_type,source:i.demultiline(e.source),metadata:u(e.metadata)})}(e);default:throw new TypeError(`Cell type ${e.cell_type} unknown`)}}function d(e){return 4===e.nbformat&&e.nbformat_minor>=5}function l(e){return e.toJS()}function h(e){switch(e.output_type){case"execute_result":return{output_type:e.output_type,execution_count:e.execution_count,data:i.createOnDiskMediaBundle(e.data),metadata:e.metadata.toJS()};case"display_data":return{output_type:e.output_type,data:i.createOnDiskMediaBundle(e.data),metadata:e.metadata.toJS()};case"stream":return{output_type:e.output_type,name:e.name,text:i.remultiline(e.text)};case"error":return{output_type:e.output_type,ename:e.ename,evalue:e.evalue,traceback:e.traceback.toJS()}}}function f(e){switch(e.cell_type){case"markdown":return function(e){return{cell_type:"markdown",source:i.remultiline(e.source),metadata:l(e.metadata)}}(e);case"code":return function(e){return{cell_type:"code",source:i.remultiline(e.source),outputs:e.outputs.map(h).toArray(),execution_count:e.execution_count,metadata:l(e.metadata)}}(e);case"raw":return function(e){return{cell_type:"raw",source:i.remultiline(e.source),metadata:l(e.get("metadata",r.Map()))}}(e);default:throw new TypeError("Cell type unknown at runtime")}}function m(e){return e&&"object"==typeof e&&4===e.nbformat&&e.nbformat_minor>=0}t.fromJS=function(e){if(!m(e))throw e=e,new TypeError(`Notebook is not a valid v4 notebook. v4 notebooks must be of form 4.x\n       It lists nbformat v${e.nbformat}.${e.nbformat_minor}`);const t={cellOrder:r.List().asMutable(),cellMap:r.Map().asMutable()},n=d(e),o=e.cells.reduce((e,t)=>a.appendCell(e,c(t),n?t.id:void 0),t);return a.makeNotebookRecord({cellOrder:o.cellOrder.asImmutable(),cellMap:o.cellMap.asImmutable(),nbformat_minor:e.nbformat_minor,nbformat:4,metadata:r.fromJS(e.metadata)})},t.outputToJS=h,t.cellToJS=f,t.toJS=function(e){const t=e.toObject(),n=t.cellOrder.toArray(),r=t.cellMap.toObject(),o=d(t);return{cells:n.filter(e=>!r[e].getIn(["metadata","nteract","transient","deleting"])).map(e=>{const t=f(r[e]);return o&&(t.id=e),t}),metadata:t.metadata.toJS(),nbformat:4,nbformat_minor:t.nbformat_minor}},t.isNotebookV4=m},"../notebook-dds/node_modules/@nteract/commutable/node_modules/uuid/dist/esm-browser/index.js":function(e,t,n){"use strict";var r;n.r(t),n.d(t,"v1",(function(){return p})),n.d(t,"v3",(function(){return C})),n.d(t,"v4",(function(){return x})),n.d(t,"v5",(function(){return I})),n.d(t,"NIL",(function(){return A})),n.d(t,"version",(function(){return N})),n.d(t,"validate",(function(){return a})),n.d(t,"stringify",(function(){return h})),n.d(t,"parse",(function(){return g}));var o=new Uint8Array(16);function s(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(o)}for(var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(e){return"string"==typeof e&&i.test(e)},u=[],c=0;c<256;++c)u.push((c+256).toString(16).substr(1));var d,l,h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!a(n))throw TypeError("Stringified UUID is invalid");return n},f=0,m=0,p=function(e,t,n){var r=t&&n||0,o=t||new Array(16),i=(e=e||{}).node||d,a=void 0!==e.clockseq?e.clockseq:l;if(null==i||null==a){var u=e.random||(e.rng||s)();null==i&&(i=d=[1|u[0],u[1],u[2],u[3],u[4],u[5]]),null==a&&(a=l=16383&(u[6]<<8|u[7]))}var c=void 0!==e.msecs?e.msecs:Date.now(),p=void 0!==e.nsecs?e.nsecs:m+1,g=c-f+(p-m)/1e4;if(g<0&&void 0===e.clockseq&&(a=a+1&16383),(g<0||c>f)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");f=c,m=p,l=a;var b=(1e4*(268435455&(c+=122192928e5))+p)%4294967296;o[r++]=b>>>24&255,o[r++]=b>>>16&255,o[r++]=b>>>8&255,o[r++]=255&b;var v=c/4294967296*1e4&268435455;o[r++]=v>>>8&255,o[r++]=255&v,o[r++]=v>>>24&15|16,o[r++]=v>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var y=0;y<6;++y)o[r+y]=i[y];return t||h(o)},g=function(e){if(!a(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n},b=function(e,t,n){function r(e,r,o,s){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=g(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var i=new Uint8Array(16+e.length);if(i.set(r),i.set(e,r.length),(i=n(i))[6]=15&i[6]|t,i[8]=63&i[8]|128,o){s=s||0;for(var a=0;a<16;++a)o[s+a]=i[a];return o}return h(i)}try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r};function v(e){return 14+(e+64>>>9<<4)+1}function y(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function _(e,t,n,r,o,s){return y((i=y(y(t,e),y(r,s)))<<(a=o)|i>>>32-a,n);var i,a}function w(e,t,n,r,o,s,i){return _(t&n|~t&r,e,t,o,s,i)}function k(e,t,n,r,o,s,i){return _(t&r|n&~r,e,t,o,s,i)}function S(e,t,n,r,o,s,i){return _(t^n^r,e,t,o,s,i)}function j(e,t,n,r,o,s,i){return _(n^(t|~r),e,t,o,s,i)}var C=b("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,r="0123456789abcdef",o=0;o<n;o+=8){var s=e[o>>5]>>>o%32&255,i=parseInt(r.charAt(s>>>4&15)+r.charAt(15&s),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[v(t)-1]=t;for(var n=1732584193,r=-271733879,o=-1732584194,s=271733878,i=0;i<e.length;i+=16){var a=n,u=r,c=o,d=s;n=w(n,r,o,s,e[i],7,-680876936),s=w(s,n,r,o,e[i+1],12,-389564586),o=w(o,s,n,r,e[i+2],17,606105819),r=w(r,o,s,n,e[i+3],22,-1044525330),n=w(n,r,o,s,e[i+4],7,-176418897),s=w(s,n,r,o,e[i+5],12,1200080426),o=w(o,s,n,r,e[i+6],17,-1473231341),r=w(r,o,s,n,e[i+7],22,-45705983),n=w(n,r,o,s,e[i+8],7,1770035416),s=w(s,n,r,o,e[i+9],12,-1958414417),o=w(o,s,n,r,e[i+10],17,-42063),r=w(r,o,s,n,e[i+11],22,-1990404162),n=w(n,r,o,s,e[i+12],7,1804603682),s=w(s,n,r,o,e[i+13],12,-40341101),o=w(o,s,n,r,e[i+14],17,-1502002290),n=k(n,r=w(r,o,s,n,e[i+15],22,1236535329),o,s,e[i+1],5,-165796510),s=k(s,n,r,o,e[i+6],9,-1069501632),o=k(o,s,n,r,e[i+11],14,643717713),r=k(r,o,s,n,e[i],20,-373897302),n=k(n,r,o,s,e[i+5],5,-701558691),s=k(s,n,r,o,e[i+10],9,38016083),o=k(o,s,n,r,e[i+15],14,-660478335),r=k(r,o,s,n,e[i+4],20,-405537848),n=k(n,r,o,s,e[i+9],5,568446438),s=k(s,n,r,o,e[i+14],9,-1019803690),o=k(o,s,n,r,e[i+3],14,-187363961),r=k(r,o,s,n,e[i+8],20,1163531501),n=k(n,r,o,s,e[i+13],5,-1444681467),s=k(s,n,r,o,e[i+2],9,-51403784),o=k(o,s,n,r,e[i+7],14,1735328473),n=S(n,r=k(r,o,s,n,e[i+12],20,-1926607734),o,s,e[i+5],4,-378558),s=S(s,n,r,o,e[i+8],11,-2022574463),o=S(o,s,n,r,e[i+11],16,1839030562),r=S(r,o,s,n,e[i+14],23,-35309556),n=S(n,r,o,s,e[i+1],4,-1530992060),s=S(s,n,r,o,e[i+4],11,1272893353),o=S(o,s,n,r,e[i+7],16,-155497632),r=S(r,o,s,n,e[i+10],23,-1094730640),n=S(n,r,o,s,e[i+13],4,681279174),s=S(s,n,r,o,e[i],11,-358537222),o=S(o,s,n,r,e[i+3],16,-722521979),r=S(r,o,s,n,e[i+6],23,76029189),n=S(n,r,o,s,e[i+9],4,-640364487),s=S(s,n,r,o,e[i+12],11,-421815835),o=S(o,s,n,r,e[i+15],16,530742520),n=j(n,r=S(r,o,s,n,e[i+2],23,-995338651),o,s,e[i],6,-198630844),s=j(s,n,r,o,e[i+7],10,1126891415),o=j(o,s,n,r,e[i+14],15,-1416354905),r=j(r,o,s,n,e[i+5],21,-57434055),n=j(n,r,o,s,e[i+12],6,1700485571),s=j(s,n,r,o,e[i+3],10,-1894986606),o=j(o,s,n,r,e[i+10],15,-1051523),r=j(r,o,s,n,e[i+1],21,-2054922799),n=j(n,r,o,s,e[i+8],6,1873313359),s=j(s,n,r,o,e[i+15],10,-30611744),o=j(o,s,n,r,e[i+6],15,-1560198380),r=j(r,o,s,n,e[i+13],21,1309151649),n=j(n,r,o,s,e[i+4],6,-145523070),s=j(s,n,r,o,e[i+11],10,-1120210379),o=j(o,s,n,r,e[i+2],15,718787259),r=j(r,o,s,n,e[i+9],21,-343485551),n=y(n,a),r=y(r,u),o=y(o,c),s=y(s,d)}return[n,r,o,s]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(v(t)),r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))})),x=function(e,t,n){var r=(e=e||{}).random||(e.rng||s)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return h(r)};function O(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function E(e,t){return e<<t|e>>>32-t}var I=b("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var o=0;o<r.length;++o)e.push(r.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var s=e.length/4+2,i=Math.ceil(s/16),a=new Array(i),u=0;u<i;++u){for(var c=new Uint32Array(16),d=0;d<16;++d)c[d]=e[64*u+4*d]<<24|e[64*u+4*d+1]<<16|e[64*u+4*d+2]<<8|e[64*u+4*d+3];a[u]=c}a[i-1][14]=8*(e.length-1)/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=8*(e.length-1)&4294967295;for(var l=0;l<i;++l){for(var h=new Uint32Array(80),f=0;f<16;++f)h[f]=a[l][f];for(var m=16;m<80;++m)h[m]=E(h[m-3]^h[m-8]^h[m-14]^h[m-16],1);for(var p=n[0],g=n[1],b=n[2],v=n[3],y=n[4],_=0;_<80;++_){var w=Math.floor(_/20),k=E(p,5)+O(w,g,b,v)+y+t[w]+h[_]>>>0;y=v,v=b,b=E(g,30)>>>0,g=p,p=k}n[0]=n[0]+p>>>0,n[1]=n[1]+g>>>0,n[2]=n[2]+b>>>0,n[3]=n[3]+v>>>0,n[4]=n[4]+y>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),A="00000000-0000-0000-0000-000000000000",N=function(e){if(!a(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},"../notebook-dds/node_modules/after/index.js":function(e,t){function n(){}e.exports=function(e,t,r){var o=!1;return r=r||n,s.count=e,0===e?t():s;function s(e,n){if(s.count<=0)throw new Error("after called too many times");--s.count,e?(o=!0,t(e),t=r):0!==s.count||o||t(null,n)}}},"../notebook-dds/node_modules/arraybuffer.slice/index.js":function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),s=new Uint8Array(n-t),i=t,a=0;i<n;i++,a++)s[a]=o[i];return s.buffer}},"../notebook-dds/node_modules/async/dist/async.js":function(e,t,n){(function(e,n,r,o){!function(t){"use strict";function s(e,t){t|=0;for(var n=Math.max(e.length-t,0),r=Array(n),o=0;o<n;o++)r[o]=e[t+o];return r}var i=function(e){var t=s(arguments,1);return function(){var n=s(arguments);return e.apply(null,t.concat(n))}},a=function(e){return function(){var t=s(arguments),n=t.pop();e.call(this,t,n)}};function u(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var c="function"==typeof e&&e,d="object"==typeof n&&"function"==typeof n.nextTick;function l(e){setTimeout(e,0)}function h(e){return function(t){var n=s(arguments,1);e((function(){t.apply(null,n)}))}}var f=h(c?e:d?n.nextTick:l);function m(e){return a((function(t,n){var r;try{r=e.apply(this,t)}catch(e){return n(e)}u(r)&&"function"==typeof r.then?r.then((function(e){p(n,null,e)}),(function(e){p(n,e.message?e:new Error(e))})):n(null,r)}))}function p(e,t,n){try{e(t,n)}catch(e){f(g,e)}}function g(e){throw e}var b="function"==typeof Symbol;function v(e){return b&&"AsyncFunction"===e[Symbol.toStringTag]}function y(e){return v(e)?m(e):e}function _(e){return function(t){var n=s(arguments,1),r=a((function(n,r){var o=this;return e(t,(function(e,t){y(e).apply(o,n.concat(t))}),r)}));return n.length?r.apply(this,n):r}}var w="object"==typeof r&&r&&r.Object===Object&&r,k="object"==typeof self&&self&&self.Object===Object&&self,S=w||k||Function("return this")(),j=S.Symbol,C=Object.prototype,x=C.hasOwnProperty,O=C.toString,E=j?j.toStringTag:void 0,I=Object.prototype.toString,A=j?j.toStringTag:void 0;function N(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":A&&A in Object(e)?function(e){var t=x.call(e,E),n=e[E];try{e[E]=void 0;var r=!0}catch(e){}var o=O.call(e);return r&&(t?e[E]=n:delete e[E]),o}(e):function(e){return I.call(e)}(e)}function T(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function F(e){return null!=e&&T(e.length)&&!function(e){if(!u(e))return!1;var t=N(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}(e)}var P={};function R(){}function D(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var M="function"==typeof Symbol&&Symbol.iterator;function L(e){return null!=e&&"object"==typeof e}function B(e){return L(e)&&"[object Arguments]"==N(e)}var q=Object.prototype,z=q.hasOwnProperty,H=q.propertyIsEnumerable,U=B(function(){return arguments}())?B:function(e){return L(e)&&z.call(e,"callee")&&!H.call(e,"callee")},V=Array.isArray,$="object"==typeof t&&t&&!t.nodeType&&t,W=$&&"object"==typeof o&&o&&!o.nodeType&&o,K=W&&W.exports===$?S.Buffer:void 0,G=(K?K.isBuffer:void 0)||function(){return!1},J=/^(?:0|[1-9]\d*)$/;function Z(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&J.test(e))&&e>-1&&e%1==0&&e<t}var X={};X["[object Float32Array]"]=X["[object Float64Array]"]=X["[object Int8Array]"]=X["[object Int16Array]"]=X["[object Int32Array]"]=X["[object Uint8Array]"]=X["[object Uint8ClampedArray]"]=X["[object Uint16Array]"]=X["[object Uint32Array]"]=!0,X["[object Arguments]"]=X["[object Array]"]=X["[object ArrayBuffer]"]=X["[object Boolean]"]=X["[object DataView]"]=X["[object Date]"]=X["[object Error]"]=X["[object Function]"]=X["[object Map]"]=X["[object Number]"]=X["[object Object]"]=X["[object RegExp]"]=X["[object Set]"]=X["[object String]"]=X["[object WeakMap]"]=!1;var Y,Q="object"==typeof t&&t&&!t.nodeType&&t,ee=Q&&"object"==typeof o&&o&&!o.nodeType&&o,te=ee&&ee.exports===Q&&w.process,ne=function(){try{return ee&&ee.require&&ee.require("util").types||te&&te.binding&&te.binding("util")}catch(e){}}(),re=ne&&ne.isTypedArray,oe=re?(Y=re,function(e){return Y(e)}):function(e){return L(e)&&T(e.length)&&!!X[N(e)]},se=Object.prototype.hasOwnProperty;var ie=Object.prototype,ae=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),ue=Object.prototype.hasOwnProperty;function ce(e){return F(e)?function(e,t){var n=V(e),r=!n&&U(e),o=!n&&!r&&G(e),s=!n&&!r&&!o&&oe(e),i=n||r||o||s,a=i?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=a.length;for(var c in e)!t&&!se.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Z(c,u))||a.push(c);return a}(e):function(e){if(!function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ie)}(e))return ae(e);var t=[];for(var n in Object(e))ue.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}function de(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function le(e){return function(t,n,r){if(r=D(r||R),e<=0||!t)return r(null);var o=function(e){if(F(e))return function(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}(e);var t=function(e){return M&&e[M]&&e[M]()}(e);return t?function(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(t):function(e){var t=ce(e),n=-1,r=t.length;return function(){var o=t[++n];return n<r?{value:e[o],key:o}:null}}(e)}(t),s=!1,i=0,a=!1;function u(e,t){if(i-=1,e)s=!0,r(e);else{if(t===P||s&&i<=0)return s=!0,r(null);a||c()}}function c(){for(a=!0;i<e&&!s;){var t=o();if(null===t)return s=!0,void(i<=0&&r(null));i+=1,n(t.value,t.key,de(u))}a=!1}c()}}function he(e,t,n,r){le(t)(e,y(n),r)}function fe(e,t){return function(n,r,o){return e(n,t,r,o)}}function me(e,t,n){n=D(n||R);var r=0,o=0,s=e.length;function i(e,t){e?n(e):++o!==s&&t!==P||n(null)}for(0===s&&n(null);r<s;r++)t(e[r],r,de(i))}var pe=fe(he,1/0),ge=function(e,t,n){(F(e)?me:pe)(e,y(t),n)};function be(e){return function(t,n,r){return e(ge,t,y(n),r)}}function ve(e,t,n,r){r=r||R,t=t||[];var o=[],s=0,i=y(n);e(t,(function(e,t,n){var r=s++;i(e,(function(e,t){o[r]=t,n(e)}))}),(function(e){r(e,o)}))}var ye=be(ve),_e=_(ye);function we(e){return function(t,n,r,o){return e(le(n),t,y(r),o)}}var ke=we(ve),Se=fe(ke,1),je=_(Se);function Ce(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function xe(e,t){return e&&function(e,t,n){for(var r=-1,o=Object(e),s=n(e),i=s.length;i--;){var a=s[++r];if(!1===t(o[a],a,o))break}return e}(e,t,ce)}function Oe(e){return e!=e}function Ee(e,t,n){return t==t?function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t,n):function(e,t,n,r){for(var o=e.length,s=n+-1;++s<o;)if(t(e[s],s,e))return s;return-1}(e,Oe,n)}var Ie=function(e,t,n){"function"==typeof t&&(n=t,t=null),n=D(n||R);var r=ce(e).length;if(!r)return n(null);t||(t=r);var o={},i=0,a=!1,u=Object.create(null),c=[],d=[],l={};function h(e,t){c.push((function(){!function(e,t){if(!a){var r=de((function(t,r){if(i--,arguments.length>2&&(r=s(arguments,1)),t){var c={};xe(o,(function(e,t){c[t]=e})),c[e]=r,a=!0,u=Object.create(null),n(t,c)}else o[e]=r,m(e)}));i++;var c=y(t[t.length-1]);t.length>1?c(o,r):c(r)}}(e,t)}))}function f(){if(0===c.length&&0===i)return n(null,o);for(;c.length&&i<t;)c.shift()()}function m(e){Ce(u[e]||[],(function(e){e()})),f()}function p(t){var n=[];return xe(e,(function(e,r){V(e)&&Ee(e,t,0)>=0&&n.push(r)})),n}xe(e,(function(t,n){if(!V(t))return h(n,[t]),void d.push(n);var r=t.slice(0,t.length-1),o=r.length;if(0===o)return h(n,t),void d.push(n);l[n]=o,Ce(r,(function(s){if(!e[s])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+s+"` in "+r.join(", "));!function(e,t){var n=u[e];n||(n=u[e]=[]),n.push(t)}(s,(function(){0==--o&&h(n,t)}))}))})),function(){for(var e=0;d.length;)e++,Ce(p(d.pop()),(function(e){0==--l[e]&&d.push(e)}));if(e!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),f()};function Ae(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}var Ne=j?j.prototype:void 0,Te=Ne?Ne.toString:void 0;function Fe(e){if("string"==typeof e)return e;if(V(e))return Ae(e,Fe)+"";if(function(e){return"symbol"==typeof e||L(e)&&"[object Symbol]"==N(e)}(e))return Te?Te.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}var Pe=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),Re="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",De="\\ud83c[\\udffb-\\udfff]",Me="[^\\ud800-\\udfff]",Le="(?:\\ud83c[\\udde6-\\uddff]){2}",Be="[\\ud800-\\udbff][\\udc00-\\udfff]",qe="(?:"+Re+"|"+De+")?",ze="[\\ufe0e\\ufe0f]?",He=ze+qe+"(?:\\u200d(?:"+[Me,Le,Be].join("|")+")"+ze+qe+")*",Ue="(?:"+[Me+Re+"?",Re,Le,Be,"[\\ud800-\\udfff]"].join("|")+")",Ve=RegExp(De+"(?="+De+")|"+Ue+He,"g");function $e(e){return function(e){return Pe.test(e)}(e)?function(e){return e.match(Ve)||[]}(e):function(e){return e.split("")}(e)}var We=/^\s+|\s+$/g;function Ke(e,t,n){var r;if((e=null==(r=e)?"":Fe(r))&&(n||void 0===t))return e.replace(We,"");if(!e||!(t=Fe(t)))return e;var o=$e(e),s=$e(t);return function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(o);++r<o;)s[r]=e[r+t];return s}(e,t,n)}(o,function(e,t){for(var n=-1,r=e.length;++n<r&&Ee(t,e[n],0)>-1;);return n}(o,s),function(e,t){for(var n=e.length;n--&&Ee(t,e[n],0)>-1;);return n}(o,s)+1).join("")}var Ge=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Je=/,/,Ze=/(=.+)?(\s*)$/,Xe=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function Ye(e,t){var n={};xe(e,(function(e,t){var r,o=v(e),s=!o&&1===e.length||o&&0===e.length;if(V(e))r=e.slice(0,-1),e=e[e.length-1],n[t]=r.concat(r.length>0?i:e);else if(s)n[t]=e;else{if(r=function(e){return(e=(e=(e=e.toString().replace(Xe,"")).match(Ge)[2].replace(" ",""))?e.split(Je):[]).map((function(e){return Ke(e.replace(Ze,""))}))}(e),0===e.length&&!o&&0===r.length)throw new Error("autoInject task functions require explicit parameters.");o||r.pop(),n[t]=r.concat(i)}function i(t,n){var o=Ae(r,(function(e){return t[e]}));o.push(n),y(e).apply(null,o)}})),Ie(n,t)}function Qe(){this.head=this.tail=null,this.length=0}function et(e,t){e.length=1,e.head=e.tail=t}function tt(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var r=y(e),o=0,s=[],i=!1;function a(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(d.started=!0,V(e)||(e=[e]),0===e.length&&d.idle())return f((function(){d.drain()}));for(var r=0,o=e.length;r<o;r++){var s={data:e[r],callback:n||R};t?d._tasks.unshift(s):d._tasks.push(s)}i||(i=!0,f((function(){i=!1,d.process()})))}function u(e){return function(t){o-=1;for(var n=0,r=e.length;n<r;n++){var i=e[n],a=Ee(s,i,0);0===a?s.shift():a>0&&s.splice(a,1),i.callback.apply(i,arguments),null!=t&&d.error(t,i.data)}o<=d.concurrency-d.buffer&&d.unsaturated(),d.idle()&&d.drain(),d.process()}}var c=!1,d={_tasks:new Qe,concurrency:t,payload:n,saturated:R,unsaturated:R,buffer:t/4,empty:R,drain:R,error:R,started:!1,paused:!1,push:function(e,t){a(e,!1,t)},kill:function(){d.drain=R,d._tasks.empty()},unshift:function(e,t){a(e,!0,t)},remove:function(e){d._tasks.remove(e)},process:function(){if(!c){for(c=!0;!d.paused&&o<d.concurrency&&d._tasks.length;){var e=[],t=[],n=d._tasks.length;d.payload&&(n=Math.min(n,d.payload));for(var i=0;i<n;i++){var a=d._tasks.shift();e.push(a),s.push(a),t.push(a.data)}o+=1,0===d._tasks.length&&d.empty(),o===d.concurrency&&d.saturated();var l=de(u(e));r(t,l)}c=!1}},length:function(){return d._tasks.length},running:function(){return o},workersList:function(){return s},idle:function(){return d._tasks.length+o===0},pause:function(){d.paused=!0},resume:function(){!1!==d.paused&&(d.paused=!1,f(d.process))}};return d}function nt(e,t){return tt(e,1,t)}Qe.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},Qe.prototype.empty=function(){for(;this.head;)this.shift();return this},Qe.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},Qe.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},Qe.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):et(this,e)},Qe.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):et(this,e)},Qe.prototype.shift=function(){return this.head&&this.removeLink(this.head)},Qe.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},Qe.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,n=0;n<this.length;n++)e[n]=t.data,t=t.next;return e},Qe.prototype.remove=function(e){for(var t=this.head;t;){var n=t.next;e(t)&&this.removeLink(t),t=n}return this};var rt=fe(he,1);function ot(e,t,n,r){r=D(r||R);var o=y(n);rt(e,(function(e,n,r){o(t,e,(function(e,n){t=n,r(e)}))}),(function(e){r(e,t)}))}function st(){var e=Ae(arguments,y);return function(){var t=s(arguments),n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=R,ot(e,t,(function(e,t,r){t.apply(n,e.concat((function(e){var t=s(arguments,1);r(e,t)})))}),(function(e,t){r.apply(n,[e].concat(t))}))}}var it=function(){return st.apply(null,s(arguments).reverse())},at=Array.prototype.concat,ut=function(e,t,n,r){r=r||R;var o=y(n);ke(e,t,(function(e,t){o(e,(function(e){return e?t(e):t(null,s(arguments,1))}))}),(function(e,t){for(var n=[],o=0;o<t.length;o++)t[o]&&(n=at.apply(n,t[o]));return r(e,n)}))},ct=fe(ut,1/0),dt=fe(ut,1),lt=function(){var e=s(arguments),t=[null].concat(e);return function(){var e=arguments[arguments.length-1];return e.apply(this,t)}};function ht(e){return e}function ft(e,t){return function(n,r,o,s){s=s||R;var i,a=!1;n(r,(function(n,r,s){o(n,(function(r,o){r?s(r):e(o)&&!i?(a=!0,i=t(!0,n),s(null,P)):s()}))}),(function(e){e?s(e):s(null,a?i:t(!1))}))}}function mt(e,t){return t}var pt=be(ft(ht,mt)),gt=we(ft(ht,mt)),bt=fe(gt,1);function vt(e){return function(t){var n=s(arguments,1);n.push((function(t){var n=s(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&Ce(n,(function(t){console[e](t)})))})),y(t).apply(null,n)}}var yt=vt("dir");function _t(e,t,n){n=de(n||R);var r=y(e),o=y(t);function i(e){if(e)return n(e);var t=s(arguments,1);t.push(a),o.apply(this,t)}function a(e,t){return e?n(e):t?void r(i):n(null)}a(null,!0)}function wt(e,t,n){n=de(n||R);var r=y(e),o=function(e){if(e)return n(e);var i=s(arguments,1);if(t.apply(this,i))return r(o);n.apply(null,[null].concat(i))};r(o)}function kt(e,t,n){wt(e,(function(){return!t.apply(this,arguments)}),n)}function St(e,t,n){n=de(n||R);var r=y(t),o=y(e);function s(e){if(e)return n(e);o(i)}function i(e,t){return e?n(e):t?void r(s):n(null)}o(i)}function jt(e){return function(t,n,r){return e(t,r)}}function Ct(e,t,n){ge(e,jt(y(t)),n)}function xt(e,t,n,r){le(t)(e,jt(y(n)),r)}var Ot=fe(xt,1);function Et(e){return v(e)?e:a((function(t,n){var r=!0;t.push((function(){var e=arguments;r?f((function(){n.apply(null,e)})):n.apply(null,e)})),e.apply(this,t),r=!1}))}function It(e){return!e}var At=be(ft(It,It)),Nt=we(ft(It,It)),Tt=fe(Nt,1);function Ft(e){return function(t){return null==t?void 0:t[e]}}function Pt(e,t,n,r){var o=new Array(t.length);e(t,(function(e,t,r){n(e,(function(e,n){o[t]=!!n,r(e)}))}),(function(e){if(e)return r(e);for(var n=[],s=0;s<t.length;s++)o[s]&&n.push(t[s]);r(null,n)}))}function Rt(e,t,n,r){var o=[];e(t,(function(e,t,r){n(e,(function(n,s){n?r(n):(s&&o.push({index:t,value:e}),r())}))}),(function(e){e?r(e):r(null,Ae(o.sort((function(e,t){return e.index-t.index})),Ft("value")))}))}function Dt(e,t,n,r){(F(t)?Pt:Rt)(e,t,y(n),r||R)}var Mt=be(Dt),Lt=we(Dt),Bt=fe(Lt,1);function qt(e,t){var n=de(t||R),r=y(Et(e));!function e(t){if(t)return n(t);r(e)}()}var zt=function(e,t,n,r){r=r||R;var o=y(n);ke(e,t,(function(e,t){o(e,(function(n,r){return n?t(n):t(null,{key:r,val:e})}))}),(function(e,t){for(var n={},o=Object.prototype.hasOwnProperty,s=0;s<t.length;s++)if(t[s]){var i=t[s].key,a=t[s].val;o.call(n,i)?n[i].push(a):n[i]=[a]}return r(e,n)}))},Ht=fe(zt,1/0),Ut=fe(zt,1),Vt=vt("log");function $t(e,t,n,r){r=D(r||R);var o={},s=y(n);he(e,t,(function(e,t,n){s(e,t,(function(e,r){if(e)return n(e);o[t]=r,n()}))}),(function(e){r(e,o)}))}var Wt=fe($t,1/0),Kt=fe($t,1);function Gt(e,t){return t in e}function Jt(e,t){var n=Object.create(null),r=Object.create(null);t=t||ht;var o=y(e),i=a((function(e,i){var a=t.apply(null,e);Gt(n,a)?f((function(){i.apply(null,n[a])})):Gt(r,a)?r[a].push(i):(r[a]=[i],o.apply(null,e.concat((function(){var e=s(arguments);n[a]=e;var t=r[a];delete r[a];for(var o=0,i=t.length;o<i;o++)t[o].apply(null,e)}))))}));return i.memo=n,i.unmemoized=e,i}var Zt=h(d?n.nextTick:c?e:l);function Xt(e,t,n){n=n||R;var r=F(t)?[]:{};e(t,(function(e,t,n){y(e)((function(e,o){arguments.length>2&&(o=s(arguments,1)),r[t]=o,n(e)}))}),(function(e){n(e,r)}))}function Yt(e,t){Xt(ge,e,t)}function Qt(e,t,n){Xt(le(t),e,n)}var en=function(e,t){var n=y(e);return tt((function(e,t){n(e[0],t)}),t,1)},tn=function(e,t){var n=en(e,t);return n.push=function(e,t,r){if(null==r&&(r=R),"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,V(e)||(e=[e]),0===e.length)return f((function(){n.drain()}));t=t||0;for(var o=n._tasks.head;o&&t>=o.priority;)o=o.next;for(var s=0,i=e.length;s<i;s++){var a={data:e[s],priority:t,callback:r};o?n._tasks.insertBefore(o,a):n._tasks.push(a)}f(n.process)},delete n.unshift,n};function nn(e,t){if(t=D(t||R),!V(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,r=e.length;n<r;n++)y(e[n])(t)}function rn(e,t,n,r){ot(s(e).reverse(),t,n,r)}function on(e){var t=y(e);return a((function(e,n){return e.push((function(e,t){var r;e?n(null,{error:e}):(r=arguments.length<=2?t:s(arguments,1),n(null,{value:r}))})),t.apply(this,e)}))}function sn(e){var t;return V(e)?t=Ae(e,on):(t={},xe(e,(function(e,n){t[n]=on.call(this,e)}))),t}function an(e,t,n,r){Dt(e,t,(function(e,t){n(e,(function(e,n){t(e,!n)}))}),r)}var un=be(an),cn=we(an),dn=fe(cn,1);function ln(e){return function(){return e}}function hn(e,t,n){var r=5,o=0,s={times:r,intervalFunc:ln(o)};function i(e,t){if("object"==typeof t)e.times=+t.times||r,e.intervalFunc="function"==typeof t.interval?t.interval:ln(+t.interval||o),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||r}}if(arguments.length<3&&"function"==typeof e?(n=t||R,t=e):(i(s,e),n=n||R),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var a=y(t),u=1;function c(){a((function(e){e&&u++<s.times&&("function"!=typeof s.errorFilter||s.errorFilter(e))?setTimeout(c,s.intervalFunc(u)):n.apply(null,arguments)}))}c()}var fn=function(e,t){t||(t=e,e=null);var n=y(t);return a((function(t,r){function o(e){n.apply(null,t.concat(e))}e?hn(e,o,r):hn(o,r)}))};function mn(e,t){Xt(rt,e,t)}var pn=be(ft(Boolean,ht)),gn=we(ft(Boolean,ht)),bn=fe(gn,1);function vn(e,t,n){var r=y(t);function o(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}ye(e,(function(e,t){r(e,(function(n,r){if(n)return t(n);t(null,{value:e,criteria:r})}))}),(function(e,t){if(e)return n(e);n(null,Ae(t.sort(o),Ft("value")))}))}function yn(e,t,n){var r=y(e);return a((function(o,s){var i,a=!1;o.push((function(){a||(s.apply(null,arguments),clearTimeout(i))})),i=setTimeout((function(){var t=e.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),a=!0,s(r)}),t),r.apply(null,o)}))}var _n=Math.ceil,wn=Math.max;function kn(e,t,n,r){var o=y(n);ke(function(e,t,n,r){for(var o=-1,s=wn(_n((t-e)/1),0),i=Array(s);s--;)i[++o]=e,e+=1;return i}(0,e),t,o,r)}var Sn=fe(kn,1/0),jn=fe(kn,1);function Cn(e,t,n,r){arguments.length<=3&&(r=n,n=t,t=V(e)?[]:{}),r=D(r||R);var o=y(n);ge(e,(function(e,n,r){o(t,e,n,r)}),(function(e){r(e,t)}))}function xn(e,t){var n,r=null;t=t||R,Ot(e,(function(e,t){y(e)((function(e,o){n=arguments.length>2?s(arguments,1):o,r=e,t(!e)}))}),(function(){t(r,n)}))}function On(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function En(e,t,n){n=de(n||R);var r=y(t);if(!e())return n(null);var o=function(t){if(t)return n(t);if(e())return r(o);var i=s(arguments,1);n.apply(null,[null].concat(i))};r(o)}function In(e,t,n){En((function(){return!e.apply(this,arguments)}),t,n)}var An=function(e,t){if(t=D(t||R),!V(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var n=0;function r(t){var r=y(e[n++]);t.push(de(o)),r.apply(null,t)}function o(o){if(o||n===e.length)return t.apply(null,arguments);r(s(arguments,1))}r([])},Nn={apply:i,applyEach:_e,applyEachSeries:je,asyncify:m,auto:Ie,autoInject:Ye,cargo:nt,compose:it,concat:ct,concatLimit:ut,concatSeries:dt,constant:lt,detect:pt,detectLimit:gt,detectSeries:bt,dir:yt,doDuring:_t,doUntil:kt,doWhilst:wt,during:St,each:Ct,eachLimit:xt,eachOf:ge,eachOfLimit:he,eachOfSeries:rt,eachSeries:Ot,ensureAsync:Et,every:At,everyLimit:Nt,everySeries:Tt,filter:Mt,filterLimit:Lt,filterSeries:Bt,forever:qt,groupBy:Ht,groupByLimit:zt,groupBySeries:Ut,log:Vt,map:ye,mapLimit:ke,mapSeries:Se,mapValues:Wt,mapValuesLimit:$t,mapValuesSeries:Kt,memoize:Jt,nextTick:Zt,parallel:Yt,parallelLimit:Qt,priorityQueue:tn,queue:en,race:nn,reduce:ot,reduceRight:rn,reflect:on,reflectAll:sn,reject:un,rejectLimit:cn,rejectSeries:dn,retry:hn,retryable:fn,seq:st,series:mn,setImmediate:f,some:pn,someLimit:gn,someSeries:bn,sortBy:vn,timeout:yn,times:Sn,timesLimit:kn,timesSeries:jn,transform:Cn,tryEach:xn,unmemoize:On,until:In,waterfall:An,whilst:En,all:At,allLimit:Nt,allSeries:Tt,any:pn,anyLimit:gn,anySeries:bn,find:pt,findLimit:gt,findSeries:bt,forEach:Ct,forEachSeries:Ot,forEachLimit:xt,forEachOf:ge,forEachOfSeries:rt,forEachOfLimit:he,inject:ot,foldl:ot,foldr:rn,select:Mt,selectLimit:Lt,selectSeries:Bt,wrapSync:m};t.default=Nn,t.apply=i,t.applyEach=_e,t.applyEachSeries=je,t.asyncify=m,t.auto=Ie,t.autoInject=Ye,t.cargo=nt,t.compose=it,t.concat=ct,t.concatLimit=ut,t.concatSeries=dt,t.constant=lt,t.detect=pt,t.detectLimit=gt,t.detectSeries=bt,t.dir=yt,t.doDuring=_t,t.doUntil=kt,t.doWhilst=wt,t.during=St,t.each=Ct,t.eachLimit=xt,t.eachOf=ge,t.eachOfLimit=he,t.eachOfSeries=rt,t.eachSeries=Ot,t.ensureAsync=Et,t.every=At,t.everyLimit=Nt,t.everySeries=Tt,t.filter=Mt,t.filterLimit=Lt,t.filterSeries=Bt,t.forever=qt,t.groupBy=Ht,t.groupByLimit=zt,t.groupBySeries=Ut,t.log=Vt,t.map=ye,t.mapLimit=ke,t.mapSeries=Se,t.mapValues=Wt,t.mapValuesLimit=$t,t.mapValuesSeries=Kt,t.memoize=Jt,t.nextTick=Zt,t.parallel=Yt,t.parallelLimit=Qt,t.priorityQueue=tn,t.queue=en,t.race=nn,t.reduce=ot,t.reduceRight=rn,t.reflect=on,t.reflectAll=sn,t.reject=un,t.rejectLimit=cn,t.rejectSeries=dn,t.retry=hn,t.retryable=fn,t.seq=st,t.series=mn,t.setImmediate=f,t.some=pn,t.someLimit=gn,t.someSeries=bn,t.sortBy=vn,t.timeout=yn,t.times=Sn,t.timesLimit=kn,t.timesSeries=jn,t.transform=Cn,t.tryEach=xn,t.unmemoize=On,t.until=In,t.waterfall=An,t.whilst=En,t.all=At,t.allLimit=Nt,t.allSeries=Tt,t.any=pn,t.anyLimit=gn,t.anySeries=bn,t.find=pt,t.findLimit=gt,t.findSeries=bt,t.forEach=Ct,t.forEachSeries=Ot,t.forEachLimit=xt,t.forEachOf=ge,t.forEachOfSeries=rt,t.forEachOfLimit=he,t.inject=ot,t.foldl=ot,t.foldr=rn,t.select=Mt,t.selectLimit=Lt,t.selectSeries=Bt,t.wrapSync=m,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,n("./node_modules/timers-browserify/main.js").setImmediate,n("./node_modules/process/browser.js"),n("./node_modules/webpack/buildin/global.js"),n("./node_modules/webpack/buildin/module.js")(e))},"../notebook-dds/node_modules/axios/index.js":function(e,t,n){e.exports=n("../notebook-dds/node_modules/axios/lib/axios.js")},"../notebook-dds/node_modules/axios/lib/adapters/xhr.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js"),o=n("../notebook-dds/node_modules/axios/lib/core/settle.js"),s=n("../notebook-dds/node_modules/axios/lib/helpers/cookies.js"),i=n("../notebook-dds/node_modules/axios/lib/helpers/buildURL.js"),a=n("../notebook-dds/node_modules/axios/lib/core/buildFullPath.js"),u=n("../notebook-dds/node_modules/axios/lib/helpers/parseHeaders.js"),c=n("../notebook-dds/node_modules/axios/lib/helpers/isURLSameOrigin.js"),d=n("../notebook-dds/node_modules/axios/lib/core/createError.js");e.exports=function(e){return new Promise((function(t,n){var l=e.data,h=e.headers;r.isFormData(l)&&delete h["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",p=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";h.Authorization="Basic "+btoa(m+":"+p)}var g=a(e.baseURL,e.url);if(f.open(e.method.toUpperCase(),i(g,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in f?u(f.getAllResponseHeaders()):null,s={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:r,config:e,request:f};o(t,n,s),f=null}},f.onabort=function(){f&&(n(d("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){n(d("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(d(t,e,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var b=(e.withCredentials||c(g))&&e.xsrfCookieName?s.read(e.xsrfCookieName):void 0;b&&(h[e.xsrfHeaderName]=b)}if("setRequestHeader"in f&&r.forEach(h,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete h[t]:f.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),n(e),f=null)})),l||(l=null),f.send(l)}))}},"../notebook-dds/node_modules/axios/lib/axios.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js"),o=n("../notebook-dds/node_modules/axios/lib/helpers/bind.js"),s=n("../notebook-dds/node_modules/axios/lib/core/Axios.js"),i=n("../notebook-dds/node_modules/axios/lib/core/mergeConfig.js");function a(e){var t=new s(e),n=o(s.prototype.request,t);return r.extend(n,s.prototype,t),r.extend(n,t),n}var u=a(n("../notebook-dds/node_modules/axios/lib/defaults.js"));u.Axios=s,u.create=function(e){return a(i(u.defaults,e))},u.Cancel=n("../notebook-dds/node_modules/axios/lib/cancel/Cancel.js"),u.CancelToken=n("../notebook-dds/node_modules/axios/lib/cancel/CancelToken.js"),u.isCancel=n("../notebook-dds/node_modules/axios/lib/cancel/isCancel.js"),u.all=function(e){return Promise.all(e)},u.spread=n("../notebook-dds/node_modules/axios/lib/helpers/spread.js"),u.isAxiosError=n("../notebook-dds/node_modules/axios/lib/helpers/isAxiosError.js"),e.exports=u,e.exports.default=u},"../notebook-dds/node_modules/axios/lib/cancel/Cancel.js":function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},"../notebook-dds/node_modules/axios/lib/cancel/CancelToken.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/cancel/Cancel.js");function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},"../notebook-dds/node_modules/axios/lib/cancel/isCancel.js":function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},"../notebook-dds/node_modules/axios/lib/core/Axios.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js"),o=n("../notebook-dds/node_modules/axios/lib/helpers/buildURL.js"),s=n("../notebook-dds/node_modules/axios/lib/core/InterceptorManager.js"),i=n("../notebook-dds/node_modules/axios/lib/core/dispatchRequest.js"),a=n("../notebook-dds/node_modules/axios/lib/core/mergeConfig.js");function u(e){this.defaults=e,this.interceptors={request:new s,response:new s}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[i,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},u.prototype.getUri=function(e){return e=a(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,n,r){return this.request(a(r||{},{method:e,url:t,data:n}))}})),e.exports=u},"../notebook-dds/node_modules/axios/lib/core/InterceptorManager.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js");function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},"../notebook-dds/node_modules/axios/lib/core/buildFullPath.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/helpers/isAbsoluteURL.js"),o=n("../notebook-dds/node_modules/axios/lib/helpers/combineURLs.js");e.exports=function(e,t){return e&&!r(t)?o(e,t):t}},"../notebook-dds/node_modules/axios/lib/core/createError.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/core/enhanceError.js");e.exports=function(e,t,n,o,s){var i=new Error(e);return r(i,t,n,o,s)}},"../notebook-dds/node_modules/axios/lib/core/dispatchRequest.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js"),o=n("../notebook-dds/node_modules/axios/lib/core/transformData.js"),s=n("../notebook-dds/node_modules/axios/lib/cancel/isCancel.js"),i=n("../notebook-dds/node_modules/axios/lib/defaults.js");function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return a(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return s(t)||(a(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},"../notebook-dds/node_modules/axios/lib/core/enhanceError.js":function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},"../notebook-dds/node_modules/axios/lib/core/mergeConfig.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js");e.exports=function(e,t){t=t||{};var n={},o=["url","method","data"],s=["headers","auth","proxy","params"],i=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function u(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function c(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=u(void 0,e[o])):n[o]=u(e[o],t[o])}r.forEach(o,(function(e){r.isUndefined(t[e])||(n[e]=u(void 0,t[e]))})),r.forEach(s,c),r.forEach(i,(function(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=u(void 0,e[o])):n[o]=u(void 0,t[o])})),r.forEach(a,(function(r){r in t?n[r]=u(e[r],t[r]):r in e&&(n[r]=u(void 0,e[r]))}));var d=o.concat(s).concat(i).concat(a),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return r.forEach(l,c),n}},"../notebook-dds/node_modules/axios/lib/core/settle.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/core/createError.js");e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},"../notebook-dds/node_modules/axios/lib/core/transformData.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js");e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},"../notebook-dds/node_modules/axios/lib/defaults.js":function(e,t,n){"use strict";(function(t){var r=n("../notebook-dds/node_modules/axios/lib/utils.js"),o=n("../notebook-dds/node_modules/axios/lib/helpers/normalizeHeaderName.js"),s={"Content-Type":"application/x-www-form-urlencoded"};function i(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a={adapter:function(){var e;return("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(e=n("../notebook-dds/node_modules/axios/lib/adapters/xhr.js")),e}(),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(i(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(i(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){a.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){a.headers[e]=r.merge(s)})),e.exports=a}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/axios/lib/helpers/bind.js":function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},"../notebook-dds/node_modules/axios/lib/helpers/buildURL.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js");function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(r.isURLSearchParams(t))s=t.toString();else{var i=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),i.push(o(t)+"="+o(e))})))})),s=i.join("&")}if(s){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}},"../notebook-dds/node_modules/axios/lib/helpers/combineURLs.js":function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},"../notebook-dds/node_modules/axios/lib/helpers/cookies.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js");e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,s,i){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(s)&&a.push("domain="+s),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},"../notebook-dds/node_modules/axios/lib/helpers/isAbsoluteURL.js":function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},"../notebook-dds/node_modules/axios/lib/helpers/isAxiosError.js":function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},"../notebook-dds/node_modules/axios/lib/helpers/isURLSameOrigin.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js");e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},"../notebook-dds/node_modules/axios/lib/helpers/normalizeHeaderName.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js");e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},"../notebook-dds/node_modules/axios/lib/helpers/parseHeaders.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/utils.js"),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,i={};return e?(r.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t){if(i[t]&&o.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([n]):i[t]?i[t]+", "+n:n}})),i):i}},"../notebook-dds/node_modules/axios/lib/helpers/spread.js":function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},"../notebook-dds/node_modules/axios/lib/utils.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/axios/lib/helpers/bind.js"),o=Object.prototype.toString;function s(e){return"[object Array]"===o.call(e)}function i(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function u(e){if("[object Object]"!==o.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===o.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!i(e)&&null!==e.constructor&&!i(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:u,isUndefined:i,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function e(){var t={};function n(n,r){u(t[r])&&u(n)?t[r]=e(t[r],n):u(n)?t[r]=e({},n):s(n)?t[r]=n.slice():t[r]=n}for(var r=0,o=arguments.length;r<o;r++)d(arguments[r],n);return t},extend:function(e,t,n){return d(t,(function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},"../notebook-dds/node_modules/backo2/index.js":function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},"../notebook-dds/node_modules/base64-arraybuffer/lib/base64-arraybuffer.js":function(e,t){!function(e){"use strict";t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,s="";for(n=0;n<o;n+=3)s+=e[r[n]>>2],s+=e[(3&r[n])<<4|r[n+1]>>4],s+=e[(15&r[n+1])<<2|r[n+2]>>6],s+=e[63&r[n+2]];return o%3==2?s=s.substring(0,s.length-1)+"=":o%3==1&&(s=s.substring(0,s.length-2)+"=="),s},t.decode=function(t){var n,r,o,s,i,a=.75*t.length,u=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var d=new ArrayBuffer(a),l=new Uint8Array(d);for(n=0;n<u;n+=4)r=e.indexOf(t[n]),o=e.indexOf(t[n+1]),s=e.indexOf(t[n+2]),i=e.indexOf(t[n+3]),l[c++]=r<<2|o>>4,l[c++]=(15&o)<<4|s>>2,l[c++]=(3&s)<<6|63&i;return d}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},"../notebook-dds/node_modules/base64-js/index.js":function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),i=r[0],a=r[1],u=new s(function(e,t,n){return 3*(t+n)/4-n}(0,i,a)),d=0,l=a>0?i-4:i;for(n=0;n<l;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],u[d++]=t>>16&255,u[d++]=t>>8&255,u[d++]=255&t;return 2===a&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,u[d++]=255&t),1===a&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,u[d++]=t>>8&255,u[d++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,s=[],i=16383,a=0,u=n-o;a<u;a+=i)s.push(d(e,a,a+i>u?u:a+i));return 1===o?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),s.join("")};for(var r=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=i.length;a<u;++a)r[a]=i[a],o[i.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function d(e,t,n){for(var o,s,i=[],a=t;a<n;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(r[(s=o)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return i.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},"../notebook-dds/node_modules/blob/index.js":function(e,t){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),o=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),s=n&&n.prototype.append&&n.prototype.getBlob;function i(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function a(e,t){t=t||{};var r=new n;return i(e).forEach((function(e){r.append(e)})),t.type?r.getBlob(t.type):r.getBlob()}function u(e,t){return new Blob(i(e),t||{})}"undefined"!=typeof Blob&&(a.prototype=Blob.prototype,u.prototype=Blob.prototype),e.exports=r?o?Blob:u:s?a:void 0},"../notebook-dds/node_modules/buffer-equal-constant-time/index.js":function(e,t,n){"use strict";var r=n("./node_modules/buffer/index.js").Buffer,o=n("./node_modules/buffer/index.js").SlowBuffer;function s(e,t){if(!r.isBuffer(e)||!r.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(var n=0,o=0;o<e.length;o++)n|=e[o]^t[o];return 0===n}e.exports=s,s.install=function(){r.prototype.equal=o.prototype.equal=function(e){return s(this,e)}};var i=r.prototype.equal,a=o.prototype.equal;s.restore=function(){r.prototype.equal=i,o.prototype.equal=a}},"../notebook-dds/node_modules/component-bind/index.js":function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},"../notebook-dds/node_modules/component-emitter/index.js":function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},"../notebook-dds/node_modules/component-inherit/index.js":function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},"../notebook-dds/node_modules/debug/src/browser.js":function(e,t,n){(function(r){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))}),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n("../notebook-dds/node_modules/debug/src/common.js")(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/debug/src/common.js":function(e,t,n){e.exports=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){let n;function i(...e){if(!i.enabled)return;const t=i,o=Number(new Date),s=o-(n||o);t.diff=s,t.prev=n,t.curr=o,n=o,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,o)=>{if("%%"===n)return n;a++;const s=r.formatters[o];if("function"==typeof s){const r=e[a];n=s.call(t,r),e.splice(a,1),a--}return n}),r.formatArgs.call(t,e),(t.log||r.log).apply(t,e)}return i.namespace=e,i.enabled=r.enabled(e),i.useColors=r.useColors(),i.color=t(e),i.destroy=o,i.extend=s,"function"==typeof r.init&&r.init(i),r.instances.push(i),i}function o(){const e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function s(e,t){const n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){const e=[...r.names.map(i),...r.skips.map(i).map(e=>"-"+e)].join(",");return r.enable(""),e},r.enable=function(e){let t;r.save(e),r.names=[],r.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){const e=r.instances[t];e.enabled=r.enabled(e.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n("../notebook-dds/node_modules/ms/index.js"),Object.keys(e).forEach(t=>{r[t]=e[t]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},"../notebook-dds/node_modules/double-ended-queue/js/deque.js":function(e,t,n){"use strict";function r(e){if(this._capacity=s(e),this._length=0,this._front=0,o(e)){for(var t=e.length,n=0;n<t;++n)this[n]=e[n];this._length=t}}r.prototype.toArray=function(){for(var e=this._length,t=new Array(e),n=this._front,r=this._capacity,o=0;o<e;++o)t[o]=this[n+o&r-1];return t},r.prototype.push=function(e){var t=arguments.length,n=this._length;if(t>1){var r=this._capacity;if(n+t>r){for(var o=0;o<t;++o)this._checkCapacity(n+1),this[s=this._front+n&this._capacity-1]=arguments[o],n++,this._length=n;return n}var s=this._front;for(o=0;o<t;++o)this[s+n&r-1]=arguments[o],s++;return this._length=n+t,n+t}return 0===t?n:(this._checkCapacity(n+1),this[o=this._front+n&this._capacity-1]=e,this._length=n+1,n+1)},r.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,n=this[t];return this[t]=void 0,this._length=e-1,n}},r.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,n=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,n}},r.prototype.unshift=function(e){var t=this._length,n=arguments.length;if(n>1){if(t+n>(o=this._capacity)){for(var r=n-1;r>=0;r--){this._checkCapacity(t+1);var o=this._capacity;this[i=(this._front-1&o-1^o)-o]=arguments[r],t++,this._length=t,this._front=i}return t}var s=this._front;for(r=n-1;r>=0;r--){var i;this[i=(s-1&o-1^o)-o]=arguments[r],s=i}return this._front=s,this._length=t+n,t+n}return 0===n?t:(this._checkCapacity(t+1),o=this._capacity,this[r=(this._front-1&o-1^o)-o]=e,this._length=t+1,this._front=r,t+1)},r.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},r.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},r.prototype.get=function(e){var t=e;if(t===(0|t)){var n=this._length;if(t<0&&(t+=n),!(t<0||t>=n))return this[this._front+t&this._capacity-1]}},r.prototype.isEmpty=function(){return 0===this._length},r.prototype.clear=function(){for(var e=this._length,t=this._front,n=this._capacity,r=0;r<e;++r)this[t+r&n-1]=void 0;this._length=0,this._front=0},r.prototype.toString=function(){return this.toArray().toString()},r.prototype.valueOf=r.prototype.toString,r.prototype.removeFront=r.prototype.shift,r.prototype.removeBack=r.prototype.pop,r.prototype.insertFront=r.prototype.unshift,r.prototype.insertBack=r.prototype.push,r.prototype.enqueue=r.prototype.push,r.prototype.dequeue=r.prototype.shift,r.prototype.toJSON=r.prototype.toArray,Object.defineProperty(r.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),r.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(s(1.5*this._capacity+16))},r.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,r=this._length;n+r>t&&function(e,t,n,r,o){for(var s=0;s<o;++s)n[s+r]=e[s+0],e[s+0]=void 0}(this,0,this,t,n+r&t-1)};var o=Array.isArray;function s(e){if("number"!=typeof e){if(!o(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,1+((t|=t>>8)|t>>16);var t}e.exports=r},"../notebook-dds/node_modules/ecdsa-sig-formatter/src/ecdsa-sig-formatter.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/safe-buffer/index.js").Buffer,o=n("../notebook-dds/node_modules/ecdsa-sig-formatter/src/param-bytes-for-alg.js");function s(e){if(r.isBuffer(e))return e;if("string"==typeof e)return r.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function i(e,t,n){for(var r=0;t+r<n&&0===e[t+r];)++r;return e[t+r]>=128&&--r,r}e.exports={derToJose:function(e,t){e=s(e);var n=o(t),i=n+1,a=e.length,u=0;if(48!==e[u++])throw new Error('Could not find expected "seq"');var c=e[u++];if(129===c&&(c=e[u++]),a-u<c)throw new Error('"seq" specified length of "'+c+'", only "'+(a-u)+'" remaining');if(2!==e[u++])throw new Error('Could not find expected "int" for "r"');var d=e[u++];if(a-u-2<d)throw new Error('"r" specified length of "'+d+'", only "'+(a-u-2)+'" available');if(i<d)throw new Error('"r" specified length of "'+d+'", max of "'+i+'" is acceptable');var l=u;if(u+=d,2!==e[u++])throw new Error('Could not find expected "int" for "s"');var h=e[u++];if(a-u!==h)throw new Error('"s" specified length of "'+h+'", expected "'+(a-u)+'"');if(i<h)throw new Error('"s" specified length of "'+h+'", max of "'+i+'" is acceptable');var f=u;if((u+=h)!==a)throw new Error('Expected to consume entire buffer, but "'+(a-u)+'" bytes remain');var m=n-d,p=n-h,g=r.allocUnsafe(m+d+p+h);for(u=0;u<m;++u)g[u]=0;e.copy(g,u,l+Math.max(-m,0),l+d);for(var b=u=n;u<b+p;++u)g[u]=0;return e.copy(g,u,f+Math.max(-p,0),f+h),(g=g.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=s(e);var n=o(t),a=e.length;if(a!==2*n)throw new TypeError('"'+t+'" signatures must be "'+2*n+'" bytes, saw "'+a+'"');var u=i(e,0,n),c=i(e,n,e.length),d=n-u,l=n-c,h=2+d+1+1+l,f=h<128,m=r.allocUnsafe((f?2:3)+h),p=0;return m[p++]=48,f?m[p++]=h:(m[p++]=129,m[p++]=255&h),m[p++]=2,m[p++]=d,u<0?(m[p++]=0,p+=e.copy(m,p,0,n)):p+=e.copy(m,p,u,n),m[p++]=2,m[p++]=l,c<0?(m[p++]=0,e.copy(m,p,n)):e.copy(m,p,n+c),m}}},"../notebook-dds/node_modules/ecdsa-sig-formatter/src/param-bytes-for-alg.js":function(e,t,n){"use strict";function r(e){return(e/8|0)+(e%8==0?0:1)}var o={ES256:r(256),ES384:r(384),ES512:r(521)};e.exports=function(e){var t=o[e];if(t)return t;throw new Error('Unknown algorithm "'+e+'"')}},"../notebook-dds/node_modules/engine.io-client/lib/globalThis.browser.js":function(e,t){e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},"../notebook-dds/node_modules/engine.io-client/lib/index.js":function(e,t,n){e.exports=n("../notebook-dds/node_modules/engine.io-client/lib/socket.js"),e.exports.parser=n("../notebook-dds/node_modules/engine.io-parser/lib/browser.js")},"../notebook-dds/node_modules/engine.io-client/lib/socket.js":function(e,t,n){var r=n("../notebook-dds/node_modules/engine.io-client/lib/transports/index.js"),o=n("../notebook-dds/node_modules/component-emitter/index.js"),s=n("../notebook-dds/node_modules/engine.io-client/node_modules/debug/src/browser.js")("engine.io-client:socket"),i=n("../notebook-dds/node_modules/indexof/index.js"),a=n("../notebook-dds/node_modules/engine.io-parser/lib/browser.js"),u=n("../notebook-dds/node_modules/parseuri/index.js"),c=n("../notebook-dds/node_modules/parseqs/index.js");function d(e,t){if(!(this instanceof d))return new d(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=u(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=u(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=d,d.priorWebsocketSuccess=!1,o(d.prototype),d.protocol=a.protocol,d.Socket=d,d.Transport=n("../notebook-dds/node_modules/engine.io-client/lib/transport.js"),d.transports=n("../notebook-dds/node_modules/engine.io-client/lib/transports/index.js"),d.parser=n("../notebook-dds/node_modules/engine.io-parser/lib/browser.js"),d.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},d.prototype.open=function(){var e;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},d.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},d.prototype.probe=function(e){s('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(s('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(s('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;d.priorWebsocketSuccess="websocket"===t.name,s('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(s("changing transport and sending upgrade packet"),h(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{s('probe transport "%s" failed',e);var i=new Error("probe error");i.transport=t.name,r.emit("upgradeError",i)}})))}function i(){n||(n=!0,h(),t.close(),t=null)}function a(n){var o=new Error("probe error: "+n);o.transport=t.name,i(),s('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function u(){a("transport closed")}function c(){a("socket closed")}function l(e){t&&e.name!==t.name&&(s('"%s" works - aborting "%s"',e.name,t.name),i())}function h(){t.removeListener("open",o),t.removeListener("error",a),t.removeListener("close",u),r.removeListener("close",c),r.removeListener("upgrading",l)}d.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",a),t.once("close",u),this.once("close",c),this.once("upgrading",l),t.open()},d.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},d.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},d.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},d.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},d.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},d.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},d.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),s("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},d.prototype.onError=function(e){s("socket error %j",e),d.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},d.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(s('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},d.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~i(this.transports,e[n])&&t.push(e[n]);return t}},"../notebook-dds/node_modules/engine.io-client/lib/transport.js":function(e,t,n){var r=n("../notebook-dds/node_modules/engine.io-parser/lib/browser.js"),o=n("../notebook-dds/node_modules/component-emitter/index.js");function s(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=s,o(s.prototype),s.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},s.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},s.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},s.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},s.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},s.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},s.prototype.onPacket=function(e){this.emit("packet",e)},s.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},"../notebook-dds/node_modules/engine.io-client/lib/transports/index.js":function(e,t,n){var r=n("../notebook-dds/node_modules/engine.io-client/lib/xmlhttprequest.js"),o=n("../notebook-dds/node_modules/engine.io-client/lib/transports/polling-xhr.js"),s=n("../notebook-dds/node_modules/engine.io-client/lib/transports/polling-jsonp.js"),i=n("../notebook-dds/node_modules/engine.io-client/lib/transports/websocket.js");t.polling=function(e){var t=!1,n=!1,i=!1!==e.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,u=location.port;u||(u=a?443:80),t=e.hostname!==location.hostname||u!==e.port,n=e.secure!==a}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new o(e);if(!i)throw new Error("JSONP disabled");return new s(e)},t.websocket=i},"../notebook-dds/node_modules/engine.io-client/lib/transports/polling-jsonp.js":function(e,t,n){var r=n("../notebook-dds/node_modules/engine.io-client/lib/transports/polling.js"),o=n("../notebook-dds/node_modules/component-inherit/index.js"),s=n("../notebook-dds/node_modules/engine.io-client/lib/globalThis.browser.js");e.exports=d;var i,a=/\n/g,u=/\\n/g;function c(){}function d(e){r.call(this,e),this.query=this.query||{},i||(i=s.___eio=s.___eio||[]),this.index=i.length;var t=this;i.push((function(e){t.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=c)}),!1)}o(d,r),d.prototype.supportsBinary=!1,d.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},d.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},d.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),s=document.createElement("textarea"),i=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=i,o.method="POST",o.setAttribute("accept-charset","utf-8"),s.name="d",o.appendChild(s),document.body.appendChild(o),this.form=o,this.area=s}function c(){d(),t()}function d(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),d(),e=e.replace(u,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&c()}:this.iframe.onload=c}},"../notebook-dds/node_modules/engine.io-client/lib/transports/polling-xhr.js":function(e,t,n){var r=n("../notebook-dds/node_modules/engine.io-client/lib/xmlhttprequest.js"),o=n("../notebook-dds/node_modules/engine.io-client/lib/transports/polling.js"),s=n("../notebook-dds/node_modules/component-emitter/index.js"),i=n("../notebook-dds/node_modules/component-inherit/index.js"),a=n("../notebook-dds/node_modules/engine.io-client/node_modules/debug/src/browser.js")("engine.io-client:polling-xhr"),u=n("../notebook-dds/node_modules/engine.io-client/lib/globalThis.browser.js");function c(){}function d(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function l(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function h(){for(var e in l.requests)l.requests.hasOwnProperty(e)&&l.requests[e].abort()}e.exports=d,e.exports.Request=l,i(d,o),d.prototype.supportsBinary=!0,d.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new l(e)},d.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=r},d.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},s(l.prototype),l.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},l.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},l.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}},l.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},l.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},l.prototype.abort=function(){this.cleanup()},l.requestsCount=0,l.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",h):"function"==typeof addEventListener&&addEventListener("onpagehide"in u?"pagehide":"unload",h,!1))},"../notebook-dds/node_modules/engine.io-client/lib/transports/polling.js":function(e,t,n){var r=n("../notebook-dds/node_modules/engine.io-client/lib/transport.js"),o=n("../notebook-dds/node_modules/parseqs/index.js"),s=n("../notebook-dds/node_modules/engine.io-parser/lib/browser.js"),i=n("../notebook-dds/node_modules/component-inherit/index.js"),a=n("../notebook-dds/node_modules/yeast/index.js"),u=n("../notebook-dds/node_modules/engine.io-client/node_modules/debug/src/browser.js")("engine.io-client:polling");e.exports=d;var c=null!=new(n("../notebook-dds/node_modules/engine.io-client/lib/xmlhttprequest.js"))({xdomain:!1}).responseType;function d(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),r.call(this,e)}i(d,r),d.prototype.name="polling",d.prototype.doOpen=function(){this.poll()},d.prototype.pause=function(e){var t=this;function n(){u("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){u("pre-pause polling complete"),--r||n()}))),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){u("pre-pause writing complete"),--r||n()})))}else n()},d.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},d.prototype.onData=function(e){var t=this;u("polling got data %s",e),s.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},d.prototype.doClose=function(){var e=this;function t(){u("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(u("transport open - closing"),t()):(u("transport not open - deferring close"),this.once("open",t))},d.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};s.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},d.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},"../notebook-dds/node_modules/engine.io-client/lib/transports/websocket.js":function(e,t,n){(function(t){var r,o,s=n("../notebook-dds/node_modules/engine.io-client/lib/transport.js"),i=n("../notebook-dds/node_modules/engine.io-parser/lib/browser.js"),a=n("../notebook-dds/node_modules/parseqs/index.js"),u=n("../notebook-dds/node_modules/component-inherit/index.js"),c=n("../notebook-dds/node_modules/yeast/index.js"),d=n("../notebook-dds/node_modules/engine.io-client/node_modules/debug/src/browser.js")("engine.io-client:websocket");if("undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{o=n(17)}catch(e){}var l=r||o;function h(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(l=o),s.call(this,e)}e.exports=h,u(h,s),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new l(e,t):new l(e):new l(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},h.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},h.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,o=0,s=r;o<s;o++)!function(e){i.encodePacket(e,n.supportsBinary,(function(o){if(!n.usingBrowserWebSocket){var s={};e.options&&(s.compress=e.options.compress),n.perMessageDeflate&&("string"==typeof o?t.byteLength(o):o.length)<n.perMessageDeflate.threshold&&(s.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,s)}catch(e){d("websocket closed before onclose event")}--r||(n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0))}))}(e[o])},h.prototype.onClose=function(){s.prototype.onClose.call(this)},h.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},h.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},h.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===h.prototype.name)}}).call(this,n("./node_modules/buffer/index.js").Buffer)},"../notebook-dds/node_modules/engine.io-client/lib/xmlhttprequest.js":function(e,t,n){var r=n("../notebook-dds/node_modules/has-cors/index.js"),o=n("../notebook-dds/node_modules/engine.io-client/lib/globalThis.browser.js");e.exports=function(e){var t=e.xdomain,n=e.xscheme,s=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&s)return new XDomainRequest}catch(e){}if(!t)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},"../notebook-dds/node_modules/engine.io-client/node_modules/debug/src/browser.js":function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).DEBUG),e}(t=e.exports=n("../notebook-dds/node_modules/engine.io-client/node_modules/debug/src/debug.js")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(s=o))})),e.splice(s,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/engine.io-client/node_modules/debug/src/debug.js":function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,s=o-(n||o);e.diff=s,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var o=t.formatters[r];if("function"==typeof o){var s=i[u];n=o.call(e,s),i.splice(u,1),u--}return n})),t.formatArgs.call(e,i);var c=r.log||t.log||console.log.bind(console);c.apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("../notebook-dds/node_modules/engine.io-client/node_modules/ms/index.js"),t.instances=[],t.names=[],t.skips=[],t.formatters={}},"../notebook-dds/node_modules/engine.io-client/node_modules/ms/index.js":function(e,t){var n=1e3,r=6e4,o=60*r,s=24*o;function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var a,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"days":case"day":case"d":return i*s;case"hours":case"hour":case"hrs":case"hr":case"h":return i*o;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return t.long?i(a=e,s,"day")||i(a,o,"hour")||i(a,r,"minute")||i(a,n,"second")||a+" ms":function(e){return e>=s?Math.round(e/s)+"d":e>=o?Math.round(e/o)+"h":e>=r?Math.round(e/r)+"m":e>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../notebook-dds/node_modules/engine.io-parser/lib/browser.js":function(e,t,n){var r,o=n("../notebook-dds/node_modules/engine.io-parser/lib/keys.js"),s=n("../notebook-dds/node_modules/has-binary2/index.js"),i=n("../notebook-dds/node_modules/arraybuffer.slice/index.js"),a=n("../notebook-dds/node_modules/after/index.js"),u=n("../notebook-dds/node_modules/engine.io-parser/lib/utf8.js");"undefined"!=typeof ArrayBuffer&&(r=n("../notebook-dds/node_modules/base64-arraybuffer/lib/base64-arraybuffer.js"));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),d="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=c||d;t.protocol=3;var h=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=o(h),m={type:"error",data:"parser error"},p=n("../notebook-dds/node_modules/blob/index.js");function g(e,t,n){for(var r=new Array(e.length),o=a(e.length,n),s=function(e,n,o){t(n,(function(t,n){r[e]=n,o(t,r)}))},i=0;i<e.length;i++)s(i,e[i],o)}t.encodePacket=function(e,n,r,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof r&&(o=r,r=null);var s=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,s=new Uint8Array(o),i=new Uint8Array(1+o.byteLength);i[0]=h[e.type];for(var a=0;a<s.length;a++)i[a+1]=s[a];return r(i.buffer)}(e,n,o);if(void 0!==p&&s instanceof p)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(l)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,r)},o.readAsArrayBuffer(e.data)}(e,n,r);var o=new Uint8Array(1);return o[0]=h[e.type],r(new p([o.buffer,e.data]))}(e,n,o);if(s&&s.base64)return function(e,n){return n("b"+t.packets[e.type]+e.data.data)}(e,o);var i=h[e.type];return void 0!==e.data&&(i+=r?u.encode(String(e.data),{strict:!1}):String(e.data)),o(""+i)},t.encodeBase64Packet=function(e,n){var r,o="b"+t.packets[e.type];if(void 0!==p&&e.data instanceof p){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];n(o+e)},s.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var i=new Uint8Array(e.data),a=new Array(i.length),u=0;u<i.length;u++)a[u]=i[u];r=String.fromCharCode.apply(null,a)}return o+=btoa(r),n(o)},t.decodePacket=function(e,n,r){if(void 0===e)return m;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=u.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return m;var o=e.charAt(0);return Number(o)==o&&f[o]?e.length>1?{type:f[o],data:e.substring(1)}:{type:f[o]}:m}o=new Uint8Array(e)[0];var s=i(e,1);return p&&"blob"===n&&(s=new p([s])),{type:f[o],data:s}},t.decodeBase64Packet=function(e,t){var n=f[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=r.decode(e.substr(1));return"blob"===t&&p&&(o=new p([o])),{type:n,data:o}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var o=s(e);return n&&o?p&&!l?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void g(e,(function(e,r){t.encodePacket(e,!!o&&n,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))})):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var o;if("function"==typeof n&&(r=n,n=null),""===e)return r(m,0,1);for(var s,i,a="",u=0,c=e.length;u<c;u++){var d=e.charAt(u);if(":"===d){if(""===a||a!=(s=Number(a)))return r(m,0,1);if(a!=(i=e.substr(u+1,s)).length)return r(m,0,1);if(i.length){if(o=t.decodePacket(i,n,!1),m.type===o.type&&m.data===o.data)return r(m,0,1);if(!1===r(o,u+s,c))return}u+=s,a=""}else a+=d}return""!==a?r(m,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),o=new Uint8Array(r),s=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);n=r.buffer}o[s++]=t?0:1;var a=n.byteLength.toString();for(i=0;i<a.length;i++)o[s++]=parseInt(a[i]);for(o[s++]=255,r=new Uint8Array(n),i=0;i<r.length;i++)o[s++]=r[i]})),n(o.buffer)}))},t.encodePayloadAsBlob=function(e,n){g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}var s=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),i=new Uint8Array(s.length+1);for(o=0;o<s.length;o++)i[o]=parseInt(s[o]);if(i[s.length]=255,p){var a=new p([t.buffer,i.buffer,e]);n(null,a)}}))}),(function(e,t){return n(new p(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o=e,s=[];o.byteLength>0;){for(var a=new Uint8Array(o),u=0===a[0],c="",d=1;255!==a[d];d++){if(c.length>310)return r(m,0,1);c+=a[d]}o=i(o,2+c.length),c=parseInt(c);var l=i(o,0,c);if(u)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(e){var h=new Uint8Array(l);for(l="",d=0;d<h.length;d++)l+=String.fromCharCode(h[d])}s.push(l),o=i(o,c)}var f=s.length;s.forEach((function(e,o){r(t.decodePacket(e,n,!0),o,f)}))}},"../notebook-dds/node_modules/engine.io-parser/lib/keys.js":function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},"../notebook-dds/node_modules/engine.io-parser/lib/utf8.js":function(e,t){var n,r,o,s=String.fromCharCode;function i(e){for(var t,n,r=[],o=0,s=e.length;o<s;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<s?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function u(e,t){return s(e>>t&63|128)}function c(e,t){if(0==(4294967168&e))return s(e);var n="";return 0==(4294965248&e)?n=s(e>>6&31|192):0==(4294901760&e)?(a(e,t)||(e=65533),n=s(e>>12&15|224),n+=u(e,6)):0==(4292870144&e)&&(n=s(e>>18&7|240),n+=u(e,12),n+=u(e,6)),n+s(63&e|128)}function d(){if(o>=r)throw Error("Invalid byte index");var e=255&n[o];if(o++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function l(e){var t,s;if(o>r)throw Error("Invalid byte index");if(o==r)return!1;if(t=255&n[o],o++,0==(128&t))return t;if(192==(224&t)){if((s=(31&t)<<6|d())>=128)return s;throw Error("Invalid continuation byte")}if(224==(240&t)){if((s=(15&t)<<12|d()<<6|d())>=2048)return a(s,e)?s:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(s=(7&t)<<18|d()<<12|d()<<6|d())>=65536&&s<=1114111)return s;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=i(e),o=r.length,s=-1,a="";++s<o;)a+=c(r[s],n);return a},decode:function(e,t){var a=!1!==(t=t||{}).strict;n=i(e),r=n.length,o=0;for(var u,c=[];!1!==(u=l(a));)c.push(u);return function(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=s((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=s(t);return o}(c)}}},"../notebook-dds/node_modules/has-binary2/index.js":function(e,t,n){(function(t){var r=n("../notebook-dds/node_modules/isarray/index.js"),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),i="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var o=0,a=n.length;o<a;o++)if(e(n[o]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||s&&n instanceof Blob||i&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var u in n)if(Object.prototype.hasOwnProperty.call(n,u)&&e(n[u]))return!0;return!1}}).call(this,n("./node_modules/buffer/index.js").Buffer)},"../notebook-dds/node_modules/has-cors/index.js":function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},"../notebook-dds/node_modules/immutable/dist/immutable.es.js":function(e,t,n){"use strict";n.r(t),n.d(t,"version",(function(){return mr})),n.d(t,"Collection",(function(){return S})),n.d(t,"Iterable",(function(){return gr})),n.d(t,"Seq",(function(){return $})),n.d(t,"Map",(function(){return Et})),n.d(t,"OrderedMap",(function(){return fn})),n.d(t,"List",(function(){return Yt})),n.d(t,"Stack",(function(){return yn})),n.d(t,"Set",(function(){return An})),n.d(t,"OrderedSet",(function(){return Qn})),n.d(t,"Record",(function(){return or})),n.d(t,"Range",(function(){return Mn})),n.d(t,"Repeat",(function(){return lr})),n.d(t,"is",(function(){return ae})),n.d(t,"fromJS",(function(){return hr})),n.d(t,"hash",(function(){return le})),n.d(t,"isImmutable",(function(){return N})),n.d(t,"isCollection",(function(){return b})),n.d(t,"isKeyed",(function(){return y})),n.d(t,"isIndexed",(function(){return w})),n.d(t,"isAssociative",(function(){return k})),n.d(t,"isOrdered",(function(){return F})),n.d(t,"isValueObject",(function(){return ie})),n.d(t,"get",(function(){return Qe})),n.d(t,"getIn",(function(){return Ln})),n.d(t,"has",(function(){return Ye})),n.d(t,"hasIn",(function(){return qn})),n.d(t,"merge",(function(){return mt})),n.d(t,"mergeDeep",(function(){return gt})),n.d(t,"mergeWith",(function(){return pt})),n.d(t,"mergeDeepWith",(function(){return bt})),n.d(t,"remove",(function(){return tt})),n.d(t,"removeIn",(function(){return it})),n.d(t,"set",(function(){return nt})),n.d(t,"setIn",(function(){return ot})),n.d(t,"update",(function(){return ut})),n.d(t,"updateIn",(function(){return rt}));var r=32,o=31,s={};function i(e){e&&(e.value=!0)}function a(){}function u(e){return void 0===e.size&&(e.size=e.__iterate(d)),e.size}function c(e,t){if("number"!=typeof t){var n=t>>>0;if(""+n!==t||4294967295===n)return NaN;t=n}return t<0?u(e)+t:t}function d(){return!0}function l(e,t,n){return(0===e&&!p(e)||void 0!==n&&e<=-n)&&(void 0===t||void 0!==n&&t>=n)}function h(e,t){return m(e,t,0)}function f(e,t){return m(e,t,t)}function m(e,t,n){return void 0===e?n:p(e)?t===1/0?t:0|Math.max(0,t+e):void 0===t||t===e?e:0|Math.min(t,e)}function p(e){return e<0||0===e&&1/e==-1/0}var g="@@__IMMUTABLE_ITERABLE__@@";function b(e){return Boolean(e&&e[g])}var v="@@__IMMUTABLE_KEYED__@@";function y(e){return Boolean(e&&e[v])}var _="@@__IMMUTABLE_INDEXED__@@";function w(e){return Boolean(e&&e[_])}function k(e){return y(e)||w(e)}var S=function(e){return b(e)?e:$(e)},j=function(e){function t(e){return y(e)?e:W(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(S),C=function(e){function t(e){return w(e)?e:K(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(S),x=function(e){function t(e){return b(e)&&!k(e)?e:G(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(S);S.Keyed=j,S.Indexed=C,S.Set=x;var O="@@__IMMUTABLE_SEQ__@@";function E(e){return Boolean(e&&e[O])}var I="@@__IMMUTABLE_RECORD__@@";function A(e){return Boolean(e&&e[I])}function N(e){return b(e)||A(e)}var T="@@__IMMUTABLE_ORDERED__@@";function F(e){return Boolean(e&&e[T])}var P="function"==typeof Symbol&&Symbol.iterator,R=P||"@@iterator",D=function(e){this.next=e};function M(e,t,n,r){var o=0===e?t:1===e?n:[t,n];return r?r.value=o:r={value:o,done:!1},r}function L(){return{value:void 0,done:!0}}function B(e){return!!H(e)}function q(e){return e&&"function"==typeof e.next}function z(e){var t=H(e);return t&&t.call(e)}function H(e){var t=e&&(P&&e[P]||e["@@iterator"]);if("function"==typeof t)return t}D.prototype.toString=function(){return"[Iterator]"},D.KEYS=0,D.VALUES=1,D.ENTRIES=2,D.prototype.inspect=D.prototype.toSource=function(){return this.toString()},D.prototype[R]=function(){return this};var U=Object.prototype.hasOwnProperty;function V(e){return!(!Array.isArray(e)&&"string"!=typeof e)||e&&"object"==typeof e&&Number.isInteger(e.length)&&e.length>=0&&(0===e.length?1===Object.keys(e).length:e.hasOwnProperty(e.length-1))}var $=function(e){function t(e){return null==e?Q():N(e)?e.toSeq():function(e){var t=ne(e);if(t)return t;if("object"==typeof e)return new Z(e);throw new TypeError("Expected Array or collection object of values, or keyed object: "+e)}(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(e,t){var n=this._cache;if(n){for(var r=n.length,o=0;o!==r;){var s=n[t?r-++o:o++];if(!1===e(s[1],s[0],this))break}return o}return this.__iterateUncached(e,t)},t.prototype.__iterator=function(e,t){var n=this._cache;if(n){var r=n.length,o=0;return new D((function(){if(o===r)return{value:void 0,done:!0};var s=n[t?r-++o:o++];return M(e,s[0],s[1])}))}return this.__iteratorUncached(e,t)},t}(S),W=function(e){function t(e){return null==e?Q().toKeyedSeq():b(e)?y(e)?e.toSeq():e.fromEntrySeq():A(e)?e.toSeq():ee(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}($),K=function(e){function t(e){return null==e?Q():b(e)?y(e)?e.entrySeq():e.toIndexedSeq():A(e)?e.toSeq().entrySeq():te(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}($),G=function(e){function t(e){return(b(e)&&!k(e)?e:K(e)).toSetSeq()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}($);$.isSeq=E,$.Keyed=W,$.Set=G,$.Indexed=K,$.prototype[O]=!0;var J=function(e){function t(e){this._array=e,this.size=e.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this.has(e)?this._array[c(this,e)]:t},t.prototype.__iterate=function(e,t){for(var n=this._array,r=n.length,o=0;o!==r;){var s=t?r-++o:o++;if(!1===e(n[s],s,this))break}return o},t.prototype.__iterator=function(e,t){var n=this._array,r=n.length,o=0;return new D((function(){if(o===r)return{value:void 0,done:!0};var s=t?r-++o:o++;return M(e,s,n[s])}))},t}(K),Z=function(e){function t(e){var t=Object.keys(e);this._object=e,this._keys=t,this.size=t.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return void 0===t||this.has(e)?this._object[e]:t},t.prototype.has=function(e){return U.call(this._object,e)},t.prototype.__iterate=function(e,t){for(var n=this._object,r=this._keys,o=r.length,s=0;s!==o;){var i=r[t?o-++s:s++];if(!1===e(n[i],i,this))break}return s},t.prototype.__iterator=function(e,t){var n=this._object,r=this._keys,o=r.length,s=0;return new D((function(){if(s===o)return{value:void 0,done:!0};var i=r[t?o-++s:s++];return M(e,i,n[i])}))},t}(W);Z.prototype[T]=!0;var X,Y=function(e){function t(e){this._collection=e,this.size=e.length||e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);var n=z(this._collection),r=0;if(q(n))for(var o;!(o=n.next()).done&&!1!==e(o.value,r++,this););return r},t.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var n=z(this._collection);if(!q(n))return new D(L);var r=0;return new D((function(){var t=n.next();return t.done?t:M(e,r++,t.value)}))},t}(K);function Q(){return X||(X=new J([]))}function ee(e){var t=Array.isArray(e)?new J(e):B(e)?new Y(e):void 0;if(t)return t.fromEntrySeq();if("object"==typeof e)return new Z(e);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+e)}function te(e){var t=ne(e);if(t)return t;throw new TypeError("Expected Array or collection object of values: "+e)}function ne(e){return V(e)?new J(e):B(e)?new Y(e):void 0}var re="@@__IMMUTABLE_MAP__@@";function oe(e){return Boolean(e&&e[re])}function se(e){return oe(e)&&F(e)}function ie(e){return Boolean(e&&"function"==typeof e.equals&&"function"==typeof e.hashCode)}function ae(e,t){if(e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1;if("function"==typeof e.valueOf&&"function"==typeof t.valueOf){if((e=e.valueOf())===(t=t.valueOf())||e!=e&&t!=t)return!0;if(!e||!t)return!1}return!!(ie(e)&&ie(t)&&e.equals(t))}var ue="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(e,t){var n=65535&(e|=0),r=65535&(t|=0);return n*r+((e>>>16)*r+n*(t>>>16)<<16>>>0)|0};function ce(e){return e>>>1&1073741824|3221225471&e}var de=Object.prototype.valueOf;function le(e){switch(typeof e){case"boolean":return e?1108378657:1108378656;case"number":return function(e){if(e!=e||e===1/0)return 0;var t=0|e;for(t!==e&&(t^=4294967295*e);e>4294967295;)t^=e/=4294967295;return ce(t)}(e);case"string":return e.length>ye?function(e){var t=ke[e];return void 0===t&&(t=he(e),we===_e&&(we=0,ke={}),we++,ke[e]=t),t}(e):he(e);case"object":case"function":return null===e?1108378658:"function"==typeof e.hashCode?ce(e.hashCode(e)):(e.valueOf!==de&&"function"==typeof e.valueOf&&(e=e.valueOf(e)),function(e){var t;if(ge&&void 0!==(t=fe.get(e)))return t;if(void 0!==(t=e[ve]))return t;if(!pe){if(void 0!==(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[ve]))return t;if(void 0!==(t=function(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}(e)))return t}if(t=++be,1073741824&be&&(be=0),ge)fe.set(e,t);else{if(void 0!==me&&!1===me(e))throw new Error("Non-extensible objects are not allowed as keys.");if(pe)Object.defineProperty(e,ve,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(void 0!==e.propertyIsEnumerable&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[ve]=t;else{if(void 0===e.nodeType)throw new Error("Unable to set a non-enumerable property on object.");e[ve]=t}}return t}(e));case"undefined":return 1108378659;default:if("function"==typeof e.toString)return he(e.toString());throw new Error("Value type "+typeof e+" cannot be hashed.")}}function he(e){for(var t=0,n=0;n<e.length;n++)t=31*t+e.charCodeAt(n)|0;return ce(t)}var fe,me=Object.isExtensible,pe=function(){try{return Object.defineProperty({},"@",{}),!0}catch(e){return!1}}(),ge="function"==typeof WeakMap;ge&&(fe=new WeakMap);var be=0,ve="__immutablehash__";"function"==typeof Symbol&&(ve=Symbol(ve));var ye=16,_e=255,we=0,ke={},Se=function(e){function t(e,t){this._iter=e,this._useKeys=t,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this._iter.get(e,t)},t.prototype.has=function(e){return this._iter.has(e)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var e=this,t=Ie(this,!0);return this._useKeys||(t.valueSeq=function(){return e._iter.toSeq().reverse()}),t},t.prototype.map=function(e,t){var n=this,r=Ee(this,e,t);return this._useKeys||(r.valueSeq=function(){return n._iter.toSeq().map(e,t)}),r},t.prototype.__iterate=function(e,t){var n=this;return this._iter.__iterate((function(t,r){return e(t,r,n)}),t)},t.prototype.__iterator=function(e,t){return this._iter.__iterator(e,t)},t}(W);Se.prototype[T]=!0;var je=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.includes=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var n=this,r=0;return t&&u(this),this._iter.__iterate((function(o){return e(o,t?n.size-++r:r++,n)}),t)},t.prototype.__iterator=function(e,t){var n=this,r=this._iter.__iterator(1,t),o=0;return t&&u(this),new D((function(){var s=r.next();return s.done?s:M(e,t?n.size-++o:o++,s.value,s)}))},t}(K),Ce=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.has=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var n=this;return this._iter.__iterate((function(t){return e(t,t,n)}),t)},t.prototype.__iterator=function(e,t){var n=this._iter.__iterator(1,t);return new D((function(){var t=n.next();return t.done?t:M(e,t.value,t.value,t)}))},t}(G),xe=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(e,t){var n=this;return this._iter.__iterate((function(t){if(t){qe(t);var r=b(t);return e(r?t.get(1):t[1],r?t.get(0):t[0],n)}}),t)},t.prototype.__iterator=function(e,t){var n=this._iter.__iterator(1,t);return new D((function(){for(;;){var t=n.next();if(t.done)return t;var r=t.value;if(r){qe(r);var o=b(r);return M(e,o?r.get(0):r[0],o?r.get(1):r[1],t)}}}))},t}(W);function Oe(e){var t=He(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var t=e.reverse.apply(this);return t.flip=function(){return e.reverse()},t},t.has=function(t){return e.includes(t)},t.includes=function(t){return e.has(t)},t.cacheResult=Ue,t.__iterateUncached=function(t,n){var r=this;return e.__iterate((function(e,n){return!1!==t(n,e,r)}),n)},t.__iteratorUncached=function(t,n){if(2===t){var r=e.__iterator(t,n);return new D((function(){var e=r.next();if(!e.done){var t=e.value[0];e.value[0]=e.value[1],e.value[1]=t}return e}))}return e.__iterator(1===t?0:1,n)},t}function Ee(e,t,n){var r=He(e);return r.size=e.size,r.has=function(t){return e.has(t)},r.get=function(r,o){var i=e.get(r,s);return i===s?o:t.call(n,i,r,e)},r.__iterateUncached=function(r,o){var s=this;return e.__iterate((function(e,o,i){return!1!==r(t.call(n,e,o,i),o,s)}),o)},r.__iteratorUncached=function(r,o){var s=e.__iterator(2,o);return new D((function(){var o=s.next();if(o.done)return o;var i=o.value,a=i[0];return M(r,a,t.call(n,i[1],a,e),o)}))},r}function Ie(e,t){var n=this,r=He(e);return r._iter=e,r.size=e.size,r.reverse=function(){return e},e.flip&&(r.flip=function(){var t=Oe(e);return t.reverse=function(){return e.flip()},t}),r.get=function(n,r){return e.get(t?n:-1-n,r)},r.has=function(n){return e.has(t?n:-1-n)},r.includes=function(t){return e.includes(t)},r.cacheResult=Ue,r.__iterate=function(n,r){var o=this,s=0;return r&&u(e),e.__iterate((function(e,i){return n(e,t?i:r?o.size-++s:s++,o)}),!r)},r.__iterator=function(r,o){var s=0;o&&u(e);var i=e.__iterator(2,!o);return new D((function(){var e=i.next();if(e.done)return e;var a=e.value;return M(r,t?a[0]:o?n.size-++s:s++,a[1],e)}))},r}function Ae(e,t,n,r){var o=He(e);return r&&(o.has=function(r){var o=e.get(r,s);return o!==s&&!!t.call(n,o,r,e)},o.get=function(r,o){var i=e.get(r,s);return i!==s&&t.call(n,i,r,e)?i:o}),o.__iterateUncached=function(o,s){var i=this,a=0;return e.__iterate((function(e,s,u){if(t.call(n,e,s,u))return a++,o(e,r?s:a-1,i)}),s),a},o.__iteratorUncached=function(o,s){var i=e.__iterator(2,s),a=0;return new D((function(){for(;;){var s=i.next();if(s.done)return s;var u=s.value,c=u[0],d=u[1];if(t.call(n,d,c,e))return M(o,r?c:a++,d,s)}}))},o}function Ne(e,t,n,r){var o=e.size;if(l(t,n,o))return e;var s=h(t,o),i=f(n,o);if(s!=s||i!=i)return Ne(e.toSeq().cacheResult(),t,n,r);var a,u=i-s;u==u&&(a=u<0?0:u);var d=He(e);return d.size=0===a?a:e.size&&a||void 0,!r&&E(e)&&a>=0&&(d.get=function(t,n){return(t=c(this,t))>=0&&t<a?e.get(t+s,n):n}),d.__iterateUncached=function(t,n){var o=this;if(0===a)return 0;if(n)return this.cacheResult().__iterate(t,n);var i=0,u=!0,c=0;return e.__iterate((function(e,n){if(!u||!(u=i++<s))return c++,!1!==t(e,r?n:c-1,o)&&c!==a})),c},d.__iteratorUncached=function(t,n){if(0!==a&&n)return this.cacheResult().__iterator(t,n);if(0===a)return new D(L);var o=e.__iterator(t,n),i=0,u=0;return new D((function(){for(;i++<s;)o.next();if(++u>a)return{value:void 0,done:!0};var e=o.next();return r||1===t||e.done?e:M(t,u-1,0===t?void 0:e.value[1],e)}))},d}function Te(e,t,n,r){var o=He(e);return o.__iterateUncached=function(o,s){var i=this;if(s)return this.cacheResult().__iterate(o,s);var a=!0,u=0;return e.__iterate((function(e,s,c){if(!a||!(a=t.call(n,e,s,c)))return u++,o(e,r?s:u-1,i)})),u},o.__iteratorUncached=function(o,s){var i=this;if(s)return this.cacheResult().__iterator(o,s);var a=e.__iterator(2,s),u=!0,c=0;return new D((function(){var e,s,d;do{if((e=a.next()).done)return r||1===o?e:M(o,c++,0===o?void 0:e.value[1],e);var l=e.value;s=l[0],d=l[1],u&&(u=t.call(n,d,s,i))}while(u);return 2===o?e:M(o,s,d,e)}))},o}function Fe(e,t){var n=y(e),r=[e].concat(t).map((function(e){return b(e)?n&&(e=j(e)):e=n?ee(e):te(Array.isArray(e)?e:[e]),e})).filter((function(e){return 0!==e.size}));if(0===r.length)return e;if(1===r.length){var o=r[0];if(o===e||n&&y(o)||w(e)&&w(o))return o}var s=new J(r);return n?s=s.toKeyedSeq():w(e)||(s=s.toSetSeq()),(s=s.flatten(!0)).size=r.reduce((function(e,t){if(void 0!==e){var n=t.size;if(void 0!==n)return e+n}}),0),s}function Pe(e,t,n){var r=He(e);return r.__iterateUncached=function(o,s){if(s)return this.cacheResult().__iterate(o,s);var i=0,a=!1;return function e(u,c){u.__iterate((function(s,u){return(!t||c<t)&&b(s)?e(s,c+1):(i++,!1===o(s,n?u:i-1,r)&&(a=!0)),!a}),s)}(e,0),i},r.__iteratorUncached=function(r,o){if(o)return this.cacheResult().__iterator(r,o);var s=e.__iterator(r,o),i=[],a=0;return new D((function(){for(;s;){var e=s.next();if(!1===e.done){var u=e.value;if(2===r&&(u=u[1]),t&&!(i.length<t)||!b(u))return n?e:M(r,a++,u,e);i.push(s),s=u.__iterator(r,o)}else s=i.pop()}return{value:void 0,done:!0}}))},r}function Re(e,t,n){t||(t=Ve);var r=y(e),o=0,s=e.toSeq().map((function(t,r){return[r,t,o++,n?n(t,r,e):t]})).valueSeq().toArray();return s.sort((function(e,n){return t(e[3],n[3])||e[2]-n[2]})).forEach(r?function(e,t){s[t].length=2}:function(e,t){s[t]=e[1]}),r?W(s):w(e)?K(s):G(s)}function De(e,t,n){if(t||(t=Ve),n){var r=e.toSeq().map((function(t,r){return[t,n(t,r,e)]})).reduce((function(e,n){return Me(t,e[1],n[1])?n:e}));return r&&r[0]}return e.reduce((function(e,n){return Me(t,e,n)?n:e}))}function Me(e,t,n){var r=e(n,t);return 0===r&&n!==t&&(null==n||n!=n)||r>0}function Le(e,t,n,r){var o=He(e),s=new J(n).map((function(e){return e.size}));return o.size=r?s.max():s.min(),o.__iterate=function(e,t){for(var n,r=this.__iterator(1,t),o=0;!(n=r.next()).done&&!1!==e(n.value,o++,this););return o},o.__iteratorUncached=function(e,o){var s=n.map((function(e){return e=S(e),z(o?e.reverse():e)})),i=0,a=!1;return new D((function(){var n;return a||(n=s.map((function(e){return e.next()})),a=r?n.every((function(e){return e.done})):n.some((function(e){return e.done}))),a?{value:void 0,done:!0}:M(e,i++,t.apply(null,n.map((function(e){return e.value}))))}))},o}function Be(e,t){return e===t?e:E(e)?t:e.constructor(t)}function qe(e){if(e!==Object(e))throw new TypeError("Expected [K, V] tuple: "+e)}function ze(e){return y(e)?j:w(e)?C:x}function He(e){return Object.create((y(e)?W:w(e)?K:G).prototype)}function Ue(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):$.prototype.cacheResult.call(this)}function Ve(e,t){return void 0===e&&void 0===t?0:void 0===e?1:void 0===t?-1:e>t?1:e<t?-1:0}function $e(e,t){t=t||0;for(var n=Math.max(0,e.length-t),r=new Array(n),o=0;o<n;o++)r[o]=e[o+t];return r}function We(e,t){if(!e)throw new Error(t)}function Ke(e){We(e!==1/0,"Cannot perform this action with an infinite size.")}function Ge(e){if(V(e)&&"string"!=typeof e)return e;if(F(e))return e.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+e)}function Je(e){return e&&("function"!=typeof e.constructor||"Object"===e.constructor.name)}function Ze(e){return"object"==typeof e&&(N(e)||Array.isArray(e)||Je(e))}function Xe(e){try{return"string"==typeof e?JSON.stringify(e):String(e)}catch(t){return JSON.stringify(e)}}function Ye(e,t){return N(e)?e.has(t):Ze(e)&&U.call(e,t)}function Qe(e,t,n){return N(e)?e.get(t,n):Ye(e,t)?"function"==typeof e.get?e.get(t):e[t]:n}function et(e){if(Array.isArray(e))return $e(e);var t={};for(var n in e)U.call(e,n)&&(t[n]=e[n]);return t}function tt(e,t){if(!Ze(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(N(e)){if(!e.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+e);return e.remove(t)}if(!U.call(e,t))return e;var n=et(e);return Array.isArray(n)?n.splice(t,1):delete n[t],n}function nt(e,t,n){if(!Ze(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(N(e)){if(!e.set)throw new TypeError("Cannot update immutable value without .set() method: "+e);return e.set(t,n)}if(U.call(e,t)&&n===e[t])return e;var r=et(e);return r[t]=n,r}function rt(e,t,n,r){r||(r=n,n=void 0);var o=function e(t,n,r,o,i,a){var u=n===s;if(o===r.length){var c=u?i:n,d=a(c);return d===c?n:d}if(!u&&!Ze(n))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,o).map(Xe)+"]: "+n);var l=r[o],h=u?s:Qe(n,l,s),f=e(h===s?t:N(h),h,r,o+1,i,a);return f===h?n:f===s?tt(n,l):nt(u?t?qt():{}:n,l,f)}(N(e),e,Ge(t),0,n,r);return o===s?n:o}function ot(e,t,n){return rt(e,t,s,(function(){return n}))}function st(e,t){return ot(this,e,t)}function it(e,t){return rt(e,t,(function(){return s}))}function at(e){return it(this,e)}function ut(e,t,n,r){return rt(e,[t],n,r)}function ct(e,t,n){return 1===arguments.length?e(this):ut(this,e,t,n)}function dt(e,t,n){return rt(this,e,t,n)}function lt(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return ft(this,e)}function ht(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if("function"!=typeof e)throw new TypeError("Invalid merger function: "+e);return ft(this,t,e)}function ft(e,t,n){for(var r=[],o=0;o<t.length;o++){var i=j(t[o]);0!==i.size&&r.push(i)}return 0===r.length?e:0!==e.toSeq().size||e.__ownerID||1!==r.length?e.withMutations((function(e){for(var t=n?function(t,r){ut(e,r,s,(function(e){return e===s?t:n(e,t,r)}))}:function(t,n){e.set(n,t)},o=0;o<r.length;o++)r[o].forEach(t)})):e.constructor(r[0])}function mt(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return yt(e,t)}function pt(e,t){for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return yt(t,n,e)}function gt(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return vt(e,t)}function bt(e,t){for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return vt(t,n,e)}function vt(e,t,n){return yt(e,t,function(e){return function t(n,r,o){return Ze(n)&&Ze(r)?yt(n,[r],t):e?e(n,r,o):r}}(n))}function yt(e,t,n){if(!Ze(e))throw new TypeError("Cannot merge into non-data-structure value: "+e);if(N(e))return"function"==typeof n&&e.mergeWith?e.mergeWith.apply(e,[n].concat(t)):e.merge?e.merge.apply(e,t):e.concat.apply(e,t);for(var r=Array.isArray(e),o=e,s=r?C:j,i=r?function(t){o===e&&(o=et(o)),o.push(t)}:function(t,r){var s=U.call(o,r),i=s&&n?n(o[r],t,r):t;s&&i===o[r]||(o===e&&(o=et(o)),o[r]=i)},a=0;a<t.length;a++)s(t[a]).forEach(i);return o}function _t(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return vt(this,e)}function wt(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return vt(this,t,e)}function kt(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return rt(this,e,qt(),(function(e){return yt(e,t)}))}function St(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return rt(this,e,qt(),(function(e){return vt(e,t)}))}function jt(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function Ct(){return this.__ownerID?this:this.__ensureOwner(new a)}function xt(){return this.__ensureOwner()}function Ot(){return this.__altered}je.prototype.cacheResult=Se.prototype.cacheResult=Ce.prototype.cacheResult=xe.prototype.cacheResult=Ue;var Et=function(e){function t(t){return null==t?qt():oe(t)&&!F(t)?t:qt().withMutations((function(n){var r=e(t);Ke(r.size),r.forEach((function(e,t){return n.set(t,e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return qt().withMutations((function(t){for(var n=0;n<e.length;n+=2){if(n+1>=e.length)throw new Error("Missing value for key: "+e[n]);t.set(e[n],e[n+1])}}))},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(e,t){return this._root?this._root.get(0,void 0,e,t):t},t.prototype.set=function(e,t){return zt(this,e,t)},t.prototype.remove=function(e){return zt(this,e,s)},t.prototype.deleteAll=function(e){var t=S(e);return 0===t.size?this:this.withMutations((function(e){t.forEach((function(t){return e.remove(t)}))}))},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):qt()},t.prototype.sort=function(e){return fn(Re(this,e))},t.prototype.sortBy=function(e,t){return fn(Re(this,t,e))},t.prototype.map=function(e,t){return this.withMutations((function(n){n.forEach((function(r,o){n.set(o,e.call(t,r,o,n))}))}))},t.prototype.__iterator=function(e,t){return new Dt(this,e,t)},t.prototype.__iterate=function(e,t){var n=this,r=0;return this._root&&this._root.iterate((function(t){return r++,e(t[1],t[0],n)}),t),r},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?Bt(this.size,this._root,e,this.__hash):0===this.size?qt():(this.__ownerID=e,this.__altered=!1,this)},t}(j);Et.isMap=oe;var It=Et.prototype;It[re]=!0,It.delete=It.remove,It.removeAll=It.deleteAll,It.setIn=st,It.removeIn=It.deleteIn=at,It.update=ct,It.updateIn=dt,It.merge=It.concat=lt,It.mergeWith=ht,It.mergeDeep=_t,It.mergeDeepWith=wt,It.mergeIn=kt,It.mergeDeepIn=St,It.withMutations=jt,It.wasAltered=Ot,It.asImmutable=xt,It["@@transducer/init"]=It.asMutable=Ct,It["@@transducer/step"]=function(e,t){return e.set(t[0],t[1])},It["@@transducer/result"]=function(e){return e.asImmutable()};var At=function(e,t){this.ownerID=e,this.entries=t};At.prototype.get=function(e,t,n,r){for(var o=this.entries,s=0,i=o.length;s<i;s++)if(ae(n,o[s][0]))return o[s][1];return r},At.prototype.update=function(e,t,n,r,o,u,c){for(var d=o===s,l=this.entries,h=0,f=l.length;h<f&&!ae(r,l[h][0]);h++);var m=h<f;if(m?l[h][1]===o:d)return this;if(i(c),(d||!m)&&i(u),!d||1!==l.length){if(!m&&!d&&l.length>=Kt)return function(e,t,n,r){e||(e=new a);for(var o=new Pt(e,le(n),[n,r]),s=0;s<t.length;s++){var i=t[s];o=o.update(e,0,void 0,i[0],i[1])}return o}(e,l,r,o);var p=e&&e===this.ownerID,g=p?l:$e(l);return m?d?h===f-1?g.pop():g[h]=g.pop():g[h]=[r,o]:g.push([r,o]),p?(this.entries=g,this):new At(e,g)}};var Nt=function(e,t,n){this.ownerID=e,this.bitmap=t,this.nodes=n};Nt.prototype.get=function(e,t,n,r){void 0===t&&(t=le(n));var s=1<<((0===e?t:t>>>e)&o),i=this.bitmap;return 0==(i&s)?r:this.nodes[$t(i&s-1)].get(e+5,t,n,r)},Nt.prototype.update=function(e,t,n,i,a,u,c){void 0===n&&(n=le(i));var d=(0===t?n:n>>>t)&o,l=1<<d,h=this.bitmap,f=0!=(h&l);if(!f&&a===s)return this;var m=$t(h&l-1),p=this.nodes,g=f?p[m]:void 0,b=Ht(g,e,t+5,n,i,a,u,c);if(b===g)return this;if(!f&&b&&p.length>=Gt)return function(e,t,n,o,s){for(var i=0,a=new Array(r),u=0;0!==n;u++,n>>>=1)a[u]=1&n?t[i++]:void 0;return a[o]=s,new Tt(e,i+1,a)}(e,p,h,d,b);if(f&&!b&&2===p.length&&Ut(p[1^m]))return p[1^m];if(f&&b&&1===p.length&&Ut(b))return b;var v=e&&e===this.ownerID,y=f?b?h:h^l:h|l,_=f?b?Wt(p,m,b,v):function(e,t,n){var r=e.length-1;if(n&&t===r)return e.pop(),e;for(var o=new Array(r),s=0,i=0;i<r;i++)i===t&&(s=1),o[i]=e[i+s];return o}(p,m,v):function(e,t,n,r){var o=e.length+1;if(r&&t+1===o)return e[t]=n,e;for(var s=new Array(o),i=0,a=0;a<o;a++)a===t?(s[a]=n,i=-1):s[a]=e[a+i];return s}(p,m,b,v);return v?(this.bitmap=y,this.nodes=_,this):new Nt(e,y,_)};var Tt=function(e,t,n){this.ownerID=e,this.count=t,this.nodes=n};Tt.prototype.get=function(e,t,n,r){void 0===t&&(t=le(n));var s=(0===e?t:t>>>e)&o,i=this.nodes[s];return i?i.get(e+5,t,n,r):r},Tt.prototype.update=function(e,t,n,r,i,a,u){void 0===n&&(n=le(r));var c=(0===t?n:n>>>t)&o,d=i===s,l=this.nodes,h=l[c];if(d&&!h)return this;var f=Ht(h,e,t+5,n,r,i,a,u);if(f===h)return this;var m=this.count;if(h){if(!f&&--m<Jt)return function(e,t,n,r){for(var o=0,s=0,i=new Array(n),a=0,u=1,c=t.length;a<c;a++,u<<=1){var d=t[a];void 0!==d&&a!==r&&(o|=u,i[s++]=d)}return new Nt(e,o,i)}(e,l,m,c)}else m++;var p=e&&e===this.ownerID,g=Wt(l,c,f,p);return p?(this.count=m,this.nodes=g,this):new Tt(e,m,g)};var Ft=function(e,t,n){this.ownerID=e,this.keyHash=t,this.entries=n};Ft.prototype.get=function(e,t,n,r){for(var o=this.entries,s=0,i=o.length;s<i;s++)if(ae(n,o[s][0]))return o[s][1];return r},Ft.prototype.update=function(e,t,n,r,o,a,u){void 0===n&&(n=le(r));var c=o===s;if(n!==this.keyHash)return c?this:(i(u),i(a),Vt(this,e,t,n,[r,o]));for(var d=this.entries,l=0,h=d.length;l<h&&!ae(r,d[l][0]);l++);var f=l<h;if(f?d[l][1]===o:c)return this;if(i(u),(c||!f)&&i(a),c&&2===h)return new Pt(e,this.keyHash,d[1^l]);var m=e&&e===this.ownerID,p=m?d:$e(d);return f?c?l===h-1?p.pop():p[l]=p.pop():p[l]=[r,o]:p.push([r,o]),m?(this.entries=p,this):new Ft(e,this.keyHash,p)};var Pt=function(e,t,n){this.ownerID=e,this.keyHash=t,this.entry=n};Pt.prototype.get=function(e,t,n,r){return ae(n,this.entry[0])?this.entry[1]:r},Pt.prototype.update=function(e,t,n,r,o,a,u){var c=o===s,d=ae(r,this.entry[0]);return(d?o===this.entry[1]:c)?this:(i(u),c?void i(a):d?e&&e===this.ownerID?(this.entry[1]=o,this):new Pt(e,this.keyHash,[r,o]):(i(a),Vt(this,e,t,le(r),[r,o])))},At.prototype.iterate=Ft.prototype.iterate=function(e,t){for(var n=this.entries,r=0,o=n.length-1;r<=o;r++)if(!1===e(n[t?o-r:r]))return!1},Nt.prototype.iterate=Tt.prototype.iterate=function(e,t){for(var n=this.nodes,r=0,o=n.length-1;r<=o;r++){var s=n[t?o-r:r];if(s&&!1===s.iterate(e,t))return!1}},Pt.prototype.iterate=function(e,t){return e(this.entry)};var Rt,Dt=function(e){function t(e,t,n){this._type=t,this._reverse=n,this._stack=e._root&&Lt(e._root)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var e=this._type,t=this._stack;t;){var n=t.node,r=t.index++,o=void 0;if(n.entry){if(0===r)return Mt(e,n.entry)}else if(n.entries){if(r<=(o=n.entries.length-1))return Mt(e,n.entries[this._reverse?o-r:r])}else if(r<=(o=n.nodes.length-1)){var s=n.nodes[this._reverse?o-r:r];if(s){if(s.entry)return Mt(e,s.entry);t=this._stack=Lt(s,t)}continue}t=this._stack=this._stack.__prev}return{value:void 0,done:!0}},t}(D);function Mt(e,t){return M(e,t[0],t[1])}function Lt(e,t){return{node:e,index:0,__prev:t}}function Bt(e,t,n,r){var o=Object.create(It);return o.size=e,o._root=t,o.__ownerID=n,o.__hash=r,o.__altered=!1,o}function qt(){return Rt||(Rt=Bt(0))}function zt(e,t,n){var r,o;if(e._root){var i={value:!1},a={value:!1};if(r=Ht(e._root,e.__ownerID,0,void 0,t,n,i,a),!a.value)return e;o=e.size+(i.value?n===s?-1:1:0)}else{if(n===s)return e;o=1,r=new At(e.__ownerID,[[t,n]])}return e.__ownerID?(e.size=o,e._root=r,e.__hash=void 0,e.__altered=!0,e):r?Bt(o,r):qt()}function Ht(e,t,n,r,o,a,u,c){return e?e.update(t,n,r,o,a,u,c):a===s?e:(i(c),i(u),new Pt(t,r,[o,a]))}function Ut(e){return e.constructor===Pt||e.constructor===Ft}function Vt(e,t,n,r,s){if(e.keyHash===r)return new Ft(t,r,[e.entry,s]);var i,a=(0===n?e.keyHash:e.keyHash>>>n)&o,u=(0===n?r:r>>>n)&o,c=a===u?[Vt(e,t,n+5,r,s)]:(i=new Pt(t,r,s),a<u?[e,i]:[i,e]);return new Nt(t,1<<a|1<<u,c)}function $t(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,127&(e+=e>>8)+(e>>16)}function Wt(e,t,n,r){var o=r?e:$e(e);return o[t]=n,o}var Kt=8,Gt=16,Jt=8,Zt="@@__IMMUTABLE_LIST__@@";function Xt(e){return Boolean(e&&e[Zt])}var Yt=function(e){function t(t){var n=sn();if(null==t)return n;if(Xt(t))return t;var o=e(t),s=o.size;return 0===s?n:(Ke(s),s>0&&s<r?on(0,s,5,null,new en(o.toArray())):n.withMutations((function(e){e.setSize(s),o.forEach((function(t,n){return e.set(n,t)}))})))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(e,t){if((e=c(this,e))>=0&&e<this.size){var n=cn(this,e+=this._origin);return n&&n.array[e&o]}return t},t.prototype.set=function(e,t){return function(e,t,n){if((t=c(e,t))!==t)return e;if(t>=e.size||t<0)return e.withMutations((function(e){t<0?dn(e,t).set(0,n):dn(e,0,t+1).set(t,n)}));t+=e._origin;var r=e._tail,o=e._root,s={value:!1};return t>=ln(e._capacity)?r=an(r,e.__ownerID,0,t,n,s):o=an(o,e.__ownerID,e._level,t,n,s),s.value?e.__ownerID?(e._root=o,e._tail=r,e.__hash=void 0,e.__altered=!0,e):on(e._origin,e._capacity,e._level,o,r):e}(this,e,t)},t.prototype.remove=function(e){return this.has(e)?0===e?this.shift():e===this.size-1?this.pop():this.splice(e,1):this},t.prototype.insert=function(e,t){return this.splice(e,0,t)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=5,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):sn()},t.prototype.push=function(){var e=arguments,t=this.size;return this.withMutations((function(n){dn(n,0,t+e.length);for(var r=0;r<e.length;r++)n.set(t+r,e[r])}))},t.prototype.pop=function(){return dn(this,0,-1)},t.prototype.unshift=function(){var e=arguments;return this.withMutations((function(t){dn(t,-e.length);for(var n=0;n<e.length;n++)t.set(n,e[n])}))},t.prototype.shift=function(){return dn(this,1)},t.prototype.concat=function(){for(var t=arguments,n=[],r=0;r<arguments.length;r++){var o=t[r],s=e("string"!=typeof o&&B(o)?o:[o]);0!==s.size&&n.push(s)}return 0===n.length?this:0!==this.size||this.__ownerID||1!==n.length?this.withMutations((function(e){n.forEach((function(t){return t.forEach((function(t){return e.push(t)}))}))})):this.constructor(n[0])},t.prototype.setSize=function(e){return dn(this,0,e)},t.prototype.map=function(e,t){var n=this;return this.withMutations((function(r){for(var o=0;o<n.size;o++)r.set(o,e.call(t,r.get(o),o,r))}))},t.prototype.slice=function(e,t){var n=this.size;return l(e,t,n)?this:dn(this,h(e,n),f(t,n))},t.prototype.__iterator=function(e,t){var n=t?this.size:0,r=rn(this,t);return new D((function(){var o=r();return o===nn?{value:void 0,done:!0}:M(e,t?--n:n++,o)}))},t.prototype.__iterate=function(e,t){for(var n,r=t?this.size:0,o=rn(this,t);(n=o())!==nn&&!1!==e(n,t?--r:r++,this););return r},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?on(this._origin,this._capacity,this._level,this._root,this._tail,e,this.__hash):0===this.size?sn():(this.__ownerID=e,this.__altered=!1,this)},t}(C);Yt.isList=Xt;var Qt=Yt.prototype;Qt[Zt]=!0,Qt.delete=Qt.remove,Qt.merge=Qt.concat,Qt.setIn=st,Qt.deleteIn=Qt.removeIn=at,Qt.update=ct,Qt.updateIn=dt,Qt.mergeIn=kt,Qt.mergeDeepIn=St,Qt.withMutations=jt,Qt.wasAltered=Ot,Qt.asImmutable=xt,Qt["@@transducer/init"]=Qt.asMutable=Ct,Qt["@@transducer/step"]=function(e,t){return e.push(t)},Qt["@@transducer/result"]=function(e){return e.asImmutable()};var en=function(e,t){this.array=e,this.ownerID=t};en.prototype.removeBefore=function(e,t,n){if(n===t?1<<t:0===this.array.length)return this;var r=n>>>t&o;if(r>=this.array.length)return new en([],e);var s,i=0===r;if(t>0){var a=this.array[r];if((s=a&&a.removeBefore(e,t-5,n))===a&&i)return this}if(i&&!s)return this;var u=un(this,e);if(!i)for(var c=0;c<r;c++)u.array[c]=void 0;return s&&(u.array[r]=s),u},en.prototype.removeAfter=function(e,t,n){if(n===(t?1<<t:0)||0===this.array.length)return this;var r,s=n-1>>>t&o;if(s>=this.array.length)return this;if(t>0){var i=this.array[s];if((r=i&&i.removeAfter(e,t-5,n))===i&&s===this.array.length-1)return this}var a=un(this,e);return a.array.splice(s+1),r&&(a.array[s]=r),a};var tn,nn={};function rn(e,t){var n=e._origin,o=e._capacity,s=ln(o),i=e._tail;return function e(a,u,c){return 0===u?function(e,a){var u=a===s?i&&i.array:e&&e.array,c=a>n?0:n-a,d=o-a;return d>r&&(d=r),function(){if(c===d)return nn;var e=t?--d:c++;return u&&u[e]}}(a,c):function(s,i,a){var u,c=s&&s.array,d=a>n?0:n-a>>i,l=1+(o-a>>i);return l>r&&(l=r),function(){for(;;){if(u){var n=u();if(n!==nn)return n;u=null}if(d===l)return nn;var r=t?--l:d++;u=e(c&&c[r],i-5,a+(r<<i))}}}(a,u,c)}(e._root,e._level,0)}function on(e,t,n,r,o,s,i){var a=Object.create(Qt);return a.size=t-e,a._origin=e,a._capacity=t,a._level=n,a._root=r,a._tail=o,a.__ownerID=s,a.__hash=i,a.__altered=!1,a}function sn(){return tn||(tn=on(0,0,5))}function an(e,t,n,r,s,a){var u,c=r>>>n&o,d=e&&c<e.array.length;if(!d&&void 0===s)return e;if(n>0){var l=e&&e.array[c],h=an(l,t,n-5,r,s,a);return h===l?e:((u=un(e,t)).array[c]=h,u)}return d&&e.array[c]===s?e:(a&&i(a),u=un(e,t),void 0===s&&c===u.array.length-1?u.array.pop():u.array[c]=s,u)}function un(e,t){return t&&e&&t===e.ownerID?e:new en(e?e.array.slice():[],t)}function cn(e,t){if(t>=ln(e._capacity))return e._tail;if(t<1<<e._level+5){for(var n=e._root,r=e._level;n&&r>0;)n=n.array[t>>>r&o],r-=5;return n}}function dn(e,t,n){void 0!==t&&(t|=0),void 0!==n&&(n|=0);var r=e.__ownerID||new a,s=e._origin,i=e._capacity,u=s+t,c=void 0===n?i:n<0?i+n:s+n;if(u===s&&c===i)return e;if(u>=c)return e.clear();for(var d=e._level,l=e._root,h=0;u+h<0;)l=new en(l&&l.array.length?[void 0,l]:[],r),h+=1<<(d+=5);h&&(u+=h,s+=h,c+=h,i+=h);for(var f=ln(i),m=ln(c);m>=1<<d+5;)l=new en(l&&l.array.length?[l]:[],r),d+=5;var p=e._tail,g=m<f?cn(e,c-1):m>f?new en([],r):p;if(p&&m>f&&u<i&&p.array.length){for(var b=l=un(l,r),v=d;v>5;v-=5){var y=f>>>v&o;b=b.array[y]=un(b.array[y],r)}b.array[f>>>5&o]=p}if(c<i&&(g=g&&g.removeAfter(r,0,c)),u>=m)u-=m,c-=m,d=5,l=null,g=g&&g.removeBefore(r,0,u);else if(u>s||m<f){for(h=0;l;){var _=u>>>d&o;if(_!==m>>>d&o)break;_&&(h+=(1<<d)*_),d-=5,l=l.array[_]}l&&u>s&&(l=l.removeBefore(r,d,u-h)),l&&m<f&&(l=l.removeAfter(r,d,m-h)),h&&(u-=h,c-=h)}return e.__ownerID?(e.size=c-u,e._origin=u,e._capacity=c,e._level=d,e._root=l,e._tail=g,e.__hash=void 0,e.__altered=!0,e):on(u,c,d,l,g)}function ln(e){return e<r?0:e-1>>>5<<5}var hn,fn=function(e){function t(e){return null==e?pn():se(e)?e:pn().withMutations((function(t){var n=j(e);Ke(n.size),n.forEach((function(e,n){return t.set(n,e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(e,t){var n=this._map.get(e);return void 0!==n?this._list.get(n)[1]:t},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):pn()},t.prototype.set=function(e,t){return gn(this,e,t)},t.prototype.remove=function(e){return gn(this,e,s)},t.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},t.prototype.__iterate=function(e,t){var n=this;return this._list.__iterate((function(t){return t&&e(t[1],t[0],n)}),t)},t.prototype.__iterator=function(e,t){return this._list.fromEntrySeq().__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e),n=this._list.__ensureOwner(e);return e?mn(t,n,e,this.__hash):0===this.size?pn():(this.__ownerID=e,this._map=t,this._list=n,this)},t}(Et);function mn(e,t,n,r){var o=Object.create(fn.prototype);return o.size=e?e.size:0,o._map=e,o._list=t,o.__ownerID=n,o.__hash=r,o}function pn(){return hn||(hn=mn(qt(),sn()))}function gn(e,t,n){var o,i,a=e._map,u=e._list,c=a.get(t),d=void 0!==c;if(n===s){if(!d)return e;u.size>=r&&u.size>=2*a.size?(o=(i=u.filter((function(e,t){return void 0!==e&&c!==t}))).toKeyedSeq().map((function(e){return e[0]})).flip().toMap(),e.__ownerID&&(o.__ownerID=i.__ownerID=e.__ownerID)):(o=a.remove(t),i=c===u.size-1?u.pop():u.set(c,void 0))}else if(d){if(n===u.get(c)[1])return e;o=a,i=u.set(c,[t,n])}else o=a.set(t,u.size),i=u.set(u.size,[t,n]);return e.__ownerID?(e.size=o.size,e._map=o,e._list=i,e.__hash=void 0,e):mn(o,i)}fn.isOrderedMap=se,fn.prototype[T]=!0,fn.prototype.delete=fn.prototype.remove;var bn="@@__IMMUTABLE_STACK__@@";function vn(e){return Boolean(e&&e[bn])}var yn=function(e){function t(e){return null==e?Sn():vn(e)?e:Sn().pushAll(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(e,t){var n=this._head;for(e=c(this,e);n&&e--;)n=n.next;return n?n.value:t},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var e=arguments;if(0===arguments.length)return this;for(var t=this.size+arguments.length,n=this._head,r=arguments.length-1;r>=0;r--)n={value:e[r],next:n};return this.__ownerID?(this.size=t,this._head=n,this.__hash=void 0,this.__altered=!0,this):kn(t,n)},t.prototype.pushAll=function(t){if(0===(t=e(t)).size)return this;if(0===this.size&&vn(t))return t;Ke(t.size);var n=this.size,r=this._head;return t.__iterate((function(e){n++,r={value:e,next:r}}),!0),this.__ownerID?(this.size=n,this._head=r,this.__hash=void 0,this.__altered=!0,this):kn(n,r)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Sn()},t.prototype.slice=function(t,n){if(l(t,n,this.size))return this;var r=h(t,this.size);if(f(n,this.size)!==this.size)return e.prototype.slice.call(this,t,n);for(var o=this.size-r,s=this._head;r--;)s=s.next;return this.__ownerID?(this.size=o,this._head=s,this.__hash=void 0,this.__altered=!0,this):kn(o,s)},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?kn(this.size,this._head,e,this.__hash):0===this.size?Sn():(this.__ownerID=e,this.__altered=!1,this)},t.prototype.__iterate=function(e,t){var n=this;if(t)return new J(this.toArray()).__iterate((function(t,r){return e(t,r,n)}),t);for(var r=0,o=this._head;o&&!1!==e(o.value,r++,this);)o=o.next;return r},t.prototype.__iterator=function(e,t){if(t)return new J(this.toArray()).__iterator(e,t);var n=0,r=this._head;return new D((function(){if(r){var t=r.value;return r=r.next,M(e,n++,t)}return{value:void 0,done:!0}}))},t}(C);yn.isStack=vn;var _n,wn=yn.prototype;function kn(e,t,n,r){var o=Object.create(wn);return o.size=e,o._head=t,o.__ownerID=n,o.__hash=r,o.__altered=!1,o}function Sn(){return _n||(_n=kn(0))}wn[bn]=!0,wn.shift=wn.pop,wn.unshift=wn.push,wn.unshiftAll=wn.pushAll,wn.withMutations=jt,wn.wasAltered=Ot,wn.asImmutable=xt,wn["@@transducer/init"]=wn.asMutable=Ct,wn["@@transducer/step"]=function(e,t){return e.unshift(t)},wn["@@transducer/result"]=function(e){return e.asImmutable()};var jn="@@__IMMUTABLE_SET__@@";function Cn(e){return Boolean(e&&e[jn])}function xn(e){return Cn(e)&&F(e)}function On(e,t){if(e===t)return!0;if(!b(t)||void 0!==e.size&&void 0!==t.size&&e.size!==t.size||void 0!==e.__hash&&void 0!==t.__hash&&e.__hash!==t.__hash||y(e)!==y(t)||w(e)!==w(t)||F(e)!==F(t))return!1;if(0===e.size&&0===t.size)return!0;var n=!k(e);if(F(e)){var r=e.entries();return t.every((function(e,t){var o=r.next().value;return o&&ae(o[1],e)&&(n||ae(o[0],t))}))&&r.next().done}var o=!1;if(void 0===e.size)if(void 0===t.size)"function"==typeof e.cacheResult&&e.cacheResult();else{o=!0;var i=e;e=t,t=i}var a=!0,u=t.__iterate((function(t,r){if(n?!e.has(t):o?!ae(t,e.get(r,s)):!ae(e.get(r,s),t))return a=!1,!1}));return a&&e.size===u}function En(e,t){var n=function(n){e.prototype[n]=t[n]};return Object.keys(t).forEach(n),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(n),e}function In(e){if(!e||"object"!=typeof e)return e;if(!b(e)){if(!Ze(e))return e;e=$(e)}if(y(e)){var t={};return e.__iterate((function(e,n){t[n]=In(e)})),t}var n=[];return e.__iterate((function(e){n.push(In(e))})),n}var An=function(e){function t(t){return null==t?Rn():Cn(t)&&!F(t)?t:Rn().withMutations((function(n){var r=e(t);Ke(r.size),r.forEach((function(e){return n.add(e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(j(e).keySeq())},t.intersect=function(e){return(e=S(e).toArray()).length?Tn.intersect.apply(t(e.pop()),e):Rn()},t.union=function(e){return(e=S(e).toArray()).length?Tn.union.apply(t(e.pop()),e):Rn()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(e){return this._map.has(e)},t.prototype.add=function(e){return Fn(this,this._map.set(e,e))},t.prototype.remove=function(e){return Fn(this,this._map.remove(e))},t.prototype.clear=function(){return Fn(this,this._map.clear())},t.prototype.map=function(e,t){var n=this,r=[],o=[];return this.forEach((function(s){var i=e.call(t,s,s,n);i!==s&&(r.push(s),o.push(i))})),this.withMutations((function(e){r.forEach((function(t){return e.remove(t)})),o.forEach((function(t){return e.add(t)}))}))},t.prototype.union=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return 0===(t=t.filter((function(e){return 0!==e.size}))).length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations((function(n){for(var r=0;r<t.length;r++)e(t[r]).forEach((function(e){return n.add(e)}))})):this.constructor(t[0])},t.prototype.intersect=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if(0===t.length)return this;t=t.map((function(t){return e(t)}));var r=[];return this.forEach((function(e){t.every((function(t){return t.includes(e)}))||r.push(e)})),this.withMutations((function(e){r.forEach((function(t){e.remove(t)}))}))},t.prototype.subtract=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if(0===t.length)return this;t=t.map((function(t){return e(t)}));var r=[];return this.forEach((function(e){t.some((function(t){return t.includes(e)}))&&r.push(e)})),this.withMutations((function(e){r.forEach((function(t){e.remove(t)}))}))},t.prototype.sort=function(e){return Qn(Re(this,e))},t.prototype.sortBy=function(e,t){return Qn(Re(this,t,e))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(e,t){var n=this;return this._map.__iterate((function(t){return e(t,t,n)}),t)},t.prototype.__iterator=function(e,t){return this._map.__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e);return e?this.__make(t,e):0===this.size?this.__empty():(this.__ownerID=e,this._map=t,this)},t}(x);An.isSet=Cn;var Nn,Tn=An.prototype;function Fn(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:0===t.size?e.__empty():e.__make(t)}function Pn(e,t){var n=Object.create(Tn);return n.size=e?e.size:0,n._map=e,n.__ownerID=t,n}function Rn(){return Nn||(Nn=Pn(qt()))}Tn[jn]=!0,Tn.delete=Tn.remove,Tn.merge=Tn.concat=Tn.union,Tn.withMutations=jt,Tn.asImmutable=xt,Tn["@@transducer/init"]=Tn.asMutable=Ct,Tn["@@transducer/step"]=function(e,t){return e.add(t)},Tn["@@transducer/result"]=function(e){return e.asImmutable()},Tn.__empty=Rn,Tn.__make=Pn;var Dn,Mn=function(e){function t(e,n,r){if(!(this instanceof t))return new t(e,n,r);if(We(0!==r,"Cannot step a Range by 0"),e=e||0,void 0===n&&(n=1/0),r=void 0===r?1:Math.abs(r),n<e&&(r=-r),this._start=e,this._end=n,this._step=r,this.size=Math.max(0,Math.ceil((n-e)/r-1)+1),0===this.size){if(Dn)return Dn;Dn=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},t.prototype.get=function(e,t){return this.has(e)?this._start+c(this,e)*this._step:t},t.prototype.includes=function(e){var t=(e-this._start)/this._step;return t>=0&&t<this.size&&t===Math.floor(t)},t.prototype.slice=function(e,n){return l(e,n,this.size)?this:(e=h(e,this.size),(n=f(n,this.size))<=e?new t(0,0):new t(this.get(e,this._end),this.get(n,this._end),this._step))},t.prototype.indexOf=function(e){var t=e-this._start;if(t%this._step==0){var n=t/this._step;if(n>=0&&n<this.size)return n}return-1},t.prototype.lastIndexOf=function(e){return this.indexOf(e)},t.prototype.__iterate=function(e,t){for(var n=this.size,r=this._step,o=t?this._start+(n-1)*r:this._start,s=0;s!==n&&!1!==e(o,t?n-++s:s++,this);)o+=t?-r:r;return s},t.prototype.__iterator=function(e,t){var n=this.size,r=this._step,o=t?this._start+(n-1)*r:this._start,s=0;return new D((function(){if(s===n)return{value:void 0,done:!0};var i=o;return o+=t?-r:r,M(e,t?n-++s:s++,i)}))},t.prototype.equals=function(e){return e instanceof t?this._start===e._start&&this._end===e._end&&this._step===e._step:On(this,e)},t}(K);function Ln(e,t,n){for(var r=Ge(t),o=0;o!==r.length;)if((e=Qe(e,r[o++],s))===s)return n;return e}function Bn(e,t){return Ln(this,e,t)}function qn(e,t){return Ln(e,t,s)!==s}function zn(){Ke(this.size);var e={};return this.__iterate((function(t,n){e[n]=t})),e}S.isIterable=b,S.isKeyed=y,S.isIndexed=w,S.isAssociative=k,S.isOrdered=F,S.Iterator=D,En(S,{toArray:function(){Ke(this.size);var e=new Array(this.size||0),t=y(this),n=0;return this.__iterate((function(r,o){e[n++]=t?[o,r]:r})),e},toIndexedSeq:function(){return new je(this)},toJS:function(){return In(this)},toKeyedSeq:function(){return new Se(this,!0)},toMap:function(){return Et(this.toKeyedSeq())},toObject:zn,toOrderedMap:function(){return fn(this.toKeyedSeq())},toOrderedSet:function(){return Qn(y(this)?this.valueSeq():this)},toSet:function(){return An(y(this)?this.valueSeq():this)},toSetSeq:function(){return new Ce(this)},toSeq:function(){return w(this)?this.toIndexedSeq():y(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return yn(y(this)?this.valueSeq():this)},toList:function(){return Yt(y(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(e,t){return 0===this.size?e+t:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+t},concat:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Be(this,Fe(this,e))},includes:function(e){return this.some((function(t){return ae(t,e)}))},entries:function(){return this.__iterator(2)},every:function(e,t){Ke(this.size);var n=!0;return this.__iterate((function(r,o,s){if(!e.call(t,r,o,s))return n=!1,!1})),n},filter:function(e,t){return Be(this,Ae(this,e,t,!0))},find:function(e,t,n){var r=this.findEntry(e,t);return r?r[1]:n},forEach:function(e,t){return Ke(this.size),this.__iterate(t?e.bind(t):e)},join:function(e){Ke(this.size),e=void 0!==e?""+e:",";var t="",n=!0;return this.__iterate((function(r){n?n=!1:t+=e,t+=null!=r?r.toString():""})),t},keys:function(){return this.__iterator(0)},map:function(e,t){return Be(this,Ee(this,e,t))},reduce:function(e,t,n){return $n(this,e,t,n,arguments.length<2,!1)},reduceRight:function(e,t,n){return $n(this,e,t,n,arguments.length<2,!0)},reverse:function(){return Be(this,Ie(this,!0))},slice:function(e,t){return Be(this,Ne(this,e,t,!0))},some:function(e,t){return!this.every(Gn(e),t)},sort:function(e){return Be(this,Re(this,e))},values:function(){return this.__iterator(1)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(e,t){return u(e?this.toSeq().filter(e,t):this)},countBy:function(e,t){return function(e,t,n){var r=Et().asMutable();return e.__iterate((function(o,s){r.update(t.call(n,o,s,e),0,(function(e){return e+1}))})),r.asImmutable()}(this,e,t)},equals:function(e){return On(this,e)},entrySeq:function(){var e=this;if(e._cache)return new J(e._cache);var t=e.toSeq().map(Kn).toIndexedSeq();return t.fromEntrySeq=function(){return e.toSeq()},t},filterNot:function(e,t){return this.filter(Gn(e),t)},findEntry:function(e,t,n){var r=n;return this.__iterate((function(n,o,s){if(e.call(t,n,o,s))return r=[o,n],!1})),r},findKey:function(e,t){var n=this.findEntry(e,t);return n&&n[0]},findLast:function(e,t,n){return this.toKeyedSeq().reverse().find(e,t,n)},findLastEntry:function(e,t,n){return this.toKeyedSeq().reverse().findEntry(e,t,n)},findLastKey:function(e,t){return this.toKeyedSeq().reverse().findKey(e,t)},first:function(e){return this.find(d,null,e)},flatMap:function(e,t){return Be(this,function(e,t,n){var r=ze(e);return e.toSeq().map((function(o,s){return r(t.call(n,o,s,e))})).flatten(!0)}(this,e,t))},flatten:function(e){return Be(this,Pe(this,e,!0))},fromEntrySeq:function(){return new xe(this)},get:function(e,t){return this.find((function(t,n){return ae(n,e)}),void 0,t)},getIn:Bn,groupBy:function(e,t){return function(e,t,n){var r=y(e),o=(F(e)?fn():Et()).asMutable();e.__iterate((function(s,i){o.update(t.call(n,s,i,e),(function(e){return(e=e||[]).push(r?[i,s]:s),e}))}));var s=ze(e);return o.map((function(t){return Be(e,s(t))})).asImmutable()}(this,e,t)},has:function(e){return this.get(e,s)!==s},hasIn:function(e){return qn(this,e)},isSubset:function(e){return e="function"==typeof e.includes?e:S(e),this.every((function(t){return e.includes(t)}))},isSuperset:function(e){return(e="function"==typeof e.isSubset?e:S(e)).isSubset(this)},keyOf:function(e){return this.findKey((function(t){return ae(t,e)}))},keySeq:function(){return this.toSeq().map(Wn).toIndexedSeq()},last:function(e){return this.toSeq().reverse().first(e)},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return De(this,e)},maxBy:function(e,t){return De(this,t,e)},min:function(e){return De(this,e?Jn(e):Xn)},minBy:function(e,t){return De(this,t?Jn(t):Xn,e)},rest:function(){return this.slice(1)},skip:function(e){return 0===e?this:this.slice(Math.max(0,e))},skipLast:function(e){return 0===e?this:this.slice(0,-Math.max(0,e))},skipWhile:function(e,t){return Be(this,Te(this,e,t,!0))},skipUntil:function(e,t){return this.skipWhile(Gn(e),t)},sortBy:function(e,t){return Be(this,Re(this,t,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return this.slice(-Math.max(0,e))},takeWhile:function(e,t){return Be(this,function(e,t,n){var r=He(e);return r.__iterateUncached=function(r,o){var s=this;if(o)return this.cacheResult().__iterate(r,o);var i=0;return e.__iterate((function(e,o,a){return t.call(n,e,o,a)&&++i&&r(e,o,s)})),i},r.__iteratorUncached=function(r,o){var s=this;if(o)return this.cacheResult().__iterator(r,o);var i=e.__iterator(2,o),a=!0;return new D((function(){if(!a)return{value:void 0,done:!0};var e=i.next();if(e.done)return e;var o=e.value,u=o[0],c=o[1];return t.call(n,c,u,s)?2===r?e:M(r,u,c,e):(a=!1,{value:void 0,done:!0})}))},r}(this,e,t))},takeUntil:function(e,t){return this.takeWhile(Gn(e),t)},update:function(e){return e(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(e){if(e.size===1/0)return 0;var t=F(e),n=y(e),r=t?1:0;return function(e,t){return t=ue(t,3432918353),t=ue(t<<15|t>>>-15,461845907),t=ue(t<<13|t>>>-13,5),t=ue((t=(t+3864292196|0)^e)^t>>>16,2246822507),ce((t=ue(t^t>>>13,3266489909))^t>>>16)}(e.__iterate(n?t?function(e,t){r=31*r+Yn(le(e),le(t))|0}:function(e,t){r=r+Yn(le(e),le(t))|0}:t?function(e){r=31*r+le(e)|0}:function(e){r=r+le(e)|0}),r)}(this))}});var Hn=S.prototype;Hn[g]=!0,Hn[R]=Hn.values,Hn.toJSON=Hn.toArray,Hn.__toStringMapper=Xe,Hn.inspect=Hn.toSource=function(){return this.toString()},Hn.chain=Hn.flatMap,Hn.contains=Hn.includes,En(j,{flip:function(){return Be(this,Oe(this))},mapEntries:function(e,t){var n=this,r=0;return Be(this,this.toSeq().map((function(o,s){return e.call(t,[s,o],r++,n)})).fromEntrySeq())},mapKeys:function(e,t){var n=this;return Be(this,this.toSeq().flip().map((function(r,o){return e.call(t,r,o,n)})).flip())}});var Un=j.prototype;Un[v]=!0,Un[R]=Hn.entries,Un.toJSON=zn,Un.__toStringMapper=function(e,t){return Xe(t)+": "+Xe(e)},En(C,{toKeyedSeq:function(){return new Se(this,!1)},filter:function(e,t){return Be(this,Ae(this,e,t,!1))},findIndex:function(e,t){var n=this.findEntry(e,t);return n?n[0]:-1},indexOf:function(e){var t=this.keyOf(e);return void 0===t?-1:t},lastIndexOf:function(e){var t=this.lastKeyOf(e);return void 0===t?-1:t},reverse:function(){return Be(this,Ie(this,!1))},slice:function(e,t){return Be(this,Ne(this,e,t,!1))},splice:function(e,t){var n=arguments.length;if(t=Math.max(t||0,0),0===n||2===n&&!t)return this;e=h(e,e<0?this.count():this.size);var r=this.slice(0,e);return Be(this,1===n?r:r.concat($e(arguments,2),this.slice(e+t)))},findLastIndex:function(e,t){var n=this.findLastEntry(e,t);return n?n[0]:-1},first:function(e){return this.get(0,e)},flatten:function(e){return Be(this,Pe(this,e,!1))},get:function(e,t){return(e=c(this,e))<0||this.size===1/0||void 0!==this.size&&e>this.size?t:this.find((function(t,n){return n===e}),void 0,t)},has:function(e){return(e=c(this,e))>=0&&(void 0!==this.size?this.size===1/0||e<this.size:-1!==this.indexOf(e))},interpose:function(e){return Be(this,function(e,t){var n=He(e);return n.size=e.size&&2*e.size-1,n.__iterateUncached=function(n,r){var o=this,s=0;return e.__iterate((function(e){return(!s||!1!==n(t,s++,o))&&!1!==n(e,s++,o)}),r),s},n.__iteratorUncached=function(n,r){var o,s=e.__iterator(1,r),i=0;return new D((function(){return(!o||i%2)&&(o=s.next()).done?o:i%2?M(n,i++,t):M(n,i++,o.value,o)}))},n}(this,e))},interleave:function(){var e=[this].concat($e(arguments)),t=Le(this.toSeq(),K.of,e),n=t.flatten(!0);return t.size&&(n.size=t.size*e.length),Be(this,n)},keySeq:function(){return Mn(0,this.size)},last:function(e){return this.get(-1,e)},skipWhile:function(e,t){return Be(this,Te(this,e,t,!1))},zip:function(){var e=[this].concat($e(arguments));return Be(this,Le(this,Zn,e))},zipAll:function(){var e=[this].concat($e(arguments));return Be(this,Le(this,Zn,e,!0))},zipWith:function(e){var t=$e(arguments);return t[0]=this,Be(this,Le(this,e,t))}});var Vn=C.prototype;function $n(e,t,n,r,o,s){return Ke(e.size),e.__iterate((function(e,s,i){o?(o=!1,n=e):n=t.call(r,n,e,s,i)}),s),n}function Wn(e,t){return t}function Kn(e,t){return[t,e]}function Gn(e){return function(){return!e.apply(this,arguments)}}function Jn(e){return function(){return-e.apply(this,arguments)}}function Zn(){return $e(arguments)}function Xn(e,t){return e<t?1:e>t?-1:0}function Yn(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}Vn[_]=!0,Vn[T]=!0,En(x,{get:function(e,t){return this.has(e)?e:t},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}}),x.prototype.has=Hn.includes,x.prototype.contains=x.prototype.includes,En(W,j.prototype),En(K,C.prototype),En(G,x.prototype);var Qn=function(e){function t(e){return null==e?rr():xn(e)?e:rr().withMutations((function(t){var n=x(e);Ke(n.size),n.forEach((function(e){return t.add(e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(j(e).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(An);Qn.isOrderedSet=xn;var er,tr=Qn.prototype;function nr(e,t){var n=Object.create(tr);return n.size=e?e.size:0,n._map=e,n.__ownerID=t,n}function rr(){return er||(er=nr(pn()))}tr[T]=!0,tr.zip=Vn.zip,tr.zipWith=Vn.zipWith,tr.__empty=rr,tr.__make=nr;var or=function(e,t){var n,r=function(s){var i=this;if(s instanceof r)return s;if(!(this instanceof r))return new r(s);if(!n){n=!0;var a=Object.keys(e),u=o._indices={};o._name=t,o._keys=a,o._defaultValues=e;for(var c=0;c<a.length;c++){var d=a[c];u[d]=c,o[d]?"object"==typeof console&&console.warn&&console.warn("Cannot define "+ar(this)+' with property "'+d+'" since that property name is part of the Record API.'):cr(o,d)}}this.__ownerID=void 0,this._values=Yt().withMutations((function(e){e.setSize(i._keys.length),j(s).forEach((function(t,n){e.set(i._indices[n],t===i._defaultValues[n]?void 0:t)}))}))},o=r.prototype=Object.create(sr);return o.constructor=r,t&&(r.displayName=t),r};or.prototype.toString=function(){for(var e,t=ar(this)+" { ",n=this._keys,r=0,o=n.length;r!==o;r++)t+=(r?", ":"")+(e=n[r])+": "+Xe(this.get(e));return t+" }"},or.prototype.equals=function(e){return this===e||e&&this._keys===e._keys&&ur(this).equals(ur(e))},or.prototype.hashCode=function(){return ur(this).hashCode()},or.prototype.has=function(e){return this._indices.hasOwnProperty(e)},or.prototype.get=function(e,t){if(!this.has(e))return t;var n=this._indices[e],r=this._values.get(n);return void 0===r?this._defaultValues[e]:r},or.prototype.set=function(e,t){if(this.has(e)){var n=this._values.set(this._indices[e],t===this._defaultValues[e]?void 0:t);if(n!==this._values&&!this.__ownerID)return ir(this,n)}return this},or.prototype.remove=function(e){return this.set(e)},or.prototype.clear=function(){var e=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:ir(this,e)},or.prototype.wasAltered=function(){return this._values.wasAltered()},or.prototype.toSeq=function(){return ur(this)},or.prototype.toJS=function(){return In(this)},or.prototype.entries=function(){return this.__iterator(2)},or.prototype.__iterator=function(e,t){return ur(this).__iterator(e,t)},or.prototype.__iterate=function(e,t){return ur(this).__iterate(e,t)},or.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._values.__ensureOwner(e);return e?ir(this,t,e):(this.__ownerID=e,this._values=t,this)},or.isRecord=A,or.getDescriptiveName=ar;var sr=or.prototype;function ir(e,t,n){var r=Object.create(Object.getPrototypeOf(e));return r._values=t,r.__ownerID=n,r}function ar(e){return e.constructor.displayName||e.constructor.name||"Record"}function ur(e){return ee(e._keys.map((function(t){return[t,e.get(t)]})))}function cr(e,t){try{Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(e){We(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}catch(e){}}sr[I]=!0,sr.delete=sr.remove,sr.deleteIn=sr.removeIn=at,sr.getIn=Bn,sr.hasIn=Hn.hasIn,sr.merge=lt,sr.mergeWith=ht,sr.mergeIn=kt,sr.mergeDeep=_t,sr.mergeDeepWith=wt,sr.mergeDeepIn=St,sr.setIn=st,sr.update=ct,sr.updateIn=dt,sr.withMutations=jt,sr.asMutable=Ct,sr.asImmutable=xt,sr[R]=sr.entries,sr.toJSON=sr.toObject=Hn.toObject,sr.inspect=sr.toSource=function(){return this.toString()};var dr,lr=function(e){function t(e,n){if(!(this instanceof t))return new t(e,n);if(this._value=e,this.size=void 0===n?1/0:Math.max(0,n),0===this.size){if(dr)return dr;dr=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},t.prototype.get=function(e,t){return this.has(e)?this._value:t},t.prototype.includes=function(e){return ae(this._value,e)},t.prototype.slice=function(e,n){var r=this.size;return l(e,n,r)?this:new t(this._value,f(n,r)-h(e,r))},t.prototype.reverse=function(){return this},t.prototype.indexOf=function(e){return ae(this._value,e)?0:-1},t.prototype.lastIndexOf=function(e){return ae(this._value,e)?this.size:-1},t.prototype.__iterate=function(e,t){for(var n=this.size,r=0;r!==n&&!1!==e(this._value,t?n-++r:r++,this););return r},t.prototype.__iterator=function(e,t){var n=this,r=this.size,o=0;return new D((function(){return o===r?{value:void 0,done:!0}:M(e,t?r-++o:o++,n._value)}))},t.prototype.equals=function(e){return e instanceof t?ae(this._value,e._value):On(e)},t}(K);function hr(e,t){return function e(t,n,r,o,s,i){var a=Array.isArray(r)?K:Je(r)?W:null;if(a){if(~t.indexOf(r))throw new TypeError("Cannot convert circular structure to Immutable");t.push(r),s&&""!==o&&s.push(o);var u=n.call(i,o,a(r).map((function(o,i){return e(t,n,o,i,s,r)})),s&&s.slice());return t.pop(),s&&s.pop(),u}return r}([],t||fr,e,"",t&&t.length>2?[]:void 0,{"":e})}function fr(e,t){return y(t)?t.toMap():t.toList()}var mr="4.0.0-rc.11",pr={version:mr,Collection:S,Iterable:S,Seq:$,Map:Et,OrderedMap:fn,List:Yt,Stack:yn,Set:An,OrderedSet:Qn,Record:or,Range:Mn,Repeat:lr,is:ae,fromJS:hr,hash:le,isImmutable:N,isCollection:b,isKeyed:y,isIndexed:w,isAssociative:k,isOrdered:F,isValueObject:ie,isSeq:E,isList:Xt,isMap:oe,isOrderedMap:se,isStack:vn,isSet:Cn,isOrderedSet:xn,isRecord:A,get:Qe,getIn:Ln,has:Ye,hasIn:qn,merge:mt,mergeDeep:gt,mergeWith:pt,mergeDeepWith:bt,remove:tt,removeIn:it,set:nt,setIn:ot,update:ut,updateIn:rt},gr=S;t.default=pr},"../notebook-dds/node_modules/indexof/index.js":function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},"../notebook-dds/node_modules/isarray/index.js":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"../notebook-dds/node_modules/isomorphic-ws/browser.js":function(e,t,n){(function(t){var n=null;"undefined"!=typeof WebSocket?n=WebSocket:"undefined"!=typeof MozWebSocket?n=MozWebSocket:void 0!==t?n=t.WebSocket||t.MozWebSocket:"undefined"!=typeof window?n=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(n=self.WebSocket||self.MozWebSocket),e.exports=n}).call(this,n("./node_modules/webpack/buildin/global.js"))},"../notebook-dds/node_modules/json-stringify-safe/stringify.js":function(e,t){function n(e,t){var n=[],r=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(t)).join(".")+"]"}),function(o,s){if(n.length>0){var i=n.indexOf(this);~i?n.splice(i+1):n.push(this),~i?r.splice(i,1/0,o):r.push(o),~n.indexOf(s)&&(s=t.call(this,o,s))}else n.push(s);return null==e?s:e.call(this,o,s)}}(e.exports=function(e,t,r,o){return JSON.stringify(e,n(t,o),r)}).getSerialize=n},"../notebook-dds/node_modules/jsonwebtoken/decode.js":function(e,t,n){var r=n("../notebook-dds/node_modules/jws/index.js");e.exports=function(e,t){t=t||{};var n=r.decode(e,t);if(!n)return null;var o=n.payload;if("string"==typeof o)try{var s=JSON.parse(o);null!==s&&"object"==typeof s&&(o=s)}catch(e){}return!0===t.complete?{header:n.header,payload:o,signature:n.signature}:o}},"../notebook-dds/node_modules/jsonwebtoken/index.js":function(e,t,n){e.exports={decode:n("../notebook-dds/node_modules/jsonwebtoken/decode.js"),verify:n("../notebook-dds/node_modules/jsonwebtoken/verify.js"),sign:n("../notebook-dds/node_modules/jsonwebtoken/sign.js"),JsonWebTokenError:n("../notebook-dds/node_modules/jsonwebtoken/lib/JsonWebTokenError.js"),NotBeforeError:n("../notebook-dds/node_modules/jsonwebtoken/lib/NotBeforeError.js"),TokenExpiredError:n("../notebook-dds/node_modules/jsonwebtoken/lib/TokenExpiredError.js")}},"../notebook-dds/node_modules/jsonwebtoken/lib/JsonWebTokenError.js":function(e,t){var n=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};(n.prototype=Object.create(Error.prototype)).constructor=n,e.exports=n},"../notebook-dds/node_modules/jsonwebtoken/lib/NotBeforeError.js":function(e,t,n){var r=n("../notebook-dds/node_modules/jsonwebtoken/lib/JsonWebTokenError.js"),o=function(e,t){r.call(this,e),this.name="NotBeforeError",this.date=t};(o.prototype=Object.create(r.prototype)).constructor=o,e.exports=o},"../notebook-dds/node_modules/jsonwebtoken/lib/TokenExpiredError.js":function(e,t,n){var r=n("../notebook-dds/node_modules/jsonwebtoken/lib/JsonWebTokenError.js"),o=function(e,t){r.call(this,e),this.name="TokenExpiredError",this.expiredAt=t};(o.prototype=Object.create(r.prototype)).constructor=o,e.exports=o},"../notebook-dds/node_modules/jsonwebtoken/lib/psSupported.js":function(e,t,n){(function(t){var r=n("../notebook-dds/node_modules/semver/semver.js");e.exports=r.satisfies(t.version,"^6.12.0 || >=8.0.0")}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/jsonwebtoken/lib/timespan.js":function(e,t,n){var r=n("../notebook-dds/node_modules/ms/index.js");e.exports=function(e,t){var n=t||Math.floor(Date.now()/1e3);if("string"==typeof e){var o=r(e);if(void 0===o)return;return Math.floor(n+o/1e3)}return"number"==typeof e?n+e:void 0}},"../notebook-dds/node_modules/jsonwebtoken/sign.js":function(e,t,n){(function(t){var r=n("../notebook-dds/node_modules/jsonwebtoken/lib/timespan.js"),o=n("../notebook-dds/node_modules/jsonwebtoken/lib/psSupported.js"),s=n("../notebook-dds/node_modules/jws/index.js"),i=n("../notebook-dds/node_modules/lodash.includes/index.js"),a=n("../notebook-dds/node_modules/lodash.isboolean/index.js"),u=n("../notebook-dds/node_modules/lodash.isinteger/index.js"),c=n("../notebook-dds/node_modules/lodash.isnumber/index.js"),d=n("../notebook-dds/node_modules/lodash.isplainobject/index.js"),l=n("../notebook-dds/node_modules/lodash.isstring/index.js"),h=n("../notebook-dds/node_modules/lodash.once/index.js"),f=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];o&&f.splice(3,0,"PS256","PS384","PS512");var m={expiresIn:{isValid:function(e){return u(e)||l(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return u(e)||l(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return l(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:i.bind(null,f),message:'"algorithm" must be a valid string enum value'},header:{isValid:d,message:'"header" must be an object'},encoding:{isValid:l,message:'"encoding" must be a string'},issuer:{isValid:l,message:'"issuer" must be a string'},subject:{isValid:l,message:'"subject" must be a string'},jwtid:{isValid:l,message:'"jwtid" must be a string'},noTimestamp:{isValid:a,message:'"noTimestamp" must be a boolean'},keyid:{isValid:l,message:'"keyid" must be a string'},mutatePayload:{isValid:a,message:'"mutatePayload" must be a boolean'}},p={iat:{isValid:c,message:'"iat" should be a number of seconds'},exp:{isValid:c,message:'"exp" should be a number of seconds'},nbf:{isValid:c,message:'"nbf" should be a number of seconds'}};function g(e,t,n,r){if(!d(n))throw new Error('Expected "'+r+'" to be a plain object.');Object.keys(n).forEach((function(o){var s=e[o];if(s){if(!s.isValid(n[o]))throw new Error(s.message)}else if(!t)throw new Error('"'+o+'" is not allowed in "'+r+'"')}))}var b={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},v=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];e.exports=function(e,n,o,i){"function"==typeof o?(i=o,o={}):o=o||{};var a="object"==typeof e&&!t.isBuffer(e),u=Object.assign({alg:o.algorithm||"HS256",typ:a?"JWT":void 0,kid:o.keyid},o.header);function c(e){if(i)return i(e);throw e}if(!n&&"none"!==o.algorithm)return c(new Error("secretOrPrivateKey must have a value"));if(void 0===e)return c(new Error("payload is required"));if(a){try{!function(e){g(p,!0,e,"payload")}(e)}catch(e){return c(e)}o.mutatePayload||(e=Object.assign({},e))}else{var d=v.filter((function(e){return void 0!==o[e]}));if(d.length>0)return c(new Error("invalid "+d.join(",")+" option for "+typeof e+" payload"))}if(void 0!==e.exp&&void 0!==o.expiresIn)return c(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==e.nbf&&void 0!==o.notBefore)return c(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){g(m,!1,e,"options")}(o)}catch(e){return c(e)}var l=e.iat||Math.floor(Date.now()/1e3);if(o.noTimestamp?delete e.iat:a&&(e.iat=l),void 0!==o.notBefore){try{e.nbf=r(o.notBefore,l)}catch(e){return c(e)}if(void 0===e.nbf)return c(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==o.expiresIn&&"object"==typeof e){try{e.exp=r(o.expiresIn,l)}catch(e){return c(e)}if(void 0===e.exp)return c(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(b).forEach((function(t){var n=b[t];if(void 0!==o[t]){if(void 0!==e[n])return c(new Error('Bad "options.'+t+'" option. The payload already has an "'+n+'" property.'));e[n]=o[t]}}));var f=o.encoding||"utf8";if("function"!=typeof i)return s.sign({header:u,payload:e,secret:n,encoding:f});i=i&&h(i),s.createSign({header:u,privateKey:n,payload:e,encoding:f}).once("error",i).once("done",(function(e){i(null,e)}))}}).call(this,n("./node_modules/buffer/index.js").Buffer)},"../notebook-dds/node_modules/jsonwebtoken/verify.js":function(e,t,n){var r=n("../notebook-dds/node_modules/jsonwebtoken/lib/JsonWebTokenError.js"),o=n("../notebook-dds/node_modules/jsonwebtoken/lib/NotBeforeError.js"),s=n("../notebook-dds/node_modules/jsonwebtoken/lib/TokenExpiredError.js"),i=n("../notebook-dds/node_modules/jsonwebtoken/decode.js"),a=n("../notebook-dds/node_modules/jsonwebtoken/lib/timespan.js"),u=n("../notebook-dds/node_modules/jsonwebtoken/lib/psSupported.js"),c=n("../notebook-dds/node_modules/jws/index.js"),d=["RS256","RS384","RS512","ES256","ES384","ES512"],l=["RS256","RS384","RS512"],h=["HS256","HS384","HS512"];u&&(d.splice(3,0,"PS256","PS384","PS512"),l.splice(3,0,"PS256","PS384","PS512")),e.exports=function(e,t,n,u){var f;if("function"!=typeof n||u||(u=n,n={}),n||(n={}),n=Object.assign({},n),f=u||function(e,t){if(e)throw e;return t},n.clockTimestamp&&"number"!=typeof n.clockTimestamp)return f(new r("clockTimestamp must be a number"));if(void 0!==n.nonce&&("string"!=typeof n.nonce||""===n.nonce.trim()))return f(new r("nonce must be a non-empty string"));var m=n.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return f(new r("jwt must be provided"));if("string"!=typeof e)return f(new r("jwt must be a string"));var p,g=e.split(".");if(3!==g.length)return f(new r("jwt malformed"));try{p=i(e,{complete:!0})}catch(e){return f(e)}if(!p)return f(new r("invalid token"));var b,v=p.header;if("function"==typeof t){if(!u)return f(new r("verify must be called asynchronous if secret or public key is provided as a callback"));b=t}else b=function(e,n){return n(null,t)};return b(v,(function(t,i){if(t)return f(new r("error in secret or public key callback: "+t.message));var u,b=""!==g[2].trim();if(!b&&i)return f(new r("jwt signature is required"));if(b&&!i)return f(new r("secret or public key must be provided"));if(b||n.algorithms||(n.algorithms=["none"]),n.algorithms||(n.algorithms=~i.toString().indexOf("BEGIN CERTIFICATE")||~i.toString().indexOf("BEGIN PUBLIC KEY")?d:~i.toString().indexOf("BEGIN RSA PUBLIC KEY")?l:h),!~n.algorithms.indexOf(p.header.alg))return f(new r("invalid algorithm"));try{u=c.verify(e,p.header.alg,i)}catch(e){return f(e)}if(!u)return f(new r("invalid signature"));var y=p.payload;if(void 0!==y.nbf&&!n.ignoreNotBefore){if("number"!=typeof y.nbf)return f(new r("invalid nbf value"));if(y.nbf>m+(n.clockTolerance||0))return f(new o("jwt not active",new Date(1e3*y.nbf)))}if(void 0!==y.exp&&!n.ignoreExpiration){if("number"!=typeof y.exp)return f(new r("invalid exp value"));if(m>=y.exp+(n.clockTolerance||0))return f(new s("jwt expired",new Date(1e3*y.exp)))}if(n.audience){var _=Array.isArray(n.audience)?n.audience:[n.audience];if(!(Array.isArray(y.aud)?y.aud:[y.aud]).some((function(e){return _.some((function(t){return t instanceof RegExp?t.test(e):t===e}))})))return f(new r("jwt audience invalid. expected: "+_.join(" or ")))}if(n.issuer&&("string"==typeof n.issuer&&y.iss!==n.issuer||Array.isArray(n.issuer)&&-1===n.issuer.indexOf(y.iss)))return f(new r("jwt issuer invalid. expected: "+n.issuer));if(n.subject&&y.sub!==n.subject)return f(new r("jwt subject invalid. expected: "+n.subject));if(n.jwtid&&y.jti!==n.jwtid)return f(new r("jwt jwtid invalid. expected: "+n.jwtid));if(n.nonce&&y.nonce!==n.nonce)return f(new r("jwt nonce invalid. expected: "+n.nonce));if(n.maxAge){if("number"!=typeof y.iat)return f(new r("iat required when maxAge is specified"));var w=a(n.maxAge,y.iat);if(void 0===w)return f(new r('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(m>=w+(n.clockTolerance||0))return f(new s("maxAge exceeded",new Date(1e3*w)))}if(!0===n.complete){var k=p.signature;return f(null,{header:v,payload:y,signature:k})}return f(null,y)}))}},"../notebook-dds/node_modules/jsrsasign/lib/jsrsasign.js":function(e,t,n){(function(e){var n={userAgent:!1},r={};if(void 0===o)var o={};o.lang={extend:function(e,t,r){if(!t||!e)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var o=function(){};if(o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t),r){var s;for(s in r)e.prototype[s]=r[s];var i=function(){},a=["toString","valueOf"];try{/MSIE/.test(n.userAgent)&&(i=function(e,t){for(s=0;s<a.length;s+=1){var n=a[s],r=t[n];"function"==typeof r&&r!=Object.prototype[n]&&(e[n]=r)}})}catch(e){}i(e.prototype,r)}}};var s=s||function(e,t){var n={},r=n.lib={},o=r.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=r.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var s=0;s<o;s++){var i=n[s>>>2]>>>24-s%4*8&255;t[r+s>>>2]|=i<<24-(r+s)%4*8}else for(s=0;s<o;s+=4)t[r+s>>>2]=n[s>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),i=n.enc={},a=i.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var s=t[o>>>2]>>>24-o%4*8&255;r.push((s>>>4).toString(16)),r.push((15&s).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},u=i.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var s=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},c=i.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i),u=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*i,c=e.min(4*u,o);if(u){for(var d=0;d<u;d+=i)this._doProcessBlock(r,d);var l=r.splice(0,u);n.sigBytes-=c}return new s.init(l,c)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),l=(r.Hasher=d.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new l.HMAC.init(e,n).finalize(t)}}}),n.algo={});return n}(Math);!function(e){var t,n=(t=s).lib,r=n.Base,o=n.WordArray;(t=t.x64={}).Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var s=e[r];n.push(s.high),n.push(s.low)}return o.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,o=0;o<n;o++)t[o]=t[o].clone();return e}})}(),s.lib.Cipher||function(e){var t=(m=s).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=m.enc.Base64,a=m.algo.EvpKDF,u=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?p:f).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?p:f).decrypt(e,t,n,r)}}}});t.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=m.mode={},d=function(e,t,n){var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;d.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),d.call(this,e,t,r),this._prevBlock=o}}),c=c.CBC=l,l=(m.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,s=[],i=0;i<n;i+=4)s.push(o);n=r.create(s,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=u.extend({cfg:u.cfg.extend({mode:c,padding:l}),reset:function(){u.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var h=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(c=(m.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return h.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:c}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,h.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),m=(m.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=a.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,h.create({key:e,iv:n,salt:o})}},p=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:m}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=f.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,f.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=s,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],u=[],c=[],d=[],l=[],h=[],f=[],m=[],p=0;256>p;p++)m[p]=128>p?p<<1:p<<1^283;var g=0,b=0;for(p=0;256>p;p++){var v=(v=b^b<<1^b<<2^b<<3^b<<4)>>>8^255&v^99;r[g]=v,o[v]=g;var y=m[g],_=m[y],w=m[_],k=257*m[v]^16843008*v;i[g]=k<<24|k>>>8,a[g]=k<<16|k>>>16,u[g]=k<<8|k>>>24,c[g]=k,k=16843009*w^65537*_^257*y^16843008*g,d[v]=k<<24|k>>>8,l[v]=k<<16|k>>>16,h[v]=k<<8|k>>>24,f[v]=k,g?(g=y^m[m[m[w^y]]],b^=m[m[b]]):g=b=1}var S=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],s=0;s<n;s++)if(s<t)o[s]=e[s];else{var i=o[s-1];s%t?6<t&&4==s%t&&(i=r[i>>>24]<<24|r[i>>>16&255]<<16|r[i>>>8&255]<<8|r[255&i]):(i=r[(i=i<<8|i>>>24)>>>24]<<24|r[i>>>16&255]<<16|r[i>>>8&255]<<8|r[255&i],i^=S[s/t|0]<<24),o[s]=o[s-t]^i}for(e=this._invKeySchedule=[],t=0;t<n;t++)s=n-t,i=t%4?o[s]:o[s-4],e[t]=4>t||4>=s?i:d[r[i>>>24]]^l[r[i>>>16&255]]^h[r[i>>>8&255]]^f[r[255&i]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,u,c,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,d,l,h,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,s,i,a){for(var u=this._nRounds,c=e[t]^n[0],d=e[t+1]^n[1],l=e[t+2]^n[2],h=e[t+3]^n[3],f=4,m=1;m<u;m++){var p=r[c>>>24]^o[d>>>16&255]^s[l>>>8&255]^i[255&h]^n[f++],g=r[d>>>24]^o[l>>>16&255]^s[h>>>8&255]^i[255&c]^n[f++],b=r[l>>>24]^o[h>>>16&255]^s[c>>>8&255]^i[255&d]^n[f++];h=r[h>>>24]^o[c>>>16&255]^s[d>>>8&255]^i[255&l]^n[f++],c=p,d=g,l=b}p=(a[c>>>24]<<24|a[d>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^n[f++],g=(a[d>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[f++],b=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&d])^n[f++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[d>>>8&255]<<8|a[255&l])^n[f++],e[t]=p,e[t+1]=g,e[t+2]=b,e[t+3]=h},keySize:8}),e.AES=t._createHelper(n)}(),function(){function e(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function t(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}var n=s,r=(o=n.lib).WordArray,o=o.BlockCipher,i=n.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=i.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;56>n;n++){var r=a[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(e=this._subKeys=[],r=0;16>r;r++){var o=e[r]=[],s=c[r];for(n=0;24>n;n++)o[n/6|0]|=t[(u[n]-1+s)%28]<<31-n%6,o[4+(n/6|0)]|=t[28+(u[n+24]-1+s)%28]<<31-n%6;for(o[0]=o[0]<<1|o[0]>>>31,n=1;7>n;n++)o[n]>>>=4*(n-1)+3;o[7]=o[7]<<5|o[7]>>>27}for(t=this._invSubKeys=[],n=0;16>n;n++)t[n]=e[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(n,r,o){this._lBlock=n[r],this._rBlock=n[r+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var s=0;16>s;s++){for(var i=o[s],a=this._lBlock,u=this._rBlock,c=0,h=0;8>h;h++)c|=d[h][((u^i[h])&l[h])>>>0];this._lBlock=u,this._rBlock=a^c}o=this._lBlock,this._lBlock=this._rBlock,this._rBlock=o,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),n[r]=this._lBlock,n[r+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});n.DES=o._createHelper(h),i=i.TripleDES=o.extend({_doReset:function(){var e=this._key.words;this._des1=h.createEncryptor(r.create(e.slice(0,2))),this._des2=h.createEncryptor(r.create(e.slice(2,4))),this._des3=h.createEncryptor(r.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2}),n.TripleDES=o._createHelper(i)}(),function(){var e=s,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,i=0;4>i&&o+.75*i<n;i++)e.push(r.charAt(s>>>6*(3-i)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map;(o=r.charAt(64))&&-1!=(o=e.indexOf(o))&&(n=o);for(var o=[],s=0,i=0;i<n;i++)if(i%4){var a=r.indexOf(e.charAt(i-1))<<i%4*2,u=r.indexOf(e.charAt(i))>>>6-i%4*2;o[s>>>2]|=(a|u)<<24-s%4*8,s++}return t.create(o,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,r,o,s,i){return((e=e+(t&n|~t&r)+o+i)<<s|e>>>32-s)+t}function n(e,t,n,r,o,s,i){return((e=e+(t&r|n&~r)+o+i)<<s|e>>>32-s)+t}function r(e,t,n,r,o,s,i){return((e=e+(t^n^r)+o+i)<<s|e>>>32-s)+t}function o(e,t,n,r,o,s,i){return((e=e+(n^(t|~r))+o+i)<<s|e>>>32-s)+t}for(var i=s,a=(c=i.lib).WordArray,u=c.Hasher,c=i.algo,d=[],l=0;64>l;l++)d[l]=4294967296*e.abs(e.sin(l+1))|0;c=c.MD5=u.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,s){for(var i=0;16>i;i++){var a=e[u=s+i];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}i=this._hash.words;var u=e[s+0],c=(a=e[s+1],e[s+2]),l=e[s+3],h=e[s+4],f=e[s+5],m=e[s+6],p=e[s+7],g=e[s+8],b=e[s+9],v=e[s+10],y=e[s+11],_=e[s+12],w=e[s+13],k=e[s+14],S=e[s+15],j=t(j=i[0],O=i[1],x=i[2],C=i[3],u,7,d[0]),C=t(C,j,O,x,a,12,d[1]),x=t(x,C,j,O,c,17,d[2]),O=t(O,x,C,j,l,22,d[3]);j=t(j,O,x,C,h,7,d[4]),C=t(C,j,O,x,f,12,d[5]),x=t(x,C,j,O,m,17,d[6]),O=t(O,x,C,j,p,22,d[7]),j=t(j,O,x,C,g,7,d[8]),C=t(C,j,O,x,b,12,d[9]),x=t(x,C,j,O,v,17,d[10]),O=t(O,x,C,j,y,22,d[11]),j=t(j,O,x,C,_,7,d[12]),C=t(C,j,O,x,w,12,d[13]),x=t(x,C,j,O,k,17,d[14]),j=n(j,O=t(O,x,C,j,S,22,d[15]),x,C,a,5,d[16]),C=n(C,j,O,x,m,9,d[17]),x=n(x,C,j,O,y,14,d[18]),O=n(O,x,C,j,u,20,d[19]),j=n(j,O,x,C,f,5,d[20]),C=n(C,j,O,x,v,9,d[21]),x=n(x,C,j,O,S,14,d[22]),O=n(O,x,C,j,h,20,d[23]),j=n(j,O,x,C,b,5,d[24]),C=n(C,j,O,x,k,9,d[25]),x=n(x,C,j,O,l,14,d[26]),O=n(O,x,C,j,g,20,d[27]),j=n(j,O,x,C,w,5,d[28]),C=n(C,j,O,x,c,9,d[29]),x=n(x,C,j,O,p,14,d[30]),j=r(j,O=n(O,x,C,j,_,20,d[31]),x,C,f,4,d[32]),C=r(C,j,O,x,g,11,d[33]),x=r(x,C,j,O,y,16,d[34]),O=r(O,x,C,j,k,23,d[35]),j=r(j,O,x,C,a,4,d[36]),C=r(C,j,O,x,h,11,d[37]),x=r(x,C,j,O,p,16,d[38]),O=r(O,x,C,j,v,23,d[39]),j=r(j,O,x,C,w,4,d[40]),C=r(C,j,O,x,u,11,d[41]),x=r(x,C,j,O,l,16,d[42]),O=r(O,x,C,j,m,23,d[43]),j=r(j,O,x,C,b,4,d[44]),C=r(C,j,O,x,_,11,d[45]),x=r(x,C,j,O,S,16,d[46]),j=o(j,O=r(O,x,C,j,c,23,d[47]),x,C,u,6,d[48]),C=o(C,j,O,x,p,10,d[49]),x=o(x,C,j,O,k,15,d[50]),O=o(O,x,C,j,f,21,d[51]),j=o(j,O,x,C,_,6,d[52]),C=o(C,j,O,x,l,10,d[53]),x=o(x,C,j,O,v,15,d[54]),O=o(O,x,C,j,a,21,d[55]),j=o(j,O,x,C,g,6,d[56]),C=o(C,j,O,x,S,10,d[57]),x=o(x,C,j,O,m,15,d[58]),O=o(O,x,C,j,w,21,d[59]),j=o(j,O,x,C,h,6,d[60]),C=o(C,j,O,x,y,10,d[61]),x=o(x,C,j,O,c,15,d[62]),O=o(O,x,C,j,b,21,d[63]),i[0]=i[0]+j|0,i[1]=i[1]+O|0,i[2]=i[2]+x|0,i[3]=i[3]+C|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var s=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=u.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=u._createHelper(c),i.HmacMD5=u._createHmacHelper(c)}(Math),function(){var e=s,t=(o=e.lib).WordArray,n=o.Hasher,r=[],o=e.algo.SHA1=n.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],s=n[1],i=n[2],a=n[3],u=n[4],c=0;80>c;c++){if(16>c)r[c]=0|e[t+c];else{var d=r[c-3]^r[c-8]^r[c-14]^r[c-16];r[c]=d<<1|d>>>31}d=(o<<5|o>>>27)+u+r[c],d=20>c?d+(1518500249+(s&i|~s&a)):40>c?d+(1859775393+(s^i^a)):60>c?d+((s&i|s&a|i&a)-1894007588):d+((s^i^a)-899497514),u=a,a=i,i=s<<30|s>>>2,s=o,o=d}n[0]=n[0]+o|0,n[1]=n[1]+s|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=n._createHelper(o),e.HmacSHA1=n._createHmacHelper(o)}(),function(e){for(var t=s,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],a=[],u=function(e){return 4294967296*(e-(0|e))|0},c=2,d=0;64>d;){var l;e:{l=c;for(var h=e.sqrt(l),f=2;f<=h;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>d&&(i[d]=u(e.pow(c,.5))),a[d]=u(e.pow(c,1/3)),d++),c++}var m=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],s=n[2],i=n[3],u=n[4],c=n[5],d=n[6],l=n[7],h=0;64>h;h++){if(16>h)m[h]=0|e[t+h];else{var f=m[h-15],p=m[h-2];m[h]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+m[h-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+m[h-16]}f=l+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&d)+a[h]+m[h],p=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&s^o&s),l=d,d=c,c=u,u=i+f|0,i=s,s=o,o=r,r=f+p|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+s|0,n[3]=n[3]+i|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+d|0,n[7]=n[7]+l|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),function(){var e=s,t=e.lib.WordArray,n=(r=e.algo).SHA256,r=r.SHA224=n.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=n._createHelper(r),e.HmacSHA224=n._createHmacHelper(r)}(),function(){function e(){return r.create.apply(r,arguments)}for(var t=s,n=t.lib.Hasher,r=(i=t.x64).Word,o=i.WordArray,i=t.algo,a=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],u=[],c=0;80>c;c++)u[c]=e();i=i.SHA512=n.extend({_doReset:function(){this._hash=new o.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=(l=this._hash.words)[0],r=l[1],o=l[2],s=l[3],i=l[4],c=l[5],d=l[6],l=l[7],h=n.high,f=n.low,m=r.high,p=r.low,g=o.high,b=o.low,v=s.high,y=s.low,_=i.high,w=i.low,k=c.high,S=c.low,j=d.high,C=d.low,x=l.high,O=l.low,E=h,I=f,A=m,N=p,T=g,F=b,P=v,R=y,D=_,M=w,L=k,B=S,q=j,z=C,H=x,U=O,V=0;80>V;V++){var $=u[V];if(16>V)var W=$.high=0|e[t+2*V],K=$.low=0|e[t+2*V+1];else{W=((K=(W=u[V-15]).high)>>>1|(G=W.low)<<31)^(K>>>8|G<<24)^K>>>7;var G=(G>>>1|K<<31)^(G>>>8|K<<24)^(G>>>7|K<<25),J=((K=(J=u[V-2]).high)>>>19|(Z=J.low)<<13)^(K<<3|Z>>>29)^K>>>6,Z=(Z>>>19|K<<13)^(Z<<3|K>>>29)^(Z>>>6|K<<26),X=(K=u[V-7]).high,Y=(Q=u[V-16]).high,Q=Q.low;W=(W=(W=W+X+((K=G+K.low)>>>0<G>>>0?1:0))+J+((K+=Z)>>>0<Z>>>0?1:0))+Y+((K+=Q)>>>0<Q>>>0?1:0),$.high=W,$.low=K}X=D&L^~D&q,Q=M&B^~M&z,$=E&A^E&T^A&T;var ee=I&N^I&F^N&F,te=(G=(E>>>28|I<<4)^(E<<30|I>>>2)^(E<<25|I>>>7),J=(I>>>28|E<<4)^(I<<30|E>>>2)^(I<<25|E>>>7),(Z=a[V]).high),ne=Z.low;Y=H+((D>>>14|M<<18)^(D>>>18|M<<14)^(D<<23|M>>>9))+((Z=U+((M>>>14|D<<18)^(M>>>18|D<<14)^(M<<23|D>>>9)))>>>0<U>>>0?1:0),H=q,U=z,q=L,z=B,L=D,B=M,D=P+(Y=(Y=(Y=Y+X+((Z+=Q)>>>0<Q>>>0?1:0))+te+((Z+=ne)>>>0<ne>>>0?1:0))+W+((Z+=K)>>>0<K>>>0?1:0))+((M=R+Z|0)>>>0<R>>>0?1:0)|0,P=T,R=F,T=A,F=N,A=E,N=I,E=Y+($=G+$+((K=J+ee)>>>0<J>>>0?1:0))+((I=Z+K|0)>>>0<Z>>>0?1:0)|0}f=n.low=f+I,n.high=h+E+(f>>>0<I>>>0?1:0),p=r.low=p+N,r.high=m+A+(p>>>0<N>>>0?1:0),b=o.low=b+F,o.high=g+T+(b>>>0<F>>>0?1:0),y=s.low=y+R,s.high=v+P+(y>>>0<R>>>0?1:0),w=i.low=w+M,i.high=_+D+(w>>>0<M>>>0?1:0),S=c.low=S+B,c.high=k+L+(S>>>0<B>>>0?1:0),C=d.low=C+z,d.high=j+q+(C>>>0<z>>>0?1:0),O=l.low=O+U,l.high=x+H+(O>>>0<U>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=n._createHelper(i),t.HmacSHA512=n._createHmacHelper(i)}(),function(){var e=s,t=(o=e.x64).Word,n=o.WordArray,r=(o=e.algo).SHA512,o=o.SHA384=r.extend({_doReset:function(){this._hash=new n.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var e=r._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=r._createHelper(o),e.HmacSHA384=r._createHmacHelper(o)}(),function(){var e=s,t=(r=e.lib).WordArray,n=r.Hasher,r=e.algo,o=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),i=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),a=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),u=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),c=t.create([0,1518500249,1859775393,2400959708,2840853838]),d=t.create([1352829926,1548603684,1836072691,2053994217,0]);r=r.RIPEMD160=n.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;16>n;n++){var r=e[w=t+n];e[w]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var s,l,h,f,m,p,g,b,v,y,_,w=this._hash.words,k=(r=c.words,d.words),S=o.words,j=i.words,C=a.words,x=u.words;for(p=s=w[0],g=l=w[1],b=h=w[2],v=f=w[3],y=m=w[4],n=0;80>n;n+=1)_=s+e[t+S[n]]|0,_=16>n?_+((l^h^f)+r[0]):32>n?_+((l&h|~l&f)+r[1]):48>n?_+(((l|~h)^f)+r[2]):64>n?_+((l&f|h&~f)+r[3]):_+((l^(h|~f))+r[4]),_=(_=(_|=0)<<C[n]|_>>>32-C[n])+m|0,s=m,m=f,f=h<<10|h>>>22,h=l,l=_,_=p+e[t+j[n]]|0,_=16>n?_+((g^(b|~v))+k[0]):32>n?_+((g&v|b&~v)+k[1]):48>n?_+(((g|~b)^v)+k[2]):64>n?_+((g&b|~g&v)+k[3]):_+((g^b^v)+k[4]),_=(_=(_|=0)<<x[n]|_>>>32-x[n])+y|0,p=y,y=v,v=b<<10|b>>>22,b=g,g=_;_=w[1]+h+v|0,w[1]=w[2]+f+y|0,w[2]=w[3]+m+p|0,w[3]=w[4]+s+g|0,w[4]=w[0]+l+b|0,w[0]=_},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;for(t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process(),t=(e=this._hash).words,n=0;5>n;n++)r=t[n],t[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return e},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),e.RIPEMD160=n._createHelper(r),e.HmacRIPEMD160=n._createHmacHelper(r)}(Math),function(){var e=s,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,o=4*r;n.sigBytes>o&&(n=e.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),i=this._iKey=n.clone(),a=s.words,u=i.words,c=0;c<r;c++)a[c]^=1549556828,u[c]^=909522486;s.sigBytes=i.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e,t=s,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).HMAC,i=e.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:e.SHA1,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){var n=this.cfg,s=o.create(n.hasher,e),i=r.create(),a=r.create([1]),u=i.words,c=a.words,d=n.keySize;for(n=n.iterations;u.length<d;){var l=s.update(t).finalize(a);s.reset();for(var h=l.words,f=h.length,m=l,p=1;p<n;p++){m=s.finalize(m),s.reset();for(var g=m.words,b=0;b<f;b++)h[b]^=g[b]}i.concat(l),c[0]++}return i.sigBytes=4*d,i}});t.PBKDF2=function(e,t,n){return i.create(n).compute(e,t)}}();var i,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function u(e){var t,n,r="";for(t=0;t+3<=e.length;t+=3)n=parseInt(e.substring(t,t+3),16),r+=a.charAt(n>>6)+a.charAt(63&n);for(t+1==e.length?(n=parseInt(e.substring(t,t+1),16),r+=a.charAt(n<<2)):t+2==e.length&&(n=parseInt(e.substring(t,t+2),16),r+=a.charAt(n>>2)+a.charAt((3&n)<<4));(3&r.length)>0;)r+="=";return r}function c(e){var t,n,r,o="",s=0;for(t=0;t<e.length&&"="!=e.charAt(t);++t)(r=a.indexOf(e.charAt(t)))<0||(0==s?(o+=g(r>>2),n=3&r,s=1):1==s?(o+=g(n<<2|r>>4),n=15&r,s=2):2==s?(o+=g(n),o+=g(r>>2),n=3&r,s=3):(o+=g(n<<2|r>>4),o+=g(15&r),s=0));return 1==s&&(o+=g(n<<2)),o}function d(e){var t,n=c(e),r=new Array;for(t=0;2*t<n.length;++t)r[t]=parseInt(n.substring(2*t,2*t+2),16);return r}function l(e,t,n){null!=e&&("number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function h(){return new l(null)}"Microsoft Internet Explorer"==n.appName?(l.prototype.am=function(e,t,n,r,o,s){for(var i=32767&t,a=t>>15;--s>=0;){var u=32767&this[e],c=this[e++]>>15,d=a*u+c*i;o=((u=i*u+((32767&d)<<15)+n[r]+(1073741823&o))>>>30)+(d>>>15)+a*c+(o>>>30),n[r++]=1073741823&u}return o},i=30):"Netscape"!=n.appName?(l.prototype.am=function(e,t,n,r,o,s){for(;--s>=0;){var i=t*this[e++]+n[r]+o;o=Math.floor(i/67108864),n[r++]=67108863&i}return o},i=26):(l.prototype.am=function(e,t,n,r,o,s){for(var i=16383&t,a=t>>14;--s>=0;){var u=16383&this[e],c=this[e++]>>14,d=a*u+c*i;o=((u=i*u+((16383&d)<<14)+n[r]+o)>>28)+(d>>14)+a*c,n[r++]=268435455&u}return o},i=28),l.prototype.DB=i,l.prototype.DM=(1<<i)-1,l.prototype.DV=1<<i,l.prototype.FV=Math.pow(2,52),l.prototype.F1=52-i,l.prototype.F2=2*i-52;var f,m,p=new Array;for(f="0".charCodeAt(0),m=0;m<=9;++m)p[f++]=m;for(f="a".charCodeAt(0),m=10;m<36;++m)p[f++]=m;for(f="A".charCodeAt(0),m=10;m<36;++m)p[f++]=m;function g(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function b(e,t){var n=p[e.charCodeAt(t)];return null==n?-1:n}function v(e){var t=h();return t.fromInt(e),t}function y(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function _(e){this.m=e}function w(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function k(e,t){return e&t}function S(e,t){return e|t}function j(e,t){return e^t}function C(e,t){return e&~t}function x(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function O(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function E(){}function I(e){return e}function A(e){this.r2=h(),this.q3=h(),l.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}_.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},_.prototype.revert=function(e){return e},_.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},_.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},_.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},w.prototype.convert=function(e){var t=h();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(l.ZERO)>0&&this.m.subTo(t,t),t},w.prototype.revert=function(e){var t=h();return e.copyTo(t),this.reduce(t),t},w.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e[t],r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[n=t+this.m.t]+=this.m.am(0,r,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},w.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},w.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},l.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},l.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},l.prototype.fromString=function(e,t){var n;if(16==t)n=4;else if(8==t)n=3;else if(256==t)n=8;else if(2==t)n=1;else if(32==t)n=5;else{if(4!=t)return void this.fromRadix(e,t);n=2}this.t=0,this.s=0;for(var r=e.length,o=!1,s=0;--r>=0;){var i=8==n?255&e[r]:b(e,r);i<0?"-"==e.charAt(r)&&(o=!0):(o=!1,0==s?this[this.t++]=i:s+n>this.DB?(this[this.t-1]|=(i&(1<<this.DB-s)-1)<<s,this[this.t++]=i>>this.DB-s):this[this.t-1]|=i<<s,(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&e[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&l.ZERO.subTo(this,this)},l.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},l.prototype.dlShiftTo=function(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s},l.prototype.drShiftTo=function(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s},l.prototype.lShiftTo=function(e,t){var n,r=e%this.DB,o=this.DB-r,s=(1<<o)-1,i=Math.floor(e/this.DB),a=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)t[n+i+1]=this[n]>>o|a,a=(this[n]&s)<<r;for(n=i-1;n>=0;--n)t[n]=0;t[i]=a,t.t=this.t+i+1,t.s=this.s,t.clamp()},l.prototype.rShiftTo=function(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)t.t=0;else{var r=e%this.DB,o=this.DB-r,s=(1<<r)-1;t[0]=this[n]>>r;for(var i=n+1;i<this.t;++i)t[i-n-1]|=(this[i]&s)<<o,t[i-n]=this[i]>>r;r>0&&(t[this.t-n-1]|=(this.s&s)<<o),t.t=this.t-n,t.clamp()}},l.prototype.subTo=function(e,t){for(var n=0,r=0,o=Math.min(e.t,this.t);n<o;)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()},l.prototype.multiplyTo=function(e,t){var n=this.abs(),r=e.abs(),o=n.t;for(t.t=o+r.t;--o>=0;)t[o]=0;for(o=0;o<r.t;++o)t[o+n.t]=n.am(0,r[o],t,o,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&l.ZERO.subTo(t,t)},l.prototype.squareTo=function(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()},l.prototype.divRemTo=function(e,t,n){var r=e.abs();if(!(r.t<=0)){var o=this.abs();if(o.t<r.t)return null!=t&&t.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=h());var s=h(),i=this.s,a=e.s,u=this.DB-y(r[r.t-1]);u>0?(r.lShiftTo(u,s),o.lShiftTo(u,n)):(r.copyTo(s),o.copyTo(n));var c=s.t,d=s[c-1];if(0!=d){var f=d*(1<<this.F1)+(c>1?s[c-2]>>this.F2:0),m=this.FV/f,p=(1<<this.F1)/f,g=1<<this.F2,b=n.t,v=b-c,_=null==t?h():t;for(s.dlShiftTo(v,_),n.compareTo(_)>=0&&(n[n.t++]=1,n.subTo(_,n)),l.ONE.dlShiftTo(c,_),_.subTo(s,s);s.t<c;)s[s.t++]=0;for(;--v>=0;){var w=n[--b]==d?this.DM:Math.floor(n[b]*m+(n[b-1]+g)*p);if((n[b]+=s.am(0,w,n,v,0,c))<w)for(s.dlShiftTo(v,_),n.subTo(_,n);n[b]<--w;)n.subTo(_,n)}null!=t&&(n.drShiftTo(c,t),i!=a&&l.ZERO.subTo(t,t)),n.t=c,n.clamp(),u>0&&n.rShiftTo(u,n),i<0&&l.ZERO.subTo(n,n)}}},l.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},l.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},l.prototype.exp=function(e,t){if(e>4294967295||e<1)return l.ONE;var n=h(),r=h(),o=t.convert(this),s=y(e)-1;for(o.copyTo(n);--s>=0;)if(t.sqrTo(n,r),(e&1<<s)>0)t.mulTo(r,o,n);else{var i=n;n=r,r=i}return t.revert(n)},l.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,r=(1<<t)-1,o=!1,s="",i=this.t,a=this.DB-i*this.DB%t;if(i-- >0)for(a<this.DB&&(n=this[i]>>a)>0&&(o=!0,s=g(n));i>=0;)a<t?(n=(this[i]&(1<<a)-1)<<t-a,n|=this[--i]>>(a+=this.DB-t)):(n=this[i]>>(a-=t)&r,a<=0&&(a+=this.DB,--i)),n>0&&(o=!0),o&&(s+=g(n));return o?s:"0"},l.prototype.negate=function(){var e=h();return l.ZERO.subTo(this,e),e},l.prototype.abs=function(){return this.s<0?this.negate():this},l.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(0!=(t=n-e.t))return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0},l.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+y(this[this.t-1]^this.s&this.DM)},l.prototype.mod=function(e){var t=h();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(l.ZERO)>0&&e.subTo(t,t),t},l.prototype.modPowInt=function(e,t){var n;return n=e<256||t.isEven()?new _(t):new w(t),this.exp(e,n)},l.ZERO=v(0),l.ONE=v(1),E.prototype.convert=I,E.prototype.revert=I,E.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n)},E.prototype.sqrTo=function(e,t){e.squareTo(t)},A.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=h();return e.copyTo(t),this.reduce(t),t},A.prototype.revert=function(e){return e},A.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},A.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},A.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var N,T,F,P=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],R=(1<<26)/P[P.length-1];function D(){this.i=0,this.j=0,this.S=new Array}function M(){var e;e=(new Date).getTime(),T[F++]^=255&e,T[F++]^=e>>8&255,T[F++]^=e>>16&255,T[F++]^=e>>24&255,F>=256&&(F-=256)}if(l.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},l.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),r=v(n),o=h(),s=h(),i="";for(this.divRemTo(r,o,s);o.signum()>0;)i=(n+s.intValue()).toString(e).substr(1)+i,o.divRemTo(r,o,s);return s.intValue().toString(e)+i},l.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var n=this.chunkSize(t),r=Math.pow(t,n),o=!1,s=0,i=0,a=0;a<e.length;++a){var u=b(e,a);u<0?"-"==e.charAt(a)&&0==this.signum()&&(o=!0):(i=t*i+u,++s>=n&&(this.dMultiply(r),this.dAddOffset(i,0),s=0,i=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(i,0)),o&&l.ZERO.subTo(this,this)},l.prototype.fromNumber=function(e,t,n){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(l.ONE.shiftLeft(e-1),S,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(l.ONE.shiftLeft(e-1),this);else{var r=new Array,o=7&e;r.length=1+(e>>3),t.nextBytes(r),o>0?r[0]&=(1<<o)-1:r[0]=0,this.fromString(r,256)}},l.prototype.bitwiseTo=function(e,t,n){var r,o,s=Math.min(e.t,this.t);for(r=0;r<s;++r)n[r]=t(this[r],e[r]);if(e.t<this.t){for(o=e.s&this.DM,r=s;r<this.t;++r)n[r]=t(this[r],o);n.t=this.t}else{for(o=this.s&this.DM,r=s;r<e.t;++r)n[r]=t(o,e[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()},l.prototype.changeBit=function(e,t){var n=l.ONE.shiftLeft(e);return this.bitwiseTo(n,t,n),n},l.prototype.addTo=function(e,t){for(var n=0,r=0,o=Math.min(e.t,this.t);n<o;)r+=this[n]+e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e[n],t[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[n++]=r:r<-1&&(t[n++]=this.DV+r),t.t=n,t.clamp()},l.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},l.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},l.prototype.multiplyLowerTo=function(e,t,n){var r,o=Math.min(this.t+e.t,t);for(n.s=0,n.t=o;o>0;)n[--o]=0;for(r=n.t-this.t;o<r;++o)n[o+this.t]=this.am(0,e[o],n,o,0,this.t);for(r=Math.min(e.t,t);o<r;++o)this.am(0,e[o],n,o,0,t-o);n.clamp()},l.prototype.multiplyUpperTo=function(e,t,n){--t;var r=n.t=this.t+e.t-t;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n[this.t+r-t]=this.am(t-r,e[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)},l.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(0==t)n=this[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this[r])%e;return n},l.prototype.millerRabin=function(e){var t=this.subtract(l.ONE),n=t.getLowestSetBit();if(n<=0)return!1;var r=t.shiftRight(n);(e=e+1>>1)>P.length&&(e=P.length);for(var o=h(),s=0;s<e;++s){o.fromInt(P[Math.floor(Math.random()*P.length)]);var i=o.modPow(r,this);if(0!=i.compareTo(l.ONE)&&0!=i.compareTo(t)){for(var a=1;a++<n&&0!=i.compareTo(t);)if(0==(i=i.modPowInt(2,this)).compareTo(l.ONE))return!1;if(0!=i.compareTo(t))return!1}}return!0},l.prototype.clone=function(){var e=h();return this.copyTo(e),e},l.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},l.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},l.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},l.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},l.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var n,r=this.DB-e*this.DB%8,o=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[o++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),0!=(128&n)&&(n|=-256),0==o&&(128&this.s)!=(128&n)&&++o,(o>0||n!=this.s)&&(t[o++]=n);return t},l.prototype.equals=function(e){return 0==this.compareTo(e)},l.prototype.min=function(e){return this.compareTo(e)<0?this:e},l.prototype.max=function(e){return this.compareTo(e)>0?this:e},l.prototype.and=function(e){var t=h();return this.bitwiseTo(e,k,t),t},l.prototype.or=function(e){var t=h();return this.bitwiseTo(e,S,t),t},l.prototype.xor=function(e){var t=h();return this.bitwiseTo(e,j,t),t},l.prototype.andNot=function(e){var t=h();return this.bitwiseTo(e,C,t),t},l.prototype.not=function(){for(var e=h(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},l.prototype.shiftLeft=function(e){var t=h();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},l.prototype.shiftRight=function(e){var t=h();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},l.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+x(this[e]);return this.s<0?this.t*this.DB:-1},l.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=O(this[n]^t);return e},l.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},l.prototype.setBit=function(e){return this.changeBit(e,S)},l.prototype.clearBit=function(e){return this.changeBit(e,C)},l.prototype.flipBit=function(e){return this.changeBit(e,j)},l.prototype.add=function(e){var t=h();return this.addTo(e,t),t},l.prototype.subtract=function(e){var t=h();return this.subTo(e,t),t},l.prototype.multiply=function(e){var t=h();return this.multiplyTo(e,t),t},l.prototype.divide=function(e){var t=h();return this.divRemTo(e,t,null),t},l.prototype.remainder=function(e){var t=h();return this.divRemTo(e,null,t),t},l.prototype.divideAndRemainder=function(e){var t=h(),n=h();return this.divRemTo(e,t,n),new Array(t,n)},l.prototype.modPow=function(e,t){var n,r,o=e.bitLength(),s=v(1);if(o<=0)return s;n=o<18?1:o<48?3:o<144?4:o<768?5:6,r=o<8?new _(t):t.isEven()?new A(t):new w(t);var i=new Array,a=3,u=n-1,c=(1<<n)-1;if(i[1]=r.convert(this),n>1){var d=h();for(r.sqrTo(i[1],d);a<=c;)i[a]=h(),r.mulTo(d,i[a-2],i[a]),a+=2}var l,f,m=e.t-1,p=!0,g=h();for(o=y(e[m])-1;m>=0;){for(o>=u?l=e[m]>>o-u&c:(l=(e[m]&(1<<o+1)-1)<<u-o,m>0&&(l|=e[m-1]>>this.DB+o-u)),a=n;0==(1&l);)l>>=1,--a;if((o-=a)<0&&(o+=this.DB,--m),p)i[l].copyTo(s),p=!1;else{for(;a>1;)r.sqrTo(s,g),r.sqrTo(g,s),a-=2;a>0?r.sqrTo(s,g):(f=s,s=g,g=f),r.mulTo(g,i[l],s)}for(;m>=0&&0==(e[m]&1<<o);)r.sqrTo(s,g),f=s,s=g,g=f,--o<0&&(o=this.DB-1,--m)}return r.revert(s)},l.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return l.ZERO;for(var n=e.clone(),r=this.clone(),o=v(1),s=v(0),i=v(0),a=v(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),t?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(e,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&a.isEven()||(i.addTo(this,i),a.subTo(e,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);n.compareTo(r)>=0?(n.subTo(r,n),t&&o.subTo(i,o),s.subTo(a,s)):(r.subTo(n,r),t&&i.subTo(o,i),a.subTo(s,a))}return 0!=r.compareTo(l.ONE)?l.ZERO:a.compareTo(e)>=0?a.subtract(e):a.signum()<0?(a.addTo(e,a),a.signum()<0?a.add(e):a):a},l.prototype.pow=function(e){return this.exp(e,new E)},l.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n,n=r}var o=t.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return t;for(o<s&&(s=o),s>0&&(t.rShiftTo(s,t),n.rShiftTo(s,n));t.signum()>0;)(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),(o=n.getLowestSetBit())>0&&n.rShiftTo(o,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n},l.prototype.isProbablePrime=function(e){var t,n=this.abs();if(1==n.t&&n[0]<=P[P.length-1]){for(t=0;t<P.length;++t)if(n[0]==P[t])return!0;return!1}if(n.isEven())return!1;for(t=1;t<P.length;){for(var r=P[t],o=t+1;o<P.length&&r<R;)r*=P[o++];for(r=n.modInt(r);t<o;)if(r%P[t++]==0)return!1}return n.millerRabin(e)},l.prototype.square=function(){var e=h();return this.squareTo(e),e},D.prototype.init=function(e){var t,n,r;for(t=0;t<256;++t)this.S[t]=t;for(n=0,t=0;t<256;++t)n=n+this.S[t]+e[t%e.length]&255,r=this.S[t],this.S[t]=this.S[n],this.S[n]=r;this.i=0,this.j=0},D.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]},null==T){var L;if(T=new Array,F=0,void 0!==r&&(void 0!==r.crypto||void 0!==r.msCrypto)){var B=r.crypto||r.msCrypto;if(B.getRandomValues){var q=new Uint8Array(32);for(B.getRandomValues(q),L=0;L<32;++L)T[F++]=q[L]}else if("Netscape"==n.appName&&n.appVersion<"5"){var z=r.crypto.random(32);for(L=0;L<z.length;++L)T[F++]=255&z.charCodeAt(L)}}for(;F<256;)L=Math.floor(65536*Math.random()),T[F++]=L>>>8,T[F++]=255&L;F=0,M()}function H(){if(null==N){for(M(),(N=new D).init(T),F=0;F<T.length;++F)T[F]=0;F=0}return N.next()}function U(){}function V(e,t){return new l(e,t)}function $(e,t,n){for(var r="",o=0;r.length<t;)r+=n(String.fromCharCode.apply(String,e.concat([(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o]))),o+=1;return r}function W(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function K(e,t,n){for(var r="",o=0;r.length<t;)r+=n(e+String.fromCharCode.apply(String,[(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o])),o+=1;return r}function G(e,t){this.x=t,this.q=e}function J(e,t,n,r){this.curve=e,this.x=t,this.y=n,this.z=null==r?l.ONE:r,this.zinv=null}function Z(e,t,n){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(n),this.infinity=new J(this,null,null)}U.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=H()},W.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},W.prototype.setPublic=function(e,t){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof e)this.n=e,this.e=t;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA public key";this.n=V(e,16),this.e=parseInt(t,16)}},W.prototype.encrypt=function(e){var t=function(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var n=new Array,r=e.length-1;r>=0&&t>0;){var o=e.charCodeAt(r--);o<128?n[--t]=o:o>127&&o<2048?(n[--t]=63&o|128,n[--t]=o>>6|192):(n[--t]=63&o|128,n[--t]=o>>6&63|128,n[--t]=o>>12|224)}n[--t]=0;for(var s=new U,i=new Array;t>2;){for(i[0]=0;0==i[0];)s.nextBytes(i);n[--t]=i[0]}return n[--t]=2,n[--t]=0,new l(n)}(e,this.n.bitLength()+7>>3);if(null==t)return null;var n=this.doPublic(t);if(null==n)return null;var r=n.toString(16);return 0==(1&r.length)?r:"0"+r},W.prototype.encryptOAEP=function(e,t,n){var r=function(e,t,n,r){var o=Y.crypto.MessageDigest,s=Y.crypto.Util,i=null;if(n||(n="sha1"),"string"==typeof n&&(i=o.getCanonicalAlgName(n),r=o.getHashLength(i),n=function(e){return he(s.hashHex(fe(e),i))}),e.length+2*r+2>t)throw"Message too long for RSA";var a,u="";for(a=0;a<t-e.length-2*r-2;a+=1)u+="\0";var c=n("")+u+""+e,d=new Array(r);(new U).nextBytes(d);var h=$(d,c.length,n),f=[];for(a=0;a<c.length;a+=1)f[a]=c.charCodeAt(a)^h.charCodeAt(a);var m=$(f,d.length,n),p=[0];for(a=0;a<d.length;a+=1)p[a+1]=d[a]^m.charCodeAt(a);return new l(p.concat(f))}(e,this.n.bitLength()+7>>3,t,n);if(null==r)return null;var o=this.doPublic(r);if(null==o)return null;var s=o.toString(16);return 0==(1&s.length)?s:"0"+s},W.prototype.type="RSA",W.prototype.doPrivate=function(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),n=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(n)<0;)t=t.add(this.p);return t.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},W.prototype.setPrivate=function(e,t,n){if(this.isPrivate=!0,"string"!=typeof e)this.n=e,this.e=t,this.d=n;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA private key";this.n=V(e,16),this.e=parseInt(t,16),this.d=V(n,16)}},W.prototype.setPrivateEx=function(e,t,n,r,o,s,i,a){if(this.isPrivate=!0,this.isPublic=!1,null==e)throw"RSASetPrivateEx N == null";if(null==t)throw"RSASetPrivateEx E == null";if(0==e.length)throw"RSASetPrivateEx N.length == 0";if(0==t.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=V(e,16),this.e=parseInt(t,16),this.d=V(n,16),this.p=V(r,16),this.q=V(o,16),this.dmp1=V(s,16),this.dmq1=V(i,16),this.coeff=V(a,16)},W.prototype.generate=function(e,t){var n=new U,r=e>>1;this.e=parseInt(t,16);for(var o=new l(t,16);;){for(;this.p=new l(e-r,1,n),0!=this.p.subtract(l.ONE).gcd(o).compareTo(l.ONE)||!this.p.isProbablePrime(10););for(;this.q=new l(r,1,n),0!=this.q.subtract(l.ONE).gcd(o).compareTo(l.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var i=this.p.subtract(l.ONE),a=this.q.subtract(l.ONE),u=i.multiply(a);if(0==u.gcd(o).compareTo(l.ONE)&&(this.n=this.p.multiply(this.q),this.n.bitLength()==e)){this.d=o.modInverse(u),this.dmp1=this.d.mod(i),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0},W.prototype.decrypt=function(e){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var t=V(e,16),n=this.doPrivate(t);return null==n?null:function(e,t){for(var n=e.toByteArray(),r=0;r<n.length&&0==n[r];)++r;if(n.length-r!=t-1||2!=n[r])return null;for(++r;0!=n[r];)if(++r>=n.length)return null;for(var o="";++r<n.length;){var s=255&n[r];s<128?o+=String.fromCharCode(s):s>191&&s<224?(o+=String.fromCharCode((31&s)<<6|63&n[r+1]),++r):(o+=String.fromCharCode((15&s)<<12|(63&n[r+1])<<6|63&n[r+2]),r+=2)}return o}(n,this.n.bitLength()+7>>3)},W.prototype.decryptOAEP=function(e,t,n){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var r=V(e,16),o=this.doPrivate(r);return null==o?null:function(e,t,n,r){var o=Y.crypto.MessageDigest,s=Y.crypto.Util,i=null;for(n||(n="sha1"),"string"==typeof n&&(i=o.getCanonicalAlgName(n),r=o.getHashLength(i),n=function(e){return he(s.hashHex(fe(e),i))}),e=e.toByteArray(),a=0;a<e.length;a+=1)e[a]&=255;for(;e.length<t;)e.unshift(0);if((e=String.fromCharCode.apply(String,e)).length<2*r+2)throw"Cipher too short";var a,u=e.substr(1,r),c=e.substr(r+1),d=K(c,r,n),l=[];for(a=0;a<u.length;a+=1)l[a]=u.charCodeAt(a)^d.charCodeAt(a);var h=K(String.fromCharCode.apply(String,l),e.length-r,n),f=[];for(a=0;a<c.length;a+=1)f[a]=c.charCodeAt(a)^h.charCodeAt(a);if((f=String.fromCharCode.apply(String,f)).substr(0,r)!==n(""))throw"Hash mismatch";var m=(f=f.substr(r)).indexOf("");if((-1!=m?f.substr(0,m).lastIndexOf("\0"):-1)+1!=m)throw"Malformed data";return f.substr(m+1)}(o,this.n.bitLength()+7>>3,t,n)},G.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)},G.prototype.toBigInteger=function(){return this.x},G.prototype.negate=function(){return new G(this.q,this.x.negate().mod(this.q))},G.prototype.add=function(e){return new G(this.q,this.x.add(e.toBigInteger()).mod(this.q))},G.prototype.subtract=function(e){return new G(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},G.prototype.multiply=function(e){return new G(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},G.prototype.square=function(){return new G(this.q,this.x.square().mod(this.q))},G.prototype.divide=function(e){return new G(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},J.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},J.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},J.prototype.equals=function(e){return e==this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(l.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(l.ZERO))},J.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(l.ZERO)&&!this.y.toBigInteger().equals(l.ZERO)},J.prototype.negate=function(){return new J(this.curve,this.x,this.y.negate(),this.z)},J.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),n=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(l.ZERO.equals(n))return l.ZERO.equals(t)?this.twice():this.curve.getInfinity();var r=new l("3"),o=this.x.toBigInteger(),s=this.y.toBigInteger(),i=(e.x.toBigInteger(),e.y.toBigInteger(),n.square()),a=i.multiply(n),u=o.multiply(i),c=t.square().multiply(this.z),d=c.subtract(u.shiftLeft(1)).multiply(e.z).subtract(a).multiply(n).mod(this.curve.q),h=u.multiply(r).multiply(t).subtract(s.multiply(a)).subtract(c.multiply(t)).multiply(e.z).add(t.multiply(a)).mod(this.curve.q),f=a.multiply(this.z).multiply(e.z).mod(this.curve.q);return new J(this.curve,this.curve.fromBigInteger(d),this.curve.fromBigInteger(h),f)},J.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new l("3"),t=this.x.toBigInteger(),n=this.y.toBigInteger(),r=n.multiply(this.z),o=r.multiply(n).mod(this.curve.q),s=this.curve.a.toBigInteger(),i=t.square().multiply(e);l.ZERO.equals(s)||(i=i.add(this.z.square().multiply(s)));var a=(i=i.mod(this.curve.q)).square().subtract(t.shiftLeft(3).multiply(o)).shiftLeft(1).multiply(r).mod(this.curve.q),u=i.multiply(e).multiply(t).subtract(o.shiftLeft(1)).shiftLeft(2).multiply(o).subtract(i.square().multiply(i)).mod(this.curve.q),c=r.square().multiply(r).shiftLeft(3).mod(this.curve.q);return new J(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(u),c)},J.prototype.multiply=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,n=e,r=n.multiply(new l("3")),o=this.negate(),s=this,i=this.curve.q.subtract(e),a=i.multiply(new l("3")),u=new J(this.curve,this.x,this.y),c=u.negate();for(t=r.bitLength()-2;t>0;--t){s=s.twice();var d=r.testBit(t);d!=n.testBit(t)&&(s=s.add(d?this:o))}for(t=a.bitLength()-2;t>0;--t){u=u.twice();var h=a.testBit(t);h!=i.testBit(t)&&(u=u.add(h?u:c))}return s},J.prototype.multiplyTwo=function(e,t,n){var r;r=e.bitLength()>n.bitLength()?e.bitLength()-1:n.bitLength()-1;for(var o=this.curve.getInfinity(),s=this.add(t);r>=0;)o=o.twice(),e.testBit(r)?o=n.testBit(r)?o.add(s):o.add(this):n.testBit(r)&&(o=o.add(t)),--r;return o},Z.prototype.getQ=function(){return this.q},Z.prototype.getA=function(){return this.a},Z.prototype.getB=function(){return this.b},Z.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)},Z.prototype.getInfinity=function(){return this.infinity},Z.prototype.fromBigInteger=function(e){return new G(this.q,e)},Z.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var t=(e.length-2)/2,n=e.substr(2,t),r=e.substr(t+2,t);return new J(this,this.fromBigInteger(new l(n,16)),this.fromBigInteger(new l(r,16)));default:return null}},G.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},J.prototype.getEncoded=function(e){var t=function(e,t){var n=e.toByteArrayUnsigned();if(t<n.length)n=n.slice(n.length-t);else for(;t>n.length;)n.unshift(0);return n},n=this.getX().toBigInteger(),r=this.getY().toBigInteger(),o=t(n,32);return e?r.isEven()?o.unshift(2):o.unshift(3):(o.unshift(4),o=o.concat(t(r,32))),o},J.decodeFrom=function(e,t){t[0];var n=t.length-1,r=t.slice(1,1+n/2),o=t.slice(1+n/2,1+n);r.unshift(0),o.unshift(0);var s=new l(r),i=new l(o);return new J(e,e.fromBigInteger(s),e.fromBigInteger(i))},J.decodeFromHex=function(e,t){t.substr(0,2);var n=t.length-2,r=t.substr(2,n/2),o=t.substr(2+n/2,n/2),s=new l(r,16),i=new l(o,16);return new J(e,e.fromBigInteger(s),e.fromBigInteger(i))},J.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),n=e.y.subtract(this.y).divide(t),r=n.square().subtract(this.x).subtract(e.x),o=n.multiply(this.x.subtract(r)).subtract(this.y);return new J(this.curve,r,o)},J.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(l.valueOf(2)),t=this.curve.fromBigInteger(l.valueOf(3)),n=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),r=n.square().subtract(this.x.multiply(e)),o=n.multiply(this.x.subtract(r)).subtract(this.y);return new J(this.curve,r,o)},J.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,n=e,r=n.multiply(new l("3")),o=this.negate(),s=this;for(t=r.bitLength()-2;t>0;--t){s=s.twice();var i=r.testBit(t);i!=n.testBit(t)&&(s=s.add2D(i?this:o))}return s},J.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),n=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),o=this.curve.getQ(),s=t.multiply(t).mod(o),i=e.multiply(e).multiply(e).add(n.multiply(e)).add(r).mod(o);return s.equals(i)},J.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},J.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),n=this.getY().toBigInteger();if(t.compareTo(l.ONE)<0||t.compareTo(e.subtract(l.ONE))>0)throw new Error("x coordinate out of bounds");if(n.compareTo(l.ONE)<0||n.compareTo(e.subtract(l.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var X=function(){var e=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),t=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function r(e,t,r){return t?n[t]:String.fromCharCode(parseInt(r,16))}var o=new String(""),s=Object.hasOwnProperty;return function(n,i){var a,u,c=n.match(e),d=c[0],l=!1;"{"===d?a={}:"["===d?a=[]:(a=[],l=!0);for(var h=[a],f=1-l,m=c.length;f<m;++f){var p;switch((d=c[f]).charCodeAt(0)){default:(p=h[0])[u||p.length]=+d,u=void 0;break;case 34:if(-1!==(d=d.substring(1,d.length-1)).indexOf("\\")&&(d=d.replace(t,r)),p=h[0],!u){if(!(p instanceof Array)){u=d||o;break}u=p.length}p[u]=d,u=void 0;break;case 91:p=h[0],h.unshift(p[u||p.length]=[]),u=void 0;break;case 93:h.shift();break;case 102:(p=h[0])[u||p.length]=!1,u=void 0;break;case 110:(p=h[0])[u||p.length]=null,u=void 0;break;case 116:(p=h[0])[u||p.length]=!0,u=void 0;break;case 123:p=h[0],h.unshift(p[u||p.length]={}),u=void 0;break;case 125:h.shift()}}if(l){if(1!==h.length)throw new Error;a=a[0]}else if(h.length)throw new Error;if(i){var g=function(e,t){var n=e[t];if(n&&"object"==typeof n){var r=null;for(var o in n)if(s.call(n,o)&&n!==e){var a=g(n,o);void 0!==a?n[o]=a:(r||(r=[]),r.push(o))}if(r)for(var u=r.length;--u>=0;)delete n[r[u]]}return i.call(e,t,n)};a=g({"":a},"")}return a}}();void 0!==Y&&Y||(Y={}),void 0!==Y.asn1&&Y.asn1||(Y.asn1={}),Y.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1))t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var n=t.substr(1).length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var r="",o=0;o<n;o++)r+="f";t=new l(r,16).xor(e).add(l.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){return be(e,t)},this.newObject=function(e){var t=Y.asn1,n=t.ASN1Object,r=t.DERBoolean,o=t.DERInteger,s=t.DERBitString,i=t.DEROctetString,a=t.DERNull,u=t.DERObjectIdentifier,c=t.DEREnumerated,d=t.DERUTF8String,l=t.DERNumericString,h=t.DERPrintableString,f=t.DERTeletexString,m=t.DERIA5String,p=t.DERUTCTime,g=t.DERGeneralizedTime,b=t.DERVisibleString,v=t.DERBMPString,y=t.DERSequence,_=t.DERSet,w=t.DERTaggedObject,k=t.ASN1Util.newObject;if(e instanceof t.ASN1Object)return e;var S=Object.keys(e);if(1!=S.length)throw new Error("key of param shall be only one.");var j=S[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+j+":"))throw new Error("undefined key: "+j);if("bool"==j)return new r(e[j]);if("int"==j)return new o(e[j]);if("bitstr"==j)return new s(e[j]);if("octstr"==j)return new i(e[j]);if("null"==j)return new a(e[j]);if("oid"==j)return new u(e[j]);if("enum"==j)return new c(e[j]);if("utf8str"==j)return new d(e[j]);if("numstr"==j)return new l(e[j]);if("prnstr"==j)return new h(e[j]);if("telstr"==j)return new f(e[j]);if("ia5str"==j)return new m(e[j]);if("utctime"==j)return new p(e[j]);if("gentime"==j)return new g(e[j]);if("visstr"==j)return new b(e[j]);if("bmpstr"==j)return new v(e[j]);if("asn1"==j)return new n(e[j]);if("seq"==j){for(var C=e[j],x=[],O=0;O<C.length;O++){var E=k(C[O]);x.push(E)}return new y({array:x})}if("set"==j){for(C=e[j],x=[],O=0;O<C.length;O++)E=k(C[O]),x.push(E);return new _({array:x})}if("tag"==j){var I=e[j];if("[object Array]"===Object.prototype.toString.call(I)&&3==I.length){var A=k(I[2]);return new w({tag:I[0],explicit:I[1],obj:A})}return new w(I)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},Y.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",n=parseInt(e.substr(0,2),16),r=(t=Math.floor(n/40)+"."+n%40,""),o=2;o<e.length;o+=2){var s=("00000000"+parseInt(e.substr(o,2),16).toString(2)).slice(-8);r+=s.substr(1,7),"0"==s.substr(0,1)&&(t=t+"."+new l(r,2).toString(10),r="")}return t},Y.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},n=function(e){var n="",r=new l(e,10).toString(2),o=7-r.length%7;7==o&&(o=0);for(var s="",i=0;i<o;i++)s+="0";for(r=s+r,i=0;i<r.length-1;i+=7){var a=r.substr(i,7);i!=r.length-7&&(a="1"+a),n+=t(parseInt(a,2))}return n};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var r="",o=e.split("."),s=40*parseInt(o[0])+parseInt(o[1]);r+=t(s),o.splice(0,2);for(var i=0;i<o.length;i++)r+=n(o[i]);return r},Y.asn1.ASN1Object=function(e){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+"".length+",v="+this.hV);var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var n=t.length/2;if(n>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+n).toString(16)+t},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(e){this.params=e},null!=e&&null!=e.tlv&&(this.hTLV=e.tlv,this.isModified=!1)},Y.asn1.DERAbstractString=function(e){Y.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=de(this.s).toLowerCase()},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},o.lang.extend(Y.asn1.DERAbstractString,Y.asn1.ASN1Object),Y.asn1.DERAbstractTime=function(e){Y.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){var t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t)},this.formatDate=function(e,t,n){var r=this.zeroPadding,o=this.localDateToUTC(e),s=String(o.getFullYear());"utc"==t&&(s=s.substr(2,2));var i=s+r(String(o.getMonth()+1),2)+r(String(o.getDate()),2)+r(String(o.getHours()),2)+r(String(o.getMinutes()),2)+r(String(o.getSeconds()),2);if(!0===n){var a=o.getMilliseconds();if(0!=a){var u=r(String(a),3);i=i+"."+(u=u.replace(/[0]+$/,""))}}return i+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=se(e)},this.setByDateValue=function(e,t,n,r,o,s){var i=new Date(Date.UTC(e,t-1,n,r,o,s,0));this.setByDate(i)},this.getFreshValueHex=function(){return this.hV}},o.lang.extend(Y.asn1.DERAbstractTime,Y.asn1.ASN1Object),Y.asn1.DERAbstractStructured=function(e){Y.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},o.lang.extend(Y.asn1.DERAbstractStructured,Y.asn1.ASN1Object),Y.asn1.DERBoolean=function(e){Y.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==e?"010100":"0101ff"},o.lang.extend(Y.asn1.DERBoolean,Y.asn1.ASN1Object),Y.asn1.DERInteger=function(e){Y.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=Y.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new l(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.bigint?this.setByBigInteger(e.bigint):void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},o.lang.extend(Y.asn1.DERInteger,Y.asn1.ASN1Object),Y.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=Y.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.getEncodedHex()}Y.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var n="0"+e;this.hTLV=null,this.isModified=!0,this.hV=n+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0);for(var n=0;n<=t;n++)e+="0";var r="";for(n=0;n<e.length-1;n+=8){var o=e.substr(n,8),s=parseInt(o,2).toString(16);1==s.length&&(s="0"+s),r+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+t+r},this.setByBooleanArray=function(e){for(var t="",n=0;n<e.length;n++)1==e[n]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},o.lang.extend(Y.asn1.DERBitString,Y.asn1.ASN1Object),Y.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=Y.asn1.ASN1Util.newObject(e.obj);e.hex=t.getEncodedHex()}Y.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},o.lang.extend(Y.asn1.DEROctetString,Y.asn1.DERAbstractString),Y.asn1.DERNull=function(){Y.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},o.lang.extend(Y.asn1.DERNull,Y.asn1.ASN1Object),Y.asn1.DERObjectIdentifier=function(e){Y.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){var t=Ae(e);if(null==t)throw new Error("malformed oid string: "+e);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){var t=Y.asn1.x509.OID.name2oid(e);if(""===t)throw new Error("DERObjectIdentifier oidName undefined: "+e);this.setValueOidString(t)},this.setValueNameOrOid=function(e){e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){"string"==typeof e?this.setValueNameOrOid(e):void 0!==e.oid?this.setValueNameOrOid(e.oid):void 0!==e.name?this.setValueNameOrOid(e.name):void 0!==e.hex&&this.setValueHex(e.hex)},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.DERObjectIdentifier,Y.asn1.ASN1Object),Y.asn1.DEREnumerated=function(e){Y.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=Y.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new l(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},o.lang.extend(Y.asn1.DEREnumerated,Y.asn1.ASN1Object),Y.asn1.DERUTF8String=function(e){Y.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},o.lang.extend(Y.asn1.DERUTF8String,Y.asn1.DERAbstractString),Y.asn1.DERNumericString=function(e){Y.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},o.lang.extend(Y.asn1.DERNumericString,Y.asn1.DERAbstractString),Y.asn1.DERPrintableString=function(e){Y.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},o.lang.extend(Y.asn1.DERPrintableString,Y.asn1.DERAbstractString),Y.asn1.DERTeletexString=function(e){Y.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},o.lang.extend(Y.asn1.DERTeletexString,Y.asn1.DERAbstractString),Y.asn1.DERIA5String=function(e){Y.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},o.lang.extend(Y.asn1.DERIA5String,Y.asn1.DERAbstractString),Y.asn1.DERVisibleString=function(e){Y.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"},o.lang.extend(Y.asn1.DERVisibleString,Y.asn1.DERAbstractString),Y.asn1.DERBMPString=function(e){Y.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"},o.lang.extend(Y.asn1.DERBMPString,Y.asn1.DERAbstractString),Y.asn1.DERUTCTime=function(e){Y.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=se(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=se(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date))},o.lang.extend(Y.asn1.DERUTCTime,Y.asn1.DERAbstractTime),Y.asn1.DERGeneralizedTime=function(e){Y.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=se(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=se(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date),!0===e.millis&&(this.withMillis=!0))},o.lang.extend(Y.asn1.DERGeneralizedTime,Y.asn1.DERAbstractTime),Y.asn1.DERSequence=function(e){Y.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++)e+=this.asn1Array[t].getEncodedHex();return this.hV=e,this.hV}},o.lang.extend(Y.asn1.DERSequence,Y.asn1.DERAbstractStructured),Y.asn1.DERSet=function(e){Y.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var n=this.asn1Array[t];e.push(n.getEncodedHex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},o.lang.extend(Y.asn1.DERSet,Y.asn1.DERAbstractStructured),Y.asn1.DERTaggedObject=function(e){Y.asn1.DERTaggedObject.superclass.constructor.call(this);var t=Y.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,n){this.hT=t,this.isExplicit=e,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){null!=e.tag&&(this.hT=e.tag),null!=e.explicit&&(this.isExplicit=e.explicit),null!=e.tage&&(this.hT=e.tage,this.isExplicit=!0),null!=e.tagi&&(this.hT=e.tagi,this.isExplicit=!1),null!=e.obj&&(e.obj instanceof t.ASN1Object?(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):"object"==typeof e.obj&&(this.asn1Object=t.ASN1Util.newObject(e.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.DERTaggedObject,Y.asn1.ASN1Object);var Y,Q,ee,te=new function(){};function ne(e){for(var t=new Array,n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function re(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}function oe(e){for(var t="",n=0;n<e.length;n++){var r=e[n].toString(16);1==r.length&&(r="0"+r),t+=r}return t}function se(e){return oe(ne(e))}function ie(e){return(e=(e=e.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function ae(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),(e=e.replace(/-/g,"+")).replace(/_/g,"/")}function ue(e){return e.length%2==1&&(e="0"+e),ie(u(e))}function ce(e){return c(ae(e))}function de(e){return we(xe(e))}function le(e){return decodeURIComponent(ke(e))}function he(e){for(var t="",n=0;n<e.length-1;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t}function fe(e){for(var t="",n=0;n<e.length;n++)t+=("0"+e.charCodeAt(n).toString(16)).slice(-2);return t}function me(e){return u(e)}function pe(e){var t=me(e).replace(/(.{64})/g,"$1\r\n");return t.replace(/\r\n$/,"")}function ge(e){return c(e.replace(/[^0-9A-Za-z\/+=]*/g,""))}function be(e,t){return"-----BEGIN "+t+"-----\r\n"+pe(e)+"\r\n-----END "+t+"-----\r\n"}function ve(e,t){if(-1==e.indexOf("-----BEGIN "))throw"can't find PEM header: "+t;return ge(e=void 0!==t?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),"")).replace(new RegExp("-----END "+t+"-----[^]*$"),""):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function ye(e){var t,n,r,o,s,i,a,u,c,d,l;if(l=e.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=l[1],t=parseInt(u),2===u.length&&(50<=t&&t<100?t=1900+t:0<=t&&t<50&&(t=2e3+t)),n=parseInt(l[2])-1,r=parseInt(l[3]),o=parseInt(l[4]),s=parseInt(l[5]),i=parseInt(l[6]),a=0,""!==(c=l[7])&&(d=(c.substr(1)+"00").substr(0,3),a=parseInt(d)),Date.UTC(t,n,r,o,s,i,a);throw"unsupported zulu format: "+e}function _e(e){return~~(ye(e)/1e3)}function we(e){return e.replace(/%/g,"")}function ke(e){return e.replace(/(..)/g,"%$1")}function Se(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;var n=(e=e.toLowerCase()).split(":").length-1;if(n<2)throw t;var r=":".repeat(7-n+2),o=(e=e.replace("::",r)).split(":");if(8!=o.length)throw t;for(var s=0;s<8;s++)o[s]=("0000"+o[s]).slice(-4);return o.join("")}function je(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var t=(e=e.toLowerCase()).match(/.{1,4}/g),n=0;n<8;n++)t[n]=t[n].replace(/^0+/,""),""==t[n]&&(t[n]="0");var r=(e=":"+t.join(":")+":").match(/:(0:){2,}/g);if(null===r)return e.slice(1,-1);var o="";for(n=0;n<r.length;n++)r[n].length>o.length&&(o=r[n]);return(e=e.replace(o,"::")).slice(1,-1)}function Ce(e){var t="malformed hex value";if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(8!=e.length)return 32==e.length?je(e):e;try{return parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16)}catch(e){throw t}}function xe(e){for(var t=encodeURIComponent(e),n="",r=0;r<t.length;r++)"%"==t[r]?(n+=t.substr(r,3),r+=2):n=n+"%"+se(t[r]);return n}function Oe(e){return!(e.length%2!=0||!e.match(/^[0-9a-f]+$/)&&!e.match(/^[0-9A-F]+$/))}function Ee(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function Ie(e){e=(e=(e=e.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return e.split(/,/).map((function(e,t,n){var r=parseInt(e);if(r<0||255<r)throw"integer not in range 0-255";return("00"+r.toString(16)).slice(-2)})).join("")}catch(e){throw"malformed integer array string: "+e}}function Ae(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},n=function(e){var n="",r=parseInt(e,10).toString(2),o=7-r.length%7;7==o&&(o=0);for(var s="",i=0;i<o;i++)s+="0";for(r=s+r,i=0;i<r.length-1;i+=7){var a=r.substr(i,7);i!=r.length-7&&(a="1"+a),n+=t(parseInt(a,2))}return n};try{if(!e.match(/^[0-9.]+$/))return null;var r="",o=e.split("."),s=40*parseInt(o[0],10)+parseInt(o[1],10);r+=t(s),o.splice(0,2);for(var i=0;i<o.length;i++)r+=n(o[i]);return r}catch(e){return null}}function Ne(e){if(!Oe(e))return null;try{var t=[],n=e.substr(0,2),r=parseInt(n,16);t[0]=new String(Math.floor(r/40)),t[1]=new String(r%40);for(var o=e.substr(2),s=[],i=0;i<o.length/2;i++)s.push(parseInt(o.substr(2*i,2),16));var a=[],u="";for(i=0;i<s.length;i++)128&s[i]?u+=Te((127&s[i]).toString(2),7):(u+=Te((127&s[i]).toString(2),7),a.push(new String(parseInt(u,2))),u="");var c=t.join(".");return a.length>0&&(c=c+"."+a.join(".")),c}catch(e){return null}}te.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var n=parseInt(e.substr(t+3,1));return 0==n?-1:0<n&&n<10?n+1:-2},te.getL=function(e,t){var n=te.getLblen(e,t);return n<1?"":e.substr(t+2,2*n)},te.getVblen=function(e,t){var n;return""==(n=te.getL(e,t))?-1:("8"===n.substr(0,1)?new l(n.substr(2),16):new l(n,16)).intValue()},te.getVidx=function(e,t){var n=te.getLblen(e,t);return n<0?n:t+2*(n+1)},te.getV=function(e,t){var n=te.getVidx(e,t),r=te.getVblen(e,t);return e.substr(n,2*r)},te.getTLV=function(e,t){return e.substr(t,2)+te.getL(e,t)+te.getV(e,t)},te.getTLVblen=function(e,t){return 2+2*te.getLblen(e,t)+2*te.getVblen(e,t)},te.getNextSiblingIdx=function(e,t){return te.getVidx(e,t)+2*te.getVblen(e,t)},te.getChildIdx=function(e,t){var n,r,o,s=te,i=[];n=s.getVidx(e,t),r=2*s.getVblen(e,t),"03"==e.substr(t,2)&&(n+=2,r-=2),o=0;for(var a=n;o<=r;){var u=s.getTLVblen(e,a);if((o+=u)<=r&&i.push(a),a+=u,o>=r)break}return i},te.getNthChildIdx=function(e,t,n){return te.getChildIdx(e,t)[n]},te.getIdxbyList=function(e,t,n,r){var o,s,i=te;return 0==n.length?void 0!==r&&e.substr(t,2)!==r?-1:t:(o=n.shift())>=(s=i.getChildIdx(e,t)).length?-1:i.getIdxbyList(e,s[o],n,r)},te.getIdxbyListEx=function(e,t,n,r){var o,s,i=te;if(0==n.length)return void 0!==r&&e.substr(t,2)!==r?-1:t;o=n.shift(),s=i.getChildIdx(e,t);for(var a=0,u=0;u<s.length;u++){var c=e.substr(s[u],2);if("number"==typeof o&&!i.isContextTag(c)&&a==o||"string"==typeof o&&i.isContextTag(c,o))return i.getIdxbyListEx(e,s[u],n,r);i.isContextTag(c)||a++}return-1},te.getTLVbyList=function(e,t,n,r){var o=te,s=o.getIdxbyList(e,t,n,r);return-1==s||s>=e.length?null:o.getTLV(e,s)},te.getTLVbyListEx=function(e,t,n,r){var o=te,s=o.getIdxbyListEx(e,t,n,r);return-1==s?null:o.getTLV(e,s)},te.getVbyList=function(e,t,n,r,o){var s,i,a=te;return-1==(s=a.getIdxbyList(e,t,n,r))||s>=e.length?null:(i=a.getV(e,s),!0===o&&(i=i.substr(2)),i)},te.getVbyListEx=function(e,t,n,r,o){var s,i,a=te;return-1==(s=a.getIdxbyListEx(e,t,n,r))?null:(i=a.getV(e,s),"03"==e.substr(s,2)&&!1!==o&&(i=i.substr(2)),i)},te.getInt=function(e,t,n){null==n&&(n=-1);try{var r=e.substr(t,2);if("02"!=r&&"03"!=r)return n;var o=te.getV(e,t);return"02"==r?parseInt(o,16):Fe(o)}catch(e){return n}},te.getOID=function(e,t,n){null==n&&(n=null);try{return"06"!=e.substr(t,2)?n:Ne(te.getV(e,t))}catch(e){return n}},te.getOIDName=function(e,t,n){null==n&&(n=null);try{var r=te.getOID(e,t,n);if(r==n)return n;var o=Y.asn1.x509.OID.oid2name(r);return""==o?r:o}catch(e){return n}},te.getString=function(e,t,n){null==n&&(n=null);try{return he(te.getV(e,t))}catch(e){return n}},te.hextooidstr=function(e){var t=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},n=[],r=e.substr(0,2),o=parseInt(r,16);n[0]=new String(Math.floor(o/40)),n[1]=new String(o%40);for(var s=e.substr(2),i=[],a=0;a<s.length/2;a++)i.push(parseInt(s.substr(2*a,2),16));var u=[],c="";for(a=0;a<i.length;a++)128&i[a]?c+=t((127&i[a]).toString(2),7):(c+=t((127&i[a]).toString(2),7),u.push(new String(parseInt(c,2))),c="");var d=n.join(".");return u.length>0&&(d=d+"."+u.join(".")),d},te.dump=function(e,t,n,r){var o=te,s=o.getV,i=o.dump,a=o.getChildIdx,u=e;e instanceof Y.asn1.ASN1Object&&(u=e.getEncodedHex());var c=function(e,t){return e.length<=2*t?e:e.substr(0,t)+"..(total "+e.length/2+"bytes).."+e.substr(e.length-t,t)};void 0===t&&(t={ommit_long_octet:32}),void 0===n&&(n=0),void 0===r&&(r="");var d,l=t.ommit_long_octet;if("01"==(d=u.substr(n,2)))return"00"==(h=s(u,n))?r+"BOOLEAN FALSE\n":r+"BOOLEAN TRUE\n";if("02"==d)return r+"INTEGER "+c(h=s(u,n),l)+"\n";if("03"==d){var h=s(u,n);return o.isASN1HEX(h.substr(2))?(w=r+"BITSTRING, encapsulates\n")+i(h.substr(2),t,0,r+"  "):r+"BITSTRING "+c(h,l)+"\n"}if("04"==d)return h=s(u,n),o.isASN1HEX(h)?(w=r+"OCTETSTRING, encapsulates\n")+i(h,t,0,r+"  "):r+"OCTETSTRING "+c(h,l)+"\n";if("05"==d)return r+"NULL\n";if("06"==d){var f=s(u,n),m=Y.asn1.ASN1Util.oidHexToInt(f),p=Y.asn1.x509.OID.oid2name(m),g=m.replace(/\./g," ");return""!=p?r+"ObjectIdentifier "+p+" ("+g+")\n":r+"ObjectIdentifier ("+g+")\n"}if("0a"==d)return r+"ENUMERATED "+parseInt(s(u,n))+"\n";if("0c"==d)return r+"UTF8String '"+le(s(u,n))+"'\n";if("13"==d)return r+"PrintableString '"+le(s(u,n))+"'\n";if("14"==d)return r+"TeletexString '"+le(s(u,n))+"'\n";if("16"==d)return r+"IA5String '"+le(s(u,n))+"'\n";if("17"==d)return r+"UTCTime "+le(s(u,n))+"\n";if("18"==d)return r+"GeneralizedTime "+le(s(u,n))+"\n";if("1a"==d)return r+"VisualString '"+le(s(u,n))+"'\n";if("1e"==d)return r+"BMPString '"+le(s(u,n))+"'\n";if("30"==d){if("3000"==u.substr(n,4))return r+"SEQUENCE {}\n";w=r+"SEQUENCE\n";var b=t;if((2==(_=a(u,n)).length||3==_.length)&&"06"==u.substr(_[0],2)&&"04"==u.substr(_[_.length-1],2)){p=o.oidname(s(u,_[0]));var v=JSON.parse(JSON.stringify(t));v.x509ExtName=p,b=v}for(var y=0;y<_.length;y++)w+=i(u,b,_[y],r+"  ");return w}if("31"==d){w=r+"SET\n";var _=a(u,n);for(y=0;y<_.length;y++)w+=i(u,t,_[y],r+"  ");return w}if(0!=(128&(d=parseInt(d,16)))){var w,k=31&d;if(0!=(32&d)){for(w=r+"["+k+"]\n",_=a(u,n),y=0;y<_.length;y++)w+=i(u,t,_[y],r+"  ");return w}return h=s(u,n),te.isASN1HEX(h)?(w=r+"["+k+"]\n")+i(h,t,0,r+"  "):(("68747470"==h.substr(0,8)||"subjectAltName"===t.x509ExtName&&2==k)&&(h=le(h)),r+"["+k+"] "+h+"\n")}return r+"UNKNOWN("+d+") "+s(u,n)+"\n"},te.isContextTag=function(e,t){var n,r;e=e.toLowerCase();try{n=parseInt(e,16)}catch(e){return-1}if(void 0===t)return 128==(192&n);try{return null!=t.match(/^\[[0-9]+\]$/)&&!((r=parseInt(t.substr(1,t.length-1),10))>31)&&128==(192&n)&&(31&n)==r}catch(e){return!1}},te.isASN1HEX=function(e){var t=te;if(e.length%2==1)return!1;var n=t.getVblen(e,0),r=e.substr(0,2),o=t.getL(e,0);return e.length-r.length-o.length==2*n},te.checkStrictDER=function(e,t,n,r,o){var s=te;if(void 0===n){if("string"!=typeof e)throw new Error("not hex string");if(e=e.toLowerCase(),!Y.lang.String.isHex(e))throw new Error("not hex string");n=e.length,o=(r=e.length/2)<128?1:Math.ceil(r.toString(16))+1}if(s.getL(e,t).length>2*o)throw new Error("L of TLV too long: idx="+t);var i=s.getVblen(e,t);if(i>r)throw new Error("value of L too long than hex: idx="+t);var a=s.getTLV(e,t),u=a.length-2-s.getL(e,t).length;if(u!==2*i)throw new Error("V string length and L's value not the same:"+u+"/"+2*i);if(0===t&&e.length!=a.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+a.length);var c=e.substr(t,2);if("02"===c){var d=s.getVidx(e,t);if("00"==e.substr(d,2)&&e.charCodeAt(d+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(c,16)){for(var l=s.getVblen(e,t),h=0,f=s.getChildIdx(e,t),m=0;m<f.length;m++)h+=s.getTLV(e,f[m]).length,s.checkStrictDER(e,f[m],n,r,o);if(2*l!=h)throw new Error("sum of children's TLV length and L unmatch: "+2*l+"!="+h)}},te.oidname=function(e){var t=Y.asn1;Y.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var n=t.x509.OID.oid2name(e);return""===n&&(n=e),n},void 0!==Y&&Y||(Y={}),void 0!==Y.asn1&&Y.asn1||(Y.asn1={}),void 0!==Y.asn1.x509&&Y.asn1.x509||(Y.asn1.x509={}),Y.asn1.x509.Certificate=function(e){Y.asn1.x509.Certificate.superclass.constructor.call(this);var t=Y.asn1,n=t.DERBitString,r=t.DERSequence,o=t.x509,s=o.TBSCertificate,i=o.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(e){this.params=e},this.sign=function(){var e=this.params,t=e.sigalg;null!=e.sigalg.name&&(t=e.sigalg.name);var n=e.tbsobj.getEncodedHex(),r=new Y.crypto.Signature({alg:t});r.init(e.cakey),r.updateHex(n),e.sighex=r.sign()},this.getPEM=function(){return be(this.getEncodedHex(),"CERTIFICATE")},this.getEncodedHex=function(){var e=this.params;if(null!=e.tbsobj&&null!=e.tbsobj||(e.tbsobj=new s(e)),null==e.sighex&&null!=e.cakey&&this.sign(),null==e.sighex)throw new Error("sighex or cakey parameter not defined");var t=[];return t.push(e.tbsobj),t.push(new i({name:e.sigalg})),t.push(new n({hex:"00"+e.sighex})),new r({array:t}).getEncodedHex()},null!=e&&(this.params=e)},o.lang.extend(Y.asn1.x509.Certificate,Y.asn1.ASN1Object),Y.asn1.x509.TBSCertificate=function(e){Y.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=Y.asn1,n=t.x509,r=t.DERTaggedObject,o=t.DERInteger,s=t.DERSequence,i=n.AlgorithmIdentifier,a=n.Time,u=n.X500Name,c=n.Extensions,d=n.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e=[],t=this.params;if(null!=t.version||1!=t.version){var n=2;null!=t.version&&(n=t.version-1);var l=new r({obj:new o({int:n})});e.push(l)}return e.push(new o(t.serial)),e.push(new i({name:t.sigalg})),e.push(new u(t.issuer)),e.push(new s({array:[new a(t.notbefore),new a(t.notafter)]})),e.push(new u(t.subject)),e.push(new d(Pe.getKey(t.sbjpubkey))),void 0!==t.ext&&t.ext.length>0&&e.push(new r({tag:"a3",obj:new c(t.ext)})),new Y.asn1.DERSequence({array:e}).getEncodedHex()},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.x509.TBSCertificate,Y.asn1.ASN1Object),Y.asn1.x509.Extensions=function(e){Y.asn1.x509.Extensions.superclass.constructor.call(this);var t=Y.asn1,n=t.DERSequence,r=t.x509;this.aParam=[],this.setByParam=function(e){this.aParam=e},this.getEncodedHex=function(){for(var e=[],t=0;t<this.aParam.length;t++){var o=this.aParam[t],s=o.extname,i=null;if(null!=o.extn)i=new r.PrivateExtension(o);else if("subjectKeyIdentifier"==s)i=new r.SubjectKeyIdentifier(o);else if("keyUsage"==s)i=new r.KeyUsage(o);else if("subjectAltName"==s)i=new r.SubjectAltName(o);else if("issuerAltName"==s)i=new r.IssuerAltName(o);else if("basicConstraints"==s)i=new r.BasicConstraints(o);else if("cRLDistributionPoints"==s)i=new r.CRLDistributionPoints(o);else if("certificatePolicies"==s)i=new r.CertificatePolicies(o);else if("authorityKeyIdentifier"==s)i=new r.AuthorityKeyIdentifier(o);else if("extKeyUsage"==s)i=new r.ExtKeyUsage(o);else if("authorityInfoAccess"==s)i=new r.AuthorityInfoAccess(o);else if("cRLNumber"==s)i=new r.CRLNumber(o);else if("cRLReason"==s)i=new r.CRLReason(o);else if("ocspNonce"==s)i=new r.OCSPNonce(o);else if("ocspNoCheck"==s)i=new r.OCSPNoCheck(o);else{if("adobeTimeStamp"!=s)throw new Error("extension not supported:"+JSON.stringify(o));i=new r.AdobeTimeStamp(o)}null!=i&&e.push(i)}return new n({array:e}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.x509.Extensions,Y.asn1.ASN1Object),Y.asn1.x509.Extension=function(e){Y.asn1.x509.Extension.superclass.constructor.call(this);var t=Y.asn1,n=t.DERObjectIdentifier,r=t.DEROctetString,o=(t.DERBitString,t.DERBoolean),s=t.DERSequence;this.getEncodedHex=function(){var e=new n({oid:this.oid}),t=new r({hex:this.getExtnValueHex()}),i=new Array;return i.push(e),this.critical&&i.push(new o),i.push(t),new s({array:i}).getEncodedHex()},this.critical=!1,void 0!==e&&void 0!==e.critical&&(this.critical=e.critical)},o.lang.extend(Y.asn1.x509.Extension,Y.asn1.ASN1Object),Y.asn1.x509.KeyUsage=function(e){Y.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=Be.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",void 0!==e&&(void 0!==e.bin&&(this.asn1ExtnValue=new Y.asn1.DERBitString(e)),void 0!==e.names&&void 0!==e.names.length)){for(var n=e.names,r="000000000",o=0;o<n.length;o++)for(var s=0;s<t.length;s++)n[o]===t[s]&&(r=r.substring(0,s)+"1"+r.substring(s+1,r.length));this.asn1ExtnValue=new Y.asn1.DERBitString({bin:r})}},o.lang.extend(Y.asn1.x509.KeyUsage,Y.asn1.x509.Extension),Y.asn1.x509.BasicConstraints=function(e){Y.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var t=Y.asn1,n=t.DERBoolean,r=t.DERInteger,o=t.DERSequence;this.getExtnValueHex=function(){var e=new Array;this.cA&&e.push(new n),this.pathLen>-1&&e.push(new r({int:this.pathLen}));var t=new o({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==e&&(void 0!==e.cA&&(this.cA=e.cA),void 0!==e.pathLen&&(this.pathLen=e.pathLen))},o.lang.extend(Y.asn1.x509.BasicConstraints,Y.asn1.x509.Extension),Y.asn1.x509.CRLDistributionPoints=function(e){Y.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=Y.asn1,n=t.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(e){for(var r=[],o=0;o<e.length;o++)if(e[o]instanceof Y.asn1.ASN1Object)r.push(e[o]);else{var s=new n.DistributionPoint(e[o]);r.push(s)}this.asn1ExtnValue=new t.DERSequence({array:r})},this.setByOneURI=function(e){var t=new n.DistributionPoint({fulluri:e});this.setByDPArray([t])},this.oid="2.5.29.31",void 0!==e&&(void 0!==e.array?this.setByDPArray(e.array):void 0!==e.uri&&this.setByOneURI(e.uri))},o.lang.extend(Y.asn1.x509.CRLDistributionPoints,Y.asn1.x509.Extension),Y.asn1.x509.DistributionPoint=function(e){Y.asn1.x509.DistributionPoint.superclass.constructor.call(this);var t=Y.asn1,n=t.x509.DistributionPointName;this.getEncodedHex=function(){var e=new t.DERSequence;if(null!=this.asn1DP){var n=new t.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});e.appendASN1Object(n)}return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==e&&(void 0!==e.dpobj?this.asn1DP=e.dpobj:void 0!==e.dpname?this.asn1DP=new n(e.dpname):void 0!==e.fulluri&&(this.asn1DP=new n({full:[{uri:e.fulluri}]})))},o.lang.extend(Y.asn1.x509.DistributionPoint,Y.asn1.ASN1Object),Y.asn1.x509.DistributionPointName=function(e){Y.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=Y.asn1,n=t.DERTaggedObject;if(this.getEncodedHex=function(){if("full"!=this.type)throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new n({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},void 0!==e)if(t.x509.GeneralNames.prototype.isPrototypeOf(e))this.type="full",this.tag="a0",this.asn1V=e;else{if(void 0===e.full)throw new Error("This class supports GeneralNames only as argument");this.type="full",this.tag="a0",this.asn1V=new t.x509.GeneralNames(e.full)}},o.lang.extend(Y.asn1.x509.DistributionPointName,Y.asn1.ASN1Object),Y.asn1.x509.CertificatePolicies=function(e){Y.asn1.x509.CertificatePolicies.superclass.constructor.call(this,e);var t=Y.asn1,n=t.x509,r=t.DERSequence,o=n.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var e=[],t=0;t<this.params.array.length;t++)e.push(new o(this.params.array[t]));var n=new r({array:e});return this.asn1ExtnValue=n,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.32",void 0!==e&&(this.params=e)},o.lang.extend(Y.asn1.x509.CertificatePolicies,Y.asn1.x509.Extension),Y.asn1.x509.PolicyInformation=function(e){Y.asn1.x509.PolicyInformation.superclass.constructor.call(this,e);var t=Y.asn1,n=t.DERSequence,r=t.DERObjectIdentifier,o=t.x509.PolicyQualifierInfo;this.params=null,this.getEncodedHex=function(){if(void 0===this.params.policyoid&&void 0===this.params.array)throw new Error("parameter oid and array missing");var e=[new r(this.params.policyoid)];if(void 0!==this.params.array){for(var t=[],s=0;s<this.params.array.length;s++)t.push(new o(this.params.array[s]));t.length>0&&e.push(new n({array:t}))}return new n({array:e}).getEncodedHex()},void 0!==e&&(this.params=e)},o.lang.extend(Y.asn1.x509.PolicyInformation,Y.asn1.ASN1Object),Y.asn1.x509.PolicyQualifierInfo=function(e){Y.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var t=Y.asn1,n=t.DERSequence,r=t.DERIA5String,o=t.DERObjectIdentifier,s=t.x509.UserNotice;this.params=null,this.getEncodedHex=function(){return void 0!==this.params.cps?new n({array:[new o({oid:"1.3.6.1.5.5.7.2.1"}),new r({str:this.params.cps})]}).getEncodedHex():null!=this.params.unotice?new n({array:[new o({oid:"1.3.6.1.5.5.7.2.2"}),new s(this.params.unotice)]}).getEncodedHex():void 0},void 0!==e&&(this.params=e)},o.lang.extend(Y.asn1.x509.PolicyQualifierInfo,Y.asn1.ASN1Object),Y.asn1.x509.UserNotice=function(e){Y.asn1.x509.UserNotice.superclass.constructor.call(this,e);var t=Y.asn1.DERSequence,n=(Y.asn1.DERInteger,Y.asn1.x509.DisplayText),r=Y.asn1.x509.NoticeReference;this.params=null,this.getEncodedHex=function(){var e=[];return void 0!==this.params.noticeref&&e.push(new r(this.params.noticeref)),void 0!==this.params.exptext&&e.push(new n(this.params.exptext)),new t({array:e}).getEncodedHex()},void 0!==e&&(this.params=e)},o.lang.extend(Y.asn1.x509.UserNotice,Y.asn1.ASN1Object),Y.asn1.x509.NoticeReference=function(e){Y.asn1.x509.NoticeReference.superclass.constructor.call(this,e);var t=Y.asn1.DERSequence,n=Y.asn1.DERInteger,r=Y.asn1.x509.DisplayText;this.params=null,this.getEncodedHex=function(){var e=[];if(void 0!==this.params.org&&e.push(new r(this.params.org)),void 0!==this.params.noticenum){for(var o=[],s=this.params.noticenum,i=0;i<s.length;i++)o.push(new n(s[i]));e.push(new t({array:o}))}if(0==e.length)throw new Error("parameter is empty");return new t({array:e}).getEncodedHex()},void 0!==e&&(this.params=e)},o.lang.extend(Y.asn1.x509.NoticeReference,Y.asn1.ASN1Object),Y.asn1.x509.DisplayText=function(e){Y.asn1.x509.DisplayText.superclass.constructor.call(this,e),this.hT="0c",void 0!==e&&("ia5"===e.type?this.hT="16":"vis"===e.type?this.hT="1a":"bmp"===e.type&&(this.hT="1e"))},o.lang.extend(Y.asn1.x509.DisplayText,Y.asn1.DERAbstractString),Y.asn1.x509.ExtKeyUsage=function(e){Y.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var t=Y.asn1;this.setPurposeArray=function(e){this.asn1ExtnValue=new t.DERSequence;for(var n=0;n<e.length;n++){var r=new t.DERObjectIdentifier(e[n]);this.asn1ExtnValue.appendASN1Object(r)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==e&&void 0!==e.array&&this.setPurposeArray(e.array)},o.lang.extend(Y.asn1.x509.ExtKeyUsage,Y.asn1.x509.Extension),Y.asn1.x509.AuthorityKeyIdentifier=function(e){Y.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var t=Y,n=t.asn1,r=n.DERTaggedObject,o=n.x509.GeneralNames;t.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var e=new Array;this.asn1KID&&e.push(new r({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&e.push(new r({explicit:!1,tag:"a1",obj:new o([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&e.push(new r({explicit:!1,tag:"82",obj:this.asn1CertSN}));var t=new n.DERSequence({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(e){if(void 0!==e.str||void 0!==e.hex)this.asn1KID=new Y.asn1.DEROctetString(e);else if("object"==typeof e&&Y.crypto.Util.isKey(e)||"string"==typeof e&&-1!=e.indexOf("BEGIN ")){var t=e;"string"==typeof e&&(t=Pe.getKey(e));var n=Pe.getKeyID(t);this.asn1KID=new Y.asn1.DEROctetString({hex:n})}},this.setCertIssuerByParam=function(e){void 0!==e.str||void 0!==e.ldapstr||void 0!==e.hex||void 0!==e.certsubject||void 0!==e.certissuer?this.asn1CertIssuer=new Y.asn1.x509.X500Name(e):"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&-1!=e.indexOf("CERTIFICATE")&&(this.asn1CertIssuer=new Y.asn1.x509.X500Name({certissuer:e}))},this.setCertSNByParam=function(e){if(void 0!==e.str||void 0!==e.bigint||void 0!==e.hex)this.asn1CertSN=new Y.asn1.DERInteger(e);else if("string"==typeof e&&-1!=e.indexOf("BEGIN ")&&e.indexOf("CERTIFICATE")){var t=new Be;t.readCertPEM(e);var n=t.getSerialNumberHex();this.asn1CertSN=new Y.asn1.DERInteger({hex:n})}},this.oid="2.5.29.35",void 0!==e&&(void 0!==e.kid&&this.setKIDByParam(e.kid),void 0!==e.issuer&&this.setCertIssuerByParam(e.issuer),void 0!==e.sn&&this.setCertSNByParam(e.sn),void 0!==e.issuersn&&"string"==typeof e.issuersn&&-1!=e.issuersn.indexOf("BEGIN ")&&e.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(e.issuersn),this.setCertIssuerByParam(e.issuersn)))},o.lang.extend(Y.asn1.x509.AuthorityKeyIdentifier,Y.asn1.x509.Extension),Y.asn1.x509.SubjectKeyIdentifier=function(e){Y.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,e);var t=Y.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(e){if(void 0!==e.str||void 0!==e.hex)this.asn1KID=new t(e);else if("object"==typeof e&&Y.crypto.Util.isKey(e)||"string"==typeof e&&-1!=e.indexOf("BEGIN")){var n=e;"string"==typeof e&&(n=Pe.getKey(e));var r=Pe.getKeyID(n);this.asn1KID=new Y.asn1.DEROctetString({hex:r})}},this.oid="2.5.29.14",void 0!==e&&void 0!==e.kid&&this.setKIDByParam(e.kid)},o.lang.extend(Y.asn1.x509.SubjectKeyIdentifier,Y.asn1.x509.Extension),Y.asn1.x509.AuthorityInfoAccess=function(e){Y.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(e){for(var t=new Array,n=Y.asn1,r=n.DERSequence,o=n.DERObjectIdentifier,s=n.x509.GeneralName,i=0;i<e.length;i++){var a,u=e[i];if(void 0!==u.ocsp)a=new r({array:[new o({oid:"1.3.6.1.5.5.7.48.1"}),new s({uri:u.ocsp})]});else{if(void 0===u.caissuer)throw new Error("unknown AccessMethod parameter: "+JSON.stringify(u));a=new r({array:[new o({oid:"1.3.6.1.5.5.7.48.2"}),new s({uri:u.caissuer})]})}t.push(a)}this.asn1ExtnValue=new r({array:t})},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==e&&void 0!==e.array&&this.setAccessDescriptionArray(e.array)},o.lang.extend(Y.asn1.x509.AuthorityInfoAccess,Y.asn1.x509.Extension),Y.asn1.x509.SubjectAltName=function(e){Y.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new Y.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},o.lang.extend(Y.asn1.x509.SubjectAltName,Y.asn1.x509.Extension),Y.asn1.x509.IssuerAltName=function(e){Y.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new Y.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},o.lang.extend(Y.asn1.x509.IssuerAltName,Y.asn1.x509.Extension),Y.asn1.x509.PrivateExtension=function(e){Y.asn1.x509.PrivateExtension.superclass.constructor.call(this,e);var t=Y,n=t.lang.String.isHex,r=t.asn1,o=r.x509.OID.name2oid,s=r.ASN1Util.newObject;this.params=null,this.setByParam=function(e){this.oid=o(e.extname),this.params=e},this.getExtnValueHex=function(){if(null==this.params.extname||null==this.params.extn)throw new Error("extname or extnhex not specified");var e=this.params.extn;if("string"==typeof e&&n(e))return e;if("object"==typeof e)try{return s(e).getEncodedHex()}catch(e){}throw new Error("unsupported extn value")},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.x509.PrivateExtension,Y.asn1.x509.Extension),Y.asn1.x509.CRL=function(e){Y.asn1.x509.CRL.superclass.constructor.call(this);var t=Y.asn1,n=t.DERSequence,r=t.DERBitString,o=t.x509,s=o.AlgorithmIdentifier,i=o.TBSCertList;this.params=void 0,this.setByParam=function(e){this.params=e},this.sign=function(){var e=new i(this.params).getEncodedHex(),t=new Y.crypto.Signature({alg:this.params.sigalg});t.init(this.params.cakey),t.updateHex(e);var n=t.sign();this.params.sighex=n},this.getPEM=function(){return be(this.getEncodedHex(),"X509 CRL")},this.getEncodedHex=function(){var e=this.params;if(null==e.tbsobj&&(e.tbsobj=new i(e)),null==e.sighex&&null!=e.cakey&&this.sign(),null==e.sighex)throw new Error("sighex or cakey parameter not defined");var t=[];return t.push(e.tbsobj),t.push(new s({name:e.sigalg})),t.push(new r({hex:"00"+e.sighex})),new n({array:t}).getEncodedHex()},null!=e&&(this.params=e)},o.lang.extend(Y.asn1.x509.CRL,Y.asn1.ASN1Object),Y.asn1.x509.TBSCertList=function(e){Y.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=Y.asn1,n=t.DERInteger,r=t.DERSequence,o=t.DERTaggedObject,s=(t.DERObjectIdentifier,t.x509),i=s.AlgorithmIdentifier,a=s.Time,u=s.Extensions,c=s.X500Name;this.params=null,this.setByParam=function(e){this.params=e},this.getRevCertSequence=function(){for(var e=[],t=this.params.revcert,o=0;o<t.length;o++){var s=[new n(t[o].sn),new a(t[o].date)];null!=t[o].ext&&s.push(new u(t[o].ext)),e.push(new r({array:s}))}return new r({array:e})},this.getEncodedHex=function(){var e=[],t=this.params;if(null!=t.version){var s=t.version-1,d=new n({int:s});e.push(d)}if(e.push(new i({name:t.sigalg})),e.push(new c(t.issuer)),e.push(new a(t.thisupdate)),null!=t.nextupdate&&e.push(new a(t.nextupdate)),null!=t.revcert&&e.push(this.getRevCertSequence()),null!=t.ext){var l=new u(t.ext);e.push(new o({tag:"a0",explicit:!0,obj:l}))}return new r({array:e}).getEncodedHex()},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.x509.TBSCertList,Y.asn1.ASN1Object),Y.asn1.x509.CRLEntry=function(e){Y.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=Y.asn1;this.setCertSerial=function(e){this.sn=new t.DERInteger(e)},this.setRevocationDate=function(e){this.time=new t.x509.Time(e)},this.getEncodedHex=function(){var e=new t.DERSequence({array:[this.sn,this.time]});return this.TLV=e.getEncodedHex(),this.TLV},void 0!==e&&(void 0!==e.time&&this.setRevocationDate(e.time),void 0!==e.sn&&this.setCertSerial(e.sn))},o.lang.extend(Y.asn1.x509.CRLEntry,Y.asn1.ASN1Object),Y.asn1.x509.CRLNumber=function(e){Y.asn1.x509.CRLNumber.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new Y.asn1.DERInteger(this.params.num),this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.20",null!=e&&(this.params=e)},o.lang.extend(Y.asn1.x509.CRLNumber,Y.asn1.x509.Extension),Y.asn1.x509.CRLReason=function(e){Y.asn1.x509.CRLReason.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new Y.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.21",null!=e&&(this.params=e)},o.lang.extend(Y.asn1.x509.CRLReason,Y.asn1.x509.Extension),Y.asn1.x509.OCSPNonce=function(e){Y.asn1.x509.OCSPNonce.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new Y.asn1.DEROctetString(this.params),this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.48.1.2",null!=e&&(this.params=e)},o.lang.extend(Y.asn1.x509.OCSPNonce,Y.asn1.x509.Extension),Y.asn1.x509.OCSPNoCheck=function(e){Y.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new Y.asn1.DERNull,this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.48.1.5",null!=e&&(this.params=e)},o.lang.extend(Y.asn1.x509.OCSPNoCheck,Y.asn1.x509.Extension),Y.asn1.x509.AdobeTimeStamp=function(e){Y.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,e);var t=Y.asn1,n=t.DERInteger,r=t.DERBoolean,o=t.DERSequence,s=t.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var e=this.params,t=[new n(1)];return t.push(new s({uri:e.uri})),null!=e.reqauth&&t.push(new r(e.reqauth)),this.asn1ExtnValue=new o({array:t}),this.asn1ExtnValue.getEncodedHex()},this.oid="1.2.840.113583.1.1.9.1",void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.x509.AdobeTimeStamp,Y.asn1.x509.Extension),Y.asn1.x509.X500Name=function(e){Y.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=Y.asn1,n=t.x509,r=n.RDN;this.setByString=function(e,t){void 0!==t&&(this.sRule=t);var n=e.split("/");n.shift();for(var o=[],s=0;s<n.length;s++)if(n[s].match(/^[^=]+=.+$/))o.push(n[s]);else{var i=o.length-1;o[i]=o[i]+"/"+n[s]}for(s=0;s<o.length;s++)this.asn1Array.push(new r({str:o[s],rule:this.sRule}))},this.setByLdapString=function(e,t){void 0!==t&&(this.sRule=t);var r=n.X500Name.ldapToCompat(e);this.setByString(r,t)},this.setByObject=function(e,t){for(var n in void 0!==t&&(this.sRule=t),e)if(e.hasOwnProperty(n)){var o=new r({str:n+"="+e[n],rule:this.sRule});this.asn1Array?this.asn1Array.push(o):this.asn1Array=[o]}},this.setByParam=function(e){var t;void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.array?this.paramArray=e.array:void 0!==e.str?this.setByString(e.str):void 0!==e.ldapstr?this.setByLdapString(e.ldapstr):void 0!==e.hex?this.hTLV=e.hex:void 0!==e.certissuer?((t=new Be).readCertPEM(e.certissuer),this.hTLV=t.getIssuerHex()):void 0!==e.certsubject?((t=new Be).readCertPEM(e.certsubject),this.hTLV=t.getSubjectHex()):"object"==typeof e&&void 0===e.certsubject&&void 0===e.certissuer&&this.setByObject(e)},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(0==this.asn1Array.length&&this.paramArray.length>0)for(var e=0;e<this.paramArray.length;e++){var n={array:this.paramArray[e]};"utf8"!=this.sRule&&(n.rule=this.sRule);var o=new r(n);this.asn1Array.push(o)}var s=new t.DERSequence({array:this.asn1Array});return this.hTLV=s.getEncodedHex(),this.hTLV},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.x509.X500Name,Y.asn1.ASN1Object),Y.asn1.x509.X500Name.compatToLDAP=function(e){if("/"!==e.substr(0,1))throw"malformed input";var t=(e=e.substr(1)).split("/");return t.reverse(),(t=t.map((function(e){return e.replace(/,/,"\\,")}))).join(",")},Y.asn1.x509.X500Name.onelineToLDAP=function(e){return Y.asn1.x509.X500Name.compatToLDAP(e)},Y.asn1.x509.X500Name.ldapToCompat=function(e){for(var t=e.split(","),n=!1,r=[],o=0;t.length>0;o++){var s=t.shift();if(!0===n){var i=(r.pop()+","+s).replace(/\\,/g,",");r.push(i),n=!1}else r.push(s);"\\"===s.substr(-1,1)&&(n=!0)}return(r=r.map((function(e){return e.replace("/","\\/")}))).reverse(),"/"+r.join("/")},Y.asn1.x509.X500Name.ldapToOneline=function(e){return Y.asn1.x509.X500Name.ldapToCompat(e)},Y.asn1.x509.RDN=function(e){Y.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=Y.asn1.x509.AttributeTypeAndValue;this.setByParam=function(e){void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.str&&this.addByMultiValuedString(e.str),void 0!==e.array&&(this.paramArray=e.array)},this.addByString=function(e){this.asn1Array.push(new Y.asn1.x509.AttributeTypeAndValue({str:e,rule:this.sRule}))},this.addByMultiValuedString=function(e){for(var t=Y.asn1.x509.RDN.parseString(e),n=0;n<t.length;n++)this.addByString(t[n])},this.getEncodedHex=function(){if(0==this.asn1Array.length&&this.paramArray.length>0)for(var e=0;e<this.paramArray.length;e++){var n=this.paramArray[e];void 0!==n.rule&&"utf8"!=this.sRule&&(n.rule=this.sRule);var r=new t(n);this.asn1Array.push(r)}var o=new Y.asn1.DERSet({array:this.asn1Array});return this.TLV=o.getEncodedHex(),this.TLV},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.x509.RDN,Y.asn1.ASN1Object),Y.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),n=!1,r=[],o=0;t.length>0;o++){var s=t.shift();if(!0===n){var i=(r.pop()+"+"+s).replace(/\\\+/g,"+");r.push(i),n=!1}else r.push(s);"\\"===s.substr(-1,1)&&(n=!0)}var a=!1,u=[];for(o=0;r.length>0;o++){if(s=r.shift(),!0===a){var c=u.pop();s.match(/"$/)?(i=(c+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2"),u.push(i),a=!1):u.push(c+"+"+s)}else u.push(s);s.match(/^[^=]+="/)&&(a=!0)}return u},Y.asn1.x509.AttributeTypeAndValue=function(e){Y.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var t=Y,n=t.asn1,r=n.DERSequence,o=n.DERUTF8String,s=n.DERPrintableString,i=n.DERTeletexString,a=n.DERIA5String,u=n.DERVisibleString,c=n.DERBMPString,d=t.lang.String.isMail,l=t.lang.String.isPrintable;this.setByParam=function(e){if(void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.ds&&(this.dsType=e.ds),void 0===e.value&&void 0!==e.str){var t=e.str.match(/^([^=]+)=(.+)$/);if(!t)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.sType=t[1],this.sValue=t[2]}else this.sType=e.type,this.sValue=e.value},this.setByString=function(e,t){void 0!==t&&(this.sRule=t);var n=e.match(/^([^=]+)=(.+)$/);if(!n)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.setByAttrTypeAndValueStr(n[1],n[2])},this._getDsType=function(){var e=this.sType,t=this.sValue,n=this.sRule;return"prn"===n?"CN"==e&&d(t)?"ia5":l(t)?"prn":"utf8":"utf8"===n?"CN"==e&&d(t)?"ia5":"C"==e?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(e,t,n){void 0!==n&&(this.sRule=n),this.sType=e,this.sValue=t},this.getValueObj=function(e,t){if("utf8"==e)return new o({str:t});if("prn"==e)return new s({str:t});if("tel"==e)return new i({str:t});if("ia5"==e)return new a({str:t});if("vis"==e)return new u({str:t});if("bmp"==e)return new c({str:t});throw new Error("unsupported directory string type: type="+e+" value="+t)},this.getEncodedHex=function(){null==this.dsType&&(this.dsType=this._getDsType());var e=Y.asn1.x509.OID.atype2obj(this.sType),t=this.getValueObj(this.dsType,this.sValue),n=new r({array:[e,t]});return this.TLV=n.getEncodedHex(),this.TLV},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.x509.AttributeTypeAndValue,Y.asn1.ASN1Object),Y.asn1.x509.SubjectPublicKeyInfo=function(e){Y.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=Y,n=t.asn1,r=n.DERInteger,o=n.DERBitString,s=n.DERObjectIdentifier,i=n.DERSequence,a=n.ASN1Util.newObject,u=n.x509.AlgorithmIdentifier,c=t.crypto;c.ECDSA,c.DSA,this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new i({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){var e=this.getASN1Object();return this.hTLV=e.getEncodedHex(),this.hTLV},this.setPubKey=function(e){try{if(e instanceof W){var t=a({seq:[{int:{bigint:e.n}},{int:{int:e.e}}]}).getEncodedHex();this.asn1AlgId=new u({name:"rsaEncryption"}),this.asn1SubjPKey=new o({hex:"00"+t})}}catch(e){}try{if(e instanceof Y.crypto.ECDSA){var n=new s({name:e.curveName});this.asn1AlgId=new u({name:"ecPublicKey",asn1params:n}),this.asn1SubjPKey=new o({hex:"00"+e.pubKeyHex})}}catch(e){}try{if(e instanceof Y.crypto.DSA){n=new a({seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}),this.asn1AlgId=new u({name:"dsa",asn1params:n});var i=new r({bigint:e.y});this.asn1SubjPKey=new o({hex:"00"+i.getEncodedHex()})}}catch(e){}},void 0!==e&&this.setPubKey(e)},o.lang.extend(Y.asn1.x509.SubjectPublicKeyInfo,Y.asn1.ASN1Object),Y.asn1.x509.Time=function(e){Y.asn1.x509.Time.superclass.constructor.call(this);var t=Y.asn1,n=t.DERUTCTime,r=t.DERGeneralizedTime;this.setTimeParams=function(e){this.timeParams=e},this.getEncodedHex=function(){var e=null;return e=null!=this.timeParams?"utc"==this.type?new n(this.timeParams):new r(this.timeParams):"utc"==this.type?new n:new r,this.TLV=e.getEncodedHex(),this.TLV},this.type="utc",void 0!==e&&(void 0!==e.type?this.type=e.type:void 0!==e.str&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)},o.lang.extend(Y.asn1.x509.Time,Y.asn1.ASN1Object),Y.asn1.x509.AlgorithmIdentifier=function(e){Y.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var t=Y.asn1,n=t.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.getEncodedHex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw new Error("algorithm not specified");if(null!==this.nameAlg){var e=null;for(var r in n)r===this.nameAlg&&(e=n[r]);if(null!==e)return this.hTLV=e,this.hTLV}null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=t.x509.OID.name2obj(this.nameAlg));var o=[this.asn1Alg];null!==this.asn1Params&&o.push(this.asn1Params);var s=new t.DERSequence({array:o});return this.hTLV=s.getEncodedHex(),this.hTLV},void 0!==e&&(void 0!==e.name&&(this.nameAlg=e.name),void 0!==e.asn1params&&(this.asn1Params=e.asn1params),void 0!==e.paramempty&&(this.paramEmpty=e.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){void 0!==this.nameAlg.name&&(this.nameAlg=this.nameAlg.name);var r=this.nameAlg.toLowerCase();"withdsa"!==r.substr(-7,7)&&"withecdsa"!==r.substr(-9,9)&&(this.asn1Params=new t.DERNull)}},o.lang.extend(Y.asn1.x509.AlgorithmIdentifier,Y.asn1.ASN1Object),Y.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},Y.asn1.x509.GeneralName=function(e){Y.asn1.x509.GeneralName.superclass.constructor.call(this);var t={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},n=Y.asn1,r=(n.DERSequence,n.DEROctetString),o=n.DERIA5String,s=n.DERTaggedObject,i=n.ASN1Object,a=n.x509.X500Name,u=ve;this.explicit=!1,this.setByParam=function(e){var n=null;if(void 0!==e){if(void 0!==e.rfc822&&(this.type="rfc822",n=new o({str:e[this.type]})),void 0!==e.dns&&(this.type="dns",n=new o({str:e[this.type]})),void 0!==e.uri&&(this.type="uri",n=new o({str:e[this.type]})),void 0!==e.dn&&(this.type="dn",this.explicit=!0,n="string"==typeof e.dn?new a({str:e.dn}):e.dn instanceof Y.asn1.x509.X500Name?e.dn:new a(e.dn)),void 0!==e.ldapdn&&(this.type="dn",this.explicit=!0,n=new a({ldapstr:e.ldapdn})),void 0!==e.certissuer){this.type="dn",this.explicit=!0;var c=null;if((l=e.certissuer).match(/^[0-9A-Fa-f]+$/),-1!=l.indexOf("-----BEGIN ")&&(c=u(l)),null==c)throw"certissuer param not cert";(h=new Be).hex=c;var d=h.getIssuerHex();(n=new i).hTLV=d}if(void 0!==e.certsubj){var l,h;if(this.type="dn",this.explicit=!0,c=null,(l=e.certsubj).match(/^[0-9A-Fa-f]+$/),-1!=l.indexOf("-----BEGIN ")&&(c=u(l)),null==c)throw"certsubj param not cert";(h=new Be).hex=c,d=h.getSubjectHex(),(n=new i).hTLV=d}if(void 0!==e.ip){this.type="ip",this.explicit=!1;var f,m=e.ip,p="malformed IP address";if(m.match(/^[0-9.]+[.][0-9.]+$/)){if(8!==(f=Ie("["+m.split(".").join(",")+"]")).length)throw p}else if(m.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))f=Se(m);else{if(!m.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw p;f=m}n=new r({hex:f})}if(null==this.type)throw"unsupported type in params="+e;this.asn1Obj=new s({explicit:this.explicit,tag:t[this.type],obj:n})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.x509.GeneralName,Y.asn1.ASN1Object),Y.asn1.x509.GeneralNames=function(e){Y.asn1.x509.GeneralNames.superclass.constructor.call(this);var t=Y.asn1;this.setByParamArray=function(e){for(var n=0;n<e.length;n++){var r=new t.x509.GeneralName(e[n]);this.asn1Array.push(r)}},this.getEncodedHex=function(){return new t.DERSequence({array:this.asn1Array}).getEncodedHex()},this.asn1Array=new Array,void 0!==e&&this.setByParamArray(e)},o.lang.extend(Y.asn1.x509.GeneralNames,Y.asn1.ASN1Object),Y.asn1.x509.OID=new function(e){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1"},this.objCache={},this.name2obj=function(e){if(void 0!==this.objCache[e])return this.objCache[e];if(void 0===this.name2oidList[e])throw"Name of ObjectIdentifier not defined: "+e;var t=this.name2oidList[e],n=new Y.asn1.DERObjectIdentifier({oid:t});return this.objCache[e]=n,n},this.atype2obj=function(e){if(void 0!==this.objCache[e])return this.objCache[e];if(void 0===this.atype2oidList[e])throw"AttributeType name undefined: "+e;var t=this.atype2oidList[e],n=new Y.asn1.DERObjectIdentifier({oid:t});return this.objCache[e]=n,n}},Y.asn1.x509.OID.oid2name=function(e){var t=Y.asn1.x509.OID.name2oidList;for(var n in t)if(t[n]==e)return n;return""},Y.asn1.x509.OID.oid2atype=function(e){var t=Y.asn1.x509.OID.atype2oidList;for(var n in t)if(t[n]==e)return n;return e},Y.asn1.x509.OID.name2oid=function(e){if(e.match(/^[0-9.]+$/))return e;var t=Y.asn1.x509.OID.name2oidList;return void 0===t[e]?"":t[e]},Y.asn1.x509.X509Util={},Y.asn1.x509.X509Util.newCertPEM=function(e){var t=Y.asn1.x509;return t.TBSCertificate,new(0,t.Certificate)(e).getPEM()},void 0!==Y&&Y||(Y={}),void 0!==Y.asn1&&Y.asn1||(Y.asn1={}),void 0!==Y.asn1.cms&&Y.asn1.cms||(Y.asn1.cms={}),Y.asn1.cms.Attribute=function(e){var t=Error,n=Y.asn1,r=n.DERSequence,o=n.DERSet,s=n.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(e){this.params=e},this.getValueArray=function(){throw new t("not yet implemented abstract")},this.getEncodedHex=function(){var e=new s({oid:this.typeOid}),t=new o({array:this.getValueArray()});return new r({array:[e,t]}).getEncodedHex()}},o.lang.extend(Y.asn1.cms.Attribute,Y.asn1.ASN1Object),Y.asn1.cms.ContentType=function(e){var t=Y.asn1;t.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){return[new t.DERObjectIdentifier(this.params.type)]},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.ContentType,Y.asn1.cms.Attribute),Y.asn1.cms.MessageDigest=function(e){var t=Y.asn1,n=t.DEROctetString;t.cms.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){return[new n(this.params)]},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.MessageDigest,Y.asn1.cms.Attribute),Y.asn1.cms.SigningTime=function(e){var t=Y.asn1;t.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){return[new t.x509.Time(this.params)]},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.SigningTime,Y.asn1.cms.Attribute),Y.asn1.cms.SigningCertificate=function(e){var t=Error,n=Y,r=n.asn1,o=r.DERSequence,s=r.cms,i=s.ESSCertID;n.crypto,s.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(null==this.params||null==this.params||null==this.params.array)throw new t("parameter 'array' not specified");for(var n=this.params.array,r=[],s=0;s<n.length;s++){var a=n[s];0!=e.hasis||"string"!=typeof a||-1==a.indexOf("-----BEGIN")&&!te.isASN1HEX(a)||(a={cert:a}),0!=a.hasis&&0==e.hasis&&(a.hasis=!1),r.push(new i(a))}var u=new o({array:r});return[new o({array:[u]})]},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.SigningCertificate,Y.asn1.cms.Attribute),Y.asn1.cms.ESSCertID=function(e){Y.asn1.cms.ESSCertID.superclass.constructor.call(this);var t=Error,n=Y,r=n.asn1,o=r.DEROctetString,s=r.DERSequence,i=r.cms.IssuerSerial;this.params=null,this.getCertHash=function(e,r){if(null!=e.hash)return e.hash;if("string"==typeof e&&-1==e.indexOf("-----BEGIN")&&!te.isASN1HEX(e))return e;var o,s,i;if("string"==typeof e)o=e;else{if(null==e.cert)throw new t("hash nor cert unspecified");o=e.cert}if(s=-1!=o.indexOf("-----BEGIN")?ve(o):o,"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?s=ve(e):te.isASN1HEX(e)&&(s=e)),null!=e.alg)i=e.alg;else{if(null==r)throw new t("hash alg unspecified");i=r}return n.crypto.Util.hashHex(s,i)},this.getEncodedHex=function(){var e=this.params,t=this.getCertHash(e,"sha1"),n=[];return n.push(new o({hex:t})),("string"==typeof e&&-1!=e.indexOf("-----BEGIN")||null!=e.cert&&0!=e.hasis||null!=e.issuer&&null!=e.serial)&&n.push(new i(e)),new s({array:n}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.ESSCertID,Y.asn1.ASN1Object),Y.asn1.cms.SigningCertificateV2=function(e){var t=Error,n=Y,r=n.asn1,o=r.DERSequence,s=(r.x509,r.cms),i=s.ESSCertIDv2;n.crypto,s.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(null==this.params||null==this.params||null==this.params.array)throw new t("parameter 'array' not specified");for(var n=this.params.array,r=[],s=0;s<n.length;s++){var a=n[s];null==e.alg&&0!=e.hasis||"string"!=typeof a||-1==a.indexOf("-----BEGIN")&&!te.isASN1HEX(a)||(a={cert:a}),null==a.alg&&null!=e.alg&&(a.alg=e.alg),0!=a.hasis&&0==e.hasis&&(a.hasis=!1),r.push(new i(a))}var u=new o({array:r});return[new o({array:[u]})]},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.SigningCertificateV2,Y.asn1.cms.Attribute),Y.asn1.cms.ESSCertIDv2=function(e){Y.asn1.cms.ESSCertIDv2.superclass.constructor.call(this),Error;var t=Y.asn1,n=t.DEROctetString,r=t.DERSequence,o=t.cms.IssuerSerial,s=t.x509.AlgorithmIdentifier;this.params=null,this.getEncodedHex=function(){var e=this.params,t=this.getCertHash(e,"sha256"),i=[];return null!=e.alg&&"sha256"!=e.alg&&i.push(new s({name:e.alg})),i.push(new n({hex:t})),("string"==typeof e&&-1!=e.indexOf("-----BEGIN")||null!=e.cert&&0!=e.hasis||null!=e.issuer&&null!=e.serial)&&i.push(new o(e)),new r({array:i}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.ESSCertIDv2,Y.asn1.cms.ESSCertID),Y.asn1.cms.IssuerSerial=function(e){var t=Error,n=Y.asn1,r=n.DERInteger,o=n.DERSequence,s=n.cms,i=n.x509.GeneralNames,a=Be;s.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e,n,s=this.params;if("string"==typeof s&&-1!=s.indexOf("-----BEGIN")||null!=s.cert){var u;u=null!=s.cert?s.cert:s;var c=new a;c.readCertPEM(u),e=c.getIssuer(),n={hex:c.getSerialNumberHex()}}else{if(null==s.issuer||!s.serial)throw new t("cert or issuer and serial parameter not specified");e=s.issuer,n=s.serial}var d=new i([{dn:e}]),l=new r(n);return new o({array:[d,l]}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.IssuerSerial,Y.asn1.ASN1Object),Y.asn1.cms.SignerIdentifier=function(e){var t=Y.asn1,n=(t.DERInteger,t.DERSequence,t.cms),r=n.IssuerAndSerialNumber,o=n.SubjectKeyIdentifier;t.x509.X500Name,Error,n.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if("isssn"==e.type)return new r(e).getEncodedHex();if("skid"==e.type)return new o(e).getEncodedHex();throw new Error("wrong property for isssn or skid")},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.SignerIdentifier,Y.asn1.ASN1Object),Y.asn1.cms.IssuerAndSerialNumber=function(e){var t=Y.asn1,n=t.DERInteger,r=t.DERSequence,o=t.cms,s=t.x509.X500Name,i=Be,a=Error;o.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e,t,o=this.params;if("string"==typeof o&&-1!=o.indexOf("-----BEGIN")||null!=o.cert){var u;u=null!=o.cert?o.cert:o;var c=new i;c.readCertPEM(u),e=c.getIssuer(),t={hex:c.getSerialNumberHex()}}else{if(null==o.issuer||!o.serial)throw new a("cert or issuer and serial parameter not specified");e=o.issuer,t=o.serial}var d=new s(e),l=new n(t);return new r({array:[d,l]}).getEncodedHex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.IssuerAndSerialNumber,Y.asn1.ASN1Object),Y.asn1.cms.SubjectKeyIdentifier=function(e){var t=Y.asn1,n=(t.DERInteger,t.DERSequence,t.ASN1Util.newObject),r=t.cms,o=(r.IssuerAndSerialName,r.SubjectKeyIdentifier,t.x509.X500Name,Be),s=Error;r.SubjectKeyIdentifier.superclass.constructor.call(this),this.getEncodedHex=function(){var e,t=this.params;if(null==t.cert&&null==t.skid)throw new s("property cert nor skid undefined");return null!=t.cert?e=new o(t.cert).getExtSubjectKeyIdentifier().kid.hex:null!=t.skid&&(e=t.skid),n({tag:{tage:"a0",obj:{octstr:{hex:e}}}}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.SubjectKeyIdentifier,Y.asn1.ASN1Object),Y.asn1.cms.AttributeList=function(e){var t=Error,n=Y.asn1,r=n.DERSet,o=n.cms;o.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e=this.params;if(null!=this.hTLV)return this.hTLV;var n=!0;null!=e.sortflag&&(n=e.sortflag);for(var s=e.array,i=[],a=0;a<s.length;a++){var u=s[a],c=u.attr;if("contentType"==c)i.push(new o.ContentType(u));else if("messageDigest"==c)i.push(new o.MessageDigest(u));else if("signingTime"==c)i.push(new o.SigningTime(u));else if("signingCertificate"==c)i.push(new o.SigningCertificate(u));else if("signingCertificateV2"==c)i.push(new o.SigningCertificateV2(u));else if("signaturePolicyIdentifier"==c)i.push(new Y.asn1.cades.SignaturePolicyIdentifier(u));else{if("signatureTimeStamp"!=c&&"timeStampToken"!=c)throw new t("unknown attr: "+c);i.push(new Y.asn1.cades.SignatureTimeStamp(u))}}var d=new r({array:i,sortflag:n});return this.hTLV=d.getEncodedHex(),this.hTLV},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.AttributeList,Y.asn1.ASN1Object),Y.asn1.cms.SignerInfo=function(e){var t=Error,n=Y,r=n.asn1,o=r.DERInteger,s=r.DEROctetString,i=r.DERSequence,a=r.DERTaggedObject,u=r.cms,c=u.SignerIdentifier,d=u.AttributeList,l=(u.ContentType,u.EncapsulatedContentInfo,u.MessageDigest,u.SignedData,r.x509.AlgorithmIdentifier),h=n.crypto,f=Pe;u.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var e=this.params,t=e.sigalg,n=new d(e.sattrs).getEncodedHex(),r=f.getKey(e.signkey),o=new h.Signature({alg:t});o.init(r),o.updateHex(n);var s=o.sign();e.sighex=s},this.getEncodedHex=function(){var e=this.params,n=[];if(n.push(new o({int:e.version})),n.push(new c(e.id)),n.push(new l({name:e.hashalg})),null!=e.sattrs){var r=new d(e.sattrs);try{n.push(new a({tag:"a0",explicit:!1,obj:r}))}catch(e){throw new t("si sattr error: "+e)}}if(null!=e.sigalgfield?n.push(new l({name:e.sigalgfield})):n.push(new l({name:e.sigalg})),null==e.sighex&&null!=e.signkey&&this.sign(),n.push(new s({hex:e.sighex})),null!=e.uattrs){r=new d(e.uattrs);try{n.push(new a({tag:"a1",explicit:!1,obj:r}))}catch(e){throw new t("si uattr error: "+e)}}return new i({array:n}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.SignerInfo,Y.asn1.ASN1Object),Y.asn1.cms.EncapsulatedContentInfo=function(e){var t=Y.asn1,n=t.DERTaggedObject,r=t.DERSequence,o=t.DERObjectIdentifier,s=t.DEROctetString;t.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];if(t.push(new o(e.type)),null!=e.content&&(null!=e.content.hex||null!=e.content.str)&&1!=e.isDetached){var i=new s(e.content),a=new n({tag:"a0",explicit:!0,obj:i});t.push(a)}return new r({array:t}).getEncodedHex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.EncapsulatedContentInfo,Y.asn1.ASN1Object),Y.asn1.cms.ContentInfo=function(e){var t=Y.asn1,n=t.DERTaggedObject,r=t.DERSequence,o=t.DERObjectIdentifier;t.x509.OID.name2obj,Y.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];t.push(new o(e.type));var s=new n({tag:"a0",explicit:!0,obj:e.obj});return t.push(s),new r({array:t}).getEncodedHex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.ContentInfo,Y.asn1.ASN1Object),Y.asn1.cms.SignedData=function(e){Error;var t=Y.asn1,n=(t.ASN1Object,t.DERInteger),r=t.DERSet,o=t.DERSequence,s=(t.DERTaggedObject,t.cms),i=s.EncapsulatedContentInfo,a=s.SignerInfo,u=s.ContentInfo,c=s.CertificateSet,d=s.RevocationInfoChoices,l=t.x509.AlgorithmIdentifier;Y.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var e=this.params;this._setDigestAlgs(e),this._setContentTypeByEContent(e),this._setMessageDigestByEContent(e),this._setSignerInfoVersion(e),this._setSignedDataVersion(e)},this._setDigestAlgs=function(e){for(var t={},n=e.sinfos,r=0;r<n.length;r++)t[n[r].hashalg]=1;e.hashalgs=Object.keys(t).sort()},this._setContentTypeByEContent=function(e){for(var t=e.econtent.type,n=e.sinfos,r=0;r<n.length;r++){var o=n[r];this._getAttrParamByName(o,"contentType").type=t}},this._setMessageDigestByEContent=function(e){var t=e.econtent,n=(e.econtent.type,t.content.hex);null==n&&"data"==t.type&&null!=t.content.str&&(n=fe(t.content.str));for(var r=e.sinfos,o=0;o<r.length;o++){var s=r[o],i=s.hashalg,a=this._getAttrParamByName(s,"messageDigest"),u=Y.crypto.Util.hashHex(n,i);a.hex=u}},this._getAttrParamByName=function(e,t){for(var n=e.sattrs.array,r=0;r<n.length;r++)if(n[r].attr==t)return n[r]},this._setSignerInfoVersion=function(e){for(var t=e.sinfos,n=0;n<t.length;n++){var r=t[n],o=1;"skid"==r.id.type&&(o=3),r.version=o}},this._setSignedDataVersion=function(e){var t=this._getSignedDataVersion(e);e.version=t},this._getSignedDataVersion=function(e){if(null!=e.revinfos)for(var t=e.revinfos,n=0;n<t.length;n++)if(null!=t[n].ocsp)return 5;var r=e.sinfos;for(n=0;n<r.length;n++)if(3==e.sinfos[n].version)return 3;return"data"!=e.econtent.type?3:1},this.getEncodedHex=function(){var e=this.params;null!=this.getEncodedHexPrepare&&this.getEncodedHexPrepare(),1!=e.fixed&&this.checkAndFixParam();var t=[];t.push(new n({int:e.version}));for(var s=[],u=0;u<e.hashalgs.length;u++){var h=e.hashalgs[u];s.push(new l({name:h}))}t.push(new r({array:s})),t.push(new i(e.econtent)),null!=e.certs&&t.push(new c(e.certs)),null!=e.revinfos&&t.push(new d(e.revinfos));var f=[];for(u=0;u<e.sinfos.length;u++){var m=e.sinfos[u];f.push(new a(m))}return t.push(new r({array:f})),new o({array:t}).getEncodedHex()},this.getContentInfo=function(){return new u({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.SignedData,Y.asn1.ASN1Object),Y.asn1.cms.CertificateSet=function(e){Y.asn1.cms.CertificateSet.superclass.constructor.call(this);var t=Error,n=Y.asn1,r=n.DERTaggedObject,o=n.DERSet,s=n.ASN1Object;this.params=null,this.getEncodedHex=function(){var e,n=this.params,i=[];if(n instanceof Array)e=n;else{if(null==n.array)throw new t("cert array not specified");e=n.array}for(var a=0;a<e.length;a++){var u=ve(e[a]),c=new s;c.hTLV=u,i.push(c)}var d={array:i};0==n.sortflag&&(d.sortflag=!1);var l=new o(d);return new r({tag:"a0",explicit:!1,obj:l}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.CertificateSet,Y.asn1.ASN1Object),Y.asn1.cms.RevocationInfoChoices=function(e){Y.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if(!e instanceof Array)throw new Error("params is not array");for(var t=[],n=0;n<e.length;n++)t.push(new Y.asn1.cms.RevocationInfoChoice(e[n]));return Y.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:t}}}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.RevocationInfoChoices,Y.asn1.ASN1Object),Y.asn1.cms.RevocationInfoChoice=function(e){Y.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if(null!=e.crl&&"string"==typeof e.crl){var t=e.crl;return-1!=e.crl.indexOf("-----BEGIN")&&(t=ve(e.crl)),t}if(null!=e.ocsp)return Y.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new Y.asn1.cms.OtherRevocationFormat(e)}}).getEncodedHex();throw new Error("property crl or ocsp undefined")},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.RevocationInfoChoice,Y.asn1.ASN1Object),Y.asn1.cms.OtherRevocationFormat=function(e){Y.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var t=Error,n=Y,r=n.asn1.ASN1Util.newObject,o=n.lang.String.isHex;this.params=null,this.getEncodedHex=function(){var e=this.params;if(null==e.ocsp)throw new t("property ocsp not specified");if(!o(e.ocsp)||!te.isASN1HEX(e.ocsp))throw new t("ocsp value not ASN.1 hex string");return r({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:e.ocsp}}]}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cms.OtherRevocationFormat,Y.asn1.ASN1Object),Y.asn1.cms.CMSUtil=new function(){},Y.asn1.cms.CMSUtil.newSignedData=function(e){return new Y.asn1.cms.SignedData(e)},Y.asn1.cms.CMSUtil.verifySignedData=function(e){var t=Y,n=t.asn1,r=n.cms,o=(r.SignerInfo,r.SignedData,r.SigningTime,r.SigningCertificate,r.SigningCertificateV2,n.cades.SignaturePolicyIdentifier,t.lang.String.isHex),s=te,i=s.getVbyList,a=s.getTLVbyList,u=s.getIdxbyList,c=s.getChildIdx,d=s.getTLV,l=s.oidname,h=t.crypto.Util.hashHex;void 0===e.cms&&o(e.cms);var f=e.cms,m=function(e,t){var n=t.idx;t.signerid_issuer1=a(e,n,[1,0],"30"),t.signerid_serial1=i(e,n,[1,1],"02"),t.hashalg=l(i(e,n,[2,0],"06"));var r=u(e,n,[3],"a0");t.idxSignedAttrs=r,p(e,t,r);var o=c(e,n).length;if(o<6)throw"malformed SignerInfo";t.sigalg=l(i(e,n,[o-2,0],"06")),t.sigval=i(e,n,[o-1],"04")},p=function(e,t,n){var r=c(e,n);t.signedAttrIdxList=r;for(var o=0;o<r.length;o++){var s,a=r[o],u=i(e,a,[0],"06");"2a864886f70d010905"===u?(s=le(i(e,a,[1,0])),t.saSigningTime=s):"2a864886f70d010904"===u&&(s=i(e,a,[1,0],"04"),t.saMessageDigest=s)}},g=function(e,t,n,r){n.verifyDetail={};var o=n.verifyDetail,s=t.parse.econtent,i=n.hashalg,a=n.saMessageDigest;o.validMessageDigest=!1,h(s,i)===a&&(o.validMessageDigest=!0),function(e,t,n,r){var o,s=t.parse.certsIdx;if(void 0===t.certs){o=[],t.certkeys=[];for(var i=c(e,s),a=0;a<i.length;a++){var u=d(e,i[a]),l=new Be;l.readCertHex(u),o[a]=l,t.certkeys[a]=l.getPublicKey()}t.certs=o}else o=t.certs;for(t.cccc=o.length,t.cccci=i.length,a=0;a<o.length;a++){var h=l.getIssuerHex(),f=l.getSerialNumberHex();n.signerid_issuer1===h&&n.signerid_serial1===f&&(n.certkey_idx=a)}}(e,t,n),o.validSignatureValue=!1;var u=n.sigalg,l="31"+d(e,n.idxSignedAttrs).substr(2);n.signedattrshex=l;var f=t.certs[n.certkey_idx].getPublicKey(),m=new Y.crypto.Signature({alg:u});m.init(f),m.updateHex(l);var p=m.verify(n.sigval);o.validSignatureValue_isValid=p,!0===p&&(o.validSignatureValue=!0),n.isValid=!1,o.validMessageDigest&&o.validSignatureValue&&(n.isValid=!0)},b={isValid:!1,parse:{}};return function(e,t){if("2a864886f70d010702"!==i(e,0,[0],"06"))return t;t.cmsType="signedData",t.econtent=i(e,0,[1,0,2,1,0]),function(e,t){for(var n,r=3;r<6;r++)if(void 0!==(n=u(e,0,[1,0,r]))){var o=e.substr(n,2);"a0"===o&&(t.certsIdx=n),"a1"===o&&(t.revinfosIdx=n),"31"===o&&(t.signerinfosIdx=n)}}(e,t),t.signerInfos=[],function(e,t){var n=t.signerinfosIdx;if(void 0!==n){var r=c(e,n);t.signerInfoIdxList=r;for(var o=0;o<r.length;o++){var s={idx:r[o]};m(e,s),t.signerInfos.push(s)}}}(e,t)}(f,b.parse),function(e,t){for(var n=t.parse.signerInfos,r=n.length,o=!0,s=0;s<r;s++){var i=n[s];g(e,t,i),i.isValid||(o=!1)}t.isValid=o}(f,b),b},Y.asn1.cms.CMSParser=function(){var e=Error,t=Be,n=new t,r=te,o=r.getV,s=r.getTLV,i=(r.getIdxbyList,r.getTLVbyList),a=r.getTLVbyListEx,u=r.getVbyList,c=r.getVbyListEx,d=r.getChildIdx;this.getCMSSignedData=function(e){var t=i(e,0,[1,0]);return this.getSignedData(t)},this.getSignedData=function(e){var t=d(e,0),n={},r=o(e,t[0]),i=parseInt(r,16);n.version=i;var u=s(e,t[1]);n.hashalgs=this.getHashAlgArray(u);var c=s(e,t[2]);n.econtent=this.getEContent(c);var l=a(e,0,["[0]"]);null!=l&&(n.certs=this.getCertificateSet(l)),a(e,0,["[1]"]);var h=a(e,0,[3]);return n.sinfos=this.getSignerInfos(h),n},this.getHashAlgArray=function(e){for(var n=d(e,0),r=new t,o=[],i=0;i<n.length;i++){var a=s(e,n[i]),u=r.getAlgorithmIdentifierName(a);o.push(u)}return o},this.getEContent=function(e){var t={},n=u(e,0,[0]),r=u(e,0,[1,0]);return t.type=Y.asn1.x509.OID.oid2name(te.hextooidstr(n)),t.content={hex:r},t},this.getSignerInfos=function(e){for(var t=[],n=d(e,0),r=0;r<n.length;r++){var o=s(e,n[r]),i=this.getSignerInfo(o);t.push(i)}return t},this.getSignerInfo=function(e){var t={},o=d(e,0),i=r.getInt(e,o[0],-1);-1!=i&&(t.version=i);var u=s(e,o[1]),l=this.getIssuerAndSerialNumber(u);t.id=l;var h=s(e,o[2]),f=n.getAlgorithmIdentifierName(h);t.hashalg=f;var m=a(e,0,["[0]"]);if(null!=m){var p=this.getAttributeList(m);t.sattrs=p}var g=a(e,0,[3]),b=n.getAlgorithmIdentifierName(g);t.sigalg=b;var v=c(e,0,[4]);t.sighex=v;var y=a(e,0,["[1]"]);if(null!=y){var _=this.getAttributeList(y);t.uattrs=_}return t},this.getSignerIdentifier=function(e){if("30"==e.substr(0,2))return this.getIssuerAndSerialNumber(e);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(e){var t={type:"isssn"},r=d(e,0),i=s(e,r[0]);t.issuer=n.getX500Name(i);var a=o(e,r[1]);return t.serial={hex:a},t},this.getAttributeList=function(e){for(var t=[],n=d(e,0),r=0;r<n.length;r++){var o=s(e,n[r]),i=this.getAttribute(o);t.push(i)}return{array:t}},this.getAttribute=function(e){var t={},n=d(e,0),o=r.getOID(e,n[0]),i=Y.asn1.x509.OID.oid2name(o);t.attr=i;var a=s(e,n[1]),u=d(a,0);if(1==u.length)t.valhex=s(a,u[0]);else{for(var c=[],l=0;l<u.length;l++)c.push(s(a,u[l]));t.valhex=c}return"contentType"==i?this.setContentType(t):"messageDigest"==i?this.setMessageDigest(t):"signingTime"==i?this.setSigningTime(t):"signingCertificate"==i?this.setSigningCertificate(t):"signingCertificateV2"==i?this.setSigningCertificateV2(t):"signaturePolicyIdentifier"==i&&this.setSignaturePolicyIdentifier(t),t},this.setContentType=function(e){var t=r.getOIDName(e.valhex,0,null);null!=t&&(e.type=t,delete e.valhex)},this.setSigningTime=function(e){var t=le(o(e.valhex,0));e.str=t,delete e.valhex},this.setMessageDigest=function(e){var t=o(e.valhex,0);e.hex=t,delete e.valhex},this.setSigningCertificate=function(e){var t=d(e.valhex,0);if(t.length>0){for(var n=s(e.valhex,t[0]),r=d(n,0),o=[],i=0;i<r.length;i++){var a=s(n,r[i]),u=this.getESSCertID(a);o.push(u)}e.array=o}if(t.length>1){var c=s(e.valhex,t[1]);e.polhex=c}delete e.valhex},this.setSignaturePolicyIdentifier=function(e){var n=d(e.valhex,0);if(n.length>0){var i=r.getOID(e.valhex,n[0]);e.oid=i}if(n.length>1){var a=new t,u=d(e.valhex,n[1]),c=s(e.valhex,u[0]),l=a.getAlgorithmIdentifierName(c);e.alg=l;var h=o(e.valhex,u[1]);e.hash=h}delete e.valhex},this.setSigningCertificateV2=function(e){var t=d(e.valhex,0);if(t.length>0){for(var n=s(e.valhex,t[0]),r=d(n,0),o=[],i=0;i<r.length;i++){var a=s(n,r[i]),u=this.getESSCertIDv2(a);o.push(u)}e.array=o}if(t.length>1){var c=s(e.valhex,t[1]);e.polhex=c}delete e.valhex},this.getESSCertID=function(e){var t={},n=d(e,0);if(n.length>0){var r=o(e,n[0]);t.hash=r}if(n.length>1){var i=s(e,n[1]),a=this.getIssuerSerial(i);null!=a.serial&&(t.serial=a.serial),null!=a.issuer&&(t.issuer=a.issuer)}return t},this.getESSCertIDv2=function(t){var r={},i=d(t,0);if(i.length<1||3<i.length)throw new e("wrong number of elements");var a=0;if("30"==t.substr(i[0],2)){var u=s(t,i[0]);r.alg=n.getAlgorithmIdentifierName(u),a++}else r.alg="sha256";var c=o(t,i[a]);if(r.hash=c,i.length>a+1){var l=s(t,i[a+1]),h=this.getIssuerSerial(l);r.issuer=h.issuer,r.serial=h.serial}return r},this.getIssuerSerial=function(e){var t={},r=d(e,0),i=s(e,r[0]),a=n.getGeneralNames(i)[0].dn;t.issuer=a;var u=o(e,r[1]);return t.serial={hex:u},t},this.getCertificateSet=function(e){for(var t=d(e,0),n=[],r=0;r<t.length;r++){var o=s(e,t[r]);if("30"==o.substr(0,2)){var i=be(o,"CERTIFICATE");n.push(i)}}return{array:n,sortflag:!1}}},void 0!==Y&&Y||(Y={}),void 0!==Y.asn1&&Y.asn1||(Y.asn1={}),void 0!==Y.asn1.tsp&&Y.asn1.tsp||(Y.asn1.tsp={}),Y.asn1.tsp.TimeStampToken=function(e){var t=Y.asn1.tsp;t.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var e=new t.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=e.getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.tsp.TimeStampToken,Y.asn1.cms.SignedData),Y.asn1.tsp.TSTInfo=function(e){Error;var t=Y.asn1,n=t.DERSequence,r=t.DERInteger,o=t.DERBoolean,s=t.DERGeneralizedTime,i=t.DERObjectIdentifier,a=t.DERTaggedObject,u=t.tsp,c=u.MessageImprint,d=u.Accuracy,l=(t.x509.X500Name,t.x509.GeneralName);if(u.TSTInfo.superclass.constructor.call(this),this.dVersion=new r({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.getEncodedHex=function(){var e=[this.dVersion];if(null==this.dPolicy)throw new Error("policy shall be specified.");if(e.push(this.dPolicy),null==this.dMessageImprint)throw new Error("messageImprint shall be specified.");if(e.push(this.dMessageImprint),null==this.dSerial)throw new Error("serialNumber shall be specified.");if(e.push(this.dSerial),null==this.dGenTime)throw new Error("genTime shall be specified.");e.push(this.dGenTime),null!=this.dAccuracy&&e.push(this.dAccuracy),null!=this.dOrdering&&e.push(this.dOrdering),null!=this.dNonce&&e.push(this.dNonce),null!=this.dTsa&&e.push(this.dTsa);var t=new n({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e){if("string"==typeof e.policy){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new i({oid:e.policy})}void 0!==e.messageImprint&&(this.dMessageImprint=new c(e.messageImprint)),void 0!==e.serial&&(this.dSerial=new r(e.serial)),void 0!==e.genTime&&(this.dGenTime=new s(e.genTime)),void 0!==e.accuracy&&(this.dAccuracy=new d(e.accuracy)),void 0!==e.ordering&&1==e.ordering&&(this.dOrdering=new o),void 0!==e.nonce&&(this.dNonce=new r(e.nonce)),void 0!==e.tsa&&(this.dTsa=new a({tag:"a0",explicit:!0,obj:new l({dn:e.tsa})}))}},o.lang.extend(Y.asn1.tsp.TSTInfo,Y.asn1.ASN1Object),Y.asn1.tsp.Accuracy=function(e){var t=Y.asn1,n=t.ASN1Util.newObject;t.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];return null!=e.seconds&&"number"==typeof e.seconds&&t.push({int:e.seconds}),null!=e.millis&&"number"==typeof e.millis&&t.push({tag:{tagi:"80",obj:{int:e.millis}}}),null!=e.micros&&"number"==typeof e.micros&&t.push({tag:{tagi:"81",obj:{int:e.micros}}}),n({seq:t}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.tsp.Accuracy,Y.asn1.ASN1Object),Y.asn1.tsp.MessageImprint=function(e){var t=Y.asn1,n=t.DERSequence,r=t.DEROctetString,o=t.x509.AlgorithmIdentifier;t.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=new o({name:e.alg}),s=new r({hex:e.hash});return new n({array:[t,s]}).getEncodedHex()},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.tsp.MessageImprint,Y.asn1.ASN1Object),Y.asn1.tsp.TimeStampReq=function(e){var t=Y.asn1,n=t.DERSequence,r=t.DERInteger,o=t.DERBoolean,s=(t.ASN1Object,t.DERObjectIdentifier),i=t.tsp,a=i.MessageImprint;i.TimeStampReq.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];return t.push(new r({int:1})),e.messageImprint instanceof Y.asn1.ASN1Object?t.push(e.messageImprint):t.push(new a(e.messageImprint)),null!=e.policy&&t.push(new s(e.policy)),null!=e.nonce&&t.push(new r(e.nonce)),1==e.certreq&&t.push(new o),new n({array:t}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.tsp.TimeStampReq,Y.asn1.ASN1Object),Y.asn1.tsp.TimeStampResp=function(e){var t=Y.asn1,n=t.DERSequence,r=(t.ASN1Object,t.tsp),o=r.PKIStatusInfo;r.TimeStampResp.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,s=[new o(e.statusinfo)];return null!=e.econtent&&s.push(new r.TimeStampToken(e).getContentInfo()),null!=e.tst&&e.tst instanceof t.ASN1Object&&s.push(e.tst),new n({array:s}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.tsp.TimeStampResp,Y.asn1.ASN1Object),Y.asn1.tsp.PKIStatusInfo=function(e){var t=Error,n=Y.asn1,r=n.DERSequence,o=n.tsp,s=o.PKIStatus,i=o.PKIFreeText,a=o.PKIFailureInfo;o.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,n=[];if("string"==typeof e)n.push(new s(e));else{if(null==e.status)throw new t("property 'status' unspecified");n.push(new s(e.status)),null!=e.statusstr&&n.push(new i(e.statusstr)),null!=e.failinfo&&n.push(new a(e.failinfo))}return new r({array:n}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.tsp.PKIStatusInfo,Y.asn1.ASN1Object),Y.asn1.tsp.PKIStatus=function(e){var t=Error,n=Y.asn1,r=n.DERInteger;n.tsp.PKIStatus.superclass.constructor.call(this);var o={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.getEncodedHex=function(){var e,n=this.params;if("string"==typeof n)try{e=o[n]}catch(e){throw new t("undefined name: "+n)}else{if("number"!=typeof n)throw new t("unsupported params");e=n}return new r({int:e}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.tsp.PKIStatus,Y.asn1.ASN1Object),Y.asn1.tsp.PKIFreeText=function(e){var t=Error,n=Y.asn1,r=n.DERSequence,o=n.DERUTF8String;n.tsp.PKIFreeText.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if(!e instanceof Array)throw new t("wrong params: not array");for(var n=[],s=0;s<e.length;s++)n.push(new o({str:e[s]}));return new r({array:n}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.tsp.PKIFreeText,Y.asn1.ASN1Object),Y.asn1.tsp.PKIFailureInfo=function(e){var t=Error,n=Y.asn1,r=n.DERBitString,o=n.tsp.PKIFailureInfo,s={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};o.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e,n=this.params;if("string"==typeof n)try{e=s[n]}catch(e){throw new t("undefined name: "+n)}else{if("number"!=typeof n)throw new t("wrong params");e=n}return new r({bin:e.toString(2)}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.tsp.PKIFailureInfo,Y.asn1.ASN1Object),Y.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(e,t){throw"not implemented yet"}},Y.asn1.tsp.SimpleTSAAdapter=function(e){var t=Y,n=t.asn1.tsp,r=t.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(e,t){var o=r(e,t);this.params.econtent.content.messageImprint={alg:t,hash:o},this.params.econtent.content.serial={int:this.serial++};var s=Math.floor(1e9*Math.random());return this.params.econtent.content.nonce={int:s},new n.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},o.lang.extend(Y.asn1.tsp.SimpleTSAAdapter,Y.asn1.tsp.AbstractTSAAdapter),Y.asn1.tsp.FixedTSAAdapter=function(e){var t=Y,n=t.asn1.tsp,r=t.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(e,t){var o=r(e,t);return this.params.econtent.content.messageImprint={alg:t,hash:o},new n.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},o.lang.extend(Y.asn1.tsp.FixedTSAAdapter,Y.asn1.tsp.AbstractTSAAdapter),Y.asn1.tsp.TSPUtil=new function(){},Y.asn1.tsp.TSPUtil.newTimeStampToken=function(e){return new Y.asn1.tsp.TimeStampToken(e)},Y.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){var t=te,n=t.getChildIdx,r=t.getV,o=t.getTLV,s={certreq:!1},i=n(e,0);if(i.length<2)throw"TimeStampReq must have at least 2 items";var a=o(e,i[1]);s.messageImprint=Y.asn1.tsp.TSPUtil.parseMessageImprint(a);for(var u=2;u<i.length;u++){var c=i[u],d=e.substr(c,2);if("06"==d){var l=r(e,c);s.policy=t.hextooidstr(l)}"02"==d&&(s.nonce=r(e,c)),"01"==d&&(s.certreq=!0)}return s},Y.asn1.tsp.TSPUtil.parseMessageImprint=function(e){var t=te,n=t.getChildIdx,r=t.getV,o=t.getIdxbyList,s={};if("30"!=e.substr(0,2))throw"head of messageImprint hex shall be '30'";n(e,0);var i=r(e,o(e,0,[0,0])),a=t.hextooidstr(i),u=Y.asn1.x509.OID.oid2name(a);if(""==u)throw"hashAlg name undefined: "+a;var c=u,d=o(e,0,[1]);return s.alg=c,s.hash=r(e,d),s},Y.asn1.tsp.TSPParser=function(){Error;var e=new Be,t=te,n=t.getV,r=t.getTLV,o=t.getIdxbyList,s=(t.getTLVbyListEx,t.getChildIdx),i=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],a={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(e){var t=s(e,0);if(1==t.length)return this.getPKIStatusInfo(r(e,t[0]));if(t.length>1){var n=this.getPKIStatusInfo(r(e,t[0])),o=r(e,t[1]),i=this.getToken(o);return i.statusinfo=n,i}},this.getToken=function(e){var t=(new Y.asn1.cms.CMSParser).getCMSSignedData(e);return this.setTSTInfo(t),t},this.setTSTInfo=function(e){var t=e.econtent;if("tstinfo"==t.type){var n=t.content.hex,r=this.getTSTInfo(n);t.content=r}},this.getTSTInfo=function(t){var o={},i=s(t,0),a=n(t,i[1]);o.policy=Ne(a);var u=r(t,i[2]);o.messageImprint=this.getMessageImprint(u);var c=n(t,i[3]);o.serial={hex:c};var d=n(t,i[4]);o.genTime={str:le(d)};var l=0;if(i.length>5&&"30"==t.substr(i[5],2)){var h=r(t,i[5]);o.accuracy=this.getAccuracy(h),l++}if(i.length>5+l&&"01"==t.substr(i[5+l],2)&&("ff"==n(t,i[5+l])&&(o.ordering=!0),l++),i.length>5+l&&"02"==t.substr(i[5+l],2)){var f=n(t,i[5+l]);o.nonce={hex:f},l++}if(i.length>5+l&&"a0"==t.substr(i[5+l],2)){var m=r(t,i[5+l]);m="30"+m.substr(2),pGeneralNames=e.getGeneralNames(m);var p=pGeneralNames[0].dn;o.tsa=p,l++}if(i.length>5+l&&"a1"==t.substr(i[5+l],2)){var g=r(t,i[5+l]);g="30"+g.substr(2);var b=e.getExtParamArray(g);o.ext=b,l++}return o},this.getAccuracy=function(e){for(var t={},r=s(e,0),o=0;o<r.length;o++){var i=e.substr(r[o],2),a=n(e,r[o]),u=parseInt(a,16);"02"==i?t.seconds=u:"80"==i?t.millis=u:"81"==i&&(t.micros=u)}return t},this.getMessageImprint=function(e){if("30"!=e.substr(0,2))throw new Error("head of messageImprint hex shall be x30");var r={},i=(s(e,0),o(e,0,[0,0])),a=n(e,i),u=t.hextooidstr(a),c=Y.asn1.x509.OID.oid2name(u);if(""==c)throw new Error("hashAlg name undefined: "+u);var d=c,l=o(e,0,[1]);return r.alg=d,r.hash=n(e,l),r},this.getPKIStatusInfo=function(e){var t={},o=s(e,0),a=0;try{var u=n(e,o[0]),c=parseInt(u,16);t.status=i[c]}catch(e){}if(o.length>1&&"30"==e.substr(o[1],2)){var d=r(e,o[1]);t.statusstr=this.getPKIFreeText(d),a++}if(o.length>a&&"03"==e.substr(o[1+a],2)){var l=r(e,o[1+a]);t.failinfo=this.getPKIFailureInfo(l)}return t},this.getPKIFreeText=function(e){for(var n=[],r=s(e,0),o=0;o<r.length;o++)n.push(t.getString(e,r[o]));return n},this.getPKIFailureInfo=function(e){var n=t.getInt(e,0);return null!=a[n]?a[n]:n}},void 0!==Y&&Y||(Y={}),void 0!==Y.asn1&&Y.asn1||(Y.asn1={}),void 0!==Y.asn1.cades&&Y.asn1.cades||(Y.asn1.cades={}),Y.asn1.cades.SignaturePolicyIdentifier=function(e){var t=Y.asn1.cades,n=t.SignaturePolicyId;t.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new n(this.params)]},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cades.SignaturePolicyIdentifier,Y.asn1.cms.Attribute),Y.asn1.cades.SignaturePolicyId=function(e){var t=Y.asn1,n=t.DERSequence,r=t.DERObjectIdentifier,o=(t.x509.AlgorithmIdentifier,t.cades),s=o.SignaturePolicyId,i=o.OtherHashAlgAndValue;s.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];return t.push(new r(e.oid)),t.push(new i(e)),new n({array:t}).getEncodedHex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cades.SignaturePolicyId,Y.asn1.ASN1Object),Y.asn1.cades.OtherHashAlgAndValue=function(e){var t=Error,n=Y.asn1,r=n.DERSequence,o=n.DEROctetString,s=n.x509.AlgorithmIdentifier;n.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if(null==e.alg)throw new t("property 'alg' not specified");if(null==e.hash&&null==e.cert)throw new t("property 'hash' nor 'cert' not specified");var n=null;if(null!=e.hash)n=e.hash;else if(null!=e.cert){if("string"!=typeof e.cert)throw new t("cert not string");var i=e.cert;-1!=e.cert.indexOf("-----BEGIN")&&(i=ve(e.cert)),n=Y.crypto.Util.hashHex(i,e.alg)}var a=[];return a.push(new s({name:e.alg})),a.push(new o({hex:n})),new r({array:a}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cades.OtherHashAlgAndValue,Y.asn1.ASN1Object),Y.asn1.cades.OtherHashValue=function(e){Y.asn1.cades.OtherHashValue.superclass.constructor.call(this);var t=Error,n=Y,r=(n.lang.String.isHex,n.asn1.DEROctetString);n.crypto.Util.hashHex,this.params=null,this.getEncodedHex=function(){var e=this.params;if(null==e.hash&&null==e.cert)throw new t("hash or cert not specified");var n=null;if(null!=e.hash)n=e.hash;else if(null!=e.cert){if("string"!=typeof e.cert)throw new t("cert not string");var o=e.cert;-1!=e.cert.indexOf("-----BEGIN")&&(o=ve(e.cert)),n=Y.crypto.Util.hashHex(o,"sha1")}return new r({hex:n}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cades.OtherHashValue,Y.asn1.ASN1Object),Y.asn1.cades.SignatureTimeStamp=function(e){var t=Error,n=Y,r=n.lang.String.isHex,o=n.asn1,s=o.ASN1Object;o.x509,o.cades.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var e=this.params;if(null!=e.tst){if(r(e.tst))return(n=new s).hTLV=e.tst,[n];if(e.tst instanceof s)return[e.tst];throw new t("params.tst has wrong value")}if(null!=e.res){var n,o=e.res;if(o instanceof s&&(o=o.getEncodedHex()),"string"!=typeof o||!r(o))throw new t("params.res has wrong value");return te.getTLVbyList(o,0,[1]),(n=new s).hTLV=e.tst,[n]}},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cades.SignatureTimeStamp,Y.asn1.cms.Attribute),Y.asn1.cades.CompleteCertificateRefs=function(e){var t=Error,n=Y,r=n.asn1,o=r.DERSequence,s=r.cades,i=s.OtherCertID,a=n.lang.String.isHex;s.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var e=this.params,n=[],r=0;r<e.array.length;r++){var s=e.array[r];if("string"==typeof s)if(-1!=s.indexOf("-----BEGIN"))s={cert:s};else{if(!a(s))throw new t("unsupported value: "+s);s={hash:s}}null!=e.alg&&null==s.alg&&(s.alg=e.alg),null!=e.hasis&&null==s.hasis&&(s.hasis=e.hasis);var u=new i(s);n.push(u)}return[new o({array:n})]},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cades.CompleteCertificateRefs,Y.asn1.cms.Attribute),Y.asn1.cades.OtherCertID=function(e){var t=Y.asn1,n=t.DERSequence,r=t.cms.IssuerSerial,o=t.cades,s=o.OtherHashValue,i=o.OtherHashAlgAndValue;o.OtherCertID.superclass.constructor.call(this),this.params=e,this.getEncodedHex=function(){var e=this.params;"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?e={cert:e}:_isHex(e)&&(e={hash:e}));var t,o=[];if(t=null!=e.alg?new i(e):new s(e),o.push(t),null!=e.cert&&1==e.hasis||null!=e.issuer&&null!=e.serial){var a=new r(e);o.push(a)}return new n({array:o}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cades.OtherCertID,Y.asn1.ASN1Object),Y.asn1.cades.OtherHash=function(e){Error;var t=Y,n=t.asn1,r=(n.cms,n.cades),o=r.OtherHashAlgAndValue,s=r.OtherHashValue,i=(t.crypto.Util.hashHex,t.lang.String.isHex);r.OtherHash.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;return"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?e={cert:e}:i(e)&&(e={hash:e})),(null!=e.alg?new o(e):new s(e)).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.cades.OtherHash,Y.asn1.ASN1Object),Y.asn1.cades.CAdESUtil=new function(){},Y.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){return(new Y.asn1.cms.CMSParser).getCMSSignedData(e)},Y.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,n){var r=te,o=r.getChildIdx,s=r.getTLV,i=r.getV,a=Y.asn1,u=a.ASN1Object,c=a.cms,d=c.AttributeList,l=c.SignerInfo,h={},f=o(e,t);if(6!=f.length)throw"not supported items for SignerInfo (!=6)";var m=f.shift();h.version=s(e,m);var p=f.shift();h.si=s(e,p);var g=f.shift();h.digalg=s(e,g);var b=f.shift();h.sattrs=s(e,b);var v=f.shift();h.sigalg=s(e,v);var y=f.shift();h.sig=s(e,y),h.sigval=i(e,y);var _=null;return h.obj=new l,(_=new u).hTLV=h.version,h.obj.dCMSVersion=_,(_=new u).hTLV=h.si,h.obj.dSignerIdentifier=_,(_=new u).hTLV=h.digalg,h.obj.dDigestAlgorithm=_,(_=new u).hTLV=h.sattrs,h.obj.dSignedAttrs=_,(_=new u).hTLV=h.sigalg,h.obj.dSigAlg=_,(_=new u).hTLV=h.sig,h.obj.dSig=_,h.obj.dUnsignedAttrs=new d,h},void 0!==Y.asn1.csr&&Y.asn1.csr||(Y.asn1.csr={}),Y.asn1.csr.CertificationRequest=function(e){var t=Y.asn1,n=t.DERBitString,r=t.DERSequence,o=t.csr,s=(t.x509,o.CertificationRequestInfo);o.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(e){this.params=e},this.sign=function(){var e=new s(this.params).getEncodedHex(),t=new Y.crypto.Signature({alg:this.params.sigalg});t.init(this.params.sbjprvkey),t.updateHex(e);var n=t.sign();this.params.sighex=n},this.getPEM=function(){return be(this.getEncodedHex(),"CERTIFICATE REQUEST")},this.getEncodedHex=function(){var e=this.params,t=new Y.asn1.csr.CertificationRequestInfo(this.params),o=new Y.asn1.x509.AlgorithmIdentifier({name:e.sigalg});if(null==e.sighex&&null!=e.sbjprvkey&&this.sign(),null==e.sighex)throw new Error("sighex or sbjprvkey parameter not defined");var s=new n({hex:"00"+e.sighex});return new r({array:[t,o,s]}).getEncodedHex()},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.csr.CertificationRequest,Y.asn1.ASN1Object),Y.asn1.csr.CertificationRequestInfo=function(e){var t=Y.asn1,n=(t.DERBitString,t.DERSequence),r=t.DERInteger,o=t.DERUTF8String,s=t.DERTaggedObject,i=t.ASN1Util.newObject,a=t.csr,u=t.x509,c=u.X500Name,d=u.Extensions,l=u.SubjectPublicKeyInfo;a.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(e){null!=e&&(this.params=e)},this.getEncodedHex=function(){var e=this.params,t=[];if(t.push(new r({int:0})),t.push(new c(e.subject)),t.push(new l(Pe.getKey(e.sbjpubkey))),null!=e.extreq){var a=new d(e.extreq),u=i({tag:{tag:"a0",explict:!0,obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[a]}]}}});t.push(u)}else t.push(new s({tag:"a0",explicit:!1,obj:new o({str:""})}));return new n({array:t}).getEncodedHex()},null!=e&&this.setByParam(e)},o.lang.extend(Y.asn1.csr.CertificationRequestInfo,Y.asn1.ASN1Object),Y.asn1.csr.CSRUtil=new function(){},Y.asn1.csr.CSRUtil.newCSRPEM=function(e){return new Y.asn1.csr.CertificationRequest(e).getPEM()},Y.asn1.csr.CSRUtil.getParam=function(e){var t=te,n=t.getV;_getIdxbyList=t.getIdxbyList,_getTLVbyList=t.getTLVbyList,_getTLVbyListEx=t.getTLVbyListEx,_getVbyListEx=t.getVbyListEx;var r={};if(-1==e.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw new Error("argument is not PEM file");var o=ve(e,"CERTIFICATE REQUEST");try{var s=_getTLVbyListEx(o,0,[0,1]);if("3000"==s)r.subject={};else{var i=new Be;r.subject=i.getX500Name(s)}}catch(e){}var a=_getTLVbyListEx(o,0,[0,2]),u=Pe.getKey(a,null,"pkcs8pub");r.sbjpubkey=Pe.getPEM(u,"PKCS8PUB");var c=function(e){var t=_getIdxbyList(e,0,[0,3,0,0],"06");return"2a864886f70d01090e"!=n(e,t)?null:_getTLVbyList(e,0,[0,3,0,1,0],"30")}(o);i=new Be,null!=c&&(r.extreq=i.getExtParamArray(c));try{var d=_getTLVbyListEx(o,0,[1],"30");i=new Be,r.sigalg=i.getAlgorithmIdentifierName(d)}catch(e){}try{var l=_getVbyListEx(o,0,[2]);r.sighex=l}catch(e){}return r},void 0!==Y&&Y||(Y={}),void 0!==Y.asn1&&Y.asn1||(Y.asn1={}),void 0!==Y.asn1.ocsp&&Y.asn1.ocsp||(Y.asn1.ocsp={}),Y.asn1.ocsp.DEFAULT_HASH="sha1",Y.asn1.ocsp.OCSPResponse=function(e){Y.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),Y.asn1.DEREnumerated;var t=Y.asn1.ASN1Util.newObject,n=Y.asn1.ocsp.ResponseBytes,r=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var e=this.params.resstatus;return"number"==typeof e?e:"string"!=typeof e?-1:r.indexOf(e)},this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e=this.params,r=this._getStatusCode();if(-1==r)throw new Error("responseStatus not supported: "+e.resstatus);if(0!=r)return t({seq:[{enum:{int:r}}]}).getEncodedHex();var o=new n(e);return t({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:o}}]}).getEncodedHex()},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.ocsp.OCSPResponse,Y.asn1.ASN1Object),Y.asn1.ocsp.ResponseBytes=function(e){Y.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var t=Y.asn1,n=t.DERSequence,r=t.DERObjectIdentifier,o=t.DEROctetString,s=t.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e=this.params;if("ocspBasic"!=e.restype)throw new Error("not supported responseType: "+e.restype);var t=new s(e),i=[];return i.push(new r({name:"ocspBasic"})),i.push(new o({hex:t.getEncodedHex()})),new n({array:i}).getEncodedHex()},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.ocsp.ResponseBytes,Y.asn1.ASN1Object),Y.asn1.ocsp.BasicOCSPResponse=function(e){Y.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var t=Error,n=Y.asn1,r=n.ASN1Object,o=n.DERSequence,s=(n.DERGeneralizedTime,n.DERTaggedObject),i=n.DERBitString,a=(n.x509.Extensions,n.x509.AlgorithmIdentifier),u=n.ocsp;u.ResponderID,_SingleResponseList=u.SingleResponseList,_ResponseData=u.ResponseData,this.params=null,this.setByParam=function(e){this.params=e},this.sign=function(){var e=this.params,t=e.tbsresp.getEncodedHex(),n=new Y.crypto.Signature({alg:e.sigalg});n.init(e.reskey),n.updateHex(t),e.sighex=n.sign()},this.getEncodedHex=function(){var e=this.params;null==e.tbsresp&&(e.tbsresp=new _ResponseData(e)),null==e.sighex&&null!=e.reskey&&this.sign();var n=[];if(n.push(e.tbsresp),n.push(new a({name:e.sigalg})),n.push(new i({hex:"00"+e.sighex})),null!=e.certs&&null!=e.certs.length){for(var u=[],c=0;c<e.certs.length;c++){var d=e.certs[c],l=null;if(te.isASN1HEX(d))l=d;else{if(!d.match(/-----BEGIN/))throw new t("certs["+c+"] not hex or PEM");l=ve(d)}u.push(new r({tlv:l}))}var h=new o({array:u});n.push(new s({tag:"a0",explicit:!0,obj:h}))}return new o({array:n}).getEncodedHex()},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.ocsp.BasicOCSPResponse,Y.asn1.ASN1Object),Y.asn1.ocsp.ResponseData=function(e){Y.asn1.ocsp.ResponseData.superclass.constructor.call(this);var t=Error,n=Y.asn1,r=n.DERSequence,o=n.DERGeneralizedTime,s=n.DERTaggedObject,i=n.x509.Extensions,a=n.ocsp,u=a.ResponderID;_SingleResponseList=a.SingleResponseList,this.params=null,this.getEncodedHex=function(){var e=this.params;null!=e.respid&&new t("respid not specified"),null!=e.prodat&&new t("prodat not specified"),null!=e.array&&new t("array not specified");var n=[];if(n.push(new u(e.respid)),n.push(new o(e.prodat)),n.push(new _SingleResponseList(e.array)),null!=e.ext){var a=new i(e.ext);n.push(new s({tag:"a1",explicit:!0,obj:a}))}return new r({array:n}).getEncodedHex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.ocsp.ResponseData,Y.asn1.ASN1Object),Y.asn1.ocsp.ResponderID=function(e){Y.asn1.ocsp.ResponderID.superclass.constructor.call(this);var t=Y.asn1,n=t.ASN1Util.newObject,r=t.x509.X500Name;this.params=null,this.getEncodedHex=function(){var e=this.params;if(null!=e.key)return n({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:e.key}}}}).getEncodedHex();if(null!=e.name)return n({tag:{tag:"a1",explicit:!0,obj:new r(e.name)}}).getEncodedHex();throw new Error("key or name not specified")},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.ocsp.ResponderID,Y.asn1.ASN1Object),Y.asn1.ocsp.SingleResponseList=function(e){Y.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var t=Y.asn1,n=t.DERSequence,r=t.ocsp.SingleResponse;this.params=null,this.getEncodedHex=function(){var e=this.params;if("object"!=typeof e||null==e.length)throw new Error("params not specified properly");for(var t=[],o=0;o<e.length;o++)t.push(new r(e[o]));return new n({array:t}).getEncodedHex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.ocsp.SingleResponseList,Y.asn1.ASN1Object),Y.asn1.ocsp.SingleResponse=function(e){var t=Error,n=Y.asn1,r=n.DERSequence,o=n.DERGeneralizedTime,s=n.DERTaggedObject,i=n.ocsp,a=i.CertID,u=i.CertStatus,c=n.x509.Extensions;i.SingleResponse.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,n=[];if(null==e.certid)throw new t("certid unspecified");if(null==e.status)throw new t("status unspecified");if(null==e.thisupdate)throw new t("thisupdate unspecified");if(n.push(new a(e.certid)),n.push(new u(e.status)),n.push(new o(e.thisupdate)),null!=e.nextupdate){var i=new o(e.nextupdate);n.push(new s({tag:"a0",explicit:!0,obj:i}))}if(null!=e.ext){var d=new c(e.ext);n.push(new s({tag:"a1",explicit:!0,obj:d}))}return new r({array:n}).getEncodedHex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.ocsp.SingleResponse,Y.asn1.ASN1Object),Y.asn1.ocsp.CertID=function(e){var t=Y,n=t.asn1,r=n.DEROctetString,o=n.DERInteger,s=n.DERSequence,i=n.x509.AlgorithmIdentifier,a=n.ocsp,u=a.DEFAULT_HASH,c=t.crypto.Util.hashHex,d=Be,l=te;if(a.CertID.superclass.constructor.call(this),this.dHashAlg=null,this.dIssuerNameHash=null,this.dIssuerKeyHash=null,this.dSerialNumber=null,this.setByValue=function(e,t,n,s){void 0===s&&(s=u),this.dHashAlg=new i({name:s}),this.dIssuerNameHash=new r({hex:e}),this.dIssuerKeyHash=new r({hex:t}),this.dSerialNumber=new o({hex:n})},this.setByCert=function(e,t,n){void 0===n&&(n=u);var r=new d;r.readCertPEM(t);var o=new d;o.readCertPEM(e);var s=o.getPublicKeyHex(),i=l.getTLVbyList(s,0,[1,0],"30"),a=r.getSerialNumberHex(),h=c(o.getSubjectHex(),n),f=c(i,n);this.setByValue(h,f,a,n),this.hoge=r.getSerialNumberHex()},this.getEncodedHex=function(){if(null===this.dHashAlg&&null===this.dIssuerNameHash&&null===this.dIssuerKeyHash&&null===this.dSerialNumber)throw"not yet set values";var e=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],t=new s({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e){var h=e;if(void 0!==h.issuerCert&&void 0!==h.subjectCert){var f=u;void 0===h.alg&&(f=void 0),this.setByCert(h.issuerCert,h.subjectCert,f)}else{if(void 0===h.issname||void 0===h.isskey||void 0===h.sbjsn)throw new Error("invalid constructor arguments");f=u,void 0===h.alg&&(f=void 0),this.setByValue(h.issname,h.isskey,h.sbjsn,f)}}},o.lang.extend(Y.asn1.ocsp.CertID,Y.asn1.ASN1Object),Y.asn1.ocsp.CertStatus=function(e){Y.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if("good"==e.status)return"8000";if("unknown"==e.status)return"8200";if("revoked"==e.status){var t=[{gentime:{str:e.time}}];null!=e.reason&&t.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:e.reason}}}});var n={tag:"a1",explicit:!1,obj:{seq:t}};return Y.asn1.ASN1Util.newObject({tag:n}).getEncodedHex()}throw new Error("bad status")},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},o.lang.extend(Y.asn1.ocsp.CertStatus,Y.asn1.ASN1Object),Y.asn1.ocsp.Request=function(e){var t=Y.asn1,n=t.DERSequence,r=t.ocsp;if(r.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.getEncodedHex=function(){var e=[];if(null===this.dReqCert)throw"reqCert not set";e.push(this.dReqCert);var t=new n({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e){var o=new r.CertID(e);this.dReqCert=o}},o.lang.extend(Y.asn1.ocsp.Request,Y.asn1.ASN1Object),Y.asn1.ocsp.TBSRequest=function(e){var t=Y.asn1,n=t.DERSequence,r=t.ocsp;r.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(e){for(var t=[],n=0;n<e.length;n++){var o=new r.Request(e[0]);t.push(o)}this.dRequestList=t},this.getEncodedHex=function(){var e=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var t=new n({array:this.dRequestList});if(e.push(t),null!==this.dRequestExt)throw"requestExtensions not supported";var r=new n({array:e});return this.hTLV=r.getEncodedHex(),this.hTLV},void 0!==e&&void 0!==e.reqList&&this.setRequestListByParam(e.reqList)},o.lang.extend(Y.asn1.ocsp.TBSRequest,Y.asn1.ASN1Object),Y.asn1.ocsp.OCSPRequest=function(e){var t=Y.asn1,n=t.DERSequence,r=t.ocsp;if(r.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.getEncodedHex=function(){var e=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(e.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var t=new n({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e&&void 0!==e.reqList){var o=new r.TBSRequest(e);this.dTbsRequest=o}},o.lang.extend(Y.asn1.ocsp.OCSPRequest,Y.asn1.ASN1Object),Y.asn1.ocsp.OCSPUtil={},Y.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,n){var r=Y.asn1.ocsp;void 0===n&&(n=r.DEFAULT_HASH);var o={alg:n,issuerCert:e,subjectCert:t};return new r.OCSPRequest({reqList:[o]}).getEncodedHex()},Y.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=te,n=t.getVbyList,r=t.getVbyListEx,o=t.getIdxbyList,s=(t.getIdxbyListEx,t.getV),i={};try{var a=r(e,0,[0],"0a");i.responseStatus=parseInt(a,16)}catch(e){}if(0!==i.responseStatus)return i;try{var u=o(e,0,[1,0,1,0,0,2,0,1]);"80"===e.substr(u,2)?i.certStatus="good":"a1"===e.substr(u,2)?(i.certStatus="revoked",i.revocationTime=le(n(e,u,[0]))):"82"===e.substr(u,2)&&(i.certStatus="unknown")}catch(e){}try{var c=o(e,0,[1,0,1,0,0,2,0,2]);i.thisUpdate=le(s(e,c))}catch(e){}try{var d=o(e,0,[1,0,1,0,0,2,0,3]);"a0"===e.substr(d,2)&&(i.nextUpdate=le(n(e,d,[0])))}catch(e){}return i},Y.asn1.ocsp.OCSPParser=function(){var e=Error,t=Be,n=new t,r=te,o=r.getV,s=r.getTLV,i=r.getIdxbyList,a=r.getTLVbyListEx,u=r.getChildIdx;this.getOCSPRequest=function(t){var n=u(t,0);if(1!=n.length&&2!=n.length)throw new e("wrong number elements: "+n.length);return this.getTBSRequest(s(t,n[0]))},this.getTBSRequest=function(e){var t={},r=a(e,0,[0],"30");t.array=this.getRequestList(r);var o=a(e,0,["[2]",0],"30");return null!=o&&(t.ext=n.getExtParamArray(o)),t},this.getRequestList=function(e){for(var t=[],n=u(e,0),r=0;r<n.length;r++)e=s(e,n[r]),t.push(this.getRequest(e));return t},this.getRequest=function(t){var r=u(t,0);if(1!=r.length&&2!=r.length)throw new e("wrong number elements: "+r.length);var o=this.getCertID(s(t,r[0]));if(2==r.length){var a=i(t,0,[1,0]);o.ext=n.getExtParamArray(s(t,a))}return o},this.getCertID=function(n){var r=u(n,0);if(4!=r.length)throw new e("wrong number elements: "+r.length);var i=new t,a={};return a.alg=i.getAlgorithmIdentifierName(s(n,r[0])),a.issname=o(n,r[1]),a.isskey=o(n,r[2]),a.sbjsn=o(n,r[3]),a}},void 0!==Y&&Y||(Y={}),void 0!==Y.lang&&Y.lang||(Y.lang={}),Y.lang.String=function(){},"function"==typeof e?(Q=function(t){return ie(e.from(t,"utf8").toString("base64"))},ee=function(t){return e.from(ae(t),"base64").toString("utf8")}):(Q=function(e){return ue(we(xe(e)))},ee=function(e){return decodeURIComponent(ke(ce(e)))}),Y.lang.String.isInteger=function(e){return!!e.match(/^[0-9]+$/)||!!e.match(/^-[0-9]+$/)},Y.lang.String.isHex=function(e){return Oe(e)},Y.lang.String.isBase64=function(e){return!(!(e=e.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||e.length%4!=0)},Y.lang.String.isBase64URL=function(e){return!e.match(/[+/=]/)&&(e=ae(e),Y.lang.String.isBase64(e))},Y.lang.String.isIntegerArray=function(e){return!!(e=e.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},Y.lang.String.isPrintable=function(e){return null!==e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},Y.lang.String.isIA5=function(e){return null!==e.match(/^[\x20-\x21\x23-\x7f]*$/)},Y.lang.String.isMail=function(e){return null!==e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};var Te=function(e,t,n){return null==n&&(n="0"),e.length>=t?e:new Array(t-e.length+1).join(n)+e};function Fe(e){try{var t=e.substr(0,2);if("00"==t)return parseInt(e.substr(2),16);var n=parseInt(t,16),r=e.substr(2),o=parseInt(r,16).toString(2);return"0"==o&&(o="00000000"),o=o.slice(0,0-n),parseInt(o,2)}catch(e){return-1}}void 0!==Y&&Y||(Y={}),void 0!==Y.crypto&&Y.crypto||(Y.crypto={}),Y.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:s.algo.MD5,sha1:s.algo.SHA1,sha224:s.algo.SHA224,sha256:s.algo.SHA256,sha384:s.algo.SHA384,sha512:s.algo.SHA512,ripemd160:s.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(void 0===this.DIGESTINFOHEAD[t])throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,n){var r=this.getDigestInfoHex(e,t),o=n/4;if(r.length+22>o)throw"key is too short for SigAlg: keylen="+n+","+t;for(var s="0001",i="00"+r,a="",u=o-s.length-i.length,c=0;c<u;c+=2)a+="ff";return s+a+i},this.hashString=function(e,t){return new Y.crypto.MessageDigest({alg:t}).digestString(e)},this.hashHex=function(e,t){return new Y.crypto.MessageDigest({alg:t}).digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof W||e instanceof Y.crypto.DSA||e instanceof Y.crypto.ECDSA}},Y.crypto.Util.md5=function(e){return new Y.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(e)},Y.crypto.Util.ripemd160=function(e){return new Y.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(e)},Y.crypto.Util.SECURERANDOMGEN=new U,Y.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return Y.crypto.Util.SECURERANDOMGEN.nextBytes(t),oe(t)},Y.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new l(Y.crypto.Util.getRandomHexOfNbytes(e),16)},Y.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,n=new Array((e-t)/8+1);return Y.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<t&255^255)&n[0],oe(n)},Y.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new l(Y.crypto.Util.getRandomHexOfNbits(e),16)},Y.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var n=Y.crypto.Util.getRandomBigIntegerOfNbits(t);if(-1!=e.compareTo(n))return n}},Y.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var n=e.compareTo(t);if(1==n)throw"biMin is greater than biMax";if(0==n)return e;var r=t.subtract(e);return Y.crypto.Util.getRandomBigIntegerZeroToMax(r).add(e)},Y.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(e,t){if(null!==(e=Y.crypto.MessageDigest.getCanonicalAlgName(e))&&void 0===t&&(t=Y.crypto.Util.DEFAULTPROVIDER[e]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)&&"cryptojs"==t){try{this.md=Y.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=s.enc.Hex.parse(e);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(s.enc.Hex)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}if(-1!=":sha256:".indexOf(e)&&"sjcl"==t){try{this.md=new sjcl.hash.sha256}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=sjcl.codec.hex.toBits(e);this.md.update(t)},this.digest=function(){var e=this.md.finalize();return sjcl.codec.hex.fromBits(e)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==e&&void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=Y.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},Y.crypto.MessageDigest.getCanonicalAlgName=function(e){return"string"==typeof e&&(e=(e=e.toLowerCase()).replace(/-/,"")),e},Y.crypto.MessageDigest.getHashLength=function(e){var t=Y.crypto.MessageDigest,n=t.getCanonicalAlgName(e);if(void 0===t.HASHLENGTH[n])throw"not supported algorithm: "+e;return t.HASHLENGTH[n]},Y.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},Y.crypto.Mac=function(e){this.setAlgAndProvider=function(e,t){if(null==(e=e.toLowerCase())&&(e="hmacsha1"),"hmac"!=(e=e.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+e;void 0===t&&(t=Y.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+t;var n=e.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==t){try{var r=Y.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[n];this.mac=s.algo.HMAC.create(r,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+e}this.updateString=function(e){this.mac.update(e)},this.updateHex=function(e){var t=s.enc.Hex.parse(e);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(s.enc.Hex)},this.doFinalString=function(e){return this.updateString(e),this.doFinal()},this.doFinalHex=function(e){return this.updateHex(e),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if("string"==typeof e){var t=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(t=fe(e)),void(this.pass=s.enc.Hex.parse(t))}if("object"!=typeof e)throw"KJUR.crypto.Mac unsupported password type: "+e;if(t=null,void 0!==e.hex){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;t=e.hex}if(void 0!==e.utf8&&(t=de(e.utf8)),void 0!==e.rstr&&(t=fe(e.rstr)),void 0!==e.b64&&(t=c(e.b64)),void 0!==e.b64u&&(t=ce(e.b64u)),null==t)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=s.enc.Hex.parse(t)},void 0!==e&&(void 0!==e.pass&&this.setPassword(e.pass),void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=Y.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},Y.crypto.Signature=function(e){var t=null;if(this._setAlgNames=function(){var e=this.algName.match(/^(.+)with(.+)$/);e&&(this.mdAlgName=e[1].toLowerCase(),this.pubkeyAlgName=e[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(e,t){for(var n="",r=t/4-e.length,o=0;o<r;o++)n+="0";return n+e},this.setAlgAndProvider=function(e,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw new Error("provider not supported: "+t);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new Y.crypto.MessageDigest({alg:this.mdAlgName})}catch(e){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+e)}this.init=function(e,t){var n=null;try{n=void 0===t?Pe.getKey(e):Pe.getKey(e,t)}catch(e){throw"init failed:"+e}if(!0===n.isPrivate)this.prvKey=n,this.state="SIGN";else{if(!0!==n.isPublic)throw"init failed.:"+n;this.pubKey=n,this.state="VERIFY"}},this.updateString=function(e){this.md.updateString(e)},this.updateHex=function(e){this.md.updateHex(e)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==Y.crypto.ECDSA&&(this.prvKey=new Y.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof W&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof W&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof Y.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof Y.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(e){return this.updateString(e),this.sign()},this.signHex=function(e){return this.updateHex(e),this.sign()},this.verify=function(e){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==Y.crypto.ECDSA&&(this.pubKey=new Y.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof W&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,e,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof W&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==Y.crypto.ECDSA&&this.pubKey instanceof Y.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==Y.crypto.DSA&&this.pubKey instanceof Y.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(e,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(e){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(e){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(e){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(e){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,void 0!==e&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=Y.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{t=Pe.getKey(e.prvkeypem),this.init(t)}catch(e){throw"fatal error to load pem private key: "+e}}},Y.crypto.Cipher=function(e){},Y.crypto.Cipher.encrypt=function(e,t,n){if(t instanceof W&&t.isPublic){var r=Y.crypto.Cipher.getAlgByKeyAndName(t,n);if("RSA"===r)return t.encrypt(e);if("RSAOAEP"===r)return t.encryptOAEP(e,"sha1");var o=r.match(/^RSAOAEP(\d+)$/);if(null!==o)return t.encryptOAEP(e,"sha"+o[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.encrypt: unsupported key or algorithm"},Y.crypto.Cipher.decrypt=function(e,t,n){if(t instanceof W&&t.isPrivate){var r=Y.crypto.Cipher.getAlgByKeyAndName(t,n);if("RSA"===r)return t.decrypt(e);if("RSAOAEP"===r)return t.decryptOAEP(e,"sha1");var o=r.match(/^RSAOAEP(\d+)$/);if(null!==o)return t.decryptOAEP(e,"sha"+o[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.decrypt: unsupported key or algorithm"},Y.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof W){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t))return t;if(null==t)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t},Y.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==Y&&Y||(Y={}),void 0!==Y.crypto&&Y.crypto||(Y.crypto={}),Y.crypto.ECDSA=function(e){var t=Error,n=l,r=J,o=Y.crypto.ECDSA,s=Y.crypto.ECParameterDB,i=o.getName,a=te,u=a.getVbyListEx,c=a.isASN1HEX,d=new U;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){return new n(e.bitLength(),d).mod(e.subtract(n.ONE)).add(n.ONE)},this.setNamedCurve=function(e){this.ecparams=s.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keylen/4;if(e.length!==2+2*t)throw"malformed public key hex length";var n={};return n.x=e.substr(2,t),n.y=e.substr(2+t),n},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":null},this.generateKeyPairHex=function(){var e=this.ecparams.n,t=this.getBigRandom(e),n=this.ecparams.G.multiply(t),r=n.getX().toBigInteger(),o=n.getY().toBigInteger(),s=this.ecparams.keylen/4,i=("0000000000"+t.toString(16)).slice(-s),a="04"+("0000000000"+r.toString(16)).slice(-s)+("0000000000"+o.toString(16)).slice(-s);return this.setPrivateKeyHex(i),this.setPublicKeyHex(a),{ecprvhex:i,ecpubhex:a}},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var r=new n(t,16),s=this.ecparams.n,i=new n(e.substring(0,this.ecparams.keylen/4),16);do{var a=this.getBigRandom(s),u=this.ecparams.G.multiply(a).getX().toBigInteger().mod(s)}while(u.compareTo(n.ZERO)<=0);var c=a.modInverse(s).multiply(i.add(r.multiply(u))).mod(s);return o.biRSSigToASN1Sig(u,c)},this.sign=function(e,t){var r=t,o=this.ecparams.n,s=n.fromByteArrayUnsigned(e);do{var i=this.getBigRandom(o),a=this.ecparams.G.multiply(i).getX().toBigInteger().mod(o)}while(a.compareTo(l.ZERO)<=0);var u=i.modInverse(o).multiply(s.add(r.multiply(a))).mod(o);return this.serializeSig(a,u)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,s){try{var i,a,u=o.parseSigHex(t);i=u.r,a=u.s;var c=r.decodeFromHex(this.ecparams.curve,s),d=new n(e.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(d,i,a,c)}catch(e){return!1}},this.verify=function(e,t,o){var s,i,a;if(Bitcoin.Util.isArray(t)){var u=this.parseSig(t);s=u.r,i=u.s}else{if("object"!=typeof t||!t.r||!t.s)throw"Invalid value for signature";s=t.r,i=t.s}if(o instanceof J)a=o;else{if(!Bitcoin.Util.isArray(o))throw"Invalid format for pubkey value, must be byte array or ECPointFp";a=r.decodeFrom(this.ecparams.curve,o)}var c=n.fromByteArrayUnsigned(e);return this.verifyRaw(c,s,i,a)},this.verifyRaw=function(e,t,r,o){var s=this.ecparams.n,i=this.ecparams.G;if(t.compareTo(n.ONE)<0||t.compareTo(s)>=0)return!1;if(r.compareTo(n.ONE)<0||r.compareTo(s)>=0)return!1;var a=r.modInverse(s),u=e.multiply(a).mod(s),c=t.multiply(a).mod(s);return i.multiply(u).add(o.multiply(c)).getX().toBigInteger().mod(s).equals(t)},this.serializeSig=function(e,t){var n=e.toByteArraySigned(),r=t.toByteArraySigned(),o=[];return o.push(2),o.push(n.length),(o=o.concat(n)).push(2),o.push(r.length),(o=o.concat(r)).unshift(o.length),o.unshift(48),o},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(2!=e[t=2])throw new Error("First element in signature must be a DERInteger");var r=e.slice(t+2,t+2+e[t+1]);if(2!=e[t+=2+e[t+1]])throw new Error("Second element in signature must be a DERInteger");var o=e.slice(t+2,t+2+e[t+1]);return t+=2+e[t+1],{r:n.fromByteArrayUnsigned(r),s:n.fromByteArrayUnsigned(o)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||t>7)throw"Invalid signature type";var r=this.ecparams.n;return{r:n.fromByteArrayUnsigned(e.slice(1,33)).mod(r),s:n.fromByteArrayUnsigned(e.slice(33,65)).mod(r),i:t}},this.readPKCS5PrvKeyHex=function(e){if(!1===c(e))throw new Error("not ASN.1 hex string");var t,n,r;try{t=u(e,0,["[0]",0],"06"),n=u(e,0,[1],"04");try{r=u(e,0,["[1]",0],"03")}catch(e){}}catch(e){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=i(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(r),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){if(!1===c(e))throw new t("not ASN.1 hex string");var n,r,o;try{u(e,0,[1,0],"06"),n=u(e,0,[1,1],"06"),r=u(e,0,[2,0,1],"04");try{o=u(e,0,[2,0,"[1]",0],"03")}catch(e){}}catch(e){throw new t("malformed PKCS#8 plain ECC private key")}if(this.curveName=i(n),void 0===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(o),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){if(!1===c(e))throw new t("not ASN.1 hex string");var n,r;try{u(e,0,[0,0],"06"),n=u(e,0,[0,1],"06"),r=u(e,0,[1],"03")}catch(e){throw new t("malformed PKCS#8 ECC public key")}if(this.curveName=i(n),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(r)},this.readCertPubKeyHex=function(e,n){if(!1===c(e))throw new t("not ASN.1 hex string");var r,o;try{r=u(e,0,[0,5,0,1],"06"),o=u(e,0,[0,5,1],"03")}catch(e){throw new t("malformed X.509 certificate ECC public key")}if(this.curveName=i(r),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(o)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},Y.crypto.ECDSA.parseSigHex=function(e){var t=Y.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new l(t.r,16),s:new l(t.s,16)}},Y.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=te,n=t.getChildIdx,r=t.getV;if(t.checkStrictDER(e,0),"30"!=e.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var o=n(e,0);if(2!=o.length)throw new Error("signature shall have two elements");var s=o[0],i=o[1];if("02"!=e.substr(s,2))throw new Error("1st item not ASN.1 integer");if("02"!=e.substr(i,2))throw new Error("2nd item not ASN.1 integer");return{r:r(e,s),s:r(e,i)}},Y.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=Y.crypto.ECDSA.parseSigHexInHexRS(e),n=t.r,r=t.s;if("00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),"00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),n.length%32==30&&(n="00"+n),r.length%32==30&&(r="00"+r),n.length%32!=0)throw"unknown ECDSA sig r length error";if(r.length%32!=0)throw"unknown ECDSA sig s length error";return n+r},Y.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var t=e.substr(0,e.length/2),n=e.substr(e.length/2);return Y.crypto.ECDSA.hexRSSigToASN1Sig(t,n)},Y.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var n=new l(e,16),r=new l(t,16);return Y.crypto.ECDSA.biRSSigToASN1Sig(n,r)},Y.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var n=Y.asn1,r=new n.DERInteger({bigint:e}),o=new n.DERInteger({bigint:t});return new n.DERSequence({array:[r,o]}).getEncodedHex()},Y.crypto.ECDSA.getName=function(e){return"2b8104001f"===e?"secp192k1":"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040021"===e?"secp224r1":"2b81040022"===e?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)?"secp256r1":-1!=="|secp256k1|".indexOf(e)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(e)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(e)?"secp384r1":null},void 0!==Y&&Y||(Y={}),void 0!==Y.crypto&&Y.crypto||(Y.crypto={}),Y.crypto.ECParameterDB=new function(){var e={},t={};function n(e){return new l(e,16)}this.getByName=function(n){var r=n;if(void 0!==t[r]&&(r=t[n]),void 0!==e[r])return e[r];throw"unregistered EC curve name: "+r},this.regist=function(r,o,s,i,a,u,c,d,l,h,f,m){e[r]={};var p=n(s),g=n(i),b=n(a),v=n(u),y=n(c),_=new Z(p,g,b),w=_.decodePointHex("04"+d+l);e[r].name=r,e[r].keylen=o,e[r].curve=_,e[r].G=w,e[r].n=v,e[r].h=y,e[r].oid=f,e[r].info=m;for(var k=0;k<h.length;k++)t[h[k]]=r}},Y.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),Y.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),Y.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),Y.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),Y.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),Y.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),Y.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),Y.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),Y.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),Y.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==Y&&Y||(Y={}),void 0!==Y.crypto&&Y.crypto||(Y.crypto={}),Y.crypto.DSA=function(){var e=te,t=(e.getVbyList,e.getVbyListEx),n=e.isASN1HEX,r=l;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(e,t,n,r,o){this.isPrivate=!0,this.p=e,this.q=t,this.g=n,this.y=r,this.x=o},this.setPrivateHex=function(e,t,n,r,o){var s,i,a,u,c;s=new l(e,16),i=new l(t,16),a=new l(n,16),u="string"==typeof r&&r.length>1?new l(r,16):null,c=new l(o,16),this.setPrivate(s,i,a,u,c)},this.setPublic=function(e,t,n,r){this.isPublic=!0,this.p=e,this.q=t,this.g=n,this.y=r,this.x=null},this.setPublicHex=function(e,t,n,r){var o,s,i,a;o=new l(e,16),s=new l(t,16),i=new l(n,16),a=new l(r,16),this.setPublic(o,s,i,a)},this.signWithMessageHash=function(e){var t=this.p,n=this.q,r=this.g,o=(this.y,this.x),s=Y.crypto.Util.getRandomBigIntegerMinToMax(l.ONE.add(l.ONE),n.subtract(l.ONE)),i=new l(e.substr(0,n.bitLength()/4),16),a=r.modPow(s,t).mod(n),u=s.modInverse(n).multiply(i.add(o.multiply(a))).mod(n);return Y.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:a}},{int:{bigint:u}}]})},this.verifyWithMessageHash=function(e,t){var n=this.p,r=this.q,o=this.g,s=this.y,i=this.parseASN1Signature(t),a=i[0],u=i[1],c=new l(e.substr(0,r.bitLength()/4),16);if(l.ZERO.compareTo(a)>0||a.compareTo(r)>0)throw"invalid DSA signature";if(l.ZERO.compareTo(u)>=0||u.compareTo(r)>0)throw"invalid DSA signature";var d=u.modInverse(r),h=c.multiply(d).mod(r),f=a.multiply(d).mod(r);return 0==o.modPow(h,n).multiply(s.modPow(f,n)).mod(n).mod(r).compareTo(a)},this.parseASN1Signature=function(e){try{return[new r(t(e,0,[0],"02"),16),new r(t(e,0,[1],"02"),16)]}catch(e){throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(e){var r,o,s,i,a;if(!1===n(e))throw new Error("not ASN.1 hex string");try{r=t(e,0,[1],"02"),o=t(e,0,[2],"02"),s=t(e,0,[3],"02"),i=t(e,0,[4],"02"),a=t(e,0,[5],"02")}catch(e){throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(r,o,s,i,a)},this.readPKCS8PrvKeyHex=function(e){var r,o,s,i;if(!1===n(e))throw new Error("not ASN.1 hex string");try{r=t(e,0,[1,1,0],"02"),o=t(e,0,[1,1,1],"02"),s=t(e,0,[1,1,2],"02"),i=t(e,0,[2,0],"02")}catch(e){throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(r,o,s,null,i)},this.readPKCS8PubKeyHex=function(e){var r,o,s,i;if(!1===n(e))throw new Error("not ASN.1 hex string");try{r=t(e,0,[0,1,0],"02"),o=t(e,0,[0,1,1],"02"),s=t(e,0,[0,1,2],"02"),i=t(e,0,[1,0],"02")}catch(e){throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(r,o,s,i)},this.readCertPubKeyHex=function(e,r){var o,s,i,a;if(!1===n(e))throw new Error("not ASN.1 hex string");try{o=t(e,0,[0,5,0,1,0],"02"),s=t(e,0,[0,5,0,1,1],"02"),i=t(e,0,[0,5,0,1,2],"02"),a=t(e,0,[0,5,1,0],"02")}catch(e){throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(o,s,i,a)}};var Pe=function(){var e=function(e,n,r){return t(s.AES,e,n,r)},t=function(e,t,n,r){var o=s.enc.Hex.parse(t),i=s.enc.Hex.parse(n),a=s.enc.Hex.parse(r),u={};u.key=i,u.iv=a,u.ciphertext=o;var c=e.decrypt(u,i,{iv:a});return s.enc.Hex.stringify(c)},n=function(e,t,n){return r(s.AES,e,t,n)},r=function(e,t,n,r){var o=s.enc.Hex.parse(t),i=s.enc.Hex.parse(n),a=s.enc.Hex.parse(r),u=e.encrypt(o,i,{iv:a}),c=s.enc.Hex.parse(u.toString());return s.enc.Base64.stringify(c)},o={"AES-256-CBC":{proc:e,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:n,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(e,n,r){return t(s.TripleDES,e,n,r)},eproc:function(e,t,n){return r(s.TripleDES,e,t,n)},keylen:24,ivlen:8},"DES-CBC":{proc:function(e,n,r){return t(s.DES,e,n,r)},eproc:function(e,t,n){return r(s.DES,e,t,n)},keylen:8,ivlen:8}},i=function(e){var t={},n=e.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));n&&(t.cipher=n[1],t.ivsalt=n[2]);var r=e.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));r&&(t.type=r[1]);var o=-1,s=0;-1!=e.indexOf("\r\n\r\n")&&(o=e.indexOf("\r\n\r\n"),s=2),-1!=e.indexOf("\n\n")&&(o=e.indexOf("\n\n"),s=1);var i=e.indexOf("-----END");if(-1!=o&&-1!=i){var a=e.substring(o+2*s,i-s);a=a.replace(/\s+/g,""),t.data=a}return t},a=function(e,t,n){for(var r=n.substring(0,16),i=s.enc.Hex.parse(r),a=s.enc.Utf8.parse(t),u=o[e].keylen+o[e].ivlen,c="",d=null;;){var l=s.algo.MD5.create();if(null!=d&&l.update(d),l.update(a),l.update(i),d=l.finalize(),(c+=s.enc.Hex.stringify(d)).length>=2*u)break}var h={};return h.keyhex=c.substr(0,2*o[e].keylen),h.ivhex=c.substr(2*o[e].keylen,2*o[e].ivlen),h},u=function(e,t,n,r){var i=s.enc.Base64.parse(e),a=s.enc.Hex.stringify(i);return(0,o[t].proc)(a,n,r)};return{version:"1.0.0",parsePKCS5PEM:function(e){return i(e)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(e,t,n){return a(e,t,n)},decryptKeyB64:function(e,t,n,r){return u(e,t,n,r)},getDecryptedKeyHex:function(e,t){var n=i(e),r=(n.type,n.cipher),o=n.ivsalt,s=n.data,c=a(r,t,o).keyhex;return u(s,r,c,o)},getEncryptedPKCS5PEMFromPrvKeyHex:function(e,t,n,r,i){var u="";if(void 0!==r&&null!=r||(r="AES-256-CBC"),void 0===o[r])throw"KEYUTIL unsupported algorithm: "+r;return void 0!==i&&null!=i||(i=function(e){var t=s.lib.WordArray.random(e);return s.enc.Hex.stringify(t)}(o[r].ivlen).toUpperCase()),u="-----BEGIN "+e+" PRIVATE KEY-----\r\n",u+="Proc-Type: 4,ENCRYPTED\r\n",u+="DEK-Info: "+r+","+i+"\r\n",u+="\r\n",(u+=function(e,t,n,r){return(0,o[t].eproc)(e,n,r)}(t,r,a(r,n,i).keyhex,i).replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+e+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(e){var t=te,n=t.getChildIdx,r=t.getV,o={},s=n(e,0);if(2!=s.length)throw"malformed format: SEQUENCE(0).items != 2: "+s.length;o.ciphertext=r(e,s[1]);var i=n(e,s[0]);if(2!=i.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+i.length;if("2a864886f70d01050d"!=r(e,i[0]))throw"this only supports pkcs5PBES2";var a=n(e,i[1]);if(2!=i.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var u=n(e,a[1]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length;if("2a864886f70d0307"!=r(e,u[0]))throw"this only supports TripleDES";o.encryptionSchemeAlg="TripleDES",o.encryptionSchemeIV=r(e,u[1]);var c=n(e,a[0]);if(2!=c.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+c.length;if("2a864886f70d01050c"!=r(e,c[0]))throw"this only supports pkcs5PBKDF2";var d=n(e,c[1]);if(d.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+d.length;o.pbkdf2Salt=r(e,d[0]);var l=r(e,d[1]);try{o.pbkdf2Iter=parseInt(l,16)}catch(e){throw"malformed format pbkdf2Iter: "+l}return o},getPBKDF2KeyHexFromParam:function(e,t){var n=s.enc.Hex.parse(e.pbkdf2Salt),r=e.pbkdf2Iter,o=s.PBKDF2(t,n,{keySize:6,iterations:r});return s.enc.Hex.stringify(o)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(e,t){var n=ve(e,"ENCRYPTED PRIVATE KEY"),r=this.parseHexOfEncryptedPKCS8(n),o=Pe.getPBKDF2KeyHexFromParam(r,t),i={};i.ciphertext=s.enc.Hex.parse(r.ciphertext);var a=s.enc.Hex.parse(o),u=s.enc.Hex.parse(r.encryptionSchemeIV),c=s.TripleDES.decrypt(i,a,{iv:u});return s.enc.Hex.stringify(c)},getKeyFromEncryptedPKCS8PEM:function(e,t){var n=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(e,t);return this.getKeyFromPlainPrivatePKCS8Hex(n)},parsePlainPrivatePKCS8Hex:function(e){var t=te,n=t.getChildIdx,r=t.getV,o={algparam:null};if("30"!=e.substr(0,2))throw new Error("malformed plain PKCS8 private key(code:001)");var s=n(e,0);if(s.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if("30"!=e.substr(s[1],2))throw new Error("malformed PKCS8 private key(code:003)");var i=n(e,s[1]);if(2!=i.length)throw new Error("malformed PKCS8 private key(code:004)");if("06"!=e.substr(i[0],2))throw new Error("malformed PKCS8 private key(code:005)");if(o.algoid=r(e,i[0]),"06"==e.substr(i[1],2)&&(o.algparam=r(e,i[1])),"04"!=e.substr(s[2],2))throw new Error("malformed PKCS8 private key(code:006)");return o.keyidx=t.getVidx(e,s[2]),o},getKeyFromPlainPrivatePKCS8PEM:function(e){var t=ve(e,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(t)},getKeyFromPlainPrivatePKCS8Hex:function(e){var t,n=this.parsePlainPrivatePKCS8Hex(e);if("2a864886f70d010101"==n.algoid)t=new W;else if("2a8648ce380401"==n.algoid)t=new Y.crypto.DSA;else{if("2a8648ce3d0201"!=n.algoid)throw"unsupported private key algorithm";t=new Y.crypto.ECDSA}return t.readPKCS8PrvKeyHex(e),t},_getKeyFromPublicPKCS8Hex:function(e){var t,n=te.getVbyList(e,0,[0,0],"06");if("2a864886f70d010101"===n)t=new W;else if("2a8648ce380401"===n)t=new Y.crypto.DSA;else{if("2a8648ce3d0201"!==n)throw"unsupported PKCS#8 public key hex";t=new Y.crypto.ECDSA}return t.readPKCS8PubKeyHex(e),t},parsePublicRawRSAKeyHex:function(e){var t=te,n=t.getChildIdx,r=t.getV,o={};if("30"!=e.substr(0,2))throw"malformed RSA key(code:001)";var s=n(e,0);if(2!=s.length)throw"malformed RSA key(code:002)";if("02"!=e.substr(s[0],2))throw"malformed RSA key(code:003)";if(o.n=r(e,s[0]),"02"!=e.substr(s[1],2))throw"malformed RSA key(code:004)";return o.e=r(e,s[1]),o},parsePublicPKCS8Hex:function(e){var t=te,n=t.getChildIdx,r=t.getV,o={algparam:null},s=n(e,0);if(2!=s.length)throw"outer DERSequence shall have 2 elements: "+s.length;var i=s[0];if("30"!=e.substr(i,2))throw"malformed PKCS8 public key(code:001)";var a=n(e,i);if(2!=a.length)throw"malformed PKCS8 public key(code:002)";if("06"!=e.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(o.algoid=r(e,a[0]),"06"==e.substr(a[1],2)?o.algparam=r(e,a[1]):"30"==e.substr(a[1],2)&&(o.algparam={},o.algparam.p=t.getVbyList(e,a[1],[0],"02"),o.algparam.q=t.getVbyList(e,a[1],[1],"02"),o.algparam.g=t.getVbyList(e,a[1],[2],"02")),"03"!=e.substr(s[1],2))throw"malformed PKCS8 public key(code:004)";return o.key=r(e,s[1]).substr(2),o}}}();Pe.getKey=function(e,t,n){var r,o=(v=te).getChildIdx,s=(v.getV,v.getVbyList),i=Y.crypto,a=i.ECDSA,u=i.DSA,c=W,d=ve,h=Pe;if(void 0!==c&&e instanceof c)return e;if(void 0!==a&&e instanceof a)return e;if(void 0!==u&&e instanceof u)return e;if(void 0!==e.curve&&void 0!==e.xy&&void 0===e.d)return new a({pub:e.xy,curve:e.curve});if(void 0!==e.curve&&void 0!==e.d)return new a({prv:e.d,curve:e.curve});if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(I=new c).setPublic(e.n,e.e),I;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.co&&void 0===e.qi)return(I=new c).setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),I;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0===e.p)return(I=new c).setPrivate(e.n,e.e,e.d),I;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0===e.x)return(I=new u).setPublic(e.p,e.q,e.g,e.y),I;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0!==e.x)return(I=new u).setPrivate(e.p,e.q,e.g,e.y,e.x),I;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(I=new c).setPublic(ce(e.n),ce(e.e)),I;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.qi)return(I=new c).setPrivateEx(ce(e.n),ce(e.e),ce(e.d),ce(e.p),ce(e.q),ce(e.dp),ce(e.dq),ce(e.qi)),I;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d)return(I=new c).setPrivate(ce(e.n),ce(e.e),ce(e.d)),I;if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0===e.d){var f=(E=new a({curve:e.crv})).ecparams.keylen/4,m="04"+("0000000000"+ce(e.x)).slice(-f)+("0000000000"+ce(e.y)).slice(-f);return E.setPublicKeyHex(m),E}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0!==e.d){f=(E=new a({curve:e.crv})).ecparams.keylen/4,m="04"+("0000000000"+ce(e.x)).slice(-f)+("0000000000"+ce(e.y)).slice(-f);var p=("0000000000"+ce(e.d)).slice(-f);return E.setPublicKeyHex(m),E.setPrivateKeyHex(p),E}if("pkcs5prv"===n){var g,b=e,v=te;if(9===(g=o(b,0)).length)(I=new c).readPKCS5PrvKeyHex(b);else if(6===g.length)(I=new u).readPKCS5PrvKeyHex(b);else{if(!(g.length>2&&"04"===b.substr(g[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(I=new a).readPKCS5PrvKeyHex(b)}return I}if("pkcs8prv"===n)return h.getKeyFromPlainPrivatePKCS8Hex(e);if("pkcs8pub"===n)return h._getKeyFromPublicPKCS8Hex(e);if("x509pub"===n)return Be.getPublicKeyFromCertHex(e);if(-1!=e.indexOf("-END CERTIFICATE-",0)||-1!=e.indexOf("-END X509 CERTIFICATE-",0)||-1!=e.indexOf("-END TRUSTED CERTIFICATE-",0))return Be.getPublicKeyFromCertPEM(e);if(-1!=e.indexOf("-END PUBLIC KEY-")){var y=ve(e,"PUBLIC KEY");return h._getKeyFromPublicPKCS8Hex(y)}if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var _=d(e,"RSA PRIVATE KEY");return h.getKey(_,null,"pkcs5prv")}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var w=s(r=d(e,"DSA PRIVATE KEY"),0,[1],"02"),k=s(r,0,[2],"02"),S=s(r,0,[3],"02"),j=s(r,0,[4],"02"),C=s(r,0,[5],"02");return(I=new u).setPrivate(new l(w,16),new l(k,16),new l(S,16),new l(j,16),new l(C,16)),I}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED"))return _=d(e,"EC PRIVATE KEY"),h.getKey(_,null,"pkcs5prv");if(-1!=e.indexOf("-END PRIVATE KEY-"))return h.getKeyFromPlainPrivatePKCS8PEM(e);if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var x=h.getDecryptedKeyHex(e,t),O=new W;return O.readPKCS5PrvKeyHex(x),O}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var E,I=s(r=h.getDecryptedKeyHex(e,t),0,[1],"04"),A=s(r,0,[2,0],"06"),N=s(r,0,[3,0],"03").substr(2);if(void 0===Y.crypto.OID.oidhex2name[A])throw"undefined OID(hex) in KJUR.crypto.OID: "+A;return(E=new a({curve:Y.crypto.OID.oidhex2name[A]})).setPublicKeyHex(N),E.setPrivateKeyHex(I),E.isPublic=!1,E}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED"))return w=s(r=h.getDecryptedKeyHex(e,t),0,[1],"02"),k=s(r,0,[2],"02"),S=s(r,0,[3],"02"),j=s(r,0,[4],"02"),C=s(r,0,[5],"02"),(I=new u).setPrivate(new l(w,16),new l(k,16),new l(S,16),new l(j,16),new l(C,16)),I;if(-1!=e.indexOf("-END ENCRYPTED PRIVATE KEY-"))return h.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")},Pe.generateKeypair=function(e,t){if("RSA"==e){var n=t;(i=new W).generate(n,"10001"),i.isPrivate=!0,i.isPublic=!0;var r=new W,o=i.n.toString(16),s=i.e.toString(16);return r.setPublic(o,s),r.isPrivate=!1,r.isPublic=!0,(a={}).prvKeyObj=i,a.pubKeyObj=r,a}if("EC"==e){var i,a,u=t,c=new Y.crypto.ECDSA({curve:u}).generateKeyPairHex();return(i=new Y.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),i.setPrivateKeyHex(c.ecprvhex),i.isPrivate=!0,i.isPublic=!1,(r=new Y.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),r.isPrivate=!1,r.isPublic=!0,(a={}).prvKeyObj=i,a.pubKeyObj=r,a}throw"unknown algorithm: "+e},Pe.getPEM=function(e,t,n,r,o,i){var a=Y,u=a.asn1,c=u.DERObjectIdentifier,d=u.DERInteger,l=u.ASN1Util.newObject,h=u.x509.SubjectPublicKeyInfo,f=a.crypto,m=f.DSA,p=f.ECDSA,g=W;function b(e){return l({seq:[{int:0},{int:{bigint:e.n}},{int:e.e},{int:{bigint:e.d}},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.dmp1}},{int:{bigint:e.dmq1}},{int:{bigint:e.coeff}}]})}function v(e){return l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a0",!0,{oid:{name:e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]})}function y(e){return l({seq:[{int:0},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}},{int:{bigint:e.y}},{int:{bigint:e.x}}]})}if((void 0!==g&&e instanceof g||void 0!==m&&e instanceof m||void 0!==p&&e instanceof p)&&1==e.isPublic&&(void 0===t||"PKCS8PUB"==t))return be(S=new h(e).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==t&&void 0!==g&&e instanceof g&&(void 0===n||null==n)&&1==e.isPrivate)return be(S=b(e).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==t&&void 0!==p&&e instanceof p&&(void 0===n||null==n)&&1==e.isPrivate){var _=new c({name:e.curveName}).getEncodedHex(),w=v(e).getEncodedHex(),k="";return(k+=be(_,"EC PARAMETERS"))+be(w,"EC PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==m&&e instanceof m&&(void 0===n||null==n)&&1==e.isPrivate)return be(S=y(e).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==t&&void 0!==g&&e instanceof g&&void 0!==n&&null!=n&&1==e.isPrivate){var S=b(e).getEncodedHex();return void 0===r&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",S,n,r,i)}if("PKCS5PRV"==t&&void 0!==p&&e instanceof p&&void 0!==n&&null!=n&&1==e.isPrivate)return S=v(e).getEncodedHex(),void 0===r&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",S,n,r,i);if("PKCS5PRV"==t&&void 0!==m&&e instanceof m&&void 0!==n&&null!=n&&1==e.isPrivate)return S=y(e).getEncodedHex(),void 0===r&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",S,n,r,i);var j=function(e,t){var n=C(e,t);return new l({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:n.pbkdf2Salt}},{int:n.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:n.encryptionSchemeIV}}]}]}]},{octstr:{hex:n.ciphertext}}]}).getEncodedHex()},C=function(e,t){var n=s.lib.WordArray.random(8),r=s.lib.WordArray.random(8),o=s.PBKDF2(t,n,{keySize:6,iterations:100}),i=s.enc.Hex.parse(e),a=s.TripleDES.encrypt(i,o,{iv:r})+"",u={};return u.ciphertext=a,u.pbkdf2Salt=s.enc.Hex.stringify(n),u.pbkdf2Iter=100,u.encryptionSchemeAlg="DES-EDE3-CBC",u.encryptionSchemeIV=s.enc.Hex.stringify(r),u};if("PKCS8PRV"==t&&null!=g&&e instanceof g&&1==e.isPrivate){var x=b(e).getEncodedHex();return S=l({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:x}}]}).getEncodedHex(),void 0===n||null==n?be(S,"PRIVATE KEY"):be(w=j(S,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==p&&e instanceof p&&1==e.isPrivate)return x=new l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]}).getEncodedHex(),S=l({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:x}}]}).getEncodedHex(),void 0===n||null==n?be(S,"PRIVATE KEY"):be(w=j(S,n),"ENCRYPTED PRIVATE KEY");if("PKCS8PRV"==t&&void 0!==m&&e instanceof m&&1==e.isPrivate)return x=new d({bigint:e.x}).getEncodedHex(),S=l({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:x}}]}).getEncodedHex(),void 0===n||null==n?be(S,"PRIVATE KEY"):be(w=j(S,n),"ENCRYPTED PRIVATE KEY");throw new Error("unsupported object nor format")},Pe.getKeyFromCSRPEM=function(e){var t=ve(e,"CERTIFICATE REQUEST");return Pe.getKeyFromCSRHex(t)},Pe.getKeyFromCSRHex=function(e){var t=Pe.parseCSRHex(e);return Pe.getKey(t.p8pubkeyhex,null,"pkcs8pub")},Pe.parseCSRHex=function(e){var t=te,n=t.getChildIdx,r=t.getTLV,o={},s=e;if("30"!=s.substr(0,2))throw"malformed CSR(code:001)";var i=n(s,0);if(i.length<1)throw"malformed CSR(code:002)";if("30"!=s.substr(i[0],2))throw"malformed CSR(code:003)";var a=n(s,i[0]);if(a.length<3)throw"malformed CSR(code:004)";return o.p8pubkeyhex=r(s,a[2]),o},Pe.getKeyID=function(e){var t=Pe,n=te;"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&(e=t.getKey(e));var r=ve(t.getPEM(e)),o=n.getIdxbyList(r,0,[1]),s=n.getV(r,o).substring(2);return Y.crypto.Util.hashHex(s,"sha1")},Pe.getJWKFromKey=function(e){var t={};if(e instanceof W&&e.isPrivate)return t.kty="RSA",t.n=ue(e.n.toString(16)),t.e=ue(e.e.toString(16)),t.d=ue(e.d.toString(16)),t.p=ue(e.p.toString(16)),t.q=ue(e.q.toString(16)),t.dp=ue(e.dmp1.toString(16)),t.dq=ue(e.dmq1.toString(16)),t.qi=ue(e.coeff.toString(16)),t;if(e instanceof W&&e.isPublic)return t.kty="RSA",t.n=ue(e.n.toString(16)),t.e=ue(e.e.toString(16)),t;if(e instanceof Y.crypto.ECDSA&&e.isPrivate){if("P-256"!==(r=e.getShortNISTPCurveName())&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;var n=e.getPublicKeyXYHex();return t.kty="EC",t.crv=r,t.x=ue(n.x),t.y=ue(n.y),t.d=ue(e.prvKeyHex),t}if(e instanceof Y.crypto.ECDSA&&e.isPublic){var r;if("P-256"!==(r=e.getShortNISTPCurveName())&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;return n=e.getPublicKeyXYHex(),t.kty="EC",t.crv=r,t.x=ue(n.x),t.y=ue(n.y),t}throw"not supported key object"},W.getPosArrayOfChildrenFromHex=function(e){return te.getChildIdx(e,0)},W.getHexValueArrayOfChildrenFromHex=function(e){var t,n=te.getV,r=n(e,(t=W.getPosArrayOfChildrenFromHex(e))[0]),o=n(e,t[1]),s=n(e,t[2]),i=n(e,t[3]),a=n(e,t[4]),u=n(e,t[5]),c=n(e,t[6]),d=n(e,t[7]),l=n(e,t[8]);return(t=new Array).push(r,o,s,i,a,u,c,d,l),t},W.prototype.readPrivateKeyFromPEMString=function(e){var t=ve(e),n=W.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},W.prototype.readPKCS5PrvKeyHex=function(e){var t=W.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},W.prototype.readPKCS8PrvKeyHex=function(e){var t,n,r,o,s,i,a,u,c=te,d=c.getVbyListEx;if(!1===c.isASN1HEX(e))throw new Error("not ASN.1 hex string");try{t=d(e,0,[2,0,1],"02"),n=d(e,0,[2,0,2],"02"),r=d(e,0,[2,0,3],"02"),o=d(e,0,[2,0,4],"02"),s=d(e,0,[2,0,5],"02"),i=d(e,0,[2,0,6],"02"),a=d(e,0,[2,0,7],"02"),u=d(e,0,[2,0,8],"02")}catch(e){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,n,r,o,s,i,a,u)},W.prototype.readPKCS5PubKeyHex=function(e){var t=te,n=t.getV;if(!1===t.isASN1HEX(e))throw new Error("keyHex is not ASN.1 hex string");var r=t.getChildIdx(e,0);if(2!==r.length||"02"!==e.substr(r[0],2)||"02"!==e.substr(r[1],2))throw new Error("wrong hex for PKCS#5 public key");var o=n(e,r[0]),s=n(e,r[1]);this.setPublic(o,s)},W.prototype.readPKCS8PubKeyHex=function(e){var t=te;if(!1===t.isASN1HEX(e))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==t.getTLVbyListEx(e,0,[0,0]))throw new Error("not PKCS8 RSA public key");var n=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(n)},W.prototype.readCertPubKeyHex=function(e,t){var n,r;(n=new Be).readCertHex(e),r=n.getPublicKeyHex(),this.readPKCS8PubKeyHex(r)};var Re=new RegExp("[^0-9a-f]","gi");function De(e,t){for(var n="",r=t/4-e.length,o=0;o<r;o++)n+="0";return n+e}function Me(e,t,n){for(var r="",o=0;r.length<t;)r+=he(n(fe(e+String.fromCharCode.apply(String,[(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o])))),o+=1;return r}function Le(e){for(var t in Y.crypto.Util.DIGESTINFOHEAD){var n=Y.crypto.Util.DIGESTINFOHEAD[t],r=n.length;if(e.substring(0,r)==n)return[t,e.substring(r)]}return[]}function Be(e){var t,n=te,r=n.getChildIdx,o=n.getV,s=n.getTLV,i=n.getVbyList,a=n.getVbyListEx,u=n.getTLVbyList,c=n.getTLVbyListEx,d=n.getIdxbyList,l=n.getIdxbyListEx,h=n.getVidx,f=n.oidname,m=n.hextooidstr,p=Be,g=ve;try{t=Y.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(e){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==u(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return a(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var e=c(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(e)},this.getAlgorithmIdentifierName=function(e){for(var n in t)if(e===t[n])return n;return f(a(e,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return u(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return p.hex2dn(this.getIssuerHex())},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return u(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return p.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var e=i(this.hex,0,[0,4+this.foffset,0]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getNotAfter=function(){var e=i(this.hex,0,[0,4+this.foffset,1]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getPublicKeyHex=function(){return n.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return d(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var e=this.getPublicKeyIdx();return d(this.hex,e,[1,0],"30")},this.getPublicKey=function(){return Pe.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var e=u(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(e)},this.getSignatureValueHex=function(){return i(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmField(),n=this.getSignatureValueHex(),r=u(this.hex,0,[0],"30"),o=new Y.crypto.Signature({alg:t});return o.init(e),o.updateHex(r),o.verify(n)},this.parseExt=function(e){var t,s,a;if(void 0===e){if(a=this.hex,3!==this.version)return-1;t=d(a,0,[0,7,0],"30"),s=r(a,t)}else{a=ve(e);var u=d(a,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=o(a,u))return void(this.aExtInfo=new Array);t=d(a,0,[0,3,0,1,0],"30"),s=r(a,t),this.hex=a}this.aExtInfo=new Array;for(var c=0;c<s.length;c++){var l={critical:!1},f=0;3===r(a,s[c]).length&&(l.critical=!0,f=1),l.oid=n.hextooidstr(i(a,s[c],[0],"06"));var m=d(a,s[c],[1+f]);l.vidx=h(a,m),this.aExtInfo.push(l)}},this.getExtInfo=function(e){var t=this.aExtInfo,n=e;if(e.match(/^[0-9.]+$/)||(n=Y.asn1.x509.OID.name2oid(e)),""!==n)for(var r=0;r<t.length;r++)if(t[r].oid===n)return t[r]},this.getExtBasicConstraints=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("basicConstraints");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"basicConstraints"};if(t&&(r.critical=!0),"3000"===e)return r;if("30030101ff"===e)return r.cA=!0,r;if("30060101ff02"===e.substr(0,12)){var i=o(e,10),a=parseInt(i,16);return r.cA=!0,r.pathLen=a,r}throw new Error("hExtV parse error: "+e)},this.getExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("keyUsage");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"keyUsage"};return t&&(r.critical=!0),r.names=this.getExtKeyUsageString(e).split(","),r},this.getExtKeyUsageBin=function(e){if(void 0===e){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";e=s(this.hex,t.vidx)}if(8!=e.length&&10!=e.length)throw new Error("malformed key usage value: "+e);var n="000000000000000"+parseInt(e.substr(6),16).toString(2);return 8==e.length&&(n=n.slice(-8)),10==e.length&&(n=n.slice(-16)),""==(n=n.replace(/0+$/,""))&&(n="0"),n},this.getExtKeyUsageString=function(e){for(var t=this.getExtKeyUsageBin(e),n=new Array,r=0;r<t.length;r++)"1"==t.substr(r,1)&&n.push(Be.KEYUSAGE_NAME[r]);return n.join(",")},this.getExtSubjectKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("subjectKeyIdentifier");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"subjectKeyIdentifier"};t&&(r.critical=!0);var i=o(e,0);return r.kid={hex:i},r},this.getExtAuthorityKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("authorityKeyIdentifier");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"authorityKeyIdentifier"};t&&(i.critical=!0);for(var a=r(e,0),u=0;u<a.length;u++){var c=e.substr(a[u],2);if("80"===c&&(i.kid={hex:o(e,a[u])}),"a1"===c){var d=s(e,a[u]),l=this.getGeneralNames(d);i.issuer=l[0].dn}"82"===c&&(i.sn={hex:o(e,a[u])})}return i},this.getExtExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("extKeyUsage");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"extKeyUsage",array:[]};t&&(i.critical=!0);for(var a=r(e,0),u=0;u<a.length;u++)i.array.push(f(o(e,a[u])));return i},this.getExtExtKeyUsageName=function(){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return e;var t=new Array,n=s(this.hex,e.vidx);if(""===n)return t;for(var i=r(n,0),a=0;a<i.length;a++)t.push(f(o(n,i[a])));return t},this.getExtSubjectAltName=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("subjectAltName");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"subjectAltName",array:[]};return t&&(r.critical=!0),r.array=this.getGeneralNames(e),r},this.getExtIssuerAltName=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("issuerAltName");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"issuerAltName",array:[]};return t&&(r.critical=!0),r.array=this.getGeneralNames(e),r},this.getGeneralNames=function(e){for(var t=r(e,0),n=[],o=0;o<t.length;o++){var i=this.getGeneralName(s(e,t[o]));void 0!==i&&n.push(i)}return n},this.getGeneralName=function(e){var t=e.substr(0,2),n=o(e,0),r=he(n);return"81"==t?{rfc822:r}:"82"==t?{dns:r}:"86"==t?{uri:r}:"87"==t?{ip:Ce(n)}:"a4"==t?{dn:this.getX500Name(n)}:void 0},this.getExtSubjectAltName2=function(){var e,t,n,i=this.getExtInfo("subjectAltName");if(void 0===i)return i;for(var a=new Array,u=s(this.hex,i.vidx),c=r(u,0),d=0;d<c.length;d++)n=u.substr(c[d],2),e=o(u,c[d]),"81"===n&&(t=le(e),a.push(["MAIL",t])),"82"===n&&(t=le(e),a.push(["DNS",t])),"84"===n&&(t=Be.hex2dn(e,0),a.push(["DN",t])),"86"===n&&(t=le(e),a.push(["URI",t])),"87"===n&&(t=Ce(e),a.push(["IP",t]));return a},this.getExtCRLDistributionPoints=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("cRLDistributionPoints");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var o={extname:"cRLDistributionPoints",array:[]};t&&(o.critical=!0);for(var i=r(e,0),a=0;a<i.length;a++){var u=s(e,i[a]);o.array.push(this.getDistributionPoint(u))}return o},this.getDistributionPoint=function(e){for(var t={},n=r(e,0),o=0;o<n.length;o++){var i=e.substr(n[o],2),a=s(e,n[o]);"a0"==i&&(t.dpname=this.getDistributionPointName(a))}return t},this.getDistributionPointName=function(e){for(var t={},n=r(e,0),o=0;o<n.length;o++){var i=e.substr(n[o],2),a=s(e,n[o]);"a0"==i&&(t.full=this.getGeneralNames(a))}return t},this.getExtCRLDistributionPointsURI=function(){var e=this.getExtInfo("cRLDistributionPoints");if(void 0===e)return e;for(var t=new Array,n=r(this.hex,e.vidx),o=0;o<n.length;o++)try{var s=le(i(this.hex,n[o],[0,0,0],"86"));t.push(s)}catch(e){}return t},this.getExtAIAInfo=function(){var e=this.getExtInfo("authorityInfoAccess");if(void 0===e)return e;for(var t={ocsp:[],caissuer:[]},n=r(this.hex,e.vidx),o=0;o<n.length;o++){var s=i(this.hex,n[o],[0],"06"),a=i(this.hex,n[o],[1],"86");"2b06010505073001"===s&&t.ocsp.push(le(a)),"2b06010505073002"===s&&t.caissuer.push(le(a))}return t},this.getExtAuthorityInfoAccess=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("authorityInfoAccess");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var o={extname:"authorityInfoAccess",array:[]};t&&(o.critical=!0);for(var u=r(e,0),c=0;c<u.length;c++){var d=a(e,u[c],[0],"06"),l=le(i(e,u[c],[1],"86"));if("2b06010505073001"==d)o.array.push({ocsp:l});else{if("2b06010505073002"!=d)throw new Error("unknown method: "+d);o.array.push({caissuer:l})}}return o},this.getExtCertificatePolicies=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("certificatePolicies");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var o={extname:"certificatePolicies",array:[]};t&&(o.critical=!0);for(var i=r(e,0),a=0;a<i.length;a++){var u=s(e,i[a]),c=this.getPolicyInformation(u);o.array.push(c)}return o},this.getPolicyInformation=function(e){var t={},n=i(e,0,[0],"06");t.policyoid=f(n);var o=l(e,0,[1],"30");if(-1!=o){t.array=[];for(var a=r(e,o),u=0;u<a.length;u++){var c=s(e,a[u]),d=this.getPolicyQualifierInfo(c);t.array.push(d)}}return t},this.getPolicyQualifierInfo=function(e){var t={},n=i(e,0,[0],"06");if("2b06010505070201"===n){var r=a(e,0,[1],"16");t.cps=he(r)}else if("2b06010505070202"===n){var o=u(e,0,[1],"30");t.unotice=this.getUserNotice(o)}return t},this.getUserNotice=function(e){for(var t={},n=r(e,0),o=0;o<n.length;o++){var i=s(e,n[o]);"30"!=i.substr(0,2)&&(t.exptext=this.getDisplayText(i))}return t},this.getDisplayText=function(e){var t={};return t.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[e.substr(0,2)],t.str=he(o(e,0)),t},this.getExtCRLNumber=function(e,t){var n={extname:"cRLNumber"};if(t&&(n.critical=!0),"02"==e.substr(0,2))return n.num={hex:o(e,0)},n;throw new Error("hExtV parse error: "+e)},this.getExtCRLReason=function(e,t){var n={extname:"cRLReason"};if(t&&(n.critical=!0),"0a"==e.substr(0,2))return n.code=parseInt(o(e,0),16),n;throw new Error("hExtV parse error: "+e)},this.getExtOcspNonce=function(e,t){var n={extname:"ocspNonce"};t&&(n.critical=!0);var r=o(e,0);return n.hex=r,n},this.getExtOcspNoCheck=function(e,t){var n={extname:"ocspNoCheck"};return t&&(n.critical=!0),n},this.getExtAdobeTimeStamp=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("adobeTimeStamp");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var o={extname:"adobeTimeStamp"};t&&(o.critical=!0);var i=r(e,0);if(i.length>1){var a=s(e,i[1]),u=this.getGeneralName(a);null!=u.uri&&(o.uri=u.uri)}if(i.length>2){var c=s(e,i[2]);"0101ff"==c&&(o.reqauth=!0),"010100"==c&&(o.reqauth=!1)}return o},this.getX500NameRule=function(e){for(var t=null,n=[],r=0;r<e.length;r++)for(var o=e[r],s=0;s<o.length;s++)n.push(o[s]);for(r=0;r<n.length;r++){var i=n[r],a=i.ds,u=i.value,c=i.type;if("prn"!=a&&"utf8"!=a&&"ia5"!=a)return"mixed";if("ia5"==a){if("CN"!=c)return"mixed";if(Y.lang.String.isMail(u))continue;return"mixed"}if("C"==c){if("prn"==a)continue;return"mixed"}if(null==t)t=a;else if(t!==a)return"mixed"}return null==t?"prn":t},this.getX500Name=function(e){var t=this.getX500NameArray(e);return{array:t,str:this.dnarraytostr(t)}},this.getX500NameArray=function(e){for(var t=[],n=r(e,0),o=0;o<n.length;o++)t.push(this.getRDN(s(e,n[o])));return t},this.getRDN=function(e){for(var t=[],n=r(e,0),o=0;o<n.length;o++)t.push(this.getAttrTypeAndValue(s(e,n[o])));return t},this.getAttrTypeAndValue=function(e){var t={type:null,value:null,ds:null},n=r(e,0),o=i(e,n[0],[],"06"),s=i(e,n[1],[]),a=Y.asn1.ASN1Util.oidHexToInt(o);return t.type=Y.asn1.x509.OID.oid2atype(a),t.value=he(s),t.ds=this.HEX2STAG[e.substr(n[1],2)],t},this.readCertPEM=function(e){this.readCertHex(g(e))},this.readCertHex=function(e){this.hex=e,this.getVersion();try{d(this.hex,0,[0,7],"a3"),this.parseExt()}catch(e){}},this.getParam=function(){var e={};return e.version=this.getVersion(),e.serial={hex:this.getSerialNumberHex()},e.sigalg=this.getSignatureAlgorithmField(),e.issuer=this.getIssuer(),e.notbefore=this.getNotBefore(),e.notafter=this.getNotAfter(),e.subject=this.getSubject(),e.sbjpubkey=be(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(e.ext=this.getExtParamArray()),e.sighex=this.getSignatureValueHex(),e},this.getExtParamArray=function(e){null==e&&-1!=l(this.hex,0,[0,"[3]"])&&(e=c(this.hex,0,[0,"[3]",0],"30"));for(var t=[],n=r(e,0),o=0;o<n.length;o++){var i=s(e,n[o]),a=this.getExtParam(i);null!=a&&t.push(a)}return t},this.getExtParam=function(e){var t=r(e,0).length;if(2!=t&&3!=t)throw new Error("wrong number elements in Extension: "+t+" "+e);var n=m(i(e,0,[0],"06")),o=!1;3==t&&"0101ff"==u(e,0,[1])&&(o=!0);var s=u(e,0,[t-1,0]),a=void 0;if("2.5.29.14"==n?a=this.getExtSubjectKeyIdentifier(s,o):"2.5.29.15"==n?a=this.getExtKeyUsage(s,o):"2.5.29.17"==n?a=this.getExtSubjectAltName(s,o):"2.5.29.18"==n?a=this.getExtIssuerAltName(s,o):"2.5.29.19"==n?a=this.getExtBasicConstraints(s,o):"2.5.29.31"==n?a=this.getExtCRLDistributionPoints(s,o):"2.5.29.32"==n?a=this.getExtCertificatePolicies(s,o):"2.5.29.35"==n?a=this.getExtAuthorityKeyIdentifier(s,o):"2.5.29.37"==n?a=this.getExtExtKeyUsage(s,o):"1.3.6.1.5.5.7.1.1"==n?a=this.getExtAuthorityInfoAccess(s,o):"2.5.29.20"==n?a=this.getExtCRLNumber(s,o):"2.5.29.21"==n?a=this.getExtCRLReason(s,o):"1.3.6.1.5.5.7.48.1.2"==n?a=this.getExtOcspNonce(s,o):"1.3.6.1.5.5.7.48.1.5"==n?a=this.getExtOcspNoCheck(s,o):"1.2.840.113583.1.1.9.1"==n&&(a=this.getExtAdobeTimeStamp(s,o)),null!=a)return a;var c={extname:n,extn:s};return o&&(c.critical=!0),c},this.findExt=function(e,t){for(var n=0;n<e.length;n++)if(e[n].extname==t)return e[n];return null},this.updateExtCDPFullURI=function(e,t){var n=this.findExt(e,"cRLDistributionPoints");if(null!=n&&null!=n.array)for(var r=n.array,o=0;o<r.length;o++)if(null!=r[o].dpname&&null!=r[o].dpname.full)for(var s=r[o].dpname.full,i=0;i<s.length;i++){var a=s[o];null!=a.uri&&(a.uri=t)}},this.updateExtAIAOCSP=function(e,t){var n=this.findExt(e,"authorityInfoAccess");if(null!=n&&null!=n.array)for(var r=n.array,o=0;o<r.length;o++)null!=r[o].ocsp&&(r[o].ocsp=t)},this.updateExtAIACAIssuer=function(e,t){var n=this.findExt(e,"authorityInfoAccess");if(null!=n&&null!=n.array)for(var r=n.array,o=0;o<r.length;o++)null!=r[o].caissuer&&(r[o].caissuer=t)},this.dnarraytostr=function(e){return"/"+e.map((function(e){return function(e){return e.map((function(e){return function(e){return e.type+"="+e.value}(e)})).join("+")}(e)})).join("/")},this.getInfo=function(){var e,t,n,r,o=function(e){for(var t="",n=e.array,r=0;r<n.length;r++){var o=n[r];if(t+="    policy oid: "+o.policyoid+"\n",void 0!==o.array)for(var s=0;s<o.array.length;s++){var i=o.array[s];void 0!==i.cps&&(t+="    cps: "+i.cps+"\n")}}return t},s=function(e){for(var t="",n=e.array,r=0;r<n.length;r++){var o=n[r];try{void 0!==o.dpname.full[0].uri&&(t+="    "+o.dpname.full[0].uri+"\n")}catch(e){}try{void 0!==o.dname.full[0].dn.hex&&(t+="    "+Be.hex2dn(o.dpname.full[0].dn.hex)+"\n")}catch(e){}}return t},i=function(e){for(var t="",n=e.array,r=0;r<n.length;r++){var o=n[r];void 0!==o.caissuer&&(t+="    caissuer: "+o.caissuer+"\n"),void 0!==o.ocsp&&(t+="    ocsp: "+o.ocsp+"\n")}return t};if(e="Basic Fields\n",e+="  serial number: "+this.getSerialNumberHex()+"\n",e+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",e+="  issuer: "+this.getIssuerString()+"\n",e+="  notBefore: "+this.getNotBefore()+"\n",e+="  notAfter: "+this.getNotAfter()+"\n",e+="  subject: "+this.getSubjectString()+"\n",e+="  subject public key info: \n",e+="    key algorithm: "+(t=this.getPublicKey()).type+"\n","RSA"===t.type&&(e+="    n="+Ee(t.n.toString(16)).substr(0,16)+"...\n",e+="    e="+Ee(t.e.toString(16))+"\n"),void 0!==(n=this.aExtInfo)&&null!==n){e+="X509v3 Extensions:\n";for(var a=0;a<n.length;a++){var u=n[a],c=Y.asn1.x509.OID.oid2name(u.oid);""===c&&(c=u.oid);var d="";if(!0===u.critical&&(d="CRITICAL"),e+="  "+c+" "+d+":\n","basicConstraints"===c){var l=this.getExtBasicConstraints();void 0===l.cA?e+="    {}\n":(e+="    cA=true",void 0!==l.pathLen&&(e+=", pathLen="+l.pathLen),e+="\n")}else if("keyUsage"===c)e+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===c)e+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"===c){var h=this.getExtAuthorityKeyIdentifier();void 0!==h.kid&&(e+="    kid="+h.kid.hex+"\n")}else"extKeyUsage"===c?e+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"===c?e+="    "+(r=this.getExtSubjectAltName(),JSON.stringify(r.array).replace(/[\[\]\{\}\"]/g,"")+"\n"):"cRLDistributionPoints"===c?e+=s(this.getExtCRLDistributionPoints()):"authorityInfoAccess"===c?e+=i(this.getExtAuthorityInfoAccess()):"certificatePolicies"===c&&(e+=o(this.getExtCertificatePolicies()))}}return(e+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n")+"signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?this.readCertPEM(e):Y.lang.String.isHex(e)&&this.readCertHex(e))}W.prototype.sign=function(e,t){var n,r=(n=e,Y.crypto.Util.hashString(n,t));return this.signWithMessageHash(r,t)},W.prototype.signWithMessageHash=function(e,t){var n=V(Y.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),16);return De(this.doPrivate(n).toString(16),this.n.bitLength())},W.prototype.signPSS=function(e,t,n){var r,o=(r=fe(e),Y.crypto.Util.hashHex(r,t));return void 0===n&&(n=-1),this.signWithMessageHashPSS(o,t,n)},W.prototype.signWithMessageHashPSS=function(e,t,n){var r,o=he(e),s=o.length,i=this.n.bitLength()-1,a=Math.ceil(i/8),u=function(e){return Y.crypto.Util.hashHex(e,t)};if(-1===n||void 0===n)n=s;else if(-2===n)n=a-s-2;else if(n<-2)throw new Error("invalid salt length");if(a<s+n+2)throw new Error("data too long");var c="";n>0&&(c=new Array(n),(new U).nextBytes(c),c=String.fromCharCode.apply(String,c));var d=he(u(fe("\0\0\0\0\0\0\0\0"+o+c))),h=[];for(r=0;r<a-n-s-2;r+=1)h[r]=0;var f=String.fromCharCode.apply(String,h)+""+c,m=Me(d,f.length,u),p=[];for(r=0;r<f.length;r+=1)p[r]=f.charCodeAt(r)^m.charCodeAt(r);var g=65280>>8*a-i&255;for(p[0]&=~g,r=0;r<s;r++)p.push(d.charCodeAt(r));return p.push(188),De(this.doPrivate(new l(p)).toString(16),this.n.bitLength())},W.prototype.verify=function(e,t){var n=V(t=(t=t.replace(Re,"")).replace(/[ \n]+/g,""),16);if(n.bitLength()>this.n.bitLength())return 0;var r=Le(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==r.length)return!1;var o,s=r[0];return r[1]==(o=e,Y.crypto.Util.hashString(o,s))},W.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var n=V(t,16);if(n.bitLength()>this.n.bitLength())return 0;var r=Le(this.doPublic(n).toString(16).replace(/^1f+00/,""));return 0!=r.length&&(r[0],r[1]==e)},W.prototype.verifyPSS=function(e,t,n,r){var o,s=(o=fe(e),Y.crypto.Util.hashHex(o,n));return void 0===r&&(r=-1),this.verifyWithMessageHashPSS(s,t,n,r)},W.prototype.verifyWithMessageHashPSS=function(e,t,n,r){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var o,s=new l(t,16),i=function(e){return Y.crypto.Util.hashHex(e,n)},a=he(e),u=a.length,c=this.n.bitLength()-1,d=Math.ceil(c/8);if(-1===r||void 0===r)r=u;else if(-2===r)r=d-u-2;else if(r<-2)throw new Error("invalid salt length");if(d<u+r+2)throw new Error("data too long");var h=this.doPublic(s).toByteArray();for(o=0;o<h.length;o+=1)h[o]&=255;for(;h.length<d;)h.unshift(0);if(188!==h[d-1])throw new Error("encoded message does not end in 0xbc");var f=(h=String.fromCharCode.apply(String,h)).substr(0,d-u-1),m=h.substr(f.length,u),p=65280>>8*d-c&255;if(0!=(f.charCodeAt(0)&p))throw new Error("bits beyond keysize not zero");var g=Me(m,f.length,i),b=[];for(o=0;o<f.length;o+=1)b[o]=f.charCodeAt(o)^g.charCodeAt(o);b[0]&=~p;var v=d-u-r-2;for(o=0;o<v;o+=1)if(0!==b[o])throw new Error("leftmost octets not zero");if(1!==b[v])throw new Error("0x01 marker not found");return m===he(i(fe("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,b.slice(-r)))))},W.SALT_LEN_HLEN=-1,W.SALT_LEN_MAX=-2,W.SALT_LEN_RECOVER=-2,Be.hex2dn=function(e,t){if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw new Error("malformed DN");for(var n=new Array,r=te.getChildIdx(e,t),o=0;o<r.length;o++)n.push(Be.hex2rdn(e,r[o]));return"/"+(n=n.map((function(e){return e.replace("/","\\/")}))).join("/")},Be.hex2rdn=function(e,t){if(void 0===t&&(t=0),"31"!==e.substr(t,2))throw new Error("malformed RDN");for(var n=new Array,r=te.getChildIdx(e,t),o=0;o<r.length;o++)n.push(Be.hex2attrTypeValue(e,r[o]));return(n=n.map((function(e){return e.replace("+","\\+")}))).join("+")},Be.hex2attrTypeValue=function(e,t){var n=te,r=n.getV;if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw new Error("malformed attribute type and value");var o=n.getChildIdx(e,t);2!==o.length||e.substr(o[0],2);var s=r(e,o[0]),i=Y.asn1.ASN1Util.oidHexToInt(s);return Y.asn1.x509.OID.oid2atype(i)+"="+he(r(e,o[1]))},Be.getPublicKeyFromCertHex=function(e){var t=new Be;return t.readCertHex(e),t.getPublicKey()},Be.getPublicKeyFromCertPEM=function(e){var t=new Be;return t.readCertPEM(e),t.getPublicKey()},Be.getPublicKeyInfoPropOfCertPEM=function(e){var t,n,r=te.getVbyList,o={algparam:null};return(t=new Be).readCertPEM(e),n=t.getPublicKeyHex(),o.keyhex=r(n,0,[1],"03").substr(2),o.algoid=r(n,0,[0,0],"06"),"2a8648ce3d0201"===o.algoid&&(o.algparam=r(n,0,[0,1],"06")),o},Be.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==Y&&Y||(Y={}),void 0!==Y.jws&&Y.jws||(Y.jws={}),Y.jws.JWS=function(){var e=Y.jws.JWS.isSafeJSONString;this.parseJWS=function(t,n){if(void 0===this.parsedJWS||!n&&void 0===this.parsedJWS.sigvalH){var r=t.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==r)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var o=r[1],s=r[2],i=r[3],a=o+"."+s;if(this.parsedJWS={},this.parsedJWS.headB64U=o,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=i,this.parsedJWS.si=a,!n){var u=ce(i),c=V(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=c}var d=ee(o),l=ee(s);if(this.parsedJWS.headS=d,this.parsedJWS.payloadS=l,!e(d,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+d}}},Y.jws.JWS.sign=function(e,t,n,r,o){var s,i,a,u=Y,c=u.jws.JWS,d=c.readSafeJSONString,l=c.isSafeJSONString,h=u.crypto,f=(h.ECDSA,h.Mac),m=h.Signature,p=JSON;if("string"!=typeof t&&"object"!=typeof t)throw"spHeader must be JSON string or object: "+t;if("object"==typeof t&&(i=t,s=p.stringify(i)),"string"==typeof t){if(!l(s=t))throw"JWS Head is not safe JSON string: "+s;i=d(s)}if(a=n,"object"==typeof n&&(a=p.stringify(n)),""!=e&&null!=e||void 0===i.alg||(e=i.alg),""!=e&&null!=e&&void 0===i.alg&&(i.alg=e,s=p.stringify(i)),e!==i.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+i.alg;var g=null;if(void 0===c.jwsalg2sigalg[e])throw"unsupported alg name: "+e;g=c.jwsalg2sigalg[e];var b=Q(s)+"."+Q(a),v="";if("Hmac"==g.substr(0,4)){if(void 0===r)throw"mac key shall be specified for HS* alg";var y=new f({alg:g,prov:"cryptojs",pass:r});y.updateString(b),v=y.doFinal()}else if(-1!=g.indexOf("withECDSA")){(w=new m({alg:g})).init(r,o),w.updateString(b);var _=w.sign();v=Y.crypto.ECDSA.asn1SigToConcatSig(_)}else{var w;"none"!=g&&((w=new m({alg:g})).init(r,o),w.updateString(b),v=w.sign())}return b+"."+ue(v)},Y.jws.JWS.verify=function(e,t,n){var r,o=Y,s=o.jws.JWS,i=s.readSafeJSONString,a=o.crypto,u=a.ECDSA,c=a.Mac,d=a.Signature;r=W;var l=e.split(".");if(3!==l.length)return!1;var h,f=l[0]+"."+l[1],m=ce(l[2]),p=i(ee(l[0])),g=null;if(void 0===p.alg)throw"algorithm not specified in header";if(h=(g=p.alg).substr(0,2),null!=n&&"[object Array]"===Object.prototype.toString.call(n)&&n.length>0&&-1==(":"+n.join(":")+":").indexOf(":"+g+":"))throw"algorithm '"+g+"' not accepted in the list";if("none"!=g&&null===t)throw"key shall be specified to verify.";if("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&(t=Pe.getKey(t)),!("RS"!=h&&"PS"!=h||t instanceof r))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==h&&!(t instanceof u))throw"key shall be a ECDSA obj for ES* algs";var b=null;if(void 0===s.jwsalg2sigalg[p.alg])throw"unsupported alg name: "+g;if("none"==(b=s.jwsalg2sigalg[g]))throw"not supported";if("Hmac"==b.substr(0,4)){if(void 0===t)throw"hexadecimal key shall be specified for HMAC";var v=new c({alg:b,pass:t});return v.updateString(f),m==v.doFinal()}if(-1!=b.indexOf("withECDSA")){var y,_=null;try{_=u.concatSigToASN1Sig(m)}catch(e){return!1}return(y=new d({alg:b})).init(t),y.updateString(f),y.verify(_)}return(y=new d({alg:b})).init(t),y.updateString(f),y.verify(m)},Y.jws.JWS.parse=function(e){var t,n,r,o=e.split("."),s={};if(2!=o.length&&3!=o.length)throw"malformed sJWS: wrong number of '.' splitted elements";return t=o[0],n=o[1],3==o.length&&(r=o[2]),s.headerObj=Y.jws.JWS.readSafeJSONString(ee(t)),s.payloadObj=Y.jws.JWS.readSafeJSONString(ee(n)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=ee(n):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==r&&(s.sigHex=ce(r)),s},Y.jws.JWS.verifyJWT=function(e,t,n){var r=Y.jws,o=r.JWS,s=o.readSafeJSONString,i=o.inArray,a=o.includedArray,u=e.split("."),c=u[0],d=u[1],l=(ce(u[2]),s(ee(c))),h=s(ee(d));if(void 0===l.alg)return!1;if(void 0===n.alg)throw"acceptField.alg shall be specified";if(!i(l.alg,n.alg))return!1;if(void 0!==h.iss&&"object"==typeof n.iss&&!i(h.iss,n.iss))return!1;if(void 0!==h.sub&&"object"==typeof n.sub&&!i(h.sub,n.sub))return!1;if(void 0!==h.aud&&"object"==typeof n.aud)if("string"==typeof h.aud){if(!i(h.aud,n.aud))return!1}else if("object"==typeof h.aud&&!a(h.aud,n.aud))return!1;var f=r.IntDate.getNow();return void 0!==n.verifyAt&&"number"==typeof n.verifyAt&&(f=n.verifyAt),void 0!==n.gracePeriod&&"number"==typeof n.gracePeriod||(n.gracePeriod=0),!(void 0!==h.exp&&"number"==typeof h.exp&&h.exp+n.gracePeriod<f||void 0!==h.nbf&&"number"==typeof h.nbf&&f<h.nbf-n.gracePeriod||void 0!==h.iat&&"number"==typeof h.iat&&f<h.iat-n.gracePeriod||void 0!==h.jti&&void 0!==n.jti&&h.jti!==n.jti||!o.verify(e,t,n.alg))},Y.jws.JWS.includedArray=function(e,t){var n=Y.jws.JWS.inArray;if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var r=0;r<e.length;r++)if(!n(e[r],t))return!1;return!0},Y.jws.JWS.inArray=function(e,t){if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},Y.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},Y.jws.JWS.isSafeJSONString=function(e,t,n){var r=null;try{return"object"!=typeof(r=X(e))||r.constructor===Array?0:(t&&(t[n]=r),1)}catch(e){return 0}},Y.jws.JWS.readSafeJSONString=function(e){var t=null;try{return"object"!=typeof(t=X(e))||t.constructor===Array?null:t}catch(e){return null}},Y.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==t)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},Y.jws.JWS.getJWKthumbprint=function(e){if("RSA"!==e.kty&&"EC"!==e.kty&&"oct"!==e.kty)throw"unsupported algorithm for JWK Thumprint";var t="{";if("RSA"===e.kty){if("string"!=typeof e.n||"string"!=typeof e.e)throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if("EC"===e.kty){if("string"!=typeof e.crv||"string"!=typeof e.x||"string"!=typeof e.y)throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if("oct"===e.kty){if("string"!=typeof e.k)throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var n=fe(t);return ue(Y.crypto.Util.hashHex(n,"sha256"))},Y.jws.IntDate={},Y.jws.IntDate.get=function(e){var t=Y.jws.IntDate,n=t.getNow,r=t.getZulu;if("now"==e)return n();if("now + 1hour"==e)return n()+3600;if("now + 1day"==e)return n()+86400;if("now + 1month"==e)return n()+2592e3;if("now + 1year"==e)return n()+31536e3;if(e.match(/Z$/))return r(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},Y.jws.IntDate.getZulu=function(e){return _e(e)},Y.jws.IntDate.getNow=function(){return~~(new Date/1e3)},Y.jws.IntDate.intDate2UTCString=function(e){return new Date(1e3*e).toUTCString()},Y.jws.IntDate.intDate2Zulu=function(e){var t=new Date(1e3*e);return("0000"+t.getUTCFullYear()).slice(-4)+("00"+(t.getUTCMonth()+1)).slice(-2)+("00"+t.getUTCDate()).slice(-2)+("00"+t.getUTCHours()).slice(-2)+("00"+t.getUTCMinutes()).slice(-2)+("00"+t.getUTCSeconds()).slice(-2)+"Z"},void 0!==Y&&Y||(Y={}),void 0!==Y.jws&&Y.jws||(Y.jws={}),Y.jws.JWSJS=function(){var e=Y.jws.JWS,t=e.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(e){this.init();var t=e.split(".");if(3!=t.length)throw"malformed input JWS";this.aHeader.push(t[0]),this.sPayload=t[1],this.aSignature.push(t[2])},this.addSignature=function(e,t,n,r){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var o=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var s=Y.jws.JWS.sign(e,t,this.sPayload,n,r).split(".");s[0],s[2],this.aHeader.push(s[0]),this.aSignature.push(s[2])}catch(e){throw this.aHeader.length>o&&this.aHeader.pop(),this.aSignature.length>o&&this.aSignature.pop(),"addSignature failed: "+e}},this.verifyAll=function(e){if(this.aHeader.length!==e.length||this.aSignature.length!==e.length)return!1;for(var t=0;t<e.length;t++){var n=e[t];if(2!==n.length)return!1;if(!1===this.verifyNth(t,n[0],n[1]))return!1}return!0},this.verifyNth=function(t,n,r){if(this.aHeader.length<=t||this.aSignature.length<=t)return!1;var o=this.aHeader[t],s=this.aSignature[t],i=o+"."+this.sPayload+"."+s,a=!1;try{a=e.verify(i,n,r)}catch(e){return!1}return a},this.readJWSJS=function(e){if("string"==typeof e){var n=t(e);if(null==n)throw"argument is not safe JSON object string";this.aHeader=n.headers,this.sPayload=n.payload,this.aSignature=n.signatures}else try{if(!(e.headers.length>0))throw"malformed header";if(this.aHeader=e.headers,"string"!=typeof e.payload)throw"malformed signatures";if(this.sPayload=e.payload,!(e.signatures.length>0))throw"malformed signatures";this.aSignature=e.signatures}catch(e){throw"malformed JWS-JS JSON object: "+e}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}},t.SecureRandom=U,t.rng_seed_time=M,t.BigInteger=l,t.RSAKey=W,t.ECDSA=Y.crypto.ECDSA,t.DSA=Y.crypto.DSA,t.Signature=Y.crypto.Signature,t.MessageDigest=Y.crypto.MessageDigest,t.Mac=Y.crypto.Mac,t.Cipher=Y.crypto.Cipher,t.KEYUTIL=Pe,t.ASN1HEX=te,t.X509=Be,t.X509CRL=function(e){var t=Y.lang.String.isHex,n=te,r=n.getV,o=n.getTLV,s=n.getVbyList,i=n.getTLVbyList,a=n.getTLVbyListEx,u=n.getIdxbyList,c=n.getIdxbyListEx,d=n.getChildIdx,l=new Be;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this._setPos=function(){var e=u(this.hex,0,[0,0]),t=this.hex.substr(e,2);if("02"==t)this.posSigAlg=1;else{if("30"!=t)throw new Error("malformed 1st item of TBSCertList: "+t);this.posSigAlg=0}var n,r=u(this.hex,0,[0,this.posSigAlg+3]),o=this.hex.substr(r,2);if("17"==o||"18"==o)n=u(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,-1!=n&&"30"==this.hex.substr(n,2)&&(this.posRevCert=this.posSigAlg+4);else if("30"==o)this.posRevCert=this.posSigAlg+3;else{if("a0"!=o)throw new Error("malformed nextUpdate or revCert tag: "+o);this.posRevCert=null}},this.getVersion=function(){return 0==this.posSigAlg?null:parseInt(s(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var e=i(this.hex,0,[0,this.posSigAlg],"30");return l.getAlgorithmIdentifierName(e)},this.getIssuer=function(){var e=i(this.hex,0,[0,this.posSigAlg+1],"30");return l.getX500Name(e)},this.getThisUpdate=function(){var e=s(this.hex,0,[0,this.posSigAlg+2]);return result=he(e)},this.getNextUpdate=function(){var e=u(this.hex,0,[0,this.posSigAlg+3]),t=this.hex.substr(e,2);return"17"!=t&&"18"!=t?null:he(r(this.hex,e))},this.getRevCertArray=function(){if(null==this.posRevCert)return null;for(var e=[],t=u(this.hex,0,[0,this.posRevCert]),n=d(this.hex,t),r=0;r<n.length;r++){var s=o(this.hex,n[r]);e.push(this.getRevCert(s))}return e},this.getRevCert=function(e){var t={},n=d(e,0);return t.sn={hex:s(e,0,[0],"02")},t.date=he(s(e,0,[1])),3==n.length&&(t.ext=l.getExtParamArray(i(e,0,[2]))),t},this.getSignatureValueHex=function(){return s(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmField(),n=this.getSignatureValueHex(),r=i(this.hex,0,[0],"30"),o=new Y.crypto.Signature({alg:t});return o.init(e),o.updateHex(r),o.verify(n)},this.getParam=function(){var e={},t=this.getVersion();null!=t&&(e.version=t),e.sigalg=this.getSignatureAlgorithmField(),e.issuer=this.getIssuer(),e.thisupdate=this.getThisUpdate();var n=this.getNextUpdate();null!=n&&(e.nextupdate=n);var r=this.getRevCertArray();if(null!=r&&(e.revcert=r),-1!=c(this.hex,0,[0,"[0]"])){var o=a(this.hex,0,[0,"[0]",0]);e.ext=l.getExtParamArray(o)}return e.sighex=this.getSignatureValueHex(),e},"string"==typeof e&&(t(e)?this.hex=e:e.match(/-----BEGIN X509 CRL/)&&(this.hex=ve(e)),this._setPos())},t.CryptoJS=s,t.b64tohex=c,t.b64toBA=d,t.ECFieldElementFp=G,t.ECPointFp=J,t.ECCurveFp=Z,t.stoBA=ne,t.BAtos=re,t.BAtohex=oe,t.stohex=se,t.stob64=function(e){return u(se(e))},t.stob64u=function(e){return ie(u(se(e)))},t.b64utos=function(e){return re(d(ae(e)))},t.b64tob64u=ie,t.b64utob64=ae,t.hex2b64=u,t.hextob64u=ue,t.b64utohex=ce,t.utf8tob64u=Q,t.b64utoutf8=ee,t.utf8tob64=function(e){return u(we(xe(e)))},t.b64toutf8=function(e){return decodeURIComponent(ke(c(e)))},t.utf8tohex=de,t.hextoutf8=le,t.hextorstr=he,t.rstrtohex=fe,t.hextob64=me,t.hextob64nl=pe,t.b64nltohex=ge,t.hextopem=be,t.pemtohex=ve,t.hextoArrayBuffer=function(e){if(e.length%2!=0)throw"input is not even length";if(null==e.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),n=new DataView(t),r=0;r<e.length/2;r++)n.setUint8(r,parseInt(e.substr(2*r,2),16));return t},t.ArrayBuffertohex=function(e){for(var t="",n=new DataView(e),r=0;r<e.byteLength;r++)t+=("00"+n.getUint8(r).toString(16)).slice(-2);return t},t.zulutomsec=ye,t.zulutosec=_e,t.zulutodate=function(e){return new Date(ye(e))},t.datetozulu=function(e,t,n){var r,o=e.getUTCFullYear();if(t){if(o<1950||2049<o)throw"not proper year for UTCTime: "+o;r=(""+o).slice(-2)}else r=("000"+o).slice(-4);if(r+=("0"+(e.getUTCMonth()+1)).slice(-2),r+=("0"+e.getUTCDate()).slice(-2),r+=("0"+e.getUTCHours()).slice(-2),r+=("0"+e.getUTCMinutes()).slice(-2),r+=("0"+e.getUTCSeconds()).slice(-2),n){var s=e.getUTCMilliseconds();0!==s&&(r+="."+(s=(s=("00"+s).slice(-3)).replace(/0+$/g,"")))}return r+"Z"},t.uricmptohex=we,t.hextouricmp=ke,t.ipv6tohex=Se,t.hextoipv6=je,t.hextoip=Ce,t.iptohex=function(e){var t="malformed IP address";if(!(e=e.toLowerCase(e)).match(/^[0-9.]+$/)){if(e.match(/^[0-9a-f:]+$/)&&-1!==e.indexOf(":"))return Se(e);throw t}var n=e.split(".");if(4!==n.length)throw t;var r="";try{for(var o=0;o<4;o++)r+=("0"+parseInt(n[o]).toString(16)).slice(-2);return r}catch(e){throw t}},t.encodeURIComponentAll=xe,t.newline_toUnix=function(e){return e.replace(/\r\n/gm,"\n")},t.newline_toDos=function(e){return(e=e.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")},t.hextoposhex=Ee,t.intarystrtohex=Ie,t.strdiffidx=function(e,t){var n=e.length;e.length>t.length&&(n=t.length);for(var r=0;r<n;r++)if(e.charCodeAt(r)!=t.charCodeAt(r))return r;return e.length!=t.length?n:-1},t.oidtohex=Ae,t.hextooid=Ne,t.strpad=Te,t.bitstrtoint=Fe,t.inttobitstr=function(e){var t=Number(e).toString(2),n=8-t.length%8;8==n&&(n=0),t+=Te("",n,"0");var r=parseInt(t,2).toString(16);return r.length%2==1&&(r="0"+r),"0"+n+r},t.KJUR=Y,t.crypto=Y.crypto,t.asn1=Y.asn1,t.jws=Y.jws,t.lang=Y.lang}).call(this,n("./node_modules/buffer/index.js").Buffer)},"../notebook-dds/node_modules/jwa/index.js":function(e,t,n){var r=n("../notebook-dds/node_modules/buffer-equal-constant-time/index.js"),o=n("../notebook-dds/node_modules/safe-buffer/index.js").Buffer,s=n("./node_modules/crypto-browserify/index.js"),i=n("../notebook-dds/node_modules/ecdsa-sig-formatter/src/ecdsa-sig-formatter.js"),a=n("./node_modules/util/util.js"),u="secret must be a string or buffer",c="key must be a string or a buffer",d="function"==typeof s.createPublicKey;function l(e){if(!o.isBuffer(e)&&"string"!=typeof e){if(!d)throw p(c);if("object"!=typeof e)throw p(c);if("string"!=typeof e.type)throw p(c);if("string"!=typeof e.asymmetricKeyType)throw p(c);if("function"!=typeof e.export)throw p(c)}}function h(e){if(!o.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw p("key must be a string, a buffer or an object")}function f(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function m(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var n=0;n<t;++n)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function p(e){var t=[].slice.call(arguments,1),n=a.format.bind(a,e).apply(null,t);return new TypeError(n)}function g(e){var t;return t=e,o.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function b(e){return function(t,n){!function(e){if(!o.isBuffer(e)){if("string"==typeof e)return e;if(!d)throw p(u);if("object"!=typeof e)throw p(u);if("secret"!==e.type)throw p(u);if("function"!=typeof e.export)throw p(u)}}(n),t=g(t);var r=s.createHmac("sha"+e,n);return f((r.update(t),r.digest("base64")))}}function v(e){return function(t,n,s){var i=b(e)(t,s);return r(o.from(n),o.from(i))}}function y(e){return function(t,n){h(n),t=g(t);var r=s.createSign("RSA-SHA"+e);return f((r.update(t),r.sign(n,"base64")))}}function _(e){return function(t,n,r){l(r),t=g(t),n=m(n);var o=s.createVerify("RSA-SHA"+e);return o.update(t),o.verify(r,n,"base64")}}function w(e){return function(t,n){h(n),t=g(t);var r=s.createSign("RSA-SHA"+e);return f((r.update(t),r.sign({key:n,padding:s.constants.RSA_PKCS1_PSS_PADDING,saltLength:s.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function k(e){return function(t,n,r){l(r),t=g(t),n=m(n);var o=s.createVerify("RSA-SHA"+e);return o.update(t),o.verify({key:r,padding:s.constants.RSA_PKCS1_PSS_PADDING,saltLength:s.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function S(e){var t=y(e);return function(){var n=t.apply(null,arguments);return i.derToJose(n,"ES"+e)}}function j(e){var t=_(e);return function(n,r,o){return r=i.joseToDer(r,"ES"+e).toString("base64"),t(n,r,o)}}function C(){return function(){return""}}function x(){return function(e,t){return""===t}}d&&(c+=" or a KeyObject",u+="or a KeyObject"),e.exports=function(e){var t={hs:b,rs:y,ps:w,es:S,none:C},n={hs:v,rs:_,ps:k,es:j,none:x},r=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!r)throw p('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var o=(r[1]||r[3]).toLowerCase(),s=r[2];return{sign:t[o](s),verify:n[o](s)}}},"../notebook-dds/node_modules/jws/index.js":function(e,t,n){var r=n("../notebook-dds/node_modules/jws/lib/sign-stream.js"),o=n("../notebook-dds/node_modules/jws/lib/verify-stream.js");t.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],t.sign=r.sign,t.verify=o.verify,t.decode=o.decode,t.isValid=o.isValid,t.createSign=function(e){return new r(e)},t.createVerify=function(e){return new o(e)}},"../notebook-dds/node_modules/jws/lib/data-stream.js":function(e,t,n){(function(t){var r=n("../notebook-dds/node_modules/safe-buffer/index.js").Buffer,o=n("./node_modules/stream-browserify/index.js");function s(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=r.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=r.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,t.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}n("./node_modules/util/util.js").inherits(s,o),s.prototype.write=function(e){this.buffer=r.concat([this.buffer,r.from(e)]),this.emit("data",e)},s.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},e.exports=s}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/jws/lib/sign-stream.js":function(e,t,n){var r=n("../notebook-dds/node_modules/safe-buffer/index.js").Buffer,o=n("../notebook-dds/node_modules/jws/lib/data-stream.js"),s=n("../notebook-dds/node_modules/jwa/index.js"),i=n("./node_modules/stream-browserify/index.js"),a=n("../notebook-dds/node_modules/jws/lib/tostring.js"),u=n("./node_modules/util/util.js");function c(e,t){return r.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function d(e){var t=e.header,n=e.payload,r=e.secret||e.privateKey,o=e.encoding,i=s(t.alg),d=function(e,t,n){n=n||"utf8";var r=c(a(e),"binary"),o=c(a(t),n);return u.format("%s.%s",r,o)}(t,n,o),l=i.sign(d,r);return u.format("%s.%s",d,l)}function l(e){var t=e.secret||e.privateKey||e.key,n=new o(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=n,this.payload=new o(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}u.inherits(l,i),l.prototype.sign=function(){try{var e=d({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},l.sign=d,e.exports=l},"../notebook-dds/node_modules/jws/lib/tostring.js":function(e,t,n){var r=n("./node_modules/buffer/index.js").Buffer;e.exports=function(e){return"string"==typeof e?e:"number"==typeof e||r.isBuffer(e)?e.toString():JSON.stringify(e)}},"../notebook-dds/node_modules/jws/lib/verify-stream.js":function(e,t,n){var r=n("../notebook-dds/node_modules/safe-buffer/index.js").Buffer,o=n("../notebook-dds/node_modules/jws/lib/data-stream.js"),s=n("../notebook-dds/node_modules/jwa/index.js"),i=n("./node_modules/stream-browserify/index.js"),a=n("../notebook-dds/node_modules/jws/lib/tostring.js"),u=n("./node_modules/util/util.js"),c=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function d(e){var t=e.split(".",1)[0];return function(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}(r.from(t,"base64").toString("binary"))}function l(e){return e.split(".")[2]}function h(e){return c.test(e)&&!!d(e)}function f(e,t,n){if(!t){var r=new Error("Missing algorithm parameter for jws.verify");throw r.code="MISSING_ALGORITHM",r}var o=l(e=a(e)),i=function(e){return e.split(".",2).join(".")}(e);return s(t).verify(i,o,n)}function m(e,t){if(t=t||{},!h(e=a(e)))return null;var n=d(e);if(!n)return null;var o=function(e,t){t=t||"utf8";var n=e.split(".")[1];return r.from(n,"base64").toString(t)}(e);return("JWT"===n.typ||t.json)&&(o=JSON.parse(o,t.encoding)),{header:n,payload:o,signature:l(e)}}function p(e){var t=(e=e||{}).secret||e.publicKey||e.key,n=new o(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=n,this.signature=new o(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}u.inherits(p,i),p.prototype.verify=function(){try{var e=f(this.signature.buffer,this.algorithm,this.key.buffer),t=m(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},p.decode=m,p.isValid=h,p.verify=f,e.exports=p},"../notebook-dds/node_modules/jwt-decode/lib/atob.js":function(e,t){function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,s=0,i=0,a="";o=t.charAt(i++);~o&&(r=s%4?64*r+o:o,s++%4)?a+=String.fromCharCode(255&r>>(-2*s&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return a}},"../notebook-dds/node_modules/jwt-decode/lib/base64_url_decode.js":function(e,t,n){var r=n("../notebook-dds/node_modules/jwt-decode/lib/atob.js");e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return r(t)}}},"../notebook-dds/node_modules/jwt-decode/lib/index.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/jwt-decode/lib/base64_url_decode.js");function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(r(e.split(".")[n]))}catch(e){throw new o("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=o},"../notebook-dds/node_modules/lodash.includes/index.js":function(e,t){var n=9007199254740991,r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,i=/^0o[0-7]+$/i,a=/^(?:0|[1-9]\d*)$/,u=parseInt;function c(e){return e!=e}var d,l,h=Object.prototype,f=h.hasOwnProperty,m=h.toString,p=h.propertyIsEnumerable,g=(d=Object.keys,l=Object,function(e){return d(l(e))}),b=Math.max;function v(e,t){var n=_(e)||function(e){return function(e){return S(e)&&w(e)}(e)&&f.call(e,"callee")&&(!p.call(e,"callee")||"[object Arguments]"==m.call(e))}(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,o=!!r;for(var s in e)!t&&!f.call(e,s)||o&&("length"==s||y(s,r))||n.push(s);return n}function y(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||a.test(e))&&e>-1&&e%1==0&&e<t}var _=Array.isArray;function w(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}(e.length)&&!function(e){var t=k(e)?m.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}function k(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function S(e){return!!e&&"object"==typeof e}e.exports=function(e,t,n,a){var d;e=w(e)?e:(d=e)?function(e,t){return function(e,t){for(var n=-1,r=e?e.length:0,o=Array(r);++n<r;)o[n]=t(e[n]);return o}(t,(function(t){return e[t]}))}(d,function(e){return w(e)?v(e):function(e){if(!function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||h)}(e))return g(e);var t=[];for(var n in Object(e))f.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}(d)):[],n=n&&!a?function(e){var t=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||S(e)&&"[object Symbol]"==m.call(e)}(e))return NaN;if(k(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=k(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var n=s.test(e);return n||i.test(e)?u(e.slice(2),n?2:8):o.test(e)?NaN:+e}(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),n=t%1;return t==t?n?t-n:t:0}(n):0;var l=e.length;return n<0&&(n=b(l+n,0)),function(e){return"string"==typeof e||!_(e)&&S(e)&&"[object String]"==m.call(e)}(e)?n<=l&&e.indexOf(t,n)>-1:!!l&&function(e,t,n){if(t!=t)return function(e,t,n,r){for(var o=e.length,s=n+-1;++s<o;)if(t(e[s],s,e))return s;return-1}(e,c,n);for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t,n)>-1}},"../notebook-dds/node_modules/lodash.isboolean/index.js":function(e,t){var n=Object.prototype.toString;e.exports=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Boolean]"==n.call(e)}},"../notebook-dds/node_modules/lodash.isinteger/index.js":function(e,t){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,i=parseInt,a=Object.prototype.toString;function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return"number"==typeof e&&e==function(e){var t=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==a.call(e)}(e))return NaN;if(u(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=u(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var c=o.test(e);return c||s.test(e)?i(e.slice(2),c?2:8):r.test(e)?NaN:+e}(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),c=t%1;return t==t?c?t-c:t:0}(e)}},"../notebook-dds/node_modules/lodash.isnumber/index.js":function(e,t){var n=Object.prototype.toString;e.exports=function(e){return"number"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Number]"==n.call(e)}},"../notebook-dds/node_modules/lodash.isplainobject/index.js":function(e,t){var n,r,o=Function.prototype,s=Object.prototype,i=o.toString,a=s.hasOwnProperty,u=i.call(Object),c=s.toString,d=(n=Object.getPrototypeOf,r=Object,function(e){return n(r(e))});e.exports=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=c.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=d(e);if(null===t)return!0;var n=a.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&i.call(n)==u}},"../notebook-dds/node_modules/lodash.isstring/index.js":function(e,t){var n=Object.prototype.toString,r=Array.isArray;e.exports=function(e){return"string"==typeof e||!r(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==n.call(e)}},"../notebook-dds/node_modules/lodash.once/index.js":function(e,t){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,i=parseInt,a=Object.prototype.toString;function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return function(e,t){var c;if("function"!=typeof t)throw new TypeError("Expected a function");return e=function(e){var t=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==a.call(e)}(e))return NaN;if(u(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=u(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var c=o.test(e);return c||s.test(e)?i(e.slice(2),c?2:8):r.test(e)?NaN:+e}(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),c=t%1;return t==t?c?t-c:t:0}(e),function(){return--e>0&&(c=t.apply(this,arguments)),e<=1&&(t=void 0),c}}(2,e)}},"../notebook-dds/node_modules/ms/index.js":function(e,t){var n=1e3,r=6e4,o=60*r,s=24*o;function i(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return i*s;case"hours":case"hour":case"hrs":case"hr":case"h":return i*o;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);return t>=s?i(e,t,s,"day"):t>=o?i(e,t,o,"hour"):t>=r?i(e,t,r,"minute"):t>=n?i(e,t,n,"second"):e+" ms"}(e):function(e){var t=Math.abs(e);return t>=s?Math.round(e/s)+"d":t>=o?Math.round(e/o)+"h":t>=r?Math.round(e/r)+"m":t>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../notebook-dds/node_modules/parseqs/index.js":function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var s=n[r].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},"../notebook-dds/node_modules/parseuri/index.js":function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,o=e.indexOf("["),s=e.indexOf("]");-1!=o&&-1!=s&&(e=e.substring(0,o)+e.substring(o,s).replace(/:/g,";")+e.substring(s,e.length));for(var i=n.exec(e||""),a={},u=14;u--;)a[r[u]]=i[u]||"";return-1!=o&&-1!=s&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(e,t){var n=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.substr(0,1)&&0!==t.length||n.splice(0,1),"/"==t.substr(t.length-1,1)&&n.splice(n.length-1,1),n}(0,a.path),a.queryKey=function(e,t){var n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,a.query),a}},"../notebook-dds/node_modules/path-browserify/index.js":function(e,t,n){"use strict";(function(t){function n(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function r(e,t){for(var n,r="",o=0,s=-1,i=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(s===a-1||1===i);else if(s!==a-1&&2===i){if(r.length<2||2!==o||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",o=0):o=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),s=a,i=0;continue}}else if(2===r.length||1===r.length){r="",o=0,s=a,i=0;continue}t&&(r.length>0?r+="/..":r="..",o=2)}else r.length>0?r+="/"+e.slice(s+1,a):r=e.slice(s+1,a),o=a-s-1;s=a,i=0}else 46===n&&-1!==i?++i:i=-1}return r}var o={resolve:function(){for(var e,o="",s=!1,i=arguments.length-1;i>=-1&&!s;i--){var a;i>=0?a=arguments[i]:(void 0===e&&(e=t.cwd()),a=e),n(a),0!==a.length&&(o=a+"/"+o,s=47===a.charCodeAt(0))}return o=r(o,!s),s?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(e){if(n(e),0===e.length)return".";var t=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=r(e,!t)).length||t||(e="."),e.length>0&&o&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return n(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];n(r),r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":o.normalize(e)},relative:function(e,t){if(n(e),n(t),e===t)return"";if((e=o.resolve(e))===(t=o.resolve(t)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var s=e.length,i=s-r,a=1;a<t.length&&47===t.charCodeAt(a);++a);for(var u=t.length-a,c=i<u?i:u,d=-1,l=0;l<=c;++l){if(l===c){if(u>c){if(47===t.charCodeAt(a+l))return t.slice(a+l+1);if(0===l)return t.slice(a+l)}else i>c&&(47===e.charCodeAt(r+l)?d=l:0===l&&(d=0));break}var h=e.charCodeAt(r+l);if(h!==t.charCodeAt(a+l))break;47===h&&(d=l)}var f="";for(l=r+d+1;l<=s;++l)l!==s&&47!==e.charCodeAt(l)||(0===f.length?f+="..":f+="/..");return f.length>0?f+t.slice(a+d):(a+=d,47===t.charCodeAt(a)&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(n(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,o=-1,s=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!s){o=i;break}}else s=!1;return-1===o?r?"/":".":r&&1===o?"//":e.slice(0,o)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');n(e);var r,o=0,s=-1,i=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,u=-1;for(r=e.length-1;r>=0;--r){var c=e.charCodeAt(r);if(47===c){if(!i){o=r+1;break}}else-1===u&&(i=!1,u=r+1),a>=0&&(c===t.charCodeAt(a)?-1==--a&&(s=r):(a=-1,s=u))}return o===s?s=u:-1===s&&(s=e.length),e.slice(o,s)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!i){o=r+1;break}}else-1===s&&(i=!1,s=r+1);return-1===s?"":e.slice(o,s)},extname:function(e){n(e);for(var t=-1,r=0,o=-1,s=!0,i=0,a=e.length-1;a>=0;--a){var u=e.charCodeAt(a);if(47!==u)-1===o&&(s=!1,o=a+1),46===u?-1===t?t=a:1!==i&&(i=1):-1!==t&&(i=-1);else if(!s){r=a+1;break}}return-1===t||-1===o||0===i||1===i&&t===o-1&&t===r+1?"":e.slice(t,o)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+"/"+r:r}(0,e)},parse:function(e){n(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var r,o=e.charCodeAt(0),s=47===o;s?(t.root="/",r=1):r=0;for(var i=-1,a=0,u=-1,c=!0,d=e.length-1,l=0;d>=r;--d)if(47!==(o=e.charCodeAt(d)))-1===u&&(c=!1,u=d+1),46===o?-1===i?i=d:1!==l&&(l=1):-1!==i&&(l=-1);else if(!c){a=d+1;break}return-1===i||-1===u||0===l||1===l&&i===u-1&&i===a+1?-1!==u&&(t.base=t.name=0===a&&s?e.slice(1,u):e.slice(a,u)):(0===a&&s?(t.name=e.slice(1,i),t.base=e.slice(1,u)):(t.name=e.slice(a,i),t.base=e.slice(a,u)),t.ext=e.slice(i,u)),a>0?t.dir=e.slice(0,a-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};o.posix=o,e.exports=o}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/safe-buffer/index.js":function(e,t,n){var r=n("./node_modules/buffer/index.js"),o=r.Buffer;function s(e,t){for(var n in e)t[n]=e[n]}function i(e,t,n){return o(e,t,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=r:(s(r,t),t.Buffer=i),i.prototype=Object.create(o.prototype),s(o,i),i.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,n)},i.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=o(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},"../notebook-dds/node_modules/semver/semver.js":function(e,t,n){(function(n){var r;t=e.exports=K,r="object"==typeof n&&Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"})&&Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var o=Number.MAX_SAFE_INTEGER||9007199254740991,s=t.re=[],i=t.src=[],a=0,u=a++;i[u]="0|[1-9]\\d*";var c=a++;i[c]="[0-9]+";var d=a++;i[d]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var l=a++;i[l]="("+i[u]+")\\.("+i[u]+")\\.("+i[u]+")";var h=a++;i[h]="("+i[c]+")\\.("+i[c]+")\\.("+i[c]+")";var f=a++;i[f]="(?:"+i[u]+"|"+i[d]+")";var m=a++;i[m]="(?:"+i[c]+"|"+i[d]+")";var p=a++;i[p]="(?:-("+i[f]+"(?:\\."+i[f]+")*))";var g=a++;i[g]="(?:-?("+i[m]+"(?:\\."+i[m]+")*))";var b=a++;i[b]="[0-9A-Za-z-]+";var v=a++;i[v]="(?:\\+("+i[b]+"(?:\\."+i[b]+")*))";var y=a++,_="v?"+i[l]+i[p]+"?"+i[v]+"?";i[y]="^"+_+"$";var w="[v=\\s]*"+i[h]+i[g]+"?"+i[v]+"?",k=a++;i[k]="^"+w+"$";var S=a++;i[S]="((?:<|>)?=?)";var j=a++;i[j]=i[c]+"|x|X|\\*";var C=a++;i[C]=i[u]+"|x|X|\\*";var x=a++;i[x]="[v=\\s]*("+i[C]+")(?:\\.("+i[C]+")(?:\\.("+i[C]+")(?:"+i[p]+")?"+i[v]+"?)?)?";var O=a++;i[O]="[v=\\s]*("+i[j]+")(?:\\.("+i[j]+")(?:\\.("+i[j]+")(?:"+i[g]+")?"+i[v]+"?)?)?";var E=a++;i[E]="^"+i[S]+"\\s*"+i[x]+"$";var I=a++;i[I]="^"+i[S]+"\\s*"+i[O]+"$";var A=a++;i[A]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var N=a++;i[N]="(?:~>?)";var T=a++;i[T]="(\\s*)"+i[N]+"\\s+",s[T]=new RegExp(i[T],"g");var F=a++;i[F]="^"+i[N]+i[x]+"$";var P=a++;i[P]="^"+i[N]+i[O]+"$";var R=a++;i[R]="(?:\\^)";var D=a++;i[D]="(\\s*)"+i[R]+"\\s+",s[D]=new RegExp(i[D],"g");var M=a++;i[M]="^"+i[R]+i[x]+"$";var L=a++;i[L]="^"+i[R]+i[O]+"$";var B=a++;i[B]="^"+i[S]+"\\s*("+w+")$|^$";var q=a++;i[q]="^"+i[S]+"\\s*("+_+")$|^$";var z=a++;i[z]="(\\s*)"+i[S]+"\\s*("+w+"|"+i[x]+")",s[z]=new RegExp(i[z],"g");var H=a++;i[H]="^\\s*("+i[x]+")\\s+-\\s+("+i[x]+")\\s*$";var U=a++;i[U]="^\\s*("+i[O]+")\\s+-\\s+("+i[O]+")\\s*$";var V=a++;i[V]="(<|>)?=?\\s*\\*";for(var $=0;$<35;$++)r($,i[$]),s[$]||(s[$]=new RegExp(i[$]));function W(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof K)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?s[k]:s[y]).test(e))return null;try{return new K(e,t)}catch(e){return null}}function K(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof K){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof K))return new K(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var n=e.trim().match(t.loose?s[k]:s[y]);if(!n)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}t.parse=W,t.valid=function(e,t){var n=W(e,t);return n?n.version:null},t.clean=function(e,t){var n=W(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null},t.SemVer=K,K.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},K.prototype.toString=function(){return this.version},K.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof K||(e=new K(e,this.options)),this.compareMain(e)||this.comparePre(e)},K.prototype.compareMain=function(e){return e instanceof K||(e=new K(e,this.options)),J(this.major,e.major)||J(this.minor,e.minor)||J(this.patch,e.patch)},K.prototype.comparePre=function(e){if(e instanceof K||(e=new K(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],o=e.prerelease[t];if(r("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return J(n,o)}while(++t)},K.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,n,r){"string"==typeof n&&(r=n,n=void 0);try{return new K(e,n).inc(t,r).version}catch(e){return null}},t.diff=function(e,t){if(Q(e,t))return null;var n=W(e),r=W(t),o="";if(n.prerelease.length||r.prerelease.length){o="pre";var s="prerelease"}for(var i in n)if(("major"===i||"minor"===i||"patch"===i)&&n[i]!==r[i])return o+i;return s},t.compareIdentifiers=J;var G=/^[0-9]+$/;function J(e,t){var n=G.test(e),r=G.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1}function Z(e,t,n){return new K(e,n).compare(new K(t,n))}function X(e,t,n){return Z(e,t,n)>0}function Y(e,t,n){return Z(e,t,n)<0}function Q(e,t,n){return 0===Z(e,t,n)}function ee(e,t,n){return 0!==Z(e,t,n)}function te(e,t,n){return Z(e,t,n)>=0}function ne(e,t,n){return Z(e,t,n)<=0}function re(e,t,n,r){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return Q(e,n,r);case"!=":return ee(e,n,r);case">":return X(e,n,r);case">=":return te(e,n,r);case"<":return Y(e,n,r);case"<=":return ne(e,n,r);default:throw new TypeError("Invalid operator: "+t)}}function oe(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof oe){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof oe))return new oe(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===se?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return J(t,e)},t.major=function(e,t){return new K(e,t).major},t.minor=function(e,t){return new K(e,t).minor},t.patch=function(e,t){return new K(e,t).patch},t.compare=Z,t.compareLoose=function(e,t){return Z(e,t,!0)},t.rcompare=function(e,t,n){return Z(t,e,n)},t.sort=function(e,n){return e.sort((function(e,r){return t.compare(e,r,n)}))},t.rsort=function(e,n){return e.sort((function(e,r){return t.rcompare(e,r,n)}))},t.gt=X,t.lt=Y,t.eq=Q,t.neq=ee,t.gte=te,t.lte=ne,t.cmp=re,t.Comparator=oe;var se={};function ie(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ie)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new ie(e.raw,t);if(e instanceof oe)return new ie(e.value,t);if(!(this instanceof ie))return new ie(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function ue(e,t,n,r,o,s,i,a,u,c,d,l,h){return((t=ae(n)?"":ae(r)?">="+n+".0.0":ae(o)?">="+n+"."+r+".0":">="+t)+" "+(a=ae(u)?"":ae(c)?"<"+(+u+1)+".0.0":ae(d)?"<"+u+"."+(+c+1)+".0":l?"<="+u+"."+c+"."+d+"-"+l:"<="+a)).trim()}function ce(e,t,n){for(var o=0;o<e.length;o++)if(!e[o].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(o=0;o<e.length;o++)if(r(e[o].semver),e[o].semver!==se&&e[o].semver.prerelease.length>0){var s=e[o].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}function de(e,t,n){try{t=new ie(t,n)}catch(e){return!1}return t.test(e)}function le(e,t,n,r){var o,s,i,a,u;switch(e=new K(e,r),t=new ie(t,r),n){case">":o=X,s=ne,i=Y,a=">",u=">=";break;case"<":o=Y,s=te,i=X,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(de(e,t,r))return!1;for(var c=0;c<t.set.length;++c){var d=t.set[c],l=null,h=null;if(d.forEach((function(e){e.semver===se&&(e=new oe(">=0.0.0")),l=l||e,h=h||e,o(e.semver,l.semver,r)?l=e:i(e.semver,h.semver,r)&&(h=e)})),l.operator===a||l.operator===u)return!1;if((!h.operator||h.operator===a)&&s(e,h.semver))return!1;if(h.operator===u&&i(e,h.semver))return!1}return!0}oe.prototype.parse=function(e){var t=this.options.loose?s[B]:s[q],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=n[1],"="===this.operator&&(this.operator=""),n[2]?this.semver=new K(n[2],this.options.loose):this.semver=se},oe.prototype.toString=function(){return this.value},oe.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===se||("string"==typeof e&&(e=new K(e,this.options)),re(e,this.operator,this.semver,this.options))},oe.prototype.intersects=function(e,t){if(!(e instanceof oe))throw new TypeError("a Comparator is required");var n;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return n=new ie(e.value,t),de(this.value,n,t);if(""===e.operator)return n=new ie(this.value,t),de(e.semver,n,t);var r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,i=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),u=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||o||s&&i||a||u},t.Range=ie,ie.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},ie.prototype.toString=function(){return this.range},ie.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?s[U]:s[H];e=e.replace(n,ue),r("hyphen replace",e),e=e.replace(s[z],"$1$2$3"),r("comparator trim",e,s[z]),e=(e=(e=e.replace(s[T],"$1~")).replace(s[D],"$1^")).split(/\s+/).join(" ");var o=t?s[B]:s[q],i=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?s[L]:s[M];return e.replace(n,(function(t,n,o,s,i){var a;return r("caret",e,t,n,o,s,i),ae(n)?a="":ae(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(s)?a="0"===n?">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":">="+n+"."+o+".0 <"+(+n+1)+".0.0":i?(r("replaceCaret pr",i),a="0"===n?"0"===o?">="+n+"."+o+"."+s+"-"+i+" <"+n+"."+o+"."+(+s+1):">="+n+"."+o+"."+s+"-"+i+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+s+"-"+i+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===o?">="+n+"."+o+"."+s+" <"+n+"."+o+"."+(+s+1):">="+n+"."+o+"."+s+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+s+" <"+(+n+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?s[P]:s[F];return e.replace(n,(function(t,n,o,s,i){var a;return r("tilde",e,t,n,o,s,i),ae(n)?a="":ae(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(s)?a=">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":i?(r("replaceTilde pr",i),a=">="+n+"."+o+"."+s+"-"+i+" <"+n+"."+(+o+1)+".0"):a=">="+n+"."+o+"."+s+" <"+n+"."+(+o+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?s[I]:s[E];return e.replace(n,(function(t,n,o,s,i,a){r("xRange",e,t,n,o,s,i,a);var u=ae(o),c=u||ae(s),d=c||ae(i);return"="===n&&d&&(n=""),u?t=">"===n||"<"===n?"<0.0.0":"*":n&&d?(c&&(s=0),i=0,">"===n?(n=">=",c?(o=+o+1,s=0,i=0):(s=+s+1,i=0)):"<="===n&&(n="<",c?o=+o+1:s=+s+1),t=n+o+"."+s+"."+i):c?t=">="+o+".0.0 <"+(+o+1)+".0.0":d&&(t=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(s[V],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter((function(e){return!!e.match(o)}))),i.map((function(e){return new oe(e,this.options)}),this)},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Range is required");return this.set.some((function(n){return n.every((function(n){return e.set.some((function(e){return e.every((function(e){return n.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new ie(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},ie.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new K(e,this.options));for(var t=0;t<this.set.length;t++)if(ce(this.set[t],e,this.options))return!0;return!1},t.satisfies=de,t.maxSatisfying=function(e,t,n){var r=null,o=null;try{var s=new ie(t,n)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(r&&-1!==o.compare(e)||(o=new K(r=e,n)))})),r},t.minSatisfying=function(e,t,n){var r=null,o=null;try{var s=new ie(t,n)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(r&&1!==o.compare(e)||(o=new K(r=e,n)))})),r},t.minVersion=function(e,t){e=new ie(e,t);var n=new K("0.0.0");if(e.test(n))return n;if(n=new K("0.0.0-0"),e.test(n))return n;n=null;for(var r=0;r<e.set.length;++r)e.set[r].forEach((function(e){var t=new K(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!X(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}));return n&&e.test(n)?n:null},t.validRange=function(e,t){try{return new ie(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,n){return le(e,t,"<",n)},t.gtr=function(e,t,n){return le(e,t,">",n)},t.outside=le,t.prerelease=function(e,t){var n=W(e,t);return n&&n.prerelease.length?n.prerelease:null},t.intersects=function(e,t,n){return e=new ie(e,n),t=new ie(t,n),e.intersects(t)},t.coerce=function(e){if(e instanceof K)return e;if("string"!=typeof e)return null;var t=e.match(s[A]);return null==t?null:W(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/sillyname/index.js":function(e,t){var n=["Black","White","Gray","Brown","Red","Pink","Crimson","Carnelian","Orange","Yellow","Ivory","Cream","Green","Viridian","Aquamarine","Cyan","Blue","Cerulean","Azure","Indigo","Navy","Violet","Purple","Lavender","Magenta","Rainbow","Iridescent","Spectrum","Prism","Bold","Vivid","Pale","Clear","Glass","Translucent","Misty","Dark","Light","Gold","Silver","Copper","Bronze","Steel","Iron","Brass","Mercury","Zinc","Chrome","Platinum","Titanium","Nickel","Lead","Pewter","Rust","Metal","Stone","Quartz","Granite","Marble","Alabaster","Agate","Jasper","Pebble","Pyrite","Crystal","Geode","Obsidian","Mica","Flint","Sand","Gravel","Boulder","Basalt","Ruby","Beryl","Scarlet","Citrine","Sulpher","Topaz","Amber","Emerald","Malachite","Jade","Abalone","Lapis","Sapphire","Diamond","Peridot","Gem","Jewel","Bevel","Coral","Jet","Ebony","Wood","Tree","Cherry","Maple","Cedar","Branch","Bramble","Rowan","Ash","Fir","Pine","Cactus","Alder","Grove","Forest","Jungle","Palm","Bush","Mulberry","Juniper","Vine","Ivy","Rose","Lily","Tulip","Daffodil","Honeysuckle","Fuschia","Hazel","Walnut","Almond","Lime","Lemon","Apple","Blossom","Bloom","Crocus","Rose","Buttercup","Dandelion","Iris","Carnation","Fern","Root","Branch","Leaf","Seed","Flower","Petal","Pollen","Orchid","Mangrove","Cypress","Sequoia","Sage","Heather","Snapdragon","Daisy","Mountain","Hill","Alpine","Chestnut","Valley","Glacier","Forest","Grove","Glen","Tree","Thorn","Stump","Desert","Canyon","Dune","Oasis","Mirage","Well","Spring","Meadow","Field","Prairie","Grass","Tundra","Island","Shore","Sand","Shell","Surf","Wave","Foam","Tide","Lake","River","Brook","Stream","Pool","Pond","Sun","Sprinkle","Shade","Shadow","Rain","Cloud","Storm","Hail","Snow","Sleet","Thunder","Lightning","Wind","Hurricane","Typhoon","Dawn","Sunrise","Morning","Noon","Twilight","Evening","Sunset","Midnight","Night","Sky","Star","Stellar","Comet","Nebula","Quasar","Solar","Lunar","Planet","Meteor","Sprout","Pear","Plum","Kiwi","Berry","Apricot","Peach","Mango","Pineapple","Coconut","Olive","Ginger","Root","Plain","Fancy","Stripe","Spot","Speckle","Spangle","Ring","Band","Blaze","Paint","Pinto","Shade","Tabby","Brindle","Patch","Calico","Checker","Dot","Pattern","Glitter","Glimmer","Shimmer","Dull","Dust","Dirt","Glaze","Scratch","Quick","Swift","Fast","Slow","Clever","Fire","Flicker","Flash","Spark","Ember","Coal","Flame","Chocolate","Vanilla","Sugar","Spice","Cake","Pie","Cookie","Candy","Caramel","Spiral","Round","Jelly","Square","Narrow","Long","Short","Small","Tiny","Big","Giant","Great","Atom","Peppermint","Mint","Butter","Fringe","Rag","Quilt","Truth","Lie","Holy","Curse","Noble","Sly","Brave","Shy","Lava","Foul","Leather","Fantasy","Keen","Luminous","Feather","Sticky","Gossamer","Cotton","Rattle","Silk","Satin","Cord","Denim","Flannel","Plaid","Wool","Linen","Silent","Flax","Weak","Valiant","Fierce","Gentle","Rhinestone","Splash","North","South","East","West","Summer","Winter","Autumn","Spring","Season","Equinox","Solstice","Paper","Motley","Torch","Ballistic","Rampant","Shag","Freckle","Wild","Free","Chain","Sheer","Crazy","Mad","Candle","Ribbon","Lace","Notch","Wax","Shine","Shallow","Deep","Bubble","Harvest","Fluff","Venom","Boom","Slash","Rune","Cold","Quill","Love","Hate","Garnet","Zircon","Power","Bone","Void","Horn","Glory","Cyber","Nova","Hot","Helix","Cosmic","Quark","Quiver","Holly","Clover","Polar","Regal","Ripple","Ebony","Wheat","Phantom","Dew","Chisel","Crack","Chatter","Laser","Foil","Tin","Clever","Treasure","Maze","Twisty","Curly","Fortune","Fate","Destiny","Cute","Slime","Ink","Disco","Plume","Time","Psychadelic","Relic","Fossil","Water","Savage","Ancient","Rapid","Road","Trail","Stitch","Button","Bow","Nimble","Zest","Sour","Bitter","Phase","Fan","Frill","Plump","Pickle","Mud","Puddle","Pond","River","Spring","Stream","Battle","Arrow","Plume","Roan","Pitch","Tar","Cat","Dog","Horse","Lizard","Bird","Fish","Saber","Scythe","Sharp","Soft","Razor","Neon","Dandy","Weed","Swamp","Marsh","Bog","Peat","Moor","Muck","Mire","Grave","Fair","Just","Brick","Puzzle","Skitter","Prong","Fork","Dent","Dour","Warp","Luck","Coffee","Split","Chip","Hollow","Heavy","Legend","Hickory","Mesquite","Nettle","Rogue","Charm","Prickle","Bead","Sponge","Whip","Bald","Frost","Fog","Oil","Veil","Cliff","Volcano","Rift","Maze","Proud","Dew","Mirror","Shard","Salt","Pepper","Honey","Thread","Bristle","Ripple","Glow","Zenith"],r=["head","crest","crown","tooth","fang","horn","frill","skull","bone","tongue","throat","voice","nose","snout","chin","eye","sight","seer","speaker","singer","song","chanter","howler","chatter","shrieker","shriek","jaw","bite","biter","neck","shoulder","fin","wing","arm","lifter","grasp","grabber","hand","paw","foot","finger","toe","thumb","talon","palm","touch","racer","runner","hoof","fly","flier","swoop","roar","hiss","hisser","snarl","dive","diver","rib","chest","back","ridge","leg","legs","tail","beak","walker","lasher","swisher","carver","kicker","roarer","crusher","spike","shaker","charger","hunter","weaver","crafter","binder","scribe","muse","snap","snapper","slayer","stalker","track","tracker","scar","scarer","fright","killer","death","doom","healer","saver","friend","foe","guardian","thunder","lightning","cloud","storm","forger","scale","hair","braid","nape","belly","thief","stealer","reaper","giver","taker","dancer","player","gambler","twister","turner","painter","dart","drifter","sting","stinger","venom","spur","ripper","swallow","devourer","knight","lady","lord","queen","king","master","mistress","prince","princess","duke","dutchess","samurai","ninja","knave","slave","servant","sage","wizard","witch","warlock","warrior","jester","paladin","bard","trader","sword","shield","knife","dagger","arrow","bow","fighter","bane","follower","leader","scourge","watcher","cat","panther","tiger","cougar","puma","jaguar","ocelot","lynx","lion","leopard","ferret","weasel","wolverine","bear","raccoon","dog","wolf","kitten","puppy","cub","fox","hound","terrier","coyote","hyena","jackal","pig","horse","donkey","stallion","mare","zebra","antelope","gazelle","deer","buffalo","bison","boar","elk","whale","dolphin","shark","fish","minnow","salmon","ray","fisher","otter","gull","duck","goose","crow","raven","bird","eagle","raptor","hawk","falcon","moose","heron","owl","stork","crane","sparrow","robin","parrot","cockatoo","carp","lizard","gecko","iguana","snake","python","viper","boa","condor","vulture","spider","fly","scorpion","heron","oriole","toucan","bee","wasp","hornet","rabbit","bunny","hare","brow","mustang","ox","piper","soarer","flasher","moth","mask","hide","hero","antler","chill","chiller","gem","ogre","myth","elf","fairy","pixie","dragon","griffin","unicorn","pegasus","sprite","fancier","chopper","slicer","skinner","butterfly","legend","wanderer","rover","raver","loon","lancer","glass","glazer","flame","crystal","lantern","lighter","cloak","bell","ringer","keeper","centaur","bolt","catcher","whimsey","quester","rat","mouse","serpent","wyrm","gargoyle","thorn","whip","rider","spirit","sentry","bat","beetle","burn","cowl","stone","gem","collar","mark","grin","scowl","spear","razor","edge","seeker","jay","ape","monkey","gorilla","koala","kangaroo","yak","sloth","ant","roach","weed","seed","eater","razor","shirt","face","goat","mind","shift","rider","face","mole","vole","pirate","llama","stag","bug","cap","boot","drop","hugger","sargent","snagglefoot","carpet","curtain"];function o(e){return e=e||Math.random,r[Math.floor(e()*r.length)]}function s(e){return e=e||Math.random,n[Math.floor(e()*n.length)]}e.exports=function(e){var t=o(e),n=o(e);return n=n.substr(0,1).toUpperCase()+n.substr(1),s(e)+t+" "+n},e.exports.randomNoun=o,e.exports.randomAdjective=s},"../notebook-dds/node_modules/socket.io-client/lib/index.js":function(e,t,n){var r=n("../notebook-dds/node_modules/socket.io-client/lib/url.js"),o=n("../notebook-dds/node_modules/socket.io-parser/index.js"),s=n("../notebook-dds/node_modules/socket.io-client/lib/manager.js"),i=n("../notebook-dds/node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client");e.exports=t=u;var a=t.managers={};function u(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o=r(e),u=o.source,c=o.id,d=o.path,l=a[c]&&d in a[c].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||l?(i("ignoring socket cache for %s",u),n=s(u,t)):(a[c]||(i("new io instance for %s",u),a[c]=s(u,t)),n=a[c]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}t.protocol=o.protocol,t.connect=u,t.Manager=n("../notebook-dds/node_modules/socket.io-client/lib/manager.js"),t.Socket=n("../notebook-dds/node_modules/socket.io-client/lib/socket.js")},"../notebook-dds/node_modules/socket.io-client/lib/manager.js":function(e,t,n){var r=n("../notebook-dds/node_modules/engine.io-client/lib/index.js"),o=n("../notebook-dds/node_modules/socket.io-client/lib/socket.js"),s=n("../notebook-dds/node_modules/component-emitter/index.js"),i=n("../notebook-dds/node_modules/socket.io-parser/index.js"),a=n("../notebook-dds/node_modules/socket.io-client/lib/on.js"),u=n("../notebook-dds/node_modules/component-bind/index.js"),c=n("../notebook-dds/node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client:manager"),d=n("../notebook-dds/node_modules/indexof/index.js"),l=n("../notebook-dds/node_modules/backo2/index.js"),h=Object.prototype.hasOwnProperty;function f(e,t){if(!(this instanceof f))return new f(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||i;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=f,f.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},f.prototype.updateSocketIds=function(){for(var e in this.nsps)h.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},f.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},s(f.prototype),f.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},f.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},f.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(e,t){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var s=a(n,"open",(function(){o.onopen(),e&&e()})),i=a(n,"error",(function(t){if(c("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else o.maybeReconnectOnOpen()}));if(!1!==this._timeout){var u=this._timeout;c("connect attempt will timeout after %d",u),0===u&&s.destroy();var d=setTimeout((function(){c("connect attempt timed out after %d",u),s.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",u)}),u);this.subs.push({destroy:function(){clearTimeout(d)}})}return this.subs.push(s),this.subs.push(i),this},f.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",u(this,"ondata"))),this.subs.push(a(e,"ping",u(this,"onping"))),this.subs.push(a(e,"pong",u(this,"onpong"))),this.subs.push(a(e,"error",u(this,"onerror"))),this.subs.push(a(e,"close",u(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",u(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(e){this.decoder.add(e)},f.prototype.ondecoded=function(e){this.emit("packet",e)},f.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},f.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",s),n.on("connect",(function(){n.id=r.generateId(e)})),this.autoConnect&&s()}function s(){~d(r.connecting,n)||r.connecting.push(n)}return n},f.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},f.prototype.packet=function(e){c("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},f.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},f.prototype.cleanup=function(){c("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(e){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(c("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},f.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},"../notebook-dds/node_modules/socket.io-client/lib/on.js":function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},"../notebook-dds/node_modules/socket.io-client/lib/socket.js":function(e,t,n){var r=n("../notebook-dds/node_modules/socket.io-parser/index.js"),o=n("../notebook-dds/node_modules/component-emitter/index.js"),s=n("../notebook-dds/node_modules/to-array/index.js"),i=n("../notebook-dds/node_modules/socket.io-client/lib/on.js"),a=n("../notebook-dds/node_modules/component-bind/index.js"),u=n("../notebook-dds/node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client:socket"),c=n("../notebook-dds/node_modules/parseqs/index.js"),d=n("../notebook-dds/node_modules/has-binary2/index.js");e.exports=f;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=o.prototype.emit;function f(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[i(e,"open",a(this,"onopen")),i(e,"packet",a(this,"onpacket")),i(e,"close",a(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},f.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(l.hasOwnProperty(e))return h.apply(this,arguments),this;var t=s(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:d(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?c.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},f.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=s(arguments);u("sending ack %j",o),t.packet({type:d(o)?r.BINARY_ACK:r.ACK,id:e,data:o})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}},"../notebook-dds/node_modules/socket.io-client/lib/url.js":function(e,t,n){var r=n("../notebook-dds/node_modules/parseuri/index.js"),o=n("../notebook-dds/node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port,n.href=n.protocol+"://"+s+(t&&t.port===n.port?"":":"+n.port),n}},"../notebook-dds/node_modules/socket.io-client/node_modules/debug/src/browser.js":function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).DEBUG),e}(t=e.exports=n("../notebook-dds/node_modules/socket.io-client/node_modules/debug/src/debug.js")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(s=o))})),e.splice(s,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/socket.io-client/node_modules/debug/src/debug.js":function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,s=o-(n||o);e.diff=s,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var o=t.formatters[r];if("function"==typeof o){var s=i[u];n=o.call(e,s),i.splice(u,1),u--}return n})),t.formatArgs.call(e,i);var c=r.log||t.log||console.log.bind(console);c.apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("../notebook-dds/node_modules/socket.io-client/node_modules/ms/index.js"),t.instances=[],t.names=[],t.skips=[],t.formatters={}},"../notebook-dds/node_modules/socket.io-client/node_modules/ms/index.js":function(e,t){var n=1e3,r=6e4,o=60*r,s=24*o;function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var a,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"days":case"day":case"d":return i*s;case"hours":case"hour":case"hrs":case"hr":case"h":return i*o;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return t.long?i(a=e,s,"day")||i(a,o,"hour")||i(a,r,"minute")||i(a,n,"second")||a+" ms":function(e){return e>=s?Math.round(e/s)+"d":e>=o?Math.round(e/o)+"h":e>=r?Math.round(e/r)+"m":e>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../notebook-dds/node_modules/socket.io-parser/binary.js":function(e,t,n){var r=n("../notebook-dds/node_modules/isarray/index.js"),o=n("../notebook-dds/node_modules/socket.io-parser/is-buffer.js"),s=Object.prototype.toString,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===s.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===s.call(File);function u(e,t){if(!e)return e;if(o(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){for(var s=new Array(e.length),i=0;i<e.length;i++)s[i]=u(e[i],t);return s}if("object"==typeof e&&!(e instanceof Date)){for(var a in s={},e)s[a]=u(e[a],t);return s}return e}t.deconstructPacket=function(e){var t=[],n=e.data,r=e;return r.data=u(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],n);else if("object"==typeof t)for(var s in t)t[s]=e(t[s],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,s=e;!function e(u,c,d){if(!u)return u;if(i&&u instanceof Blob||a&&u instanceof File){n++;var l=new FileReader;l.onload=function(){d?d[c]=this.result:s=this.result,--n||t(s)},l.readAsArrayBuffer(u)}else if(r(u))for(var h=0;h<u.length;h++)e(u[h],h,u);else if("object"==typeof u&&!o(u))for(var f in u)e(u[f],f,u)}(s),n||t(s)}},"../notebook-dds/node_modules/socket.io-parser/index.js":function(e,t,n){var r=n("../notebook-dds/node_modules/socket.io-parser/node_modules/debug/src/browser.js")("socket.io-parser"),o=n("../notebook-dds/node_modules/component-emitter/index.js"),s=n("../notebook-dds/node_modules/socket.io-parser/binary.js"),i=n("../notebook-dds/node_modules/isarray/index.js"),a=n("../notebook-dds/node_modules/socket.io-parser/is-buffer.js");function u(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=u,t.Decoder=l;var c=t.ERROR+'"encode error"';function d(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===o)return c;n+=o}return r("encoded %j as %s",e,n),n}function l(){this.reconstructor=null}function h(e){this.reconPack=e,this.buffers=[]}function f(e){return{type:t.ERROR,data:"parser error: "+e}}u.prototype.encode=function(e,n){r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){s.removeBlobs(e,(function(e){var n=s.deconstructPacket(e),r=d(n.packet),o=n.buffers;o.unshift(r),t(o)}))}(e,n):n([d(e)])},o(l.prototype),l.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return f("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var s=n+1;"-"!==e.charAt(++n)&&n!=e.length;);var a=e.substring(s,n);if(a!=Number(a)||"-"!==e.charAt(n))throw new Error("Illegal attachments");o.attachments=Number(a)}if("/"===e.charAt(n+1)){for(s=n+1;++n&&","!==(c=e.charAt(n))&&n!==e.length;);o.nsp=e.substring(s,n)}else o.nsp="/";var u=e.charAt(n+1);if(""!==u&&Number(u)==u){for(s=n+1;++n;){var c;if(null==(c=e.charAt(n))||Number(c)!=c){--n;break}if(n===e.length)break}o.id=Number(e.substring(s,n+1))}if(e.charAt(++n)){var d=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!1===d||o.type!==t.ERROR&&!i(d))return f("invalid payload");o.data=d}return r("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new h(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=s.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},"../notebook-dds/node_modules/socket.io-parser/is-buffer.js":function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||r&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,r="function"==typeof ArrayBuffer}).call(this,n("./node_modules/buffer/index.js").Buffer)},"../notebook-dds/node_modules/socket.io-parser/node_modules/debug/src/browser.js":function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"",AZNB_PUB_COMPONENT_VERSION:"1.3.16",AZNB_PUB_DEFAULT_ENDPOINT:"%AZNB_BACKEND_ENDPOINT%",AZNB_PUB_AZNBCONTENT_ENDPOINT:"%AZNB_AZNBCONTENT_ENDPOINT%",AZNB_PUB_BUILDTAG:"notebooks-release-prod.4693184.20210426233000.c51d4ad0"}).DEBUG),e}(t=e.exports=n("../notebook-dds/node_modules/socket.io-parser/node_modules/debug/src/debug.js")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(s=o))})),e.splice(s,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n("./node_modules/process/browser.js"))},"../notebook-dds/node_modules/socket.io-parser/node_modules/debug/src/debug.js":function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,s=o-(n||o);e.diff=s,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var o=t.formatters[r];if("function"==typeof o){var s=i[u];n=o.call(e,s),i.splice(u,1),u--}return n})),t.formatArgs.call(e,i);var c=r.log||t.log||console.log.bind(console);c.apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("../notebook-dds/node_modules/socket.io-parser/node_modules/ms/index.js"),t.instances=[],t.names=[],t.skips=[],t.formatters={}},"../notebook-dds/node_modules/socket.io-parser/node_modules/ms/index.js":function(e,t){var n=1e3,r=6e4,o=60*r,s=24*o;function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var a,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"days":case"day":case"d":return i*s;case"hours":case"hour":case"hrs":case"hr":case"h":return i*o;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return t.long?i(a=e,s,"day")||i(a,o,"hour")||i(a,r,"minute")||i(a,n,"second")||a+" ms":function(e){return e>=s?Math.round(e/s)+"d":e>=o?Math.round(e/o)+"h":e>=r?Math.round(e/r)+"m":e>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../notebook-dds/node_modules/string-hash/index.js":function(e,t,n){"use strict";e.exports=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return t>>>0}},"../notebook-dds/node_modules/to-array/index.js":function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},"../notebook-dds/node_modules/uuid/dist/esm-browser/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"v1",(function(){return c})),n.d(t,"v3",(function(){return _})),n.d(t,"v4",(function(){return w.a})),n.d(t,"v5",(function(){return j})),n.d(t,"NIL",(function(){return C})),n.d(t,"version",(function(){return x})),n.d(t,"validate",(function(){return d.a})),n.d(t,"stringify",(function(){return i.a})),n.d(t,"parse",(function(){return l}));var r,o,s=n("../notebook-dds/node_modules/uuid/dist/esm-browser/rng.js"),i=n("../notebook-dds/node_modules/uuid/dist/esm-browser/stringify.js"),a=0,u=0,c=function(e,t,n){var c=t&&n||0,d=t||new Array(16),l=(e=e||{}).node||r,h=void 0!==e.clockseq?e.clockseq:o;if(null==l||null==h){var f=e.random||(e.rng||s.a)();null==l&&(l=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=o=16383&(f[6]<<8|f[7]))}var m=void 0!==e.msecs?e.msecs:Date.now(),p=void 0!==e.nsecs?e.nsecs:u+1,g=m-a+(p-u)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||m>a)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=m,u=p,o=h;var b=(1e4*(268435455&(m+=122192928e5))+p)%4294967296;d[c++]=b>>>24&255,d[c++]=b>>>16&255,d[c++]=b>>>8&255,d[c++]=255&b;var v=m/4294967296*1e4&268435455;d[c++]=v>>>8&255,d[c++]=255&v,d[c++]=v>>>24&15|16,d[c++]=v>>>16&255,d[c++]=h>>>8|128,d[c++]=255&h;for(var y=0;y<6;++y)d[c+y]=l[y];return t||Object(i.a)(d)},d=n("../notebook-dds/node_modules/uuid/dist/esm-browser/validate.js"),l=function(e){if(!Object(d.a)(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n},h=function(e,t,n){function r(e,r,o,s){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=l(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+e.length);if(a.set(r),a.set(e,r.length),(a=n(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,o){s=s||0;for(var u=0;u<16;++u)o[s+u]=a[u];return o}return Object(i.a)(a)}try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r};function f(e){return 14+(e+64>>>9<<4)+1}function m(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function p(e,t,n,r,o,s){return m((i=m(m(t,e),m(r,s)))<<(a=o)|i>>>32-a,n);var i,a}function g(e,t,n,r,o,s,i){return p(t&n|~t&r,e,t,o,s,i)}function b(e,t,n,r,o,s,i){return p(t&r|n&~r,e,t,o,s,i)}function v(e,t,n,r,o,s,i){return p(t^n^r,e,t,o,s,i)}function y(e,t,n,r,o,s,i){return p(n^(t|~r),e,t,o,s,i)}var _=h("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,r="0123456789abcdef",o=0;o<n;o+=8){var s=e[o>>5]>>>o%32&255,i=parseInt(r.charAt(s>>>4&15)+r.charAt(15&s),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[f(t)-1]=t;for(var n=1732584193,r=-271733879,o=-1732584194,s=271733878,i=0;i<e.length;i+=16){var a=n,u=r,c=o,d=s;n=g(n,r,o,s,e[i],7,-680876936),s=g(s,n,r,o,e[i+1],12,-389564586),o=g(o,s,n,r,e[i+2],17,606105819),r=g(r,o,s,n,e[i+3],22,-1044525330),n=g(n,r,o,s,e[i+4],7,-176418897),s=g(s,n,r,o,e[i+5],12,1200080426),o=g(o,s,n,r,e[i+6],17,-1473231341),r=g(r,o,s,n,e[i+7],22,-45705983),n=g(n,r,o,s,e[i+8],7,1770035416),s=g(s,n,r,o,e[i+9],12,-1958414417),o=g(o,s,n,r,e[i+10],17,-42063),r=g(r,o,s,n,e[i+11],22,-1990404162),n=g(n,r,o,s,e[i+12],7,1804603682),s=g(s,n,r,o,e[i+13],12,-40341101),o=g(o,s,n,r,e[i+14],17,-1502002290),n=b(n,r=g(r,o,s,n,e[i+15],22,1236535329),o,s,e[i+1],5,-165796510),s=b(s,n,r,o,e[i+6],9,-1069501632),o=b(o,s,n,r,e[i+11],14,643717713),r=b(r,o,s,n,e[i],20,-373897302),n=b(n,r,o,s,e[i+5],5,-701558691),s=b(s,n,r,o,e[i+10],9,38016083),o=b(o,s,n,r,e[i+15],14,-660478335),r=b(r,o,s,n,e[i+4],20,-405537848),n=b(n,r,o,s,e[i+9],5,568446438),s=b(s,n,r,o,e[i+14],9,-1019803690),o=b(o,s,n,r,e[i+3],14,-187363961),r=b(r,o,s,n,e[i+8],20,1163531501),n=b(n,r,o,s,e[i+13],5,-1444681467),s=b(s,n,r,o,e[i+2],9,-51403784),o=b(o,s,n,r,e[i+7],14,1735328473),n=v(n,r=b(r,o,s,n,e[i+12],20,-1926607734),o,s,e[i+5],4,-378558),s=v(s,n,r,o,e[i+8],11,-2022574463),o=v(o,s,n,r,e[i+11],16,1839030562),r=v(r,o,s,n,e[i+14],23,-35309556),n=v(n,r,o,s,e[i+1],4,-1530992060),s=v(s,n,r,o,e[i+4],11,1272893353),o=v(o,s,n,r,e[i+7],16,-155497632),r=v(r,o,s,n,e[i+10],23,-1094730640),n=v(n,r,o,s,e[i+13],4,681279174),s=v(s,n,r,o,e[i],11,-358537222),o=v(o,s,n,r,e[i+3],16,-722521979),r=v(r,o,s,n,e[i+6],23,76029189),n=v(n,r,o,s,e[i+9],4,-640364487),s=v(s,n,r,o,e[i+12],11,-421815835),o=v(o,s,n,r,e[i+15],16,530742520),n=y(n,r=v(r,o,s,n,e[i+2],23,-995338651),o,s,e[i],6,-198630844),s=y(s,n,r,o,e[i+7],10,1126891415),o=y(o,s,n,r,e[i+14],15,-1416354905),r=y(r,o,s,n,e[i+5],21,-57434055),n=y(n,r,o,s,e[i+12],6,1700485571),s=y(s,n,r,o,e[i+3],10,-1894986606),o=y(o,s,n,r,e[i+10],15,-1051523),r=y(r,o,s,n,e[i+1],21,-2054922799),n=y(n,r,o,s,e[i+8],6,1873313359),s=y(s,n,r,o,e[i+15],10,-30611744),o=y(o,s,n,r,e[i+6],15,-1560198380),r=y(r,o,s,n,e[i+13],21,1309151649),n=y(n,r,o,s,e[i+4],6,-145523070),s=y(s,n,r,o,e[i+11],10,-1120210379),o=y(o,s,n,r,e[i+2],15,718787259),r=y(r,o,s,n,e[i+9],21,-343485551),n=m(n,a),r=m(r,u),o=m(o,c),s=m(s,d)}return[n,r,o,s]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(f(t)),r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))})),w=n("../notebook-dds/node_modules/uuid/dist/esm-browser/v4.js");function k(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function S(e,t){return e<<t|e>>>32-t}var j=h("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var o=0;o<r.length;++o)e.push(r.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var s=e.length/4+2,i=Math.ceil(s/16),a=new Array(i),u=0;u<i;++u){for(var c=new Uint32Array(16),d=0;d<16;++d)c[d]=e[64*u+4*d]<<24|e[64*u+4*d+1]<<16|e[64*u+4*d+2]<<8|e[64*u+4*d+3];a[u]=c}a[i-1][14]=8*(e.length-1)/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=8*(e.length-1)&4294967295;for(var l=0;l<i;++l){for(var h=new Uint32Array(80),f=0;f<16;++f)h[f]=a[l][f];for(var m=16;m<80;++m)h[m]=S(h[m-3]^h[m-8]^h[m-14]^h[m-16],1);for(var p=n[0],g=n[1],b=n[2],v=n[3],y=n[4],_=0;_<80;++_){var w=Math.floor(_/20),j=S(p,5)+k(w,g,b,v)+y+t[w]+h[_]>>>0;y=v,v=b,b=S(g,30)>>>0,g=p,p=j}n[0]=n[0]+p>>>0,n[1]=n[1]+g>>>0,n[2]=n[2]+b>>>0,n[3]=n[3]+v>>>0,n[4]=n[4]+y>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),C="00000000-0000-0000-0000-000000000000",x=function(e){if(!Object(d.a)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},"../notebook-dds/node_modules/uuid/dist/esm-browser/rng.js":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return s}));var o=new Uint8Array(16);function s(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(o)}},"../notebook-dds/node_modules/uuid/dist/esm-browser/stringify.js":function(e,t,n){"use strict";for(var r=n("../notebook-dds/node_modules/uuid/dist/esm-browser/validate.js"),o=[],s=0;s<256;++s)o.push((s+256).toString(16).substr(1));t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase();if(!Object(r.a)(n))throw TypeError("Stringified UUID is invalid");return n}},"../notebook-dds/node_modules/uuid/dist/esm-browser/v4.js":function(e,t,n){"use strict";var r=n("../notebook-dds/node_modules/uuid/dist/esm-browser/rng.js"),o=n("../notebook-dds/node_modules/uuid/dist/esm-browser/stringify.js");t.a=function(e,t,n){var s=(e=e||{}).random||(e.rng||r.a)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=s[i];return t}return Object(o.a)(s)}},"../notebook-dds/node_modules/uuid/dist/esm-browser/validate.js":function(e,t,n){"use strict";var r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;t.a=function(e){return"string"==typeof e&&r.test(e)}},"../notebook-dds/node_modules/ws/browser.js":function(e,t,n){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},"../notebook-dds/node_modules/yeast/index.js":function(e,t,n){"use strict";var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s={},i=0,a=0;function u(e){var t="";do{t=o[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function c(){var e=u(+new Date);return e!==r?(i=0,r=e):e+"."+u(i++)}for(;a<64;a++)s[o[a]]=a;c.encode=u,c.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=64*t+s[e.charAt(a)];return t},e.exports=c},"./node_modules/assert/assert.js":function(e,t,n){"use strict";(function(t){var r=n("./node_modules/object-assign/index.js");function o(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,o=0,s=Math.min(n,r);o<s;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0}function s(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var i=n("./node_modules/util/util.js"),a=Object.prototype.hasOwnProperty,u=Array.prototype.slice,c="foo"===function(){}.name;function d(e){return Object.prototype.toString.call(e)}function l(e){return!s(e)&&"function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}var h=e.exports=v,f=/\s*function\s+([^\(\s]*)\s*/;function m(e){if(i.isFunction(e)){if(c)return e.name;var t=e.toString().match(f);return t&&t[1]}}function p(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function g(e){if(c||!i.isFunction(e))return i.inspect(e);var t=m(e);return"[Function"+(t?": "+t:"")+"]"}function b(e,t,n,r,o){throw new h.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:o})}function v(e,t){e||b(e,!0,t,"==",h.ok)}function y(e,t,n,r){if(e===t)return!0;if(s(e)&&s(t))return 0===o(e,t);if(i.isDate(e)&&i.isDate(t))return e.getTime()===t.getTime();if(i.isRegExp(e)&&i.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(l(e)&&l(t)&&d(e)===d(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===o(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(s(e)!==s(t))return!1;var a=(r=r||{actual:[],expected:[]}).actual.indexOf(e);return-1!==a&&a===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),function(e,t,n,r){if(null==e||null==t)return!1;if(i.isPrimitive(e)||i.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var o=_(e),s=_(t);if(o&&!s||!o&&s)return!1;if(o)return y(e=u.call(e),t=u.call(t),n);var a,c,d=S(e),l=S(t);if(d.length!==l.length)return!1;for(d.sort(),l.sort(),c=d.length-1;c>=0;c--)if(d[c]!==l[c])return!1;for(c=d.length-1;c>=0;c--)if(!y(e[a=d[c]],t[a],n,r))return!1;return!0}(e,t,n,r))}return n?e===t:e==t}function _(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function w(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function k(e,t,n,r){var o;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),o=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!o&&b(o,n,"Missing expected exception"+r);var s="string"==typeof r,a=!e&&o&&!n;if((!e&&i.isError(o)&&s&&w(o,n)||a)&&b(o,n,"Got unwanted exception"+r),e&&o&&n&&!w(o,n)||!e&&o)throw o}h.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return p(g(e.actual),128)+" "+e.operator+" "+p(g(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||b;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,o=m(t),s=r.indexOf("\n"+o);if(s>=0){var i=r.indexOf("\n",s+1);r=r.substring(i+1)}this.stack=r}}},i.inherits(h.AssertionError,Error),h.fail=b,h.ok=v,h.equal=function(e,t,n){e!=t&&b(e,t,n,"==",h.equal)},h.notEqual=function(e,t,n){e==t&&b(e,t,n,"!=",h.notEqual)},h.deepEqual=function(e,t,n){y(e,t,!1)||b(e,t,n,"deepEqual",h.deepEqual)},h.deepStrictEqual=function(e,t,n){y(e,t,!0)||b(e,t,n,"deepStrictEqual",h.deepStrictEqual)},h.notDeepEqual=function(e,t,n){y(e,t,!1)&&b(e,t,n,"notDeepEqual",h.notDeepEqual)},h.notDeepStrictEqual=function e(t,n,r){y(t,n,!0)&&b(t,n,r,"notDeepStrictEqual",e)},h.strictEqual=function(e,t,n){e!==t&&b(e,t,n,"===",h.strictEqual)},h.notStrictEqual=function(e,t,n){e===t&&b(e,t,n,"!==",h.notStrictEqual)},h.throws=function(e,t,n){k(!0,e,t,n)},h.doesNotThrow=function(e,t,n){k(!1,e,t,n)},h.ifError=function(e){if(e)throw e},h.strict=r((function e(t,n){t||b(t,!0,n,"==",e)}),h,{equal:h.strictEqual,deepEqual:h.deepStrictEqual,notEqual:h.notStrictEqual,notDeepEqual:h.notDeepStrictEqual}),h.strict.strict=h.strict;var S=Object.keys||function(e){var t=[];for(var n in e)a.call(e,n)&&t.push(n);return t}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/color-name/index.js":function(e,t,n){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},"./node_modules/color-string/index.js":function(e,t,n){var r=n("./node_modules/color-name/index.js"),o=n("./node_modules/simple-swizzle/index.js"),s={};for(var i in r)r.hasOwnProperty(i)&&(s[r[i]]=i);var a=e.exports={to:{},get:{}};function u(e,t,n){return Math.min(Math.max(t,e),n)}function c(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}a.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=a.get.hsl(e),n="hsl";break;case"hwb":t=a.get.hwb(e),n="hwb";break;default:t=a.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},a.get.rgb=function(e){if(!e)return null;var t,n,o,s=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(o=t[2],t=t[1],n=0;n<3;n++){var i=2*n;s[n]=parseInt(t.slice(i,i+2),16)}o&&(s[3]=parseInt(o,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(o=(t=t[1])[3],n=0;n<3;n++)s[n]=parseInt(t[n]+t[n],16);o&&(s[3]=parseInt(o+o,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(n=0;n<3;n++)s[n]=parseInt(t[n+1],0);t[4]&&(s[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(s=r[t[1]])?(s[3]=1,s):null:null;for(n=0;n<3;n++)s[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(s[3]=parseFloat(t[4]))}for(n=0;n<3;n++)s[n]=u(s[n],0,255);return s[3]=u(s[3],0,1),s},a.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,u(parseFloat(t[2]),0,100),u(parseFloat(t[3]),0,100),u(isNaN(n)?1:n,0,1)]}return null},a.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,u(parseFloat(t[2]),0,100),u(parseFloat(t[3]),0,100),u(isNaN(n)?1:n,0,1)]}return null},a.to.hex=function(){var e=o(arguments);return"#"+c(e[0])+c(e[1])+c(e[2])+(e[3]<1?c(Math.round(255*e[3])):"")},a.to.rgb=function(){var e=o(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},a.to.rgb.percent=function(){var e=o(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},a.to.hsl=function(){var e=o(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},a.to.hwb=function(){var e=o(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},a.to.keyword=function(e){return s[e.slice(0,3)]}},"./node_modules/is-arrayish/index.js":function(e,t){e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},"./node_modules/simple-swizzle/index.js":function(e,t,n){"use strict";var r=n("./node_modules/is-arrayish/index.js"),o=Array.prototype.concat,s=Array.prototype.slice,i=e.exports=function(e){for(var t=[],n=0,i=e.length;n<i;n++){var a=e[n];r(a)?t=o.call(t,s.call(a)):t.push(a)}return t};i.wrap=function(e){return function(){return e(i(arguments))}}},"./src/features/collaboration/async/index.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"SessionFactory",(function(){return Ca})),n.d(t,"NotebookCollaboration",(function(){return Ea})),n.d(t,"ContentFeeder",(function(){return Pa})),n.d(t,"reducer",(function(){return Da})),n.d(t,"initialState",(function(){return Ra})),n.d(t,"epics",(function(){return Ja})),n.d(t,"actions",(function(){return o})),n.d(t,"selectors",(function(){return r})),n.d(t,"EditorComponent",(function(){return Qa})),n.d(t,"OutputAnnotationPanel",(function(){return zu})),n.d(t,"SessionPanel",(function(){return dc})),n.d(t,"PresenceDecorators",(function(){return vc}));var r={};n.r(r),n.d(r,"tenantId",(function(){return yi})),n.d(r,"resourceId",(function(){return _i})),n.d(r,"sharedDocumentUrl",(function(){return wi})),n.d(r,"userId",(function(){return ki})),n.d(r,"sessionStatus",(function(){return Si})),n.d(r,"connectionStatus",(function(){return ji})),n.d(r,"audience",(function(){return Ci})),n.d(r,"presence",(function(){return xi})),n.d(r,"cellOutputAnnotations",(function(){return Oi})),n.d(r,"sessionConfig",(function(){return Ei})),n.d(r,"isLeader",(function(){return Ii})),n.d(r,"cellIdMap",(function(){return Ai})),n.d(r,"reverseCellIdMap",(function(){return Ni})),n.d(r,"outputCreatedBy",(function(){return Ti})),n.d(r,"getPeerByUserId",(function(){return Fi})),n.d(r,"audienceSize",(function(){return Pi})),n.d(r,"allowSaveNotebook",(function(){return Ri})),n.d(r,"cellIdExistsInMap",(function(){return Di})),n.d(r,"getLocalCellId",(function(){return Mi})),n.d(r,"getRemoteCellId",(function(){return Li})),n.d(r,"localCellIdsInMap",(function(){return Bi})),n.d(r,"getCutCellId",(function(){return qi})),n.d(r,"getPasteCellId",(function(){return zi}));var o={};n.r(o),n.d(o,"updateAudience",(function(){return Wi})),n.d(o,"updatePresence",(function(){return Ki})),n.d(o,"setCursorPosition",(function(){return Gi})),n.d(o,"updateLeaderElection",(function(){return Ji})),n.d(o,"updateCellOutputAnnotation",(function(){return Zi})),n.d(o,"deleteCellOutputAnnotation",(function(){return Xi})),n.d(o,"clearCellOutputAnnotations",(function(){return Yi})),n.d(o,"initCellOutputAnnotations",(function(){return Qi})),n.d(o,"initCellIdMap",(function(){return ea})),n.d(o,"updateCellIdMap",(function(){return ta})),n.d(o,"deleteCellIdFromMap",(function(){return na})),n.d(o,"error",(function(){return ra})),n.d(o,"attachCellAdapter",(function(){return oa})),n.d(o,"detachCellAdapter",(function(){return sa})),n.d(o,"updateConnectionStatus",(function(){return ia}));var s=n("./node_modules/tslib/tslib.es6.js");function i(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))}Object.create,Object.create;var a,u=n("./node_modules/url/url.js"),c=n("./node_modules/events/events.js"),d=n("../notebook-dds/node_modules/uuid/dist/esm-browser/v4.js");!function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.executionContext="execution-context",e.pause="pause",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(a||(a={}));var l=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/promises.js"),h=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/performanceBrowser.js"),f=n("../notebook-dds/node_modules/debug/src/browser.js"),m=n.n(f),p=n("../notebook-dds/node_modules/@fluidframework/telemetry-utils/lib/logger.js");class g extends p.e{constructor(e,t,n,r){super(void 0,n,r),this.debug=e,this.debugErr=t}static create(e,t,n){const r=Object(f.debug)(e),o=Object(f.debug)(e);return o.log=console.error.bind(console),o.enabled=!0,new g(r,o,t,n)}static mixinDebugLogger(e,t,n,r){if(!t)return g.create(e,n,r);const o=new p.c(void 0,n,r);return o.addLogger(g.create(e)),o.addLogger(p.a.create(t,e)),o}send(e){const t=this.prepareEvent(e),n="error"===t.category;let r=n?this.debugErr:this.debug;const o=e.eventName.lastIndexOf(p.e.eventNamespaceSeparator),s=e.eventName.substring(o+1);o>0&&(r=r.extend(e.eventName.substring(0,o))),t.eventName=void 0;let i="";i="tick="+p.e.formatTick(h.a.now());const a=t.stack?t.stack:"";let u;t.stack=void 0;try{u=JSON.stringify(t)}catch(e){t.error=void 0,u=JSON.stringify(t)}"{}"===u&&(u=""),n&&(r.enabled=!0),r(`${s} ${u} ${i} ${a}`)}}var b=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/multiUrlResolver.js"),v=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/multiDocumentServiceFactory.js"),y=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/fluidResolvedUrl.js"),_=n("../notebook-dds/node_modules/@fluidframework/container-loader/node_modules/lodash/merge.js"),w=n.n(_),k=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/assert.js");const S=e=>{const t=e;return"object"==typeof t&&("string"==typeof(null==t?void 0:t.package)||"object"==typeof(n=null==t?void 0:t.package)&&"string"==typeof(null==n?void 0:n.name)&&"object"==typeof(null==n?void 0:n.fluid))&&(void 0===(null==t?void 0:t.config)||"object"==typeof(null==t?void 0:t.config));var n};var j,C,x,O;function E(e){return"string"==typeof(null==e?void 0:e.message)?e.message:""+e}!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(j||(j={})),function(e){e.NotBound="NotBound",e.Binding="Binding",e.Bound="Bound"}(C||(C={})),function(e){e.genericError="genericError",e.throttlingError="throttlingError",e.dataCorruptionError="dataCorruptionError"}(x||(x={}));class I extends p.b{constructor(e,t){super(e),this.error=t,this.errorType=x.genericError}}class A extends p.b{constructor(e,t){super(e,t),this.errorType=x.dataCorruptionError,this.canRetry=!1}}function N(e){var t;if(Object(k.a)(void 0!==e),"object"==typeof e&&null!==e){const n=e;return void 0!==e.errorType&&e instanceof p.b?n:new p.b(E(e),{errorType:null!==(t=e.errorType)&&void 0!==t?t:x.genericError,stack:e.stack})}return"string"==typeof e?new I(e,new Error(e)):new I(E(e),e)}!function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(O||(O={}));var T=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/summaryForCreateNew.js"),F=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/buildSnapshotTree.js"),P=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/blobCacheStorageService.js"),R=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/readAndParse.js"),D=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/network.js"),M=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/protocol.js"),L=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/quorum.js"),B=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/storage.js"),q=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/protocol.js"),z=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/typedEventEmitter.js");class H extends z.a{emit(e,...t){if("error"===e){const n=super.emit(e,...t);return n||console.error("Nobody is listening for 'error' events"),n}let n;try{n=super.emit(e,...t)}catch(e){n=this.emit("error",e)}return n}}const U="connected",V="disconnected";function $(e,t,n,...r){try{e.emit(n,...r)}catch(e){t.sendErrorEvent({eventName:"RaiseEventError",event:n},e)}}function W(e,t,n,r){try{n?t.emit(U,r):t.emit(V)}catch(t){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},t)}}class K extends c.EventEmitter{constructor(){super(...arguments),this.members=new Map}on(e,t){return super.on(e,t)}addMember(e,t){this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){this.members.delete(e),this.emit("removeMember",e)}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}clear(){const e=this.members.keys();for(const t of e)this.removeMember(t)}}class G extends c.EventEmitter{constructor(){super(),this._disposed=!1}get IFluidSerializer(){throw new Error("Not implemented")}get IFluidHandleContext(){throw new Error("Not implemented")}get disposed(){return this._disposed}dispose(){this._disposed=!0}snapshot(e){return Promise.resolve(null)}summarize(e=!1){return Promise.resolve({tree:{},type:1})}setConnectionState(e,t){}stop(){return Promise.resolve({})}createSummary(){return{tree:{},type:1}}setAttachState(e){throw new Error("Null Runtime should not be attached")}async request(e){return{status:404,mimeType:"text/plain",value:null}}process(e,t,n){throw new Error("Null runtime should not receive messages")}processSignal(e,t){}}class J{async instantiateRuntime(e){return new G}get IRuntimeFactory(){return this}}class Z{constructor(e,t,n,r,o,s,i,a,u,c,d,h,f,m,g,b){this.container=e,this.scope=t,this.codeLoader=n,this.codeDetails=r,this._baseSnapshot=o,this.attributes=s,this.deltaManager=i,this.quorum=a,this.loader=u,this.raiseContainerWarning=c,this.submitFn=d,this.submitSignalFn=h,this.snapshotFn=f,this.closeFn=m,this.version=g,this.previousRuntimeState=b,this._disposed=!1,this.fluidModuleP=new l.b(async()=>void 0===this.codeDetails?{fluidExport:new J}:await p.d.timedExecAsync(this.logger,{eventName:"CodeLoad"},async()=>this.codeLoader.load(this.codeDetails))),this.logger=e.subLogger,this.attachListener()}static async createOrLoad(e,t,n,r,o,s,i,a,u,c,d,l,h,f,m,p){const g=new Z(e,t,n,r,o,s,i,a,u,c,d,l,h,f,m,p);return await g.load(),g}get id(){return this.container.id}get clientId(){return this.container.clientId}get clientDetails(){return this.container.clientDetails}get existing(){return this.container.existing}get branch(){return this.attributes.branch}get runtimeVersion(){var e;return null===(e=this.runtime)||void 0===e?void 0:e.runtimeVersion}get connected(){return this.container.connected}get canSummarize(){return"summarize"in this.runtime}get serviceConfiguration(){return this.container.serviceConfiguration}get audience(){return this.container.audience}get options(){return this.container.options}get configuration(){return{scopes:this.container.scopes}}get baseSnapshot(){return this._baseSnapshot}get storage(){return this.container.storage}get runtime(){if(void 0===this._runtime)throw new Error("Attempted to access runtime before it was defined");return this._runtime}get disposed(){return this._disposed}attachListener(){this.container.once("attaching",()=>{var e,t;null===(t=null===(e=this._runtime)||void 0===e?void 0:e.setAttachState)||void 0===t||t.call(e,j.Attaching)}),this.container.once("attached",()=>{var e,t;null===(t=null===(e=this._runtime)||void 0===e?void 0:e.setAttachState)||void 0===t||t.call(e,j.Attached)})}dispose(e){this._disposed||(this._disposed=!0,this.runtime.dispose(e),this.quorum.dispose(),this.deltaManager.dispose())}async snapshot(e="",t=!1){return this.runtime.snapshot(e,t)}getLoadedFromVersion(){return this.container.loadedFromVersion}async snapshotRuntimeState(){return this.runtime.stop()}get attachState(){return this.container.attachState}createSummary(){return this.runtime.createSummary()}setConnectionState(e,t){const n=this.runtime;Object(k.a)(e===this.connected,"Mismatch in connection state while setting"),n.setConnectionState(e,t)}process(e,t,n){this.runtime.process(e,t,n)}processSignal(e,t){this.runtime.processSignal(e,t)}async request(e){return this.runtime.request(e)}async requestSnapshot(e){return this.snapshotFn(e)}registerTasks(e){}async reloadContext(){return this.container.reloadContext()}hasNullRuntime(){return this.runtime instanceof G}async getAbsoluteUrl(e){return this.container.getAbsoluteUrl(e)}async satisfies(e){const t=[],n=this.codeLoader;void 0!==n.IFluidCodeDetailsComparer&&t.push(n.IFluidCodeDetailsComparer);const r=(await this.fluidModuleP).fluidExport;if(void 0!==(null==r?void 0:r.IFluidCodeDetailsComparer)&&t.push(r.IFluidCodeDetailsComparer),0===t.length)return!1;for(const n of t)if(!1===await n.satisfies(this.codeDetails,e))return!1;return!0}async load(){const e=(await this.fluidModuleP).fluidExport.IRuntimeFactory;if(void 0===e)throw new Error("Code package does not implement IRuntimeFactory");this._runtime=await e.instantiateRuntime(this)}}const X=m()("fluid:container-loader");var Y;X("Package: @fluidframework/container-loader - Version: 0.34.1"),function(e){e[e.NoCaching=0]="NoCaching",e[e.Prefetch=1]="Prefetch"}(Y||(Y={}));var Q=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/utils.js"),ee=n("../notebook-dds/node_modules/@fluidframework/protocol-definitions/lib/scopes.js"),te=n("../notebook-dds/node_modules/double-ended-queue/js/deque.js"),ne=n.n(te);class re extends z.a{constructor(e){super(),this.worker=e,this.isDisposed=!1,this.q=new ne.a,this.pauseCount=1}get disposed(){return this.isDisposed}get paused(){return 0!==this.pauseCount}get length(){return this.q.length}get idle(){return void 0===this.processingDeferred&&0===this.q.length}dispose(){throw new Error("Not implemented.")}clear(){this.q.clear()}peek(){return this.q.peekFront()}toArray(){return this.q.toArray()}push(e){this.q.push(e),this.emit("push",e),this.ensureProcessing()}async pause(){if(this.pauseCount++,void 0!==this.processingDeferred)return this.processingDeferred.promise}resume(){Object(k.a)(this.pauseCount>0),this.pauseCount--,this.paused||this.ensureProcessing()}async systemPause(){return this.pause()}systemResume(){this.resume()}ensureProcessing(){void 0===this.processingDeferred&&(this.processingDeferred=new l.a,Promise.resolve().then(()=>{this.processDeltas(),void 0!==this.processingDeferred&&(this.processingDeferred.resolve(),this.processingDeferred=void 0)}))}processDeltas(){for(;0!==this.q.length&&!this.paused&&void 0===this.error;){const e=this.q.shift();try{this.worker(e),this.emit("op",e)}catch(e){this.error=e,this.emit("error",e)}}0===this.q.length&&this.emit("idle")}}function oe(e,t,n){var r,o;const s=Object.assign({},t);if(s.online=Object(D.j)(),void 0!==(null==n?void 0:n.online)&&(s.online=n.online),"object"==typeof navigator&&null!==navigator){const e=navigator,t=null!==(o=null!==(r=e.connection)&&void 0!==r?r:e.mozConnection)&&void 0!==o?o:e.webkitConnection;null!==t&&"object"==typeof t&&(s.connectionType=t.type)}s.online===D.e.Online?e.logException(s,n):e.sendTelemetryEvent(s,n)}function se(e){return new Promise(t=>{let n=t,r=e;Object(D.j)()===D.e.Offline&&void 0!==(null===window||void 0===window?void 0:window.addEventListener)&&(n=()=>{t(),window.removeEventListener("online",n)},window.addEventListener("online",n,!1),r=Math.max(e,3e4)),setTimeout(n,r)})}class ie{constructor(e,t,n){this.internalStorageService=e,this.deltaManager=t,this.logger=n,this.disposed=!1}dispose(){this.disposed=!0}get repositoryUrl(){return this.internalStorageService.repositoryUrl}async getSnapshotTree(e){return this.readWithRetry(async()=>this.internalStorageService.getSnapshotTree(e),"getSnapshotTree")}async read(e){return this.readWithRetry(async()=>this.internalStorageService.read(e),"read")}async readBlob(e){return this.readWithRetry(async()=>this.internalStorageService.readBlob(e),"readBlob")}async getVersions(e,t){return this.readWithRetry(async()=>this.internalStorageService.getVersions(e,t),"getVersions")}async write(e,t,n,r){return this.readWithRetry(async()=>this.internalStorageService.write(e,t,n,r),"write")}async uploadSummaryWithContext(e,t){return this.readWithRetry(async()=>this.internalStorageService.uploadSummaryWithContext(e,t),"uploadSummaryWithContext")}async downloadSummary(e){return this.readWithRetry(async()=>this.internalStorageService.downloadSummary(e),"downloadSummary")}async createBlob(e){return this.readWithRetry(async()=>this.internalStorageService.createBlob(e),"createBlob")}async delay(e){return new Promise(t=>setTimeout(()=>t(),e))}async readWithRetry(e,t){var n;let r,o=!1,s=0,i=0;const a=h.a.now();let u,c;do{try{r=await e(),void 0!==c&&this.deltaManager.refreshDelayInfo(c),o=!0}catch(e){if(this.disposed)throw N("Storage service disposed!!");if(!Object(D.g)(e))throw this.logger.sendErrorEvent({eventName:"Storage_"+t,retry:i,duration:h.a.now()-a},e),e;i++,u=e,s=null!==(n=de(e))&&void 0!==n?n:Math.min(2*s,8e3),void 0===c&&(c=Object(d.a)()),void 0!==c&&this.deltaManager.emitDelayInfo(c,s,N(e)),await this.delay(s)}}while(!o);return i>0&&this.logger.sendTelemetryEvent({eventName:"Storage_"+t,retry:i,duration:h.a.now()-a},u),r}}var ae=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/bufferBrowser.js"),ue=n("../notebook-dds/node_modules/@fluidframework/driver-utils/lib/documentStorageServiceProxy.js");class ce extends ue.a{constructor(){super(...arguments),this.prefetchCache=new Map,this.prefetchEnabled=!0}async getSnapshotTree(e){const t=this.internalStorageService.getSnapshotTree(e);return this.prefetchEnabled&&t.then(e=>{null!=e&&this.prefetchTree(e)}),t}async read(e){return this.cachedRead(e)}async readBlob(e){const t=await this.cachedRead(e);return Object(ae.d)(t,"base64")}stopPrefetch(){this.prefetchEnabled=!1,this.prefetchCache.clear()}cachedRead(e){if(this.prefetchEnabled){const t=this.prefetchCache.get(e);if(void 0!==t)return t;const n=this.internalStorageService.read(e);return this.prefetchCache.set(e,n),n}return this.internalStorageService.read(e)}prefetchTree(e){const t=[];this.prefetchTreeCore(e,t);for(const e of t)this.cachedRead(e)}prefetchTreeCore(e,t){for(const n of Object.keys(e.blobs)){const r=e.blobs[n];n.startsWith(".")||"header"===n||n.startsWith("quorum")?null!==r&&this.cachedRead(r):n.startsWith("deltas")||null!==r&&t.push(r)}for(const t of Object.keys(e.commits))this.getVersions(e.commits[t],1).then(e=>this.getSnapshotTree(e[0])).catch(e=>X("Ignored cached read error",e));for(const n of Object.keys(e.trees))this.prefetchTreeCore(e.trees[n],t)}}const de=e=>null==e?void 0:e.retryAfterSeconds;function le(e,t){const n=N(t),r=Object.create(n);return r.message=`${e}: ${n.message}`,r.canRetry=!0,r}var he;!function(e){e.Never="Never",e.Disabled="Disabled",e.Enabled="Enabled"}(he||(he={}));class fe extends z.a{constructor(e,t,n,r){super(),this.serviceProvider=e,this.client=t,this.logger=n,this._forceReadonly=!1,this.pending=[],this.fetching=!1,this.inQuorum=!1,this.minSequenceNumber=0,this.lastQueuedSequenceNumber=0,this.lastObservedSeqNumber=0,this.lastProcessedSequenceNumber=0,this.baseTerm=0,this.initSequenceNumber=0,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.closed=!1,this.deltaStreamDelayId=Object(d.a)(),this.deltaStorageDelayId=Object(d.a)(),this.messageBuffer=[],this.connectFirstConnection=!0,this.throttlingIdSet=new Set,this.timeTillThrottling=0,this._hasCheckpointSequenceNumber=!1,this.opHandler=(e,t)=>{t instanceof Array?this.enqueueMessages(t):this.enqueueMessages([t])},this.signalHandler=e=>{this._inboundSignal.push(e)},this.nackHandler=(e,t)=>{const n=t[0];this._readonlyPermissions&&this.close(Object(D.i)("WriteOnReadOnlyDocument"));const r=void 0!==n.content?function(e){const t="Nack: "+e.message,n=403!==e.code;return Object(D.h)(t,n,e.retryAfter,e.code)}(n.content):Object(D.h)("Nack: unknown reason",!0);this.reconnectMode!==he.Enabled&&this.logger.sendErrorEvent({eventName:"NackWithNoReconnect",reason:r.message,mode:this.connectionMode}),this.reconnectOnError("write",r)},this.disconnectHandler=e=>{this.reconnectOnError(this.defaultReconnectionMode,le("Disconnect",e))},this.errorHandler=e=>{oe(this.logger,{eventName:"DeltaConnectionError"},e),this.reconnectOnError(this.defaultReconnectionMode,le("error",e))},this.pongHandler=e=>{this.emit("pong",e)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=r?he.Enabled:he.Never,this._inbound=new re(e=>{this.processInboundMessage(e)}),this._inbound.on("error",e=>{this.close(N(e))}),this._outbound=new re(e=>{if(void 0===this.connection)throw new Error("Attempted to submit an outbound message without connection");this.connection.submit(e)}),this._outbound.on("error",e=>{this.close(N(e))}),this._inboundSignal=new re(e=>{if(void 0===this.handler)throw new Error("Attempted to process an inbound signal without a handler attached");this.handler.processSignal({clientId:e.clientId,content:JSON.parse(e.content)})}),this._inboundSignal.on("error",e=>{this.close(N(e))}),this._inbound.pause(),this._outbound.pause(),this._inboundSignal.pause()}get disposed(){return this.closed}get IDeltaSender(){return this}get hasCheckpointSequenceNumber(){return Object(k.a)(void 0!==this.connection),this._hasCheckpointSequenceNumber}get inbound(){return this._inbound}get outbound(){return this._outbound}get inboundSignal(){return this._inboundSignal}get initialSequenceNumber(){return this.initSequenceNumber}get lastSequenceNumber(){return this.lastProcessedSequenceNumber}get lastKnownSeqNumber(){return this.lastObservedSeqNumber}get referenceTerm(){return this.baseTerm}get minimumSequenceNumber(){return this.minSequenceNumber}get maxMessageSize(){var e,t,n,r,o;return null!==(o=null!==(n=null===(t=null===(e=this.connection)||void 0===e?void 0:e.serviceConfiguration)||void 0===t?void 0:t.maxMessageSize)&&void 0!==n?n:null===(r=this.connection)||void 0===r?void 0:r.maxMessageSize)&&void 0!==o?o:16384}get version(){if(void 0===this.connection)throw new Error("Cannot check version without a connection");return this.connection.version}get serviceConfiguration(){var e;return null===(e=this.connection)||void 0===e?void 0:e.serviceConfiguration}get scopes(){var e;return null===(e=this.connection)||void 0===e?void 0:e.claims.scopes}get active(){const e=this.inQuorum&&"write"===this.connectionMode;return Object(k.a)(!(this._readonlyPermissions&&e)),e}get socketDocumentId(){var e;return null===(e=this.connection)||void 0===e?void 0:e.claims.documentId}get connectionMode(){return void 0===this.connection?"read":this.connection.mode}get readonly(){return!!this._forceReadonly||this._readonlyPermissions}get readonlyPermissions(){return this._readonlyPermissions}get reconnectMode(){return this._reconnectMode}async connectToStorage(){var e;if(void 0!==this.storageService)return this.storageService;const t=this.serviceProvider();if(void 0===t)throw new Error("Not attached");let n=await t.connectToStorage();return(null===(e=t.policies)||void 0===e?void 0:e.caching)!==Y.NoCaching&&(n=new ce(n)),this.storageService=new ie(n,this,this.logger),this.storageService}setAutomaticReconnect(e){Object(k.a)(this._reconnectMode!==he.Never,"Cannot toggle automatic reconnect if reconnect is set to Never."),this._reconnectMode=e?he.Enabled:he.Disabled}forceReadonly(e){const t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){let e=!1;!0===this.readonly&&(e=this.disconnectFromDeltaStream("Force readonly")),$(this,this.logger,"readonly",this.readonly),e&&this.triggerConnect({mode:"read",fetchOpsFromStorage:!1})}}set_readonlyPermissions(e){const t=this.readonly;this._readonlyPermissions=e,t!==this.readonly&&$(this,this.logger,"readonly",this.readonly)}dispose(){throw new Error("Not implemented.")}attachOpHandler(e,t,n,r){X("Attached op handler",t),this.initSequenceNumber=t,this.lastProcessedSequenceNumber=t,this.baseTerm=n,this.minSequenceNumber=e,this.lastQueuedSequenceNumber=t,this.lastObservedSeqNumber=t,Object(k.a)(void 0===this.handler),this.handler=r,Object(k.a)(!!this.handler),this._inbound.systemResume(),this._inboundSignal.systemResume(),this.pending.length>0?this.processPendingOps("DocumentOpen"):void 0===this.connection&&void 0===this.connectionP||this.fetchMissingDeltas("DocumentOpen",this.lastQueuedSequenceNumber)}updateQuorumJoin(){this.inQuorum=!0}updateQuorumLeave(){this.inQuorum=!1}static detailsFromConnection(e){return{claims:e.claims,clientId:e.clientId,existing:e.existing,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},maxMessageSize:e.maxMessageSize,mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version}}async connect(e={}){const t=await this.connectCore(e);return fe.detailsFromConnection(t)}triggerConnect(e){this.connectCore(e).catch(e=>{this.closed||this.logger.sendErrorEvent({eventName:"ConnectException"},e)})}async connectCore(e={}){var t,n,r;if(void 0!==this.connection)return this.connection;if(void 0!==this.connectionP)return this.connectionP;const o=null===(t=e.fetchOpsFromStorage)||void 0===t||t;let s=null!==(n=e.mode)&&void 0!==n?n:this.defaultReconnectionMode;this.clientSequenceNumberObserved!==this.clientSequenceNumber&&(s="write"),this.logger.debugAssert(void 0!==this.handler||o),o&&void 0!==this.handler&&this.fetchMissingDeltas(null!==(r=e.reason)&&void 0!==r?r:"DocumentOpen",this.lastQueuedSequenceNumber);const i=this.serviceProvider();if(void 0===i)throw new Error("Container is not attached");const a=async()=>{let e,t=1,n=0;const r=h.a.now();for(;void 0===e;){if(this.closed)throw new Error("Attempting to connect a closed DeltaManager");n++;try{this.client.mode=s,e=await i.connectToDeltaStream(this.client)}catch(e){const r=N(e);if(!Object(D.g)(e))throw this.close(r),r;1===n&&oe(this.logger,{delay:t,eventName:"DeltaConnectionFailureToConnect"},e);const o=de(e);t=null!=o?o:Math.min(2*t,8),void 0!==o&&this.emitDelayInfo(this.deltaStreamDelayId,o,r),await se(1e3*t)}}return n>1&&this.logger.sendTelemetryEvent({attempts:n,duration:p.e.formatTick(h.a.now()-r),eventName:"MultipleDeltaConnectionFailures"}),this.setupNewSuccessfulConnection(e,s),e};return this.connectionP=new Promise((e,t)=>{const n=e=>{this.connectionP=void 0,this.removeListener("closed",n),t(e)};this.on("closed",n),a().then(t=>{this.connectionP=void 0,this.removeListener("closed",n),e(t)}).catch(n)}),this.connectionP}flush(){0!==this.messageBuffer.length&&(this.emit("prepareSend",this.messageBuffer),this._outbound.push(this.messageBuffer),this.messageBuffer=[])}submit(e,t,n=!1,r){var o,s;if(this.readonly)return this.close(N("Op is sent in read-only document state")),-1;Object(k.a)(!!this.connection),this.lastSubmittedClientId!==(null===(o=this.connection)||void 0===o?void 0:o.clientId)&&(this.lastSubmittedClientId=null===(s=this.connection)||void 0===s?void 0:s.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0);const i=[{action:"start",service:void 0===this.clientDetails.type||""===this.clientDetails.type?"unknown":this.clientDetails.type,timestamp:Date.now()}],a={clientSequenceNumber:++this.clientSequenceNumber,contents:JSON.stringify(t),metadata:r,referenceSequenceNumber:this.lastProcessedSequenceNumber,traces:i,type:e},u=this.createOutboundMessage(e,a);return this.stopSequenceNumberUpdate(),this.emit("submitOp",a),n?this.messageBuffer.push(u):(this.flush(),this.messageBuffer.push(u),this.flush()),u.clientSequenceNumber}submitSignal(e){void 0!==this.connection?this.connection.submitSignal(e):this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"})}async getDeltas(e,t,n,r){let o=0,s=t,i=[],a=0;const u=this.serviceProvider();if(void 0===u)throw new Error("Delta manager is not attached");const c=p.d.start(this.logger,{eventName:"GetDeltas_"+e,from:s,to:n});let d,l=0;for(;!this.closed;){const e=s+2e3,t=void 0===n?e:Math.min(e,n);let h,f,m=0,p=!0,g=!1;try{void 0===d&&(void 0===this.deltaStorageP&&(this.deltaStorageP=u.connectToDeltaStorage()),d=await this.deltaStorageP),l++,g=!0;const o=d.get(s,t);i.length>0&&r(i);const{messages:h,partialResult:f}=await o;i=h,m=i.length,a+=m;const p=m>0?i[m-1].sequenceNumber:s;if(void 0===n?!f&&p<e-1:n-1<=p)return r(i),void c.end({lastFetch:p,deltasRetrievedTotal:a,requests:l});s=p}catch(e){g=g&&Object(D.g)(e);const n=N(e);if(oe(this.logger,{eventName:"GetDeltas_Error",fetchTo:t,from:s,requests:l,retry:o+1},e),!g)return c.cancel({category:"error"},e),void this.close(n);p=!1,h=de(e),void 0!==h&&h>=0&&this.emitDelayInfo(this.deltaStorageDelayId,h,n)}if(void 0!==n&&this.lastQueuedSequenceNumber>=n)return void c.end({deltasRetrievedTotal:a,requests:l,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber});if(0!==m)f=0,o=0;else if(o++,f=null!=h?h:Math.min(10,.1*Math.pow(2,o)),p&&o>=100){c.cancel({category:"error",error:"too many retries",retry:o,requests:l,deltasRetrievedTotal:a,replayFrom:s,to:n});const e=Object(D.h)("Failed to retrieve ops from storage: giving up after too many retries",!1);return void this.close(e)}c.reportProgress({delay:f,deltasRetrievedLast:m,deltasRetrievedTotal:a,replayFrom:s,requests:l,retry:o,success:p}),await se(1e3*f)}this.logger.sendErrorEvent({eventName:"GetDeltasClosedConnection"}),c.cancel({error:"container closed"})}close(e){var t;this.closed||(this.closed=!0,null===(t=this.storageService)||void 0===t||t.dispose(),this.stopSequenceNumberUpdate(),this.disconnectFromDeltaStream(void 0!==e?""+e.message:"Container closed"),this._inbound.clear(),this._outbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[],this.set_readonlyPermissions(!0),this.emit("closed",e),this.removeAllListeners())}createOutboundMessage(e,t){if(Object(Q.a)(e)){const e=t.contents;return t.contents=null,Object.assign(Object.assign({},t),{data:e})}return t}refreshDelayInfo(e){this.throttlingIdSet.delete(e),0===this.throttlingIdSet.size&&(this.timeTillThrottling=0)}emitDelayInfo(e,t,n){const r=Date.now();if(this.throttlingIdSet.add(e),t>0&&r+t>this.timeTillThrottling){this.timeTillThrottling=r+t;const e={errorType:x.throttlingError,message:"Service busy/throttled: "+n.message,retryAfterSeconds:t};this.emit("throttled",e)}}setupNewSuccessfulConnection(e,t){var n;Object(k.a)(void 0===this.connection,"old connection exists on new connection setup"),this.connection=e;const r=!e.claims.scopes.includes(ee.a.DocWrite);if(Object(k.a)("read"===t||r===("read"===this.connectionMode),"claims/connectionMode mismatch"),Object(k.a)(!r||"read"===this.connectionMode,"readonly perf with write connection"),this.set_readonlyPermissions(r),this.refreshDelayInfo(this.deltaStreamDelayId),this.closed)return void this.disconnectFromDeltaStream("Disconnect on close");Object(k.a)(0===this.messageBuffer.length,"messageBuffer is not empty on new connection"),this._outbound.systemResume(),e.on("op",this.opHandler),e.on("signal",this.signalHandler),e.on("nack",this.nackHandler),e.on("disconnect",this.disconnectHandler),e.on("error",this.errorHandler),e.on("pong",this.pongHandler);const o=e.initialMessages;this._hasCheckpointSequenceNumber=!1,void 0!==e.checkpointSequenceNumber&&(this._hasCheckpointSequenceNumber=!0,this.updateLatestKnownOpSeqNumber(e.checkpointSequenceNumber)),o.length>0&&(this._hasCheckpointSequenceNumber=!0,this.updateLatestKnownOpSeqNumber(o[o.length-1].sequenceNumber)),this.emit("connect",fe.detailsFromConnection(e),this._hasCheckpointSequenceNumber?this.lastKnownSeqNumber-this.lastSequenceNumber:void 0),this.processInitialMessages(o,null!==(n=e.initialSignals)&&void 0!==n?n:[],this.connectFirstConnection),void 0!==this.handler&&"write"!==e.mode&&0===o.length&&this.fetchMissingDeltas("Reconnect",this.lastQueuedSequenceNumber),this.connectFirstConnection=!1}disconnectFromDeltaStream(e){if(void 0===this.connection)return!1;const t=this.connection;return this.connection=void 0,t.off("op",this.opHandler),t.off("signal",this.signalHandler),t.off("nack",this.nackHandler),t.off("disconnect",this.disconnectHandler),t.off("error",this.errorHandler),t.off("pong",this.pongHandler),Object(k.a)(0===this.messageBuffer.length,"messageBuffer is not empty on disconnect"),this._outbound.systemPause(),this._outbound.clear(),this.emit("disconnect",e),t.close(),!0}async reconnectOnError(e,t){Object(k.a)(void 0!==this.connection),this.disconnectFromDeltaStream(t.message);const n=Object(D.g)(t);if(this.reconnectMode!==he.Never&&n||this.close(n?void 0:t),!this.closed&&this.reconnectMode===he.Enabled){const n=de(t);void 0!==n&&(this.emitDelayInfo(this.deltaStreamDelayId,n,t),await se(1e3*n)),this.triggerConnect({mode:e,fetchOpsFromStorage:!1})}}processInitialMessages(e,t,n){e.length>0&&this.catchUp(e,n?"InitialOps":"ReconnectOps");for(const e of t)this._inboundSignal.push(e)}comparableMessagePayload(e){return`${e.clientId}-${e.type}-${e.minimumSequenceNumber}-${e.referenceSequenceNumber}`}enqueueMessages(e,t="OutOfOrderMessage"){var n,r;if(void 0===this.handler)return void(this.pending=this.pending.concat(e));let o,s,i=0;e.length>0&&this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);for(const a of e)if(a.sequenceNumber<=this.lastQueuedSequenceNumber){if(i++,(void 0===o||o>a.sequenceNumber)&&(o=a.sequenceNumber),(void 0===s||s<a.sequenceNumber)&&(s=a.sequenceNumber),(null===(n=this.previouslyProcessedMessage)||void 0===n?void 0:n.sequenceNumber)===a.sequenceNumber){const e=this.comparableMessagePayload(this.previouslyProcessedMessage),t=this.comparableMessagePayload(a);if(e!==t){const n=new A("Two messages with same seq# and different payload!",{clientId:null===(r=this.connection)||void 0===r?void 0:r.clientId,sequenceNumber:a.sequenceNumber,message1:e,message2:t});this.close(n)}}}else a.sequenceNumber!==this.lastQueuedSequenceNumber+1?(this.pending.push(a),this.fetchMissingDeltas(t,this.lastQueuedSequenceNumber,a.sequenceNumber)):(this.lastQueuedSequenceNumber=a.sequenceNumber,this.previouslyProcessedMessage=a,this._inbound.push(a),this.pending.length>0&&this.processPendingOps("EnqueueMessages_"+t));0!==i&&this.logger.sendTelemetryEvent({eventName:"DuplicateMessages_"+t,start:o,end:s,count:i})}processInboundMessage(e){var t;const n=Date.now();if(Object(k.a)(void 0!==e.clientId||Object(M.b)(e)||e.type===q.a.NoClient,"non-system message have to have clientId"),Object(k.a)(void 0===this.connection||this.connection.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,"Not accounting local messages correctly"),void 0!==this.lastSubmittedClientId&&this.lastSubmittedClientId===e.clientId){const t=e.clientSequenceNumber;Object(k.a)(this.clientSequenceNumberObserved<t,"client seq# not growing"),Object(k.a)(t<=this.clientSequenceNumber,"Incoming local client seq# > generated by this client"),this.clientSequenceNumberObserved=t}if("string"==typeof e.contents&&""!==e.contents&&e.type!==q.a.ClientLeave&&(e.contents=JSON.parse(e.contents)),(null===(t=e.traces)||void 0===t?void 0:t.length)>0){const t=void 0===this.clientDetails.type||""===this.clientDetails.type?"unknown":this.clientDetails.type;e.traces.push({action:"end",service:t,timestamp:Date.now()})}if(Object(k.a)(this.minSequenceNumber<=e.minimumSequenceNumber,"msn moves backwards"),this.minSequenceNumber=e.minimumSequenceNumber,Object(k.a)(e.sequenceNumber===this.lastProcessedSequenceNumber+1,"non-seq seq#"),this.lastProcessedSequenceNumber=e.sequenceNumber,void 0===e.term&&(e.term=1),this.baseTerm=e.term,this.emit("beforeOpProcessing",e),void 0===this.handler)throw new Error("Attempted to process an inbound message without a handler attached");const r=this.handler.process(e);this.scheduleSequenceNumberUpdate(e,!0===r.immediateNoOp);const o=Date.now();this.emit("op",e,o-n)}fetchMissingDeltas(e,t,n){this.fetching||(this.closed?this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection"}):(this.fetching=!0,this.getDeltas(e,t,n,t=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.enqueueMessages(t,e)}).finally(()=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.fetching=!1}).catch(e=>{this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},e)})))}catchUp(e,t){const n={eventName:"CatchUp_"+t,messageCount:e.length,pendingCount:this.pending.length};0!==e.length&&(n.from=e[0].sequenceNumber,n.to=e[e.length-1].sequenceNumber,n.messageGap=void 0!==this.handler?n.from-this.lastQueuedSequenceNumber-1:void 0),this.logger.sendPerformanceEvent(n),this.enqueueMessages(e,t)}processPendingOps(e){if(void 0!==this.handler){const t=this.pending.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);this.pending=[],this.enqueueMessages(t,e)}}scheduleSequenceNumberUpdate(e,t){if(this.active)return t?(this.stopSequenceNumberUpdate(),void this.submit(q.a.NoOp,"")):void(e.type!==q.a.NoOp&&void 0===this.updateSequenceNumberTimer&&(this.updateSequenceNumberTimer=setTimeout(()=>{this.updateSequenceNumberTimer=void 0,this.active&&this.submit(q.a.NoOp,null)},2e3)));this.stopSequenceNumberUpdate()}stopSequenceNumberUpdate(){void 0!==this.updateSequenceNumberTimer&&clearTimeout(this.updateSequenceNumberTimer),this.updateSequenceNumberTimer=void 0}updateLatestKnownOpSeqNumber(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}}var me=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/eventForwarder.js");class pe extends me.a{constructor(e){super(e),this.queue=e}get paused(){return this.queue.paused}get length(){return this.queue.length}get idle(){return this.queue.idle}peek(){return this.queue.peek()}toArray(){return this.queue.toArray()}async systemPause(){return this.pause()}async pause(){return this.queue.pause()}async systemResume(){return this.resume()}async resume(){this.queue.resume()}}class ge extends me.a{constructor(e){super(e),this.deltaManager=e,this.inbound=new pe(e.inbound),this.outbound=new pe(e.outbound),this.inboundSignal=new pe(e.inboundSignal)}get IDeltaSender(){return this}get minimumSequenceNumber(){return this.deltaManager.minimumSequenceNumber}get lastSequenceNumber(){return this.deltaManager.lastSequenceNumber}get lastKnownSeqNumber(){return this.deltaManager.lastKnownSeqNumber}get referenceSequenceNumber(){return this.lastSequenceNumber}get initialSequenceNumber(){return this.deltaManager.initialSequenceNumber}get hasCheckpointSequenceNumber(){return this.deltaManager.hasCheckpointSequenceNumber}get clientDetails(){return this.deltaManager.clientDetails}get version(){return this.deltaManager.version}get maxMessageSize(){return this.deltaManager.maxMessageSize}get serviceConfiguration(){return this.deltaManager.serviceConfiguration}get active(){return this.deltaManager.active}get readonly(){return this.deltaManager.readonly}dispose(){this.inbound.dispose(),this.outbound.dispose(),this.inboundSignal.dispose(),super.dispose()}close(){return this.deltaManager.close()}submitSignal(e){return this.deltaManager.submitSignal(e)}submit(e,t,n,r){return this.deltaManager.submit(e,t,n,r)}flush(){return this.deltaManager.flush()}}var be=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/base64Encoding.js");function ve(e){const t=Object(u.parse)(e,!0);if("string"!=typeof t.pathname)throw new Error("Failed to parse pathname");const n=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(t.pathname);return 3===(null==n?void 0:n.length)?{id:n[1],path:n[2],version:t.query.version}:void 0}function ye(e){const t={blobs:{},trees:{},commits:{},id:Object(d.a)()},n=Object.keys(e.tree);for(const r of n){const n=e.tree[r];switch(n.type){case 1:t.trees[r]=ye(n);break;case 2:{const e=Object(d.a)();t.blobs[r]=e;const o="string"==typeof n.content?n.content:Object(ae.b)(n.content,"base64");t.blobs[e]=Object(be.b)(o);break}case 3:throw new Error("No handles should be there in summary in detached container!!");default:throw new Error("Unknown tree type "+n.type)}}return t}const _e="connect";var we;!function(e){e[e.Disconnected=0]="Disconnected",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(we||(we={}));class ke extends H{constructor(e,t){super(),this.loader=e,this._canReconnect=!0,this.loaded=!1,this._attachState=j.Detached,this._connectionState=we.Disconnected,this.resumedOpProcessingAfterLoad=!1,this.firstConnection=!0,this.manualReconnectInProgress=!1,this.connectionTransitionTimes=[],this.messageCountAfterDisconnection=0,this.attachInProgress=!1,this._closed=!1,this._audience=new K,this.originalRequest=t.originalRequest,this._id=t.id,this._resolvedUrl=t.resolvedUrl,void 0!==t.canReconnect&&(this._canReconnect=t.canReconnect);const n=this.client.details.type,r=`${this.client.details.capabilities.interactive?"interactive":"noninteractive"}${void 0!==n&&""!==n?"/"+n:""}`;this.subLogger=p.a.create(e.services.subLogger,void 0,{clientType:r,loaderVersion:"0.34.1",containerId:Object(d.a)()},{docId:()=>this.id,containerAttachState:()=>this._attachState,containerLoaded:()=>this.loaded}),this.logger=p.a.create(this.subLogger,"Container"),this._deltaManager=this.createDeltaManager(),"object"==typeof document&&null!==document&&(this.lastVisible=document.hidden?h.a.now():void 0,document.addEventListener("visibilitychange",()=>{document.hidden?this.lastVisible=h.a.now():setTimeout(()=>this.lastVisible=void 0,0)})),this.on("newListener",(e,t)=>{Promise.resolve().then(()=>{e===U&&this.connected?t(e,this.clientId):e!==V||this.connected?e===_e&&this._connectionState!==we.Disconnected&&t(e):t(e)}).catch(e=>{this.logger.sendErrorEvent({eventName:"RaiseConnectedEventError"},e)})})}static async load(e,t,n,r){var o;const[,s]=e.split("/"),i=new ke(t,{originalRequest:n,id:decodeURI(s),resolvedUrl:r,canReconnect:!(!1===(null===(o=n.headers)||void 0===o?void 0:o[a.reconnect]))});return p.d.timedExecAsync(i.logger,{eventName:"Load"},async e=>new Promise((t,r)=>{var o,s;const u=null===(o=n.headers)||void 0===o?void 0:o[a.version],c=null===(s=n.headers)||void 0===s?void 0:s[a.pause],d=e=>{const t=null!=e?e:N("Container closed without an error");i.close(t),r(t)};i.on("closed",d),i.load(u,!0===c).finally(()=>{i.removeListener("closed",d)}).then(n=>{e.end(n),t(i)},e=>{const t=N(e);d(t)})}))}static async createDetached(e,t){const n=new ke(e,{});return await n.createDetached(t),n}static async rehydrateDetachedFromSnapshot(e,t){const n=new ke(e,{});return await n.rehydrateDetachedFromSnapshot(t),n}get storageService(){if(void 0===this._storageService)throw new Error("Attempted to access storageService before it was defined");return this._storageService}get context(){if(void 0===this._context)throw new Error("Attempted to access context before it was defined");return this._context}get protocolHandler(){if(void 0===this._protocolHandler)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}get IFluidRouter(){return this}get resolvedUrl(){return this._resolvedUrl}get loadedFromVersion(){return this._loadedFromVersion}get readonly(){return this._deltaManager.readonly}get readonlyPermissions(){return this._deltaManager.readonlyPermissions}forceReadonly(e){this._deltaManager.forceReadonly(e)}get closed(){return this._closed}get id(){var e;return null!==(e=this._id)&&void 0!==e?e:""}get deltaManager(){return this._deltaManager}get connectionState(){return this._connectionState}get connected(){return this.connectionState===we.Connected}get serviceConfiguration(){return this._deltaManager.serviceConfiguration}get clientId(){return this._clientId}get scopes(){return this._deltaManager.scopes}get clientDetails(){return this._deltaManager.clientDetails}get chaincodePackage(){return this.codeDetails}get codeDetails(){var e,t;return null!==(t=null===(e=this._context)||void 0===e?void 0:e.codeDetails)&&void 0!==t?t:this.getCodeDetailsFromQuorum()}get existing(){return this._existing}get audience(){return this._audience}get serviceFactory(){return this.loader.services.documentServiceFactory}get urlResolver(){return this.loader.services.urlResolver}get options(){return this.loader.services.options}get scope(){return this.loader.services.scope}get codeLoader(){return this.loader.services.codeLoader}getQuorum(){return this.protocolHandler.quorum}close(e){var t,n,r;this._closed||(this._closed=!0,this._deltaManager.close(e),null===(t=this._protocolHandler)||void 0===t||t.close(),null===(n=this._context)||void 0===n||n.dispose(void 0!==e?new Error(e.message):void 0),Object(k.a)(this.connectionState===we.Disconnected,"disconnect event was not raised!"),void 0!==e?this.logger.sendErrorEvent({eventName:"ContainerClose",sequenceNumber:null!==(r=e.sequenceNumber)&&void 0!==r?r:this._deltaManager.lastSequenceNumber},e):(Object(k.a)(this.loaded),this.logger.sendTelemetryEvent({eventName:"ContainerClose"})),this.emit("closed",e),this.removeAllListeners())}get attachState(){return this._attachState}serialize(){Object(k.a)(this.attachState===j.Detached,"Should only be called in detached container");const e=this.context.createSummary(),t=function(e,t){const n=ye({type:1,tree:{".protocol":{type:1,tree:Object.assign({},e.tree)}}});return n.trees=Object.assign(Object.assign({},n.trees),ye(t).trees),n}(this.captureProtocolSummary(),e);return JSON.stringify(t)}async attach(e){var t,n;if(Object(k.a)(this.loaded,"not loaded"),Object(k.a)(!this.closed,"closed"),Object(k.a)(!(!1===(null===(t=e.headers)||void 0===t?void 0:t[a.reconnect])),"reconnect"),this._attachState!==j.Attached&&!this.attachInProgress){this.attachInProgress=!0;try{if(Object(k.a)(0===this.deltaManager.inbound.length,"Inbound queue should be empty when attaching"),this._attachState===j.Detached){(void 0===this.context.runtimeVersion||this.context.runtimeVersion<"0.25")&&(this._attachState=j.Attaching,this.emit("attaching"));const e=this.context.createSummary();if(void 0===this.protocolHandler)throw new Error("Protocol Handler is undefined");const t=this.captureProtocolSummary();this.cachedAttachSummary=Object(T.a)(e,t),void 0!==this.context.runtimeVersion&&this.context.runtimeVersion>="0.25"&&(this._attachState=j.Attaching,this.emit("attaching"))}Object(k.a)(!!this.cachedAttachSummary,"Summary should be there either by this attach call or previous attach call!!"),void 0===(null===(n=e.headers)||void 0===n?void 0:n[O.createNew])&&(e.headers=Object.assign(Object.assign({},e.headers),{[O.createNew]:{}}));const t=await this.urlResolver.resolve(e);Object(y.a)(t),void 0===this.service&&(this.service=await this.serviceFactory.createContainer(this.cachedAttachSummary,t,this.subLogger));const r=this.service.resolvedUrl;Object(y.a)(r),this._resolvedUrl=r;const o=await this.getAbsoluteUrl("");Object(k.a)(void 0!==o,"Container url undefined"),this.originalRequest={url:o};const s=ve(r.url);if(void 0===s)throw new Error("Unable to parse Url");this.loader.cacheContainer(this,e,s);const[,i]=s.id.split("/");this._id=decodeURI(i),void 0===this._storageService&&(this._storageService=await this.getDocumentStorageService()),this._attachState=j.Attached,this.emit("attached"),this.cachedAttachSummary=void 0,this.propagateConnectionState(),this.closed||this.resumeInternal({fetchOpsFromStorage:!1,reason:"createDetached"})}finally{this.attachInProgress=!1}}}async request(e){return p.d.timedExecAsync(this.logger,{eventName:"Request"},async()=>this.context.request(e))}async snapshot(e,t=!1){if(this.protocolHandler.quorum.has("code")||this.protocolHandler.quorum.has("code2"))try{await this.deltaManager.inbound.pause(),await this.snapshotCore(e,t)}catch(e){throw this.logger.logException({eventName:"SnapshotExceptionError"},e),e}finally{this.deltaManager.inbound.resume()}else this.logger.sendTelemetryEvent({eventName:"SkipSnapshot"})}setAutoReconnect(e){if(e&&this.closed)throw new Error("Attempting to setAutoReconnect() a closed DeltaManager");this._deltaManager.setAutomaticReconnect(e),this.logger.sendTelemetryEvent({eventName:e?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this._deltaManager.connectionMode,connectionState:we[this.connectionState]}),e&&this._attachState===j.Attached&&this.resumedOpProcessingAfterLoad&&(this._connectionState===we.Disconnected&&(this.manualReconnectInProgress=!0),this.connectToDeltaStream({reason:"autoReconnect"}).catch(e=>{this.logger.sendTelemetryEvent({eventName:"setAutoReconnectError"},e)}))}resume(){this.closed||this.resumeInternal()}resumeInternal(e={}){Object(k.a)(!this.closed,"Attempting to setAutoReconnect() a closed DeltaManager"),this.resumedOpProcessingAfterLoad||(this.resumedOpProcessingAfterLoad=!0,this._deltaManager.inbound.resume(),this._deltaManager.outbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(e).catch(()=>{})}get storage(){var e;return null!==(e=this.blobsCacheStorageService)&&void 0!==e?e:this._storageService}raiseContainerWarning(e){!0!==e.logged&&this.logContainerError(e),this.emit("warning",e)}async reloadContext(){return this.reloadContextCore().catch(e=>{throw this.close(N(e)),e})}hasNullRuntime(){return this.context.hasNullRuntime()}async getAbsoluteUrl(e){var t;if(void 0===this.resolvedUrl)return;const n=this.urlResolver;if(void 0!==n.getAbsoluteUrl)return this.urlResolver.getAbsoluteUrl(this.resolvedUrl,e,null===(t=this._context)||void 0===t?void 0:t.codeDetails);if(void 0!==n.requestUrl){const t=await n.requestUrl(this.resolvedUrl,{url:e});if(200===t.status)return t.value;throw new Error(t.value)}throw new Error("Url Resolver does not support creating urls")}async proposeCodeDetails(e){if(!S(e))throw new Error("Provided codeDetails are not IFluidCodeDetails");if(this.codeLoader.IFluidCodeDetailsComparer){const t=await this.codeLoader.IFluidCodeDetailsComparer.compare(e,this.getCodeDetailsFromQuorum());if(void 0!==t&&t<=0)throw new Error("Proposed code details should be greater than the current")}return this.getQuorum().propose("code",e).then(()=>!0).catch(()=>!1)}async reloadContextCore(){var e;const t=this.getCodeDetailsFromQuorum();if(await Promise.all([this.deltaManager.inbound.pause(),this.deltaManager.inboundSignal.pause()]),!0===await this.context.satisfies(t))return this.deltaManager.inbound.resume(),void this.deltaManager.inboundSignal.resume();let n,r={hotSwap:!1};if(!0===this.options.hotSwapContext&&(r={hotSwap:!0,prevState:await this.context.snapshotRuntimeState()}),this.context.dispose(new Error("ContextDisposedForReload")),this.hasNullRuntime()?r.hotSwap||(r={hotSwap:!0,prevState:{}}):this.emit("contextDisposed",t,null===(e=this.context)||void 0===e?void 0:e.codeDetails),this.closed)return;if(!r.hotSwap)return void this.close();const o=new Map;void 0!==r.prevState.snapshot&&(n=Object(F.a)(r.prevState.snapshot.entries,o),this._existing=!0),o.size>0&&(this.blobsCacheStorageService=new P.a(this.storageService,o));const s={branch:this.id,minimumSequenceNumber:this._deltaManager.minimumSequenceNumber,sequenceNumber:this._deltaManager.lastSequenceNumber,term:this._deltaManager.referenceTerm};await this.loadContext(t,s,n,r.prevState),this.deltaManager.inbound.resume(),this.deltaManager.inboundSignal.resume()}async snapshotCore(e,t=!1){const n=this.snapshotBase(),r=await this.context.snapshot(e,t);null!==r&&n.entries.push(...r.entries);const o=`Commit @${this._deltaManager.lastSequenceNumber}:${this._deltaManager.minimumSequenceNumber} ${e}`,s=await this.getVersion(this.id),i=void 0!==s?[s.id]:[];return this.storageService.write(n,i,o,"")}snapshotBase(){const e=[],t=this.protocolHandler.quorum.snapshot();e.push({mode:B.a.File,path:"quorumMembers",type:B.b.Blob,value:{contents:JSON.stringify(t.members),encoding:"utf-8"}}),e.push({mode:B.a.File,path:"quorumProposals",type:B.b.Blob,value:{contents:JSON.stringify(t.proposals),encoding:"utf-8"}}),e.push({mode:B.a.File,path:"quorumValues",type:B.b.Blob,value:{contents:JSON.stringify(t.values),encoding:"utf-8"}});const n={branch:this.id,minimumSequenceNumber:this._deltaManager.minimumSequenceNumber,sequenceNumber:this._deltaManager.lastSequenceNumber,term:this._deltaManager.referenceTerm};return e.push({mode:B.a.File,path:".attributes",type:B.b.Blob,value:{contents:JSON.stringify(n),encoding:"utf-8"}}),{entries:e}}async getVersion(e){return(await this.storageService.getVersions(e,1))[0]}recordConnectStartTime(){void 0===this.connectionTransitionTimes[we.Disconnected]&&(this.connectionTransitionTimes[we.Disconnected]=h.a.now())}async connectToDeltaStream(e={}){return this.recordConnectStartTime(),this._canReconnect&&this.client.details.capabilities.interactive||(e.mode="write"),this._deltaManager.connect(e)}async load(e,t){if(void 0===this._resolvedUrl)throw new Error("Attempting to load without a resolved url");let n;this.service=await this.serviceFactory.createDocumentService(this._resolvedUrl,this.subLogger);const r={mode:"write"};t||(n=this.connectToDeltaStream(r),n.catch(e=>{})),this._storageService=await this.getDocumentStorageService(),this._attachState=j.Attached;const{snapshot:o,versionId:s}=await this.fetchSnapshotTree(e),i=await this.getDocumentAttributes(this.storageService,o);this.attachDeltaManagerOpHandler(i);const a=this.loadAndInitializeProtocolState(i,this.storageService,o);let u;void 0!==o?(this._existing=!0,u=Promise.resolve()):(void 0===n&&(n=this.connectToDeltaStream(r)),u=n.then(e=>{this._existing=e.existing})),[this._protocolHandler]=await Promise.all([a,u]);const c=this.getCodeDetailsFromQuorum();return await this.loadContext(c,i,o),this.propagateConnectionState(),t||this.resume(),this.loaded=!0,{existing:this._existing,sequenceNumber:i.sequenceNumber,version:s}}async createDetached(e){S(e)||this.logger.send({eventName:"DetachCreateNotIFluidCodeDetails",category:"warning"});const t={branch:"",sequenceNumber:0,term:1,minimumSequenceNumber:0},n=[["code",{key:"code",value:e,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]];this.attachDeltaManagerOpHandler(t),this._existing=!1,this._protocolHandler=this.initializeProtocolState(t,[],[],n),await this.createDetachedContext(t),this.propagateConnectionState(),this.loaded=!0}async rehydrateDetachedFromSnapshot(e){const t=await this.getDocumentAttributes(void 0,e);Object(k.a)(0===t.sequenceNumber,"Seq number in detached container should be 0!!"),this.attachDeltaManagerOpHandler(t),this._existing=!0,this._protocolHandler=await this.loadAndInitializeProtocolState(t,void 0,e),await this.createDetachedContext(t,e),this.loaded=!0,this.propagateConnectionState()}async getDocumentStorageService(){return this._deltaManager.connectToStorage()}async getDocumentAttributes(e,t){if(void 0===t)return{branch:this.id,minimumSequenceNumber:0,sequenceNumber:0,term:1};const n=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"],r=void 0!==e?await Object(R.a)(e,n):Object(R.b)(t.trees[".protocol"].blobs,n);return void 0===r.term&&(r.term=1),r}async loadAndInitializeProtocolState(e,t,n){let r=[],o=[],s=[];if(void 0!==n){const e=".protocol"in n.trees?n.trees[".protocol"]:n;void 0!==t?[r,o,s]=await Promise.all([Object(R.a)(t,e.blobs.quorumMembers),Object(R.a)(t,e.blobs.quorumProposals),Object(R.a)(t,e.blobs.quorumValues)]):(r=Object(R.b)(n.trees[".protocol"].blobs,e.blobs.quorumMembers),o=Object(R.b)(n.trees[".protocol"].blobs,e.blobs.quorumProposals),s=Object(R.b)(n.trees[".protocol"].blobs,e.blobs.quorumValues))}return this.initializeProtocolState(e,r,o,s)}initializeProtocolState(e,t,n,r){const o=new M.a(e.minimumSequenceNumber,e.sequenceNumber,e.term,t,n,r,(e,t)=>this.submitMessage(q.a.Propose,{key:e,value:t}),e=>this.submitMessage(q.a.Reject,e)),s=p.a.create(this.subLogger,"ProtocolHandler");return o.quorum.on("error",e=>{s.sendErrorEvent(e)}),o.quorum.on("addMember",(e,t)=>{e===this.pendingClientId&&this.setConnectionState(we.Connected)}),o.quorum.on("removeMember",e=>{e===this._clientId&&this._deltaManager.updateQuorumLeave()}),o.quorum.on("addProposal",e=>{"code"!==e.key&&"code2"!==e.key||this.emit("codeDetailsProposed",e.value,e)}),o.quorum.on("approveProposal",(e,t,n)=>{X("approved "+t),"code"!==t&&"code2"!==t||(X("codeProposal "+JSON.stringify(n)),S(n)||this.logger.send({eventName:"CodeProposalNotIFluidCodeDetails",category:"warning"}),this.reloadContext())}),o}captureProtocolSummary(){const e=this.protocolHandler.quorum.snapshot(),t={branch:this.id,minimumSequenceNumber:this.protocolHandler.minimumSequenceNumber,sequenceNumber:this.protocolHandler.sequenceNumber,term:this.protocolHandler.term};return{tree:{attributes:{content:JSON.stringify(t),type:2},quorumMembers:{content:JSON.stringify(e.members),type:2},quorumProposals:{content:JSON.stringify(e.proposals),type:2},quorumValues:{content:JSON.stringify(e.values),type:2}},type:1}}getCodeDetailsFromQuorum(){const e=this.protocolHandler.quorum;let t=e.get("code");return void 0===t&&(t=e.get("code2")),t}get client(){var e,t,n;const r=void 0!==(null===(e=this.options)||void 0===e?void 0:e.client)?this.options.client:{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}},o=null===(n=null===(t=this.originalRequest)||void 0===t?void 0:t.headers)||void 0===n?void 0:n[a.clientDetails];return void 0!==o&&w()(r.details,o),r}createDeltaManager(){const e=new fe(()=>this.service,this.client,p.a.create(this.subLogger,"DeltaManager"),this._canReconnect);return e.on(_e,(t,n)=>{var r;const o=this._connectionState;this._connectionState=we.Connecting,this.pendingClientId=t.clientId,this.emit(_e,n),this.logConnectionStateChangeTelemetry(we.Connecting,o),(void 0!==this._protocolHandler&&this._protocolHandler.quorum.has(t.clientId)||"read"===e.connectionMode)&&this.setConnectionState(we.Connected),this._audience.clear();for(const e of null!==(r=t.initialClients)&&void 0!==r?r:[])this._audience.addMember(e.clientId,e.client)}),e.on("disconnect",e=>{this.manualReconnectInProgress=!1,this.setConnectionState(we.Disconnected,e)}),e.on("throttled",e=>{this.raiseContainerWarning(e)}),e.on("readonly",e=>{this.emit("readonly",e)}),e}attachDeltaManagerOpHandler(e){var t;this._deltaManager.on("closed",e=>{this.close(e)}),this._deltaManager.attachOpHandler(e.minimumSequenceNumber,e.sequenceNumber,null!==(t=e.term)&&void 0!==t?t:1,{process:e=>this.processRemoteMessage(e),processSignal:e=>{this.processSignal(e)}})}logConnectionStateChangeTelemetry(e,t,n){const r=h.a.now();this.connectionTransitionTimes[e]=r;const o=r-this.connectionTransitionTimes[t];let s,i,a,u,c,d,l;e===we.Disconnected?u=this._deltaManager.reconnectMode:(i=this._deltaManager.connectionMode,d=this.deltaManager.lastSequenceNumber,e===we.Connected?(s=r-this.connectionTransitionTimes[we.Disconnected],s=p.e.formatTick(s)):(c=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&(l=c-d)),a=this.firstConnection?"InitialConnect":this.manualReconnectInProgress?"ManualReconnect":"AutoReconnect"),this.logger.sendPerformanceEvent({eventName:"ConnectionStateChange_"+we[e],from:we[t],duration:o,durationFromDisconnected:s,reason:n,connectionInitiationReason:a,socketDocumentId:this._deltaManager.socketDocumentId,pendingClientId:this.pendingClientId,clientId:this.clientId,connectionMode:i,autoReconnect:u,opsBehind:l,online:D.e[Object(D.j)()],lastVisible:void 0!==this.lastVisible?h.a.now()-this.lastVisible:void 0,checkpointSequenceNumber:c,sequenceNumber:d}),e===we.Connected&&(this.firstConnection=!1,this.manualReconnectInProgress=!1)}setConnectionState(e,t){var n;if(Object(k.a)(e!==we.Connecting),this.connectionState===e)return void this.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e});const r=this._connectionState;if(this._connectionState=e,e===we.Connected){if(void 0!==this._clientId){const e=null===(n=this._protocolHandler)||void 0===n?void 0:n.quorum.getMember(this._clientId);void 0!==e&&(e.shouldHaveLeft=!0)}this._clientId=this.pendingClientId,this._deltaManager.updateQuorumJoin()}else e===we.Disconnected&&(this.pendingClientId=void 0);this.loaded&&this.propagateConnectionState(),this.logConnectionStateChangeTelemetry(e,r,t)}propagateConnectionState(){const e=this._connectionState===we.Connected&&!this.firstConnection&&"write"===this._deltaManager.connectionMode;e&&(this.messageCountAfterDisconnection=0);const t=this._connectionState===we.Connected;this.context.disposed||this.context.setConnectionState(t,this.clientId),this.protocolHandler.quorum.setConnectionState(t,this.clientId),W(this.logger,this,t,this.clientId),e&&this.logger.sendTelemetryEvent({eventName:"OpsSentOnReconnect",count:this.messageCountAfterDisconnection})}submitContainerMessage(e,t,n,r){switch(e){case q.a.Operation:case q.a.RemoteHelp:case q.a.Summarize:break;default:return this.close(N("Runtime can't send arbitrary message type: "+e)),-1}return this.submitMessage(e,t,n,r)}submitMessage(e,t,n,r){return this.connectionState!==we.Connected?(this.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:e}),-1):(this.messageCountAfterDisconnection+=1,this._deltaManager.submit(e,t,n,r))}processRemoteMessage(e){if(null!=e.clientId){let t;const n=this.getQuorum().getMember(e.clientId);if(void 0===n&&e.type!==q.a.ClientJoin?t="messageClientIdMissingFromQuorum":!0===(null==n?void 0:n.shouldHaveLeft)&&(t="messageClientIdShouldHaveLeft"),void 0!==t){const n=new I(t,{clientId:this._clientId,messageClientId:e.clientId,sequenceNumber:e.sequenceNumber,clientSequenceNumber:e.clientSequenceNumber});this.close(N(n))}}const t=this._clientId===e.clientId;Object(M.b)(e)||this.context.process(e,t,void 0);const n=this.protocolHandler.processMessage(e,t);return this.emit("op",e),n}submitSignal(e){this._deltaManager.submitSignal(JSON.stringify(e))}processSignal(e){if(null===e.clientId){const t=e.content;if(t.type===q.a.ClientJoin){const e=t.content;this._audience.addMember(e.clientId,e.client)}else if(t.type===q.a.ClientLeave){const e=t.content;this._audience.removeMember(e)}}else{const t=this._clientId===e.clientId;this.context.processSignal(e,t)}}async fetchSnapshotTree(e){var t;if(null===e)return{};const n=await this.getVersion(null!=e?e:this.id);void 0===n&&void 0!==e&&this.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:e}),this._loadedFromVersion=n;const r=null!==(t=await this.storageService.getSnapshotTree(n))&&void 0!==t?t:void 0;return void 0===r&&void 0!==n&&this.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:n.id}),{snapshot:r,versionId:null==n?void 0:n.id}}async loadContext(e,t,n,r={}){var o,s;Object(k.a)(!1!==(null===(o=this._context)||void 0===o?void 0:o.disposed),"Existing context not disposed");const i=new je(this.loader,()=>this.originalRequest),a=null===(s=this._context)||void 0===s?void 0:s.codeDetails;this._context=await Z.createOrLoad(this,this.scope,this.codeLoader,e,n,t,new ge(this._deltaManager),new L.b(this.protocolHandler.quorum),i,e=>this.raiseContainerWarning(e),(e,t,n,r)=>this.submitContainerMessage(e,t,n,r),e=>this.submitSignal(e),async e=>this.snapshot(e),e=>this.close(e),ke.version,r),i.resolveContainer(this),this.emit("contextChanged",e,a)}async createDetachedContext(e,t){const n=this.getCodeDetailsFromQuorum();if(void 0===n)throw new Error("pkg should be provided in create flow!!");await this.loadContext(n,e,t)}logContainerError(e){this.logger.sendErrorEvent({eventName:"ContainerWarning"},e)}}function Se(e){return void 0===e.headers||!1!==e.headers[a.cache]}ke.version="^0.1.0";class je extends c.EventEmitter{constructor(e,t){super(),this.loader=e,this.baseRequest=t,this.containerDeferred=new l.a}get IFluidRouter(){return this}async resolve(e){return e.url.startsWith("/")?await this.containerDeferred.promise:this.loader.resolve(e)}async request(e){const t=this.baseRequest();if(e.url.startsWith("/")){if(this.needExecutionContext(e)){if(void 0===t)throw new Error("Base Request is not provided");return this.loader.requestWorker(t.url,e)}{let n;if(Se(e))n=await this.containerDeferred.promise;else{if(void 0===t)throw new Error("Base Request is not provided");n=await this.loader.resolve({url:t.url,headers:e.headers})}return n.request(e)}}return this.loader.request(e)}async createDetachedContainer(e){throw new Error("Relative loader should not create a detached container")}async rehydrateDetachedContainerFromSnapshot(e){throw new Error("Relative loader should not create a detached container from snapshot")}resolveContainer(e){this.containerDeferred.resolve(e)}needExecutionContext(e){return void 0!==e.headers&&void 0!==e.headers[a.executionContext]}}function Ce(e){const t=Object.create(e),n=new Map;return t.resolve=async t=>Se(t)?(n.has(t.url)||n.set(t.url,e.resolve(t)),n.get(t.url)):e.resolve(t),t}class xe extends c.EventEmitter{constructor(e){var t,n,r;super(),this.containers=new Map,this.services={urlResolver:Ce(b.a.create(e.urlResolver)),documentServiceFactory:v.a.create(e.documentServiceFactory),codeLoader:e.codeLoader,options:null!==(t=e.options)&&void 0!==t?t:{},scope:null!==(n=e.scope)&&void 0!==n?n:{},subLogger:g.mixinDebugLogger("fluid:telemetry",e.logger,{loaderId:Object(d.a)()}),proxyLoaderFactories:null!==(r=e.proxyLoaderFactories)&&void 0!==r?r:new Map},this.logger=p.a.create(this.services.subLogger,"Loader")}static _create(e,t,n,r,o,s,i){return new xe({urlResolver:b.a.create(e),documentServiceFactory:v.a.create(t),codeLoader:n,options:r,scope:o,proxyLoaderFactories:s,logger:i})}get IFluidRouter(){return this}async createDetachedContainer(e){return X(`Container creating in detached state: ${h.a.now()} `),ke.createDetached(this,e)}async rehydrateDetachedContainerFromSnapshot(e){return X(`Container creating in detached state: ${h.a.now()} `),ke.rehydrateDetachedFromSnapshot(this,JSON.parse(e))}async resolve(e){return p.d.timedExecAsync(this.logger,{eventName:"Resolve"},async()=>(await this.resolveCore(e)).container)}async request(e){return p.d.timedExecAsync(this.logger,{eventName:"Request"},async()=>{const t=await this.resolveCore(e);return t.container.request({url:t.parsed.path})})}cacheContainer(e,t,n){const{canCache:r}=this.parseHeader(n,t);if(r){const r=this.getKeyForContainerCache(t,n);this.containers.set(r,Promise.resolve(e))}}async requestWorker(e,t){const n=this.services.proxyLoaderFactories.get("webworker");if(void 0===n)return(await this.resolve({url:e,headers:t.headers})).request(t);{const r=await this.services.urlResolver.resolve({url:e,headers:t.headers}),o=ve(r.url);if(void 0===o)return Promise.reject(new Error("Invalid URL "+r.url));const{fromSequenceNumber:s}=this.parseHeader(o,{url:e,headers:t.headers});return(await n.createProxyLoader(o.id,this.services.options,r,s)).request(t)}}getKeyForContainerCache(e,t){var n;return void 0!==(null===(n=e.headers)||void 0===n?void 0:n[a.version])?`${t.id}@${e.headers[a.version]}`:t.id}async resolveCore(e){const t=await this.services.urlResolver.resolve(e);Object(y.a)(t);const n=ve(t.url);if(void 0===n)return Promise.reject(new Error("Invalid URL "+t.url));const{canCache:r,fromSequenceNumber:o}=this.parseHeader(n,e);let s;if(r){const r=this.getKeyForContainerCache(e,n),o=await this.containers.get(r);if(void 0!==o)s=o;else{const o=this.loadContainer(n.id,e,t);s=await o,s.closed||(this.containers.set(r,o),s.once("closed",()=>{this.containers.delete(r)}))}}else s=await this.loadContainer(n.id,e,t);return s.deltaManager.lastSequenceNumber<=o&&await new Promise((e,t)=>{s.on("op",(function t(n){n.sequenceNumber>o&&(e(),s.removeListener("op",t))}))}),{container:s,parsed:n}}canUseCache(e){return!1!==this.services.options.cache&&!1!==e[a.cache]}parseHeader(e,t){var n,r;let o=-1;t.headers=null!==(n=t.headers)&&void 0!==n?n:{};const s=t.headers[a.sequenceNumber];void 0!==s&&(o=s),t.headers[a.version]=null!==(r=e.version)&&void 0!==r?r:t.headers[a.version],"null"===t.headers[a.version]&&(t.headers[a.version]=null);const i=this.canUseCache(t.headers);return X(`${i} ${t.headers[a.version]}`),{canCache:i,fromSequenceNumber:o}}async loadContainer(e,t,n){return ke.load(e,this,t,n)}}var Oe=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentServiceFactory.js"),Ee=n("../notebook-dds/node_modules/axios/index.js"),Ie=n.n(Ee),Ae=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/errorTracking.js"),Ne=n("./node_modules/assert/assert.js"),Te=n.n(Ne),Fe=n("../notebook-dds/node_modules/socket.io-client/lib/index.js"),Pe=n.n(Fe),Re=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/gitManager.js"),De=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/nullBlobStorageService.js"),Me=n("../notebook-dds/node_modules/@fluidframework/routerlicious-driver/lib/documentStorageService.js"),Le=n("./node_modules/querystring-es3/index.js"),Be=n.n(Le);class qe{constructor(e,t,n,r){this.tenantId=e,this.id=t,this.storageService=n,this.documentStorageService=r,this.logtailSha=this.documentStorageService.logTailSha}get(e,t){return i(this,void 0,void 0,(function*(){const n=this.logtailSha?yield Object(R.a)(this.documentStorageService,this.logtailSha):[];if(this.logtailSha=void 0,n.length>0){const t=n.filter(t=>t.sequenceNumber>e);if(t.length>0)return{messages:t,partialResult:!0}}return this.storageService.get(this.tenantId,this.id,e,t)}))}}class ze{constructor(e,t,n,r){this.url=e,this.tokenProvider=t,this.headersProvider=n,this.logger=r}get(e,t,n,r){return i(this,void 0,void 0,(function*(){const o=Be.a.stringify({from:n,to:r});let s={"x-correlation-id":d.a()};const i=yield this.headersProvider.fetchHeaders(),a=yield this.tokenProvider.fetchStorageToken(e,t);i&&(s=Object.assign(Object.assign({},s),i.headers)),a&&(s.Authorization="Basic "+a.jwt);const u=yield Ie.a.get(`${this.url}?${o}`,{headers:s});return this.logger&&this.logger.sendTelemetryEvent({eventName:"R11sDriverToServer",correlationId:s["x-correlation-id"]}),{messages:u.data,partialResult:!1}}))}}var He,Ue=n("../notebook-dds/node_modules/@fluidframework/driver-base/lib/documentDeltaConnection.js"),Ve=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/logger.js");!function(e){e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError"}(He||(He={}));const $e=["^0.4.0","^0.3.0","^0.2.0","^0.1.0"];class We extends Ue.a{static create(e,t,n,r,o,s,a,u={},c=2e4){return i(this,void 0,void 0,(function*(){let i={documentId:t,tenantId:e};u&&(i=Object.assign(Object.assign({},i),u));const d=r(s,{query:i,path:"/api/proxy/collab/socket.io",reconnection:!1,transportOptions:{websocket:{protocols:["access-token#"+a]}},transports:["websocket"],timeout:c}),l={client:o,id:t,mode:o.mode,tenantId:e,token:n,versions:$e},h=new We(d,t,new Ve.b);return yield h.initialize(l,c),h}))}createErrorObject(e,t,n=!0){return n&&"object"==typeof t&&null!==t?((e,t,n)=>function(e,t,n,r){switch(n){case 401:case 403:return new D.c(e,He.authorizationError,t,n);case 404:return new D.c(e,He.fileNotFoundOrAccessDeniedError,t,n);case 500:return new D.b(e,t,n);default:return Object(D.h)(e,t,r,n)}}(`socket.io: ${t}: ${e.message}`,n,e.code,e.retryAfter))(t,e,n):super.createErrorObject(e,t,n)}}var Ke,Ge=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/restWrapper.js");function Je(e,t){for(const n of t)if(e.endsWith(n))return!0;return!1}class Ze{constructor(e,t,n,r,o,s){this.endpoint=e,this.historianApi=t,this.disableCache=n;const i={};let a=!1;this.disableCache&&this.historianApi?i.disableCache=this.disableCache:this.disableCache&&(a=!0),o&&(i.token=Object(be.b)(""+o.user));let u=o?{Authorization:"Basic "+Object(be.b)(`${o.user}:${o.password}`)}:{};u=Object.assign(Object.assign({},u),r),s&&(u["x-correlation-id"]=s()||d.a()),this.restWrapper=new Ge.a(e,u,i,a)}getHeader(e){return this.historianApi?this.restWrapper.get("/headers/"+encodeURIComponent(e)):this.getHeaderDirect(e)}getFullTree(e){return this.restWrapper.get("/tree/"+encodeURIComponent(e))}getBlob(e){return this.restWrapper.get("/git/blobs/"+encodeURIComponent(e))}createBlob(e){return this.restWrapper.post("/git/blobs",e)}getContent(e,t){return this.restWrapper.get("/contents/"+e,{ref:t})}getCommits(e,t){return this.restWrapper.get("/commits",{count:t,sha:e}).catch(e=>400===e||404===e?[]:Promise.reject(e))}getCommit(e){return this.restWrapper.get("/git/commits/"+encodeURIComponent(e))}createCommit(e){return this.restWrapper.post("/git/commits",e)}getRefs(){return this.restWrapper.get("/git/refs")}getRef(e){return this.restWrapper.get("/git/refs/"+e)}createRef(e){return this.restWrapper.post("/git/refs",e)}updateRef(e,t){return this.restWrapper.patch("/git/refs/"+e,t)}deleteRef(e){return i(this,void 0,void 0,(function*(){yield this.restWrapper.delete("/git/refs/"+e)}))}createTag(e){return this.restWrapper.post("/git/tags",e)}getTag(e){return this.restWrapper.get("/git/tags/"+e)}createTree(e){return this.restWrapper.post("/git/trees",e)}getTree(e,t){return this.restWrapper.get("/git/trees/"+encodeURIComponent(e),{recursive:t?1:0})}getHeaderDirect(e){return i(this,void 0,void 0,(function*(){const t=yield this.getTree(e,!0),n=[".attributes",".blobs",".messages","header"],r=[];for(const e of t.tree)if("blob"===e.type&&Je(e.path,n)){const t=this.getBlob(e.sha);r.push(t)}return{blobs:yield Promise.all(r),tree:t}}))}}class Xe{constructor(e,t,n,r,o,s,i,a,u,c,d){this.resolvedUrl=e,this.ordererUrl=t,this.deltaStorageUrl=n,this.gitUrl=r,this.errorTracking=o,this.logger=s,this.tokenProvider=i,this.headersProvider=a,this.getWebsocketToken=u,this.tenantId=c,this.documentId=d}connectToStorage(){return i(this,void 0,void 0,(function*(){if(void 0===this.gitUrl)return new De.a;const e={password:(yield this.tokenProvider.fetchStorageToken(this.tenantId,this.documentId)).jwt,user:this.tenantId},t=yield this.headersProvider.fetchHeaders(),n=new Ze(this.gitUrl,!0,!1,t.headers,e),r=new Re.a(n);return this.documentStorageService=new Me.a(this.documentId,r),this.documentStorageService}))}connectToDeltaStorage(){return i(this,void 0,void 0,(function*(){Te()(this.documentStorageService,"Storage service not initialized");const e=new ze(this.deltaStorageUrl,this.tokenProvider,this.headersProvider,this.logger);return new qe(this.tenantId,this.documentId,e,this.documentStorageService)}))}connectToDeltaStream(e){return i(this,void 0,void 0,(function*(){const t=yield this.tokenProvider.fetchOrdererToken(this.tenantId,this.documentId),n=yield this.headersProvider.fetchHeaders(),r=yield this.getWebsocketToken();return We.create(this.tenantId,this.documentId,t.jwt,Pe.a,e,this.ordererUrl,r,n.headers)}))}getErrorTrackingService(){return this.errorTracking}}class Ye{constructor(e,t,n,r=new Ae.a){this.tokenProvider=e,this.headersProvider=t,this.getWebsocketToken=n,this.errorTracking=r,this.protocolName="fluid:"}createContainer(e,t,n){return i(this,void 0,void 0,(function*(){Object(y.a)(t),Object(k.a)(!!t.endpoints.ordererUrl);const r=Object(u.parse)(t.url);if(!r.pathname)throw new Error("Parsed url should contain tenant and doc Id!!");const[,o,s]=r.pathname.split("/"),i=e.tree[".protocol"],a=e.tree[".app"];if(!i||!a)throw new Error("Protocol and App Summary required in the full summary");const c=Object(T.b)(i),d=Object(T.c)(i);let l={Authorization:"Basic "+(yield this.tokenProvider.fetchStorageToken(o,s)).jwt};const h=yield this.headersProvider.fetchHeaders();return l=Object.assign(Object.assign({},l),h),yield Ie.a.post(`${t.endpoints.ordererUrl}/api/proxy/collab/documents/${o}`,{id:s,summary:a,sequenceNumber:c.sequenceNumber,values:d},{headers:l}),this.createDocumentService(t,n)}))}createDocumentService(e,t){return i(this,void 0,void 0,(function*(){Object(y.a)(e);const n=e,r=n.endpoints.storageUrl,o=n.endpoints.ordererUrl,s=n.endpoints.deltaStorageUrl;if(!o||!s)throw new Error(`All endpoints urls must be provided. [ordererUrl:${o}][deltaStorageUrl:${s}]`);const i=Object(u.parse)(n.url),[,a,c]=i.pathname.split("/");if(!c||!a)throw new Error(`Couldn't parse documentId and/or tenantId. [documentId:${c}][tenantId:${a}]`);const d=p.a.create(t,"RouterliciousDriver");return new Xe(n,o,s,r,this.errorTracking,d,this.tokenProvider,this.headersProvider,this.getWebsocketToken,a,c)}))}}function Qe(e){const t=u.parse(e);return t.pathname.endsWith("/")||(t.pathname+="/"),t}class et{constructor(e){this.config=e;const t=Qe(e.ordererUrl);if(this.origin=`${t.protocol}//${t.host}`,this.ordererUrl=u.format(t),e.storageUrl){const t=Qe(e.storageUrl);this.storageUrl=u.format(t)}else this.storageUrl=this.ordererUrl}getAbsoluteUrl(e,t){const n=e,r=u.parse(n.url),[o,s,i]=r.pathname.split("/");return t.startsWith("/")&&(t=t.substr(1)),Promise.resolve(`${o}/${s}/${i}/${u}`)}resolve(e){const t=u.parse(e.url),n=t.pathname.split("/"),[r,o]=n.splice(-2),s=`${this.ordererUrl}deltas/${r}/${o}`,i=`${this.storageUrl}repos/${r}`,a={endpoints:{deltaStorageUrl:s,ordererUrl:this.origin,storageUrl:i},tokens:{},type:"fluid",url:`fluid://${t.host}/${r}/${o}`};return Promise.resolve(a)}}function tt(e){return e&&void 0!==e.appendOutput}!function(e){e.active="active",e.inactive="inactive"}(Ke||(Ke={}));const nt=async(e,t)=>t.IFluidHandleContext.resolveHandle(e);class rt{constructor(e,t){this.absolutePath=e,this.runtime=t,this.isAttached=!0}get IFluidHandle(){return this}attachGraph(){Object(k.a)(!1)}async get(){const e=await this.runtime.IFluidHandleContext.resolveHandle({url:this.absolutePath});if(200===e.status&&"fluid/object"===e.mimeType)return e.value;throw new Error("Failed to resolve container path "+this.absolutePath)}bind(e){throw new Error("Cannot bind to LegacyUriHandle")}}function ot(e,t){return new rt(e,t)}class st{constructor(e){this.request=e;const t=this.request.url.indexOf("?");this.query=t>=0?this.request.url.substring(t):""}static getPathParts(e){const t=e.indexOf("?");return e.substring(0,t<0?e.length:t).split("/").reduce((e,t)=>(void 0!==t&&t.length>0&&e.push(decodeURIComponent(t)),e),[])}static create(e){return e instanceof st?e:new st(e)}get url(){return this.request.url}get headers(){return this.request.headers}get pathParts(){return void 0===this.requestPathParts&&(this.requestPathParts=st.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return""===this.query&&this.pathParts.length===e}createSubRequest(e){const t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:"/"+this.query,headers:this.headers};const n="/"+this.pathParts.slice(e).join("/");return{url:""===this.query?n:`${n}/${this.query}`,headers:this.headers}}}class it{constructor(){this.handlers=[]}pushHandler(...e){void 0!==e&&this.handlers.push(...e)}async handleRequest(e,t){const n=st.create(e);for(const e of this.handlers){const r=await e(n,t);if(void 0!==r)return r}return{status:404,mimeType:"text/plain",value:e.url+" not found"}}}class at{constructor(e){this.map=new Map(e)}get IFluidDataStoreRegistry(){return this}async get(e){if(this.map.has(e))return this.map.get(e)}}function ut(e,t){let n;return n=""===e?void 0===t?"":t.absolutePath:void 0===t?"/"+e:`${t.absolutePath}/${e}`,n}class ct{constructor(e,t,n){this.value=e,this.path=t,this.routeContext=n,this.graphAttachState=j.Detached,this.absolutePath=ut(t,this.routeContext)}get IFluidHandle(){return this}get isAttached(){return this.routeContext.isAttached}async get(){return this.value}attachGraph(){if(this.graphAttachState===j.Detached){if(this.graphAttachState=j.Attaching,void 0!==this.bound){for(const e of this.bound)e.attachGraph();this.bound=void 0}this.routeContext.attachGraph(),this.graphAttachState=j.Attached}}bind(e){this.isAttached||this.graphAttachState!==j.Detached?e.attachGraph():(void 0===this.bound&&(this.bound=new Set),this.bound.add(e))}}var dt=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/unreachable.js"),lt=n("../notebook-dds/node_modules/@fluidframework/runtime-definitions/dist/index.js");class ht{constructor(e,t){this.absolutePath=e,this.routeContext=t,this.isAttached=!0,Object(k.a)(e.startsWith("/"),"Handles should always have absolute paths")}get IFluidRouter(){return this}get IFluidHandleContext(){return this}get IFluidHandle(){return this}get path(){return this.absolutePath}async get(){return void 0===this.dataStoreP&&(this.dataStoreP=this.routeContext.resolveHandle({url:this.absolutePath}).then(e=>"fluid/object"===e.mimeType?e.value:Promise.reject(new Error(e.value)))),this.dataStoreP}attachGraph(){}bind(e){e.attachGraph()}async request(e){const t=(await this.get()).IFluidRouter;return void 0!==t?t.request(e):{status:404,mimeType:"text/plain",value:e.url+" not found"}}}class ft{constructor(e){for(this.context=e,this.root=this.context;void 0!==this.root.routeContext;)this.root=this.root.routeContext}get IFluidSerializer(){return this}replaceHandles(e,t){return e&&"object"==typeof e?this.recursivelyReplaceHandles(e,t):e}stringify(e,t){return JSON.stringify(e,(e,n)=>{const r=!!n&&n.IFluidHandle;return r?this.serializeHandle(r,t):n})}parse(e){return JSON.parse(e,(e,t)=>{if(!(e=>"__fluid_handle__"===(null==e?void 0:e.type))(t))return t;const n=t.url.startsWith("/")?t.url:ut(t.url,this.context);return new ht(n,this.root)})}recursivelyReplaceHandles(e,t){const n=e.IFluidHandle;if(void 0!==n)return this.serializeHandle(n,t);let r;for(const n of Object.keys(e)){const o=e[n];if(o&&"object"==typeof o){const s=this.recursivelyReplaceHandles(o,t);s!==o&&(r=null!=r?r:Array.isArray(e)?[...e]:Object.assign({},e),r[n]=s)}}return null!=r?r:e}serializeHandle(e,t){return t.bind(e),{type:"__fluid_handle__",url:e.absolutePath}}}var mt=n("../notebook-dds/node_modules/@fluidframework/protocol-base/lib/blobs.js");function pt(...e){const t={treeNodeCount:0,blobNodeCount:0,handleNodeCount:0,totalBlobSize:0};for(const n of e)t.treeNodeCount+=n.treeNodeCount,t.blobNodeCount+=n.blobNodeCount,t.handleNodeCount+=n.handleNodeCount,t.totalBlobSize+=n.totalBlobSize;return t}function gt(e){return"string"==typeof e?ae.a.from(e,"utf8").byteLength:e.byteLength}function bt(e){const t=pt();return function e(t,n){switch(t.type){case 1:n.treeNodeCount++;for(const r of Object.values(t.tree))e(r,n);return;case 3:return void n.handleNodeCount++;case 2:return n.blobNodeCount++,void(n.totalBlobSize+=gt(t.content));default:return}}(e,t),t}function vt(e,t,n){const r={type:2,content:n};e.summary.tree[t]=r,e.stats.blobNodeCount++,e.stats.totalBlobSize+=gt(n)}class yt{constructor(){this.attachmentCounter=0,this.summaryTree={},this.summaryStats=pt(),this.summaryStats.treeNodeCount++}get summary(){return{type:1,tree:Object.assign({},this.summaryTree)}}get stats(){return Object.assign({},this.summaryStats)}addBlob(e,t){vt({summary:{type:1,tree:this.summaryTree},stats:this.summaryStats},e,t)}addHandle(e,t,n){this.summaryTree[e]={type:3,handleType:t,handle:n},this.summaryStats.handleNodeCount++}addWithStats(e,t){this.summaryTree[e]=t.summary,this.summaryStats=pt(this.summaryStats,t.stats)}addAttachment(e){this.summaryTree[this.attachmentCounter++]={id:e,type:4}}getSummaryTree(){return{summary:this.summary,stats:this.stats}}}function _t(e,t=!1){const n=new yt;for(const r of e.entries)switch(r.type){case B.b.Blob:{const e=r.value;let t;t="base64"===e.encoding?ae.a.from(e.contents,"base64"):e.contents,n.addBlob(r.path,t);break}case B.b.Tree:{const e=wt(r.value,t);n.addWithStats(r.path,e);break}case B.b.Attachment:{const e=r.value.id;n.addAttachment(e);break}case B.b.Commit:throw new Error("Should not have Commit TreeEntry in summary");default:throw new Error("Unexpected TreeEntry type")}return n.getSummaryTree()}function wt(e,t=!1){if(e.id&&!t){const t=pt();return t.handleNodeCount++,{summary:{handle:e.id,handleType:1,type:3},stats:t}}return _t(e,t)}function kt(e){Object(k.a)(0===Object.keys(e.commits).length,"There should not be commit tree entries in snapshot");const t=new yt;for(const[n,r]of Object.entries(e.blobs))if(void 0!==e.blobs[r]){const o=Object(be.a)(e.blobs[r]);t.addBlob(n,o)}for(const[n,r]of Object.entries(e.trees)){const e=kt(r);t.addWithStats(n,e)}return t.getSummaryTree()}function St(e){const t=[];for(const[n,r]of Object.entries(e.tree))switch(r.type){case 2:{let e,o="utf-8";"string"==typeof r.content?e=r.content:(e=Object(ae.b)(r.content,"base64"),o="base64"),t.push(new mt.b(n,e,o));break}case 1:t.push(new mt.d(n,St(r)));break;case 4:t.push(new mt.a(n,r.id));break;case 3:throw new Error("Should not have Handle type in summary tree");default:Object(dt.a)(r,"Unexpected summary tree type")}return{entries:t}}function jt(e){const t={};for(const[n,r]of Object.entries(e.gcNodes))t[n]=Array.from(r);return{gcNodes:t}}function Ct(e){const t=new Map;for(const n of e){Object(k.a)(n.startsWith("/"),"Used route should always be an absolute route");const e=n.split("/")[1],r=n.slice(e.length+1),o=t.get(e);void 0!==o?o.push(r):t.set(e,[r])}return t}class xt{constructor(){this.gcNodes={}}addNode(e,t){this.gcNodes[e]=t}prefixAndAddNodes(e,t){for(const[n,r]of Object.entries(t)){let t=n;for(;t.startsWith("/");)t=t.substr(1);for(t=`/${e}/${t}`;t.endsWith("/");)t=t.substr(0,t.length-1);this.gcNodes[t]=r}}addRouteToAllNodes(e){for(const t of Object.values(this.gcNodes))t.push(e)}getGCData(){return{gcNodes:this.gcNodes}}}class Ot{constructor(e,t,n,r){this.objectId=e,this._connected=t,this.submitFn=n,this.dirtyFn=r}get handler(){return Object(k.a)(!!this._handler),this._handler}get connected(){return this._connected}attach(e){Object(k.a)(void 0===this._handler),this._handler=e}setConnectionState(e){this._connected=e,this.handler.setConnectionState(e)}process(e,t,n){this.handler.process(e,t,n)}reSubmit(e,t){this.handler.reSubmit(e,t)}submit(e,t){this.submitFn(e,t)}dirty(){this.dirtyFn()}}class Et{constructor(e,t,n){this.tree=e,this.storage=t,this.extraBlobs=n,this.flattenedTree={},void 0!==e&&Et.flattenTree("",e,this.flattenedTree)}static flattenTree(e,t,n){for(const r in t.trees)Et.flattenTree(`${e}${r}/`,t.trees[r],n);for(const r in t.blobs)n[`${e}${r}`]=t.blobs[r]}async contains(e){return void 0!==this.flattenedTree[e]}async read(e){const t=await this.getIdForPath(e),n=void 0!==this.extraBlobs?this.extraBlobs.get(t):void 0;return null!=n?n:this.storage.read(t)}async readBlob(e){const t=await this.getIdForPath(e),n=void 0!==this.extraBlobs?this.extraBlobs.get(t):void 0;if(void 0!==n)return Object(ae.d)(n,"base64");const r=await this.storage.read(t);return Object(ae.d)(r,"base64")}async list(e){var t;let n=this.tree;const r=function(e){let t=e;return t.startsWith("/")&&(t=t.substr(1)),t.endsWith("/")&&(t=t.substr(0,t.length-1)),t.length>0?t.split("/"):[]}(e);for(;void 0!==n&&r.length>0;){const e=r.shift();n=n.trees[e]}if(void 0===n||0!==r.length)throw new Error("path does not exist");return Object.keys(null!==(t=null==n?void 0:n.blobs)&&void 0!==t?t:{})}async getIdForPath(e){return this.flattenedTree[e]}}const It=".attributes";function At(e,t,n,r,o,s,i){return{deltaConnection:new Ot(e,t,(e,t)=>n(e,t),r),objectStorage:new Et(s,o,i)}}function Nt(e,t=!1,n=!1){const r=e.summarize(t,n);vt(r,It,JSON.stringify(e.attributes));const o={usedRoutes:[""],gcData:r.gcData};return vt(r,lt.gcBlobKey,JSON.stringify(o)),r}var Tt=n("../notebook-dds/node_modules/@fluidframework/datastore/node_modules/lodash/cloneDeep.js"),Ft=n.n(Tt),Pt=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/lazy.js");class Rt{constructor(e,t,n,r,o,s,i,a,u){let c;this.id=e,this.runtime=r,this.dataStoreContext=o,this.storageService=s,this.submitFn=i,this.snapshotTree=u,this.attached=!1,this.pending=[];const d=Ft()(this.snapshotTree);if(void 0!==d&&(c=new Map,this.collectExtraBlobsAndSanitizeSnapshot(d,c)),this.services=new Pt.a(()=>At(this.id,this.dataStoreContext.connected,this.submitFn,this.dirtyFn,this.storageService,d,c)),this.factory=t.get(n),void 0===this.factory)throw new Error(`Channel Factory ${n} not registered`);void 0===u&&(this.channel=this.factory.create(r,e)),this.dirtyFn=()=>{a(e)}}async getChannel(){return void 0===this.channel&&(this.channel=await this.loadChannel()),this.channel}get isLoaded(){return void 0!==this.channel}setConnectionState(e,t){this.attached&&this.isLoaded&&this.services.value.deltaConnection.setConnectionState(e)}processOp(e,t,n){Object(k.a)(this.attached,"Local channel must be attached when processing op"),this.isLoaded?this.services.value.deltaConnection.process(e,t,n):(Object(k.a)(!1===t,"Should always be remote because a local dds shouldn't generate ops before loading"),this.pending.push(e))}reSubmit(e,t){Object(k.a)(this.isLoaded,"Channel should be loaded to resubmit ops"),Object(k.a)(this.attached,"Local channel must be attached when resubmitting op"),this.services.value.deltaConnection.reSubmit(e,t)}async summarize(e=!1,t=!1){return Object(k.a)(this.isLoaded&&void 0!==this.channel,"Channel should be loaded to summarize"),Nt(this.channel,e,t)}getAttachSummary(){return Object(k.a)(this.isLoaded&&void 0!==this.channel,"Channel should be loaded to take snapshot"),Nt(this.channel,!0,!1)}async loadChannel(){Object(k.a)(!this.isLoaded,"Channel must not already be loaded when loading"),Object(k.a)(!!this.snapshotTree,"Snapshot should be provided to load from!!"),Object(k.a)(await this.services.value.objectStorage.contains(".attributes"),".attributes blob should be present");const e=await Object(R.a)(this.services.value.objectStorage,".attributes");Object(k.a)(!!this.factory,"Factory should be there for local channel");const t=await this.factory.load(this.runtime,this.id,this.services.value,e);this.channel=t;for(const e of this.pending)try{this.services.value.deltaConnection.process(e,!1,void 0)}catch(t){const n=N(t);throw n.sequenceNumber=e.sequenceNumber,n}return this.channel}markAttached(){if(this.attached)throw new Error("Channel is already attached");this.isLoaded&&(Object(k.a)(!!this.channel,"Channel should be there if loaded!!"),this.channel.connect(this.services.value)),this.attached=!0}collectExtraBlobsAndSanitizeSnapshot(e,t){const n=new Map(Object.entries(e.blobs));for(const[r,o]of n.entries()){const s=n.get(o);void 0!==s?t.set(o,s):delete e.blobs[r]}for(const n of Object.values(e.trees))this.collectExtraBlobsAndSanitizeSnapshot(n,t)}async getGCData(){return Object(k.a)(this.isLoaded&&void 0!==this.channel,"Channel should be loaded to run GC"),this.channel.getGCData()}updateUsedRoutes(e){}}const Dt=m()("fluid:process-loader");Dt("Package: @fluidframework/datastore - Version: 0.34.1");class Mt{constructor(e,t,n,r,o,s,i,a,u,c,d){this.runtime=e,this.dataStoreContext=t,this.id=s,this.registry=a,this.attachMessageType=d,this.isLoaded=!1,this.pending=[],this.gcDetailsInInitialSummaryP=new l.b(async()=>await this.services.objectStorage.contains(lt.gcBlobKey)?Object(R.a)(this.services.objectStorage,lt.gcBlobKey):{}),this.services=At(this.id,this.dataStoreContext.connected,r,()=>o(this.id),n,i,u),this.summarizerNode=c(async(e,t)=>this.summarizeInternal(e,t),async()=>this.getGCDataInternal(),async()=>this.gcDetailsInInitialSummaryP)}getChannel(){return void 0===this.channelP&&(this.channelP=this.loadChannel()),this.channelP}setConnectionState(e,t){this.isLoaded&&this.services.deltaConnection.setConnectionState(e)}processOp(e,t,n){this.summarizerNode.invalidate(e.sequenceNumber),this.isLoaded?this.services.deltaConnection.process(e,t,n):(Object(k.a)(!t,"Remote channel must not be local when processing op"),this.pending.push(e))}reSubmit(e,t){Object(k.a)(this.isLoaded,"Remote channel must be loaded when resubmitting op"),this.services.deltaConnection.reSubmit(e,t)}async summarize(e=!1,t=!0){return this.summarizerNode.summarize(e,t)}async summarizeInternal(e,t){const n=Nt(await this.getChannel(),e,t);return Object.assign(Object.assign({},n),{id:this.id})}async loadChannel(){let e,t;if(Object(k.a)(!this.isLoaded,"Remote channel must not already be loaded when loading"),await this.services.objectStorage.contains(It)&&(e=await Object(R.a)(this.services.objectStorage,It)),void 0===e){if(void 0===this.attachMessageType)throw new A("Channel type not available",{channelId:this.id,dataStoreId:this.dataStoreContext.id,dataStorePackagePath:this.dataStoreContext.packagePath.join("/")});if(t=this.registry.get(this.attachMessageType),void 0===t)throw new A(`Channel Factory ${this.attachMessageType} for attach not registered`,{channelId:this.id,dataStoreId:this.dataStoreContext.id,dataStorePackagePath:this.dataStoreContext.packagePath.join("/"),channelFactoryType:this.attachMessageType});e=t.attributes}else if(t=this.registry.get(e.type),void 0===t)throw new A(`Channel Factory ${e.type} not registered`,{channelId:this.id,dataStoreId:this.dataStoreContext.id,dataStorePackagePath:this.dataStoreContext.packagePath.join("/"),channelFactoryType:e.type});void 0!==e.snapshotFormatVersion&&e.snapshotFormatVersion!==t.attributes.snapshotFormatVersion&&Dt(`Snapshot version mismatch. Type: ${e.type}, Snapshot format@pkg version: ${e.snapshotFormatVersion}@${e.packageVersion}, client format@pkg version: ${t.attributes.snapshotFormatVersion}@${t.attributes.packageVersion}`);const n=await t.load(this.runtime,this.id,this.services,e);for(const e of this.pending)try{this.services.deltaConnection.process(e,!1,void 0)}catch(t){const n=N(t);throw n.sequenceNumber=e.sequenceNumber,n}return this.channel=n,this.pending=void 0,this.isLoaded=!0,this.services.deltaConnection.setConnectionState(this.dataStoreContext.connected),this.channel}async getGCData(){return this.summarizerNode.getGCData()}async getGCDataInternal(){return(await this.getChannel()).getGCData()}updateUsedRoutes(e){void 0!==this.summarizerNode.updateUsedRoutes&&this.summarizerNode.updateUsedRoutes([""])}}var Lt;!function(e){e.Attach="attach",e.ChannelOp="op"}(Lt||(Lt={}));class Bt extends z.a{constructor(e,t){super(),this.dataStoreContext=e,this.sharedObjectRegistry=t,this.serializer=new ft(this.IFluidHandleContext),this._disposed=!1,this.contexts=new Map,this.contextsDeferred=new Map,this.pendingAttach=new Map,this.graphAttachState=j.Detached,this.deferredAttached=new l.a,this.localChannelContextQueue=new Map,this.notBoundedChannelContextSet=new Set,this.logger=p.a.create(e.containerRuntime.logger,void 0,{dataStoreId:Object(d.a)()}),this.documentId=e.documentId,this.id=e.id,this.existing=e.existing,this.options=e.options,this.deltaManager=e.deltaManager,this.quorum=e.getQuorum(),this.audience=e.getAudience();const n=e.baseSnapshot;void 0!==(null==n?void 0:n.trees)&&Object.keys(n.trees).forEach(t=>{if("_search"===t)return;let r;if(e.isLocalDataStore){const o=Object(R.b)(n.trees[t].blobs,n.trees[t].blobs[".attributes"]);r=new Rt(t,this.sharedObjectRegistry,o.type,this,this.dataStoreContext,this.dataStoreContext.storage,(e,n)=>this.submitChannelOp(t,e,n),e=>this.setChannelDirty(e),n.trees[t]),e.attachState!==j.Detached?r.markAttached():this.localChannelContextQueue.set(t,r)}else r=new Mt(this,e,e.storage,(e,n)=>this.submitChannelOp(t,e,n),e=>this.setChannelDirty(e),t,n.trees[t],this.sharedObjectRegistry,void 0,this.dataStoreContext.getCreateChildSummarizerNodeFn(t,{type:lt.CreateSummarizerNodeSource.FromSummary}));const o=new l.a;o.resolve(r),this.contexts.set(t,r),this.contextsDeferred.set(t,o)}),this.attachListener(),this.bindState=this.existing?C.Bound:C.NotBound,this._attachState=e.attachState,this.existing&&this.deferredAttached.resolve()}static load(e,t){return new Bt(e,t)}get IFluidRouter(){return this}get connected(){return this.dataStoreContext.connected}get leader(){return this.dataStoreContext.leader}get clientId(){return this.dataStoreContext.clientId}get clientDetails(){return this.dataStoreContext.containerRuntime.clientDetails}get loader(){return this.dataStoreContext.loader}get isAttached(){return this.attachState!==j.Detached}get attachState(){return this._attachState}get path(){return this.id}get absolutePath(){return ut(this.id,this.routeContext)}get routeContext(){return this.dataStoreContext.containerRuntime.IFluidHandleContext}get IFluidSerializer(){return this.serializer}get IFluidHandleContext(){return this}get rootRoutingContext(){return this}get channelsRoutingContext(){return this}get objectsRoutingContext(){return this}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this.emit("dispose"),this.removeAllListeners())}async resolveHandle(e){return this.request(e)}async request(e){const t=st.create(e),n=t.pathParts[0];if("_channels"===n||"_custom"===n)return this.request(t.createSubRequest(1));if(this.contextsDeferred.has(n)&&t.isLeaf(1))try{const e=await this.contextsDeferred.get(n).promise;return{mimeType:"fluid/object",status:200,value:await e.getChannel()}}catch(e){return this.logger.sendErrorEvent({eventName:"GetChannelFailedInRequest"},e),{status:500,mimeType:"text/plain",value:`Failed to get Channel with id:[${n}] error:{${e}}`}}return void 0===this.requestHandler?{status:404,mimeType:"text/plain",value:e.url+" not found"}:this.requestHandler(t)}registerRequestHandler(e){this.requestHandler=e}async getChannel(e){this.verifyNotClosed(),this.contextsDeferred.has(e)||this.contextsDeferred.set(e,new l.a);const t=await this.contextsDeferred.get(e).promise;return await t.getChannel()}createChannel(e=Object(d.a)(),t){this.verifyNotClosed(),Object(k.a)(!this.contexts.has(e),"createChannel() with existing ID"),this.notBoundedChannelContextSet.add(e);const n=new Rt(e,this.sharedObjectRegistry,t,this,this.dataStoreContext,this.dataStoreContext.storage,(t,n)=>this.submitChannelOp(e,t,n),e=>this.setChannelDirty(e),void 0);if(this.contexts.set(e,n),this.contextsDeferred.has(e))this.contextsDeferred.get(e).resolve(n);else{const t=new l.a;t.resolve(n),this.contextsDeferred.set(e,t)}return Object(k.a)(!!n.channel,"Channel should be loaded when created!!"),n.channel}bindChannel(e){Object(k.a)(this.notBoundedChannelContextSet.has(e.id),"Channel to be binded should be in not bounded set"),this.notBoundedChannelContextSet.delete(e.id),this.isAttached?this.attachChannel(e):(this.bind(e.handle),this.localChannelContextQueue.has(e.id)||this.localChannelContextQueue.set(e.id,this.contexts.get(e.id)))}attachGraph(){this.graphAttachState===j.Detached&&(this.graphAttachState=j.Attaching,void 0!==this.boundhandles&&(this.boundhandles.forEach(e=>{e.attachGraph()}),this.boundhandles=void 0),this.localChannelContextQueue.forEach(e=>{e.markAttached()}),this.localChannelContextQueue.clear(),this.bindToContext(),this.graphAttachState=j.Attached)}bindToContext(){this.bindState===C.NotBound&&(this.bindState=C.Binding,this.dataStoreContext.bindToContext(this),this.bindState=C.Bound)}bind(e){this.isAttached||this.graphAttachState!==j.Detached?e.attachGraph():(void 0===this.boundhandles&&(this.boundhandles=new Set),this.boundhandles.add(e))}setConnectionState(e,t){this.verifyNotClosed();for(const[,n]of this.contexts)n.setConnectionState(e,t);W(this.logger,this,e,t)}getQuorum(){return this.quorum}getAudience(){return this.audience}async uploadBlob(e){return this.verifyNotClosed(),this.dataStoreContext.uploadBlob(e)}process(e,t,n){switch(this.verifyNotClosed(),e.type){case Lt.Attach:{const n=e.contents,r=n.id;if(t)Object(k.a)(this.pendingAttach.has(r),"Unexpected attach (local) channel OP"),this.pendingAttach.delete(r);else{Object(k.a)(!this.contexts.has(r),`Unexpected attach channel OP,\n                        is in pendingAttach set: ${this.pendingAttach.has(r)},\n                        is local channel contexts: ${this.contexts.get(r)instanceof Rt}`);const t=new Map,o=Object(F.a)(n.snapshot.entries,t),s=new Mt(this,this.dataStoreContext,this.dataStoreContext.storage,(e,t)=>this.submitChannelOp(r,e,t),e=>this.setChannelDirty(e),r,o,this.sharedObjectRegistry,t,this.dataStoreContext.getCreateChildSummarizerNodeFn(r,{type:lt.CreateSummarizerNodeSource.FromAttach,sequenceNumber:e.sequenceNumber,snapshot:n.snapshot}),n.type);if(this.contexts.set(r,s),this.contextsDeferred.has(r))this.contextsDeferred.get(r).resolve(s);else{const e=new l.a;e.resolve(s),this.contextsDeferred.set(r,e)}}break}case Lt.ChannelOp:this.processChannelOp(e,t,n)}this.emit("op",e)}processSignal(e,t){this.emit("signal",e,t)}isChannelAttached(e){return!this.notBoundedChannelContextSet.has(e)&&!this.localChannelContextQueue.has(e)&&!this.pendingAttach.has(e)}async snapshotInternal(e=!1){return St((await this.summarize(e)).summary).entries}getOutboundRoutes(){const e=[];for(const[t]of this.contexts)e.push(`${this.absolutePath}/${t}`);return e}updateGCNodes(e){e.addRouteToAllNodes(this.absolutePath),e.addNode("/",this.getOutboundRoutes())}async getGCData(){const e=new xt;return await Promise.all(Array.from(this.contexts).filter(([e,t])=>this.isChannelAttached(e)).map(async([t,n])=>{const r=await n.getGCData();e.prefixAndAddNodes(t,r.gcNodes)})),this.updateGCNodes(e),e.getGCData()}updateUsedRoutes(e){var t;const n=Ct(e);for(const[e]of n)Object(k.a)(this.contexts.has(e),"Used route does not belong to any known context");for(const[e,r]of this.contexts)r.updateUsedRoutes(null!==(t=n.get(e))&&void 0!==t?t:[])}async summarize(e=!1,t=!0){const n=new xt,r=new yt;return await Promise.all(Array.from(this.contexts).filter(([e,t])=>{const n=this.isChannelAttached(e);return Object(k.a)(n,"Not expecting detached channels during summarize"),n}).map(async([o,s])=>{const i=await s.summarize(e,t);r.addWithStats(o,i),void 0!==i.gcData&&n.prefixAndAddNodes(o,i.gcData.gcNodes)})),this.updateGCNodes(n),Object.assign(Object.assign({},r.getSummaryTree()),{gcData:n.getGCData()})}getAttachSummary(){this.attachGraph();const e=new xt,t=new yt;for(const[n,r]of this.contexts){if(!(r instanceof Rt))throw new Error("Should only be called with local channel handles");if(!this.notBoundedChannelContextSet.has(n)){let o;if(r.isLoaded){const t=r.getAttachSummary();Object(k.a)(1===t.summary.type,"getAttachSummary should always return a tree"),o={stats:t.stats,summary:t.summary},void 0!==t.gcData&&e.prefixAndAddNodes(n,t.gcData.gcNodes)}else Object(k.a)(!!this.dataStoreContext.baseSnapshot,"BaseSnapshot should be there as detached container loaded from snapshot"),o=kt(this.dataStoreContext.baseSnapshot.trees[n]);t.addWithStats(n,o)}}return this.updateGCNodes(e),Object.assign(Object.assign({},t.getSummaryTree()),{gcData:e.getGCData()})}submitMessage(e,t,n){this.submit(e,t,n)}submitSignal(e,t){return this.verifyNotClosed(),this.dataStoreContext.submitSignal(e,t)}async waitAttached(){return this.deferredAttached.promise}raiseContainerWarning(e){this.dataStoreContext.raiseContainerWarning(e)}attachChannel(e){if(this.verifyNotClosed(),!e.handle.isAttached){if(e.handle.attachGraph(),Object(k.a)(this.isAttached,"Data store should be attached to attach the channel."),this.bindState===C.Bound&&this.graphAttachState===j.Attached){const t=St(Nt(e,!0,!1).summary),n={id:e.id,snapshot:t,type:e.attributes.type};this.pendingAttach.set(e.id,n),this.submit(Lt.Attach,n)}this.contexts.get(e.id).markAttached()}}submitChannelOp(e,t,n){const r={address:e,contents:t};this.submit(Lt.ChannelOp,r,n)}submit(e,t,n){this.verifyNotClosed(),this.dataStoreContext.submitMessage(e,t,n)}reSubmit(e,t,n){switch(this.verifyNotClosed(),e){case Lt.ChannelOp:{const e=t,r=this.contexts.get(e.address);Object(k.a)(!!r,"There should be a channel context for the op"),r.reSubmit(e.contents,n);break}case Lt.Attach:this.submit(e,t,n);break;default:Object(dt.a)(e)}}setChannelDirty(e){this.verifyNotClosed(),this.dataStoreContext.setChannelDirty(e)}processChannelOp(e,t,n){this.verifyNotClosed();const r=e.contents,o=Object.assign(Object.assign({},e),{contents:r.contents}),s=this.contexts.get(r.address);return Object(k.a)(!!s,"Channel not found"),s.processOp(o,t,n),s}attachListener(){this.setMaxListeners(Number.MAX_SAFE_INTEGER),this.dataStoreContext.on("leader",()=>{this.emit("leader")}),this.dataStoreContext.on("notleader",()=>{this.emit("notleader")}),this.dataStoreContext.once("attaching",()=>{Object(k.a)(this.bindState!==C.NotBound,"Data store attaching should not occur if it is not bound"),this._attachState=j.Attaching,this.deferredAttached.resolve(),this.emit("attaching")}),this.dataStoreContext.once("attached",()=>{Object(k.a)(this.bindState===C.Bound,"Data store should only be attached after it is bound"),this._attachState=j.Attached,this.emit("attached")})}verifyNotClosed(){if(this._disposed)throw new Error("Runtime is closed")}}const qt=(e,t=Bt)=>class extends t{async request(t){const n=await super.request(t);return 404===n.status?e(t,this):n}};class zt extends ct{get isAttached(){return this.value.isAttached()}constructor(e,t,n){super(e,t,n)}attachGraph(){this.value.bindToContext(),super.attachGraph()}async request(e){return{status:404,mimeType:"text/plain",value:e.url+" not found"}}}class Ht extends ft{constructor(){super(...arguments),this.serializedRoutes=new Set}getSerializedRoutes(){return Array.from(this.serializedRoutes)}serializeHandle(e,t){return this.serializedRoutes.add(e.absolutePath),super.serializeHandle(e,t)}}class Ut extends H{constructor(e,t,n){super(),this.id=e,this.runtime=t,this.attributes=n,this._connected=!1,this._isBoundToContext=!1,this._isSummarizing=!1,this.handle=new zt(this,e,t.IFluidHandleContext),this.logger=p.a.create(null!==t?t.logger:void 0,void 0,{sharedObjectId:Object(d.a)()}),this._serializer=new ft(this.runtime.channelsRoutingContext),this.attachListeners()}static is(e){return void 0!==(null==e?void 0:e.ISharedObject)}get ISharedObject(){return this}get IChannel(){return this}get IFluidLoadable(){return this}get connected(){return this._connected}get url(){return this.id}get serializer(){return Object(k.a)(!this._isSummarizing,"SummarySerializer should be used for serializing data during summary."),this._serializer}attachListeners(){this.on("error",e=>{this.runtime.raiseContainerWarning(e)}),this.isAttached()||this.runtime.once("attaching",()=>{this.didAttach()})}toJSON(){throw new Error("Only the handle can be converted to JSON")}async load(e){this.runtime.attachState!==j.Detached&&(this.services=e),await this.loadCore(e.objectStorage),this.runtime.attachState!==j.Detached&&this.attachDeltaHandler()}initializeLocal(){this.initializeLocalCore()}bindToContext(){this._isBoundToContext||(this._isBoundToContext=!0,this.setOwner(),this.registerCore(),this.runtime.bindChannel(this))}connect(e){this.services=e,this.attachDeltaHandler()}isAttached(){return void 0!==this.services&&this.runtime.attachState!==j.Detached}summarize(e=!1,t=!1){let n,r;Object(k.a)(!this._isSummarizing,"Possible re-entrancy! Summary should not already be in progress."),this._isSummarizing=!0;try{const t=new Ht(this.runtime.channelsRoutingContext);n=_t(this.snapshotCore(t),e),r={gcNodes:{"/":t.getSerializedRoutes()}},Object(k.a)(this._isSummarizing,"Possible re-entrancy! Summary should have been in progress.")}finally{this._isSummarizing=!1}return Object.assign(Object.assign({},n),{gcData:r})}getGCData(){let e;Object(k.a)(!this._isSummarizing,"Possible re-entrancy! Summary should not already be in progress."),this._isSummarizing=!0;try{const t=new Ht(this.runtime.channelsRoutingContext);this.snapshotCore(t),e={gcNodes:{"/":t.getSerializedRoutes()}},Object(k.a)(this._isSummarizing,"Possible re-entrancy! Summary should have been in progress.")}finally{this._isSummarizing=!1}return e}snapshot(){return this.snapshotCore(this.serializer)}setOwner(){}initializeLocalCore(){}didAttach(){}submitLocalMessage(e,t){this.isAttached()&&this.services.deltaConnection.submit(e,t)}dirty(){this.isAttached()&&this.services.deltaConnection.dirty()}onConnect(){}reSubmitCore(e,t){this.submitLocalMessage(e,t)}async newAckBasedPromise(e){let t;return new Promise((n,r)=>{t=()=>r(new Error("FluidDataStoreRuntime disposed while this ack-based Promise was pending")),this.runtime.disposed?t():(this.runtime.on("dispose",t),e(n,r))}).finally(()=>{this.runtime.off("dispose",t)})}debugAssert(e,t){this.logger.debugAssert(e,t)}attachDeltaHandler(){Object(k.a)(void 0!==this.services,"Services should be there to attach delta handler"),this._isBoundToContext=!0,this.didAttach(),this.services.deltaConnection.attach({process:(e,t,n)=>{this.process(e,t,n)},setConnectionState:e=>{this.setConnectionState(e)},reSubmit:(e,t)=>{this.reSubmit(e,t)}}),this.setConnectionState(this.services.deltaConnection.connected)}setConnectionState(e){this._connected!==e&&(this._connected=e,e?this.onConnect():this.onDisconnect())}process(e,t,n){this.emit("pre-op",e,t,this),this.processCore(e,t,n),this.emit("op",e,t,this)}reSubmit(e,t){this.reSubmitCore(e,t)}}const Vt=m()("fluid:map");function $t(e,t,n){return void 0!==e?t.stringify(e,n):e}function Wt(e,t,n){return t.replaceHandles(e,n)}function Kt(e,t){return void 0!==e?t.parse(JSON.stringify(e)):e}var Gt;function Jt(e,t,n){const r=e.makeSerialized(t,n);return{type:r.type,value:r.value&&JSON.parse(r.value)}}Vt("Package: @fluidframework/map - Version: 0.34.1"),function(e){e[e.Shared=0]="Shared",e[e.Plain=1]="Plain"}(Gt||(Gt={}));class Zt{constructor(e){this.value=e}get type(){return Gt[Gt.Plain]}makeSerialized(e,t){const n=$t(this.value,e,t);return{type:this.type,value:n}}}class Xt{constructor(e,t){this.value=e,this.valueType=t}get type(){return this.valueType.name}makeSerialized(e,t){const n=$t(this.valueType.factory.store(this.value),e,t);return{type:this.type,value:n}}getOpHandler(e){const t=this.valueType.ops.get(e);if(!t)throw new Error("Unknown type message");return t}}class Yt{constructor(e){this.serializer=e,this.valueTypes=new Map}registerValueType(e){this.valueTypes.set(e.name,e)}fromSerializable(e){if(e.type===Gt[Gt.Shared]){e.type=Gt[Gt.Plain];const t={type:"__fluid_handle__",url:e.value};e.value=t}const t=Kt(e.value,this.serializer);return new Zt(t)}fromSerializableValueType(e,t){if(this.valueTypes.has(e.type)){const n=this.valueTypes.get(e.type);e.value=Kt(e.value,this.serializer);const r=n.factory.load(t,e.value);return new Xt(r,n)}throw new Error(`Unknown value type "${e.type}"`)}fromInMemory(e){if(Ut.is(e))throw new Error("SharedObject sets are no longer supported. Instead set the SharedObject handle.");return new Zt(e)}makeValueType(e,t,n){const r=this.loadValueType(n,e,t);return new Xt(r,this.valueTypes.get(e))}loadValueType(e,t,n){const r=this.valueTypes.get(t);if(!r)throw new Error(`Unknown type '${t}' specified`);return r.factory.load(n,e)}}class Qt{constructor(e,t,n,r,o,s=new z.a){this.serializer=e,this.handle=t,this.submitMessage=n,this.isAttached=r,this.eventEmitter=s,this.messageHandlers=new Map,this.data=new Map,this.pendingKeys=new Map,this.pendingMessageId=-1,this.pendingClearMessageId=-1,this.localValueMaker=new Yt(e),this.messageHandlers=this.getMessageHandlers();for(const e of o)this.localValueMaker.registerValueType(e)}get size(){return this.data.size}keys(){return this.data.keys()}entries(){const e=this.data.entries();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:[t.value[0],t.value[1].value],done:!1}},[Symbol.iterator](){return this}}}values(){const e=this.data.values();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:t.value.value,done:!1}},[Symbol.iterator](){return this}}}[Symbol.iterator](){return this.entries()}forEach(e){this.data.forEach((t,n,r)=>{e(t.value,n,r)})}get(e){if(this.data.has(e))return this.data.get(e).value}async wait(e){return this.has(e)?this.get(e):new Promise(t=>{const n=r=>{e===r.key&&(t(this.get(r.key)),this.eventEmitter.removeListener("valueChanged",n))};this.eventEmitter.on("valueChanged",n)})}has(e){return this.data.has(e)}set(e,t){if(null==e)throw new Error("Undefined and null keys are not supported");const n=this.localValueMaker.fromInMemory(t),r=Jt(n,this.serializer,this.handle);if(this.setCore(e,n,!0,null),!this.isAttached())return;const o={key:e,type:"set",value:r};this.submitMapKeyMessage(o)}createValueType(e,t,n){const r=this.localValueMaker.makeValueType(t,this.makeMapValueOpEmitter(e),n),o=Wt(n,this.serializer,this.handle);if(this.setCore(e,r,!0,null),!this.isAttached())return this;const s={key:e,type:"set",value:{type:t,value:o}};return this.submitMapKeyMessage(s),this}delete(e){const t=this.deleteCore(e,!0,null);if(!this.isAttached())return t;const n={key:e,type:"delete"};return this.submitMapKeyMessage(n),t}clear(){this.clearCore(!0,null),this.isAttached()&&this.submitMapClearMessage({type:"clear"})}getSerializedStorage(e){const t={};return this.data.forEach((n,r)=>{t[r]=n.makeSerialized(e,this.handle)}),t}getSerializableStorage(e){const t={};return this.data.forEach((n,r)=>{t[r]=Jt(n,e,this.handle)}),t}serialize(e){return JSON.stringify(this.getSerializableStorage(e))}populateFromSerializable(e){for(const[t,n]of Object.entries(e)){const e={key:t,value:this.makeLocal(t,n)};this.data.set(e.key,e.value)}}populate(e){this.populateFromSerializable(JSON.parse(e))}trySubmitMessage(e,t){const n=e.type;return!!this.messageHandlers.has(n)&&(this.messageHandlers.get(n).submit(e,t),!0)}tryProcessMessage(e,t,n){const r=e.contents;return!!this.messageHandlers.has(r.type)&&(this.messageHandlers.get(r.type).process(r,t,e,n),!0)}setCore(e,t,n,r){const o=this.get(e);this.data.set(e,t);const s={key:e,previousValue:o};this.eventEmitter.emit("valueChanged",s,n,r,this.eventEmitter)}clearCore(e,t){this.data.clear(),this.eventEmitter.emit("clear",e,t,this.eventEmitter)}deleteCore(e,t,n){const r=this.get(e),o=this.data.delete(e);if(o){const o={key:e,previousValue:r};this.eventEmitter.emit("valueChanged",o,t,n,this.eventEmitter)}return o}clearExceptPendingKeys(){const e=new Map;this.pendingKeys.forEach((t,n)=>{e.set(n,this.data.get(n))}),this.data.clear(),e.forEach((e,t)=>{this.data.set(t,e)})}makeLocal(e,t){return t.type===Gt[Gt.Plain]||t.type===Gt[Gt.Shared]?this.localValueMaker.fromSerializable(t):this.localValueMaker.fromSerializableValueType(t,this.makeMapValueOpEmitter(e))}needProcessKeyOperation(e,t,n,r){if(-1!==this.pendingClearMessageId)return t&&Object(k.a)(void 0!==r&&r<this.pendingClearMessageId,"Received out of order op when there is an unackd clear message"),!1;if(this.pendingKeys.has(e.key)){if(t){Object(k.a)(void 0!==r,`pendingMessageId is missing from the local client's ${e.type} operation`);const t=r;this.pendingKeys.get(e.key)===t&&this.pendingKeys.delete(e.key)}return!1}return!t}getMessageHandlers(){const e=new Map;return e.set("clear",{process:(e,t,n,r)=>{if(t){Object(k.a)(void 0!==r,"pendingMessageId is missing from the local client's clear operation");const e=r;this.pendingClearMessageId===e&&(this.pendingClearMessageId=-1)}else 0===this.pendingKeys.size?this.clearCore(t,n):this.clearExceptPendingKeys()},submit:(e,t)=>{this.submitMapClearMessage(e)}}),e.set("delete",{process:(e,t,n,r)=>{this.needProcessKeyOperation(e,t,n,r)&&this.deleteCore(e.key,t,n)},submit:(e,t)=>{this.submitMapKeyMessage(e)}}),e.set("set",{process:(e,t,n,r)=>{if(!this.needProcessKeyOperation(e,t,n,r))return;const o=this.makeLocal(e.key,e.value);this.setCore(e.key,o,t,n)},submit:(e,t)=>{this.submitMapKeyMessage(e)}}),e.set("act",{process:(e,t,n,r)=>{const o=this.data.get(e.key);if(!o)return;const s=o.getOpHandler(e.value.opName),i=o.value,a=Kt(e.value.value,this.serializer);s.process(i,a,t,n);const u={key:e.key,previousValue:i};this.eventEmitter.emit("valueChanged",u,t,n,this.eventEmitter)},submit:(e,t)=>{this.submitMessage(e,t)}}),e}submitMapClearMessage(e){const t=++this.pendingMessageId;this.submitMessage(e,t),this.pendingClearMessageId=t}submitMapKeyMessage(e){const t=++this.pendingMessageId;this.submitMessage(e,t),this.pendingKeys.set(e.key,t)}makeMapValueOpEmitter(e){return{emit:(t,n,r)=>{const o=Wt(r,this.serializer,this.handle),s={key:e,type:"act",value:{opName:t,value:o}};this.submitMessage(s,void 0);const i={key:e,previousValue:n};this.eventEmitter.emit("valueChanged",i,!0,null,this.eventEmitter)}}}}class en{get type(){return en.Type}get attributes(){return en.Attributes}async load(e,t,n,r){const o=new tn(t,e,r);return await o.load(n),o}create(e,t){const n=new tn(t,e,en.Attributes);return n.initializeLocal(),n}}en.Type="https://graph.microsoft.com/types/map",en.Attributes={type:en.Type,snapshotFormatVersion:"0.2",packageVersion:"0.34.1"};class tn extends Ut{constructor(e,t,n){super(e,t,n),this[Symbol.toStringTag]="SharedMap",this.kernel=new Qt(this.serializer,this.handle,(e,t)=>this.submitLocalMessage(e,t),()=>this.isAttached(),[],this)}static create(e,t){return e.createChannel(t,en.Type)}static getFactory(){return new en}keys(){return this.kernel.keys()}entries(){return this.kernel.entries()}values(){return this.kernel.values()}[Symbol.iterator](){return this.kernel.entries()}get size(){return this.kernel.size}forEach(e){this.kernel.forEach(e)}get(e){return this.kernel.get(e)}async wait(e){return this.kernel.wait(e)}has(e){return this.kernel.has(e)}set(e,t){return this.kernel.set(e,t),this}delete(e){return this.kernel.delete(e)}clear(){this.kernel.clear()}snapshotCore(e){let t=0,n=0,r={};const o=[],s={entries:[]},i=this.kernel.getSerializedStorage(e);for(const e of Object.keys(i)){const a=i[e];if(a.value&&a.value.length>=8192){const t="blob"+n;n++,o.push(t);const r={[e]:{type:a.type,value:JSON.parse(a.value)}};Object(mt.e)(s,t,r)}else{if(t+=a.type.length+21,a.value&&(t+=a.value.length),t>16384){const e="blob"+n;n++,o.push(e),Object(mt.e)(s,e,r),r={},t=0}r[e]={type:a.type,value:void 0===a.value?void 0:JSON.parse(a.value)}}}const a={blobs:o,content:r};return Object(mt.e)(s,"header",a),s}getSerializableStorage(){return this.kernel.getSerializableStorage(this.serializer)}async loadCore(e){const t=await e.readBlob("header"),n=Object(ae.c)(t,"utf8"),r=JSON.parse(n),o=r;Array.isArray(o.blobs)?(this.kernel.populateFromSerializable(o.content),await Promise.all(o.blobs.map(async t=>{const n=await e.readBlob(t),r=Object(ae.c)(n,"utf8");this.kernel.populateFromSerializable(JSON.parse(r))}))):this.kernel.populateFromSerializable(r)}onDisconnect(){Vt(`Map ${this.id} is now disconnected`)}reSubmitCore(e,t){this.kernel.trySubmitMessage(e,t)}processCore(e,t,n){e.type===q.a.Operation&&this.kernel.tryProcessMessage(e,t,n)}registerCore(){for(const e of this.values())Ut.is(e)&&e.bindToContext()}}class nn{get type(){return nn.Type}get attributes(){return nn.Attributes}async load(e,t,n,r){const o=new an(t,e,r);return await o.load(n),o}create(e,t){const n=new an(t,e,nn.Attributes);return n.initializeLocal(),n}}nn.Type="https://graph.microsoft.com/types/consensus-register-collection",nn.Attributes={type:nn.Type,snapshotFormatVersion:"0.1",packageVersion:"0.34.1"};const rn=m()("fluid:consensus-register-collection");var on;rn("Package: @fluidframework/register-collection - Version: 0.34.1"),function(e){e[e.Atomic=0]="Atomic",e[e.LWW=1]="LWW"}(on||(on={}));const sn=(e,t)=>({sequenceNumber:e,value:{type:"Plain",value:t}});class an extends Ut{constructor(e,t,n){super(e,t,n),this.data=new Map}static create(e,t){return e.createChannel(t,nn.Type)}static getFactory(){return new nn}async write(e,t){const n=this.stringify(t,this.serializer);if(!this.isAttached())return this.processInboundWrite(e,this.parse(n,this.serializer),0,0,!0),!0;const r={key:e,type:"write",serializedValue:n,refSeq:this.runtime.deltaManager.lastSequenceNumber};return this.newAckBasedPromise(e=>{this.submitLocalMessage(r,e)}).catch(e=>!1)}read(e,t=on.Atomic){if(t===on.Atomic)return this.readAtomic(e);const n=this.readVersions(e);return void 0!==n?(Object(k.a)(n.length>0,"Value should be undefined or non-empty"),n[n.length-1]):void 0}readVersions(e){const t=this.data.get(e);return null==t?void 0:t.versions.map(e=>e.value.value)}keys(){return[...this.data.keys()]}snapshotCore(e){const t={};return this.data.forEach((e,n)=>{t[n]=e}),{entries:[{mode:B.a.File,path:"header",type:B.b.Blob,value:{contents:this.stringify(t,e),encoding:"utf-8"}}]}}async loadCore(e){var t;const n=await e.readBlob("header"),r=Object(ae.c)(n,"utf8"),o=this.parse(r,this.serializer);for(const e of Object.keys(o))Object(k.a)("Shared"!==(null===(t=o[e].atomic)||void 0===t?void 0:t.value.type),"SharedObjects contained in ConsensusRegisterCollection can no longer be deserialized as of 0.17"),this.data.set(e,o[e])}registerCore(){}onDisconnect(){rn(`ConsensusRegisterCollection ${this.id} is now disconnected`)}processCore(e,t,n){if(e.type===q.a.Operation){const r=e.contents;switch(r.type){case"write":{void 0===r.refSeq&&(r.refSeq=e.referenceSequenceNumber);const o=r.refSeq;Object(k.a)(o<=e.referenceSequenceNumber);const s=(e=>"serializedValue"in e)(r)?this.parse(r.serializedValue,this.serializer):r.value.value,i=this.processInboundWrite(r.key,s,o,e.sequenceNumber,t);t&&n(i);break}default:Object(dt.a)(r.type)}}}readAtomic(e){const t=this.data.get(e);return null==t?void 0:t.atomic.value.value}processInboundWrite(e,t,n,r,o){let s=this.data.get(e);const i=void 0===s||n>=s.atomic.sequenceNumber;if(i){const n=sn(r,t);void 0===s?(s={atomic:n,versions:[]},this.data.set(e,s)):s.atomic=n}else Object(k.a)(!!s);for(;s.versions.length>0&&n>=s.versions[0].sequenceNumber;)s.versions.shift();const a=sn(r,t);return this.isAttached()?s.versions.length>0&&Object(k.a)(r>s.versions[s.versions.length-1].sequenceNumber,"Versions should naturally be ordered by sequenceNumber"):Object(k.a)(0===n&&0===r,"sequence numbersare expected to be 0 when unattached"),s.versions.push(a),i&&this.emit("atomicChanged",e,t,o),this.emit("versionChanged",e,t,o),i}stringify(e,t){return t.stringify(e,this.handle)}parse(e,t){return t.parse(e)}}const un=Object(d.a)()+"_unattached";class cn extends c.EventEmitter{constructor(e,t,n){super(),this.runtime=e,this.context=t,this.scheduler=n,this.registeredTasks=new Set,this.locallyRunnableTasks=new Map,this.runningTasks=new Set}static async load(e,t){let n,r;if(e.existing){n=await e.getChannel("root");const t=await n.wait("scheduler");Object(k.a)(void 0!==t),r=await t.get()}else n=tn.create(e,"root"),n.bindToContext(),r=an.create(e),r.bindToContext(),n.set("scheduler",r.handle);const o=new cn(e,t,r);return o.initialize(),o}get IAgentScheduler(){return this}get clientId(){if(this.runtime.attachState===j.Detached)return un;const e=this.runtime.clientId;return Object(k.a)(!!e),e}async register(...e){for(const t of e)if(this.registeredTasks.has(t))return Promise.reject(new Error(t+" is already registered"));const t=[];for(const n of e)this.registeredTasks.add(n),void 0===this.getTaskClientId(n)&&t.push(n);return this.registerCore(t)}async pick(e,t){if(this.locallyRunnableTasks.has(e))return Promise.reject(new Error(e+" is already attempted"));if(this.locallyRunnableTasks.set(e,t),Object(k.a)(this.context.deltaManager.clientDetails.capabilities.interactive),this.isActive()){const t=this.getTaskClientId(e);null!=t||(m()("Requesting "+e),await this.writeCore(e,this.clientId))}}async release(...e){const t=this.isActive();for(const n of e){if(!this.locallyRunnableTasks.has(n))return Promise.reject(new Error(n+" was never registered"));if(Object(k.a)(t),this.getTaskClientId(n)!==this.clientId)return Promise.reject(new Error(n+" was never picked"))}return this.releaseCore([...e])}pickedTasks(){return Array.from(this.runningTasks.values())}async registerCore(e){if(e.length>0){const t=[];for(const n of e)m()("Registering "+n),t.push(this.writeCore(n,null));await Promise.all(t);for(const t of e){const e=this.getTaskClientId(t);Object(k.a)(void 0!==e,"Unsuccessful registration"),null===e?m()("Registered "+t):m()(`${e} is running ${t}`)}}}async releaseCore(e){if(e.length>0){const t=[];for(const n of e)m()("Releasing "+n),this.locallyRunnableTasks.delete(n),t.push(this.writeCore(n,null));await Promise.all(t)}}async clearTasks(e){Object(k.a)(this.isActive());const t=[];for(const n of e)m()("Clearing "+n),t.push(this.writeCore(n,null));await Promise.all(t)}getTaskClientId(e){return this.scheduler.read(e)}async writeCore(e,t){await this.scheduler.write(e,t)}initialize(){this.runtime.getQuorum().on("removeMember",async e=>{if(Object(k.a)(this.runtime.objectsRoutingContext.isAttached),this.isActive()){const t=[];for(const n of this.scheduler.keys())this.getTaskClientId(n)===e&&t.push(n);await this.clearTasks(t)}}),this.scheduler.on("atomicChanged",async(e,t)=>{this.isActive()&&t===this.clientId?this.onNewTaskAssigned(e):await this.onTaskReassigned(e,t)}),this.isActive()&&this.initializeCore(),this.runtime.on("connected",()=>{this.isActive()&&this.initializeCore()}),this.runtime.attachState===j.Detached&&this.runtime.waitAttached().then(()=>{this.clearRunningTasks()}).catch(e=>{this.sendErrorEvent("AgentScheduler_clearRunningTasks",e)}),this.runtime.on("disconnected",()=>{this.runtime.attachState!==j.Detached&&this.clearRunningTasks()})}onNewTaskAssigned(e){Object(k.a)(!this.runningTasks.has(e),"task is already running"),this.runningTasks.add(e);const t=this.locallyRunnableTasks.get(e);void 0===t?this.sendErrorEvent("AgentScheduler_UnwantedChange",void 0,e):(this.emit("picked",e),t().catch(t=>{this.sendErrorEvent("AgentScheduler_FailedWork",t,e)}))}async onTaskReassigned(e,t){this.runningTasks.has(e)&&(this.runningTasks.delete(e),this.emit("released",e)),Object(k.a)(void 0!==t,"client is undefined"),this.isActive()&&(null===t?this.locallyRunnableTasks.has(e)&&(m()("Requesting "+e),await this.writeCore(e,this.clientId)):void 0===this.runtime.getQuorum().getMember(t)&&await this.writeCore(e,null))}isActive(){return this.runtime.attachState===j.Detached||!!this.runtime.connected&&this.context.deltaManager.active}initializeCore(){const e=[],t=[];for(const[e]of this.locallyRunnableTasks)this.getTaskClientId(e)||(m()("Requesting "+e),t.push(this.writeCore(e,this.clientId)));for(const t of this.scheduler.keys()){const n=this.getTaskClientId(t);n&&void 0===this.runtime.getQuorum().getMember(n)&&e.push(t)}t.push(this.clearTasks(e)),Promise.all(t).catch(e=>{this.sendErrorEvent("AgentScheduler_InitError",e)})}clearRunningTasks(){const e=this.runningTasks;this.runningTasks=new Set,this.isActive()&&this.initializeCore();for(const t of e)this.emit("lost",t)}sendErrorEvent(e,t,n){this.runtime.logger.sendErrorEvent({eventName:e,key:n},t)}}class dn{constructor(e,t,n){this.scheduler=e,this.runtime=t,this.context=n,this.taskUrl="_tasks",this.taskMap=new Map,this.innerHandle=new ct(this,"",this.runtime.objectsRoutingContext)}static async load(e,t){const n=await cn.load(e,t);return new dn(n,e,t)}get IAgentScheduler(){return this.scheduler}get handle(){return this.innerHandle}get IFluidHandle(){return this.innerHandle}get IFluidLoadable(){return this}get IFluidRouter(){return this}get ITaskManager(){return this}async request(e){if(""===e.url||"/"===e.url)return{status:200,mimeType:"fluid/object",value:this};if(e.url.startsWith(this.taskUrl)){const t=e.url.substr(this.taskUrl.length),n=t.length>0&&t.startsWith("/")?t.substr(1):"";return""!==n&&this.taskMap.has(n)?{status:200,mimeType:"fluid/object",value:this.taskMap.get(n)}:{status:404,mimeType:"text/plain",value:e.url+" not found"}}return{status:404,mimeType:"text/plain",value:e.url+" not found"}}register(...e){for(const t of e)this.taskMap.set(t.id,t.instance)}async pick(e,t){if(this.context.deltaManager.clientDetails.capabilities.interactive){if(this.runtime.attachState!==j.Attached)return Promise.reject(new Error("Picking not allowed in detached container in task manager"));{const n=`/${this.runtime.id}/${this.taskUrl}/${e}`;return this.scheduler.pick(n,async()=>this.runTask(n,void 0!==t&&t))}}return Promise.reject(new Error("Picking not allowed on secondary copy"))}async runTask(e,t){const n={headers:{[a.cache]:!1,[a.clientDetails]:{capabilities:{interactive:!1},type:"agent"},[a.reconnect]:!1,[a.sequenceNumber]:this.context.deltaManager.lastSequenceNumber,[a.executionContext]:t?"worker":void 0},url:e},r=await this.runtime.loader.request(n);if(200!==r.status||"fluid/object"!==r.mimeType)return Promise.reject(new Error("Invalid agent route: "+e));const o=r.value.IFluidRunnable;return void 0===o?Promise.reject(new Error("Fluid object does not implement IFluidRunnable")):o.run()}}class ln{constructor(){this.type=ln.type}get IFluidDataStoreFactory(){return this}static get registryEntry(){return[this.type,Promise.resolve(new ln)]}async instantiateDataStore(e){const t=tn.getFactory(),n=an.getFactory(),r=new Map;r.set(t.type,t),r.set(n.type,n);const o=new(qt(async e=>(await s).request(e)))(e,r),s=dn.load(o,e);return o}}ln.type="_scheduler";var hn=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/trace.js");const fn="_baseSummary";class mn{constructor(e){this.path=e}static create(e){return new mn(encodeURIComponent(e))}static createAndConcat(e){var t;let n=mn.create(null!==(t=e[0])&&void 0!==t?t:"");for(let t=1;t<e.length;t++)n=n.concat(mn.create(e[t]));return n}toString(){return this.path}concat(e){return new mn(`${this.path}/${e.path}`)}}class pn{constructor(e){this.summary=e}static createForRoot(e){return new pn({referenceSequenceNumber:e,basePath:void 0,localPath:mn.create("")})}get referenceSequenceNumber(){return this.summary.referenceSequenceNumber}get basePath(){return this.summary.basePath}get localPath(){return this.summary.localPath}get additionalPath(){return this.summary.additionalPath}set additionalPath(e){this.summary.additionalPath=e}get fullPath(){var e,t;return null!==(t=null===(e=this.basePath)||void 0===e?void 0:e.concat(this.localPath))&&void 0!==t?t:this.localPath}get fullPathForChildren(){return void 0!==this.additionalPath?this.fullPath.concat(this.additionalPath):this.fullPath}createForChild(e){return new pn({referenceSequenceNumber:this.referenceSequenceNumber,basePath:this.fullPathForChildren,localPath:mn.create(e)})}}function gn(e,t){let n=e;const r=[],o=[];for(let e=0;;e++){e>100&&t.sendTelemetryEvent({eventName:"DecodeSummaryMaxDepth",maxDecodeDepth:100});const s=n.blobs._outstandingOps,i=n.trees._baseSummary;if(void 0===s&&void 0===i)return{baseSummary:n,pathParts:r,async getOutstandingOps(e){let n=[];for(const r of o){const o=await e(r);if(n.length>0&&o.length>0){const e=n[n.length-1].sequenceNumber,r=o[0].sequenceNumber;if(r<=e)for(t.sendTelemetryEvent({eventName:"DuplicateOutstandingOps",category:"generic",message:`newEarliestSeq <= latestSeq in decodeSummary: ${r} <= ${e}`});o.length>0&&o[0].sequenceNumber<=e;)o.shift()}n=n.concat(o)}return n}};Object(k.a)(!!s,"Outstanding ops blob missing, but base summary tree exists"),Object(k.a)(void 0!==i,"Base summary tree missing, but outstanding ops blob exists"),n=i,r.push(fn),o.unshift(s)}}function bn(e){const t=e.trees[lt.channelsTreeName];return void 0!==t?{childrenTree:t,childrenPathPart:lt.channelsTreeName}:{childrenTree:e,childrenPathPart:void 0}}class vn{constructor(e,t,n,r,o,s,i){var a;this.defaultLogger=e,this.summarizeInternalFn=t,this._changeSequenceNumber=r,this.latestSummary=o,this.initialSummary=s,this.wipSummaryLogger=i,this.children=new Map,this.pendingSummaries=new Map,this.outstandingOps=[],this.wipSkipRecursion=!1,this.canReuseHandle=null===(a=n.canReuseHandle)||void 0===a||a,this.throwOnError=!0,this.trackingSequenceNumber=this._changeSequenceNumber}get referenceSequenceNumber(){var e,t;return null!==(t=null===(e=this.latestSummary)||void 0===e?void 0:e.referenceSequenceNumber)&&void 0!==t?t:0}startSummary(e,t){Object(k.a)(void 0===this.wipSummaryLogger,"wipSummaryLogger should not be set yet in startSummary"),Object(k.a)(void 0===this.wipReferenceSequenceNumber,"Already tracking a summary"),this.wipSummaryLogger=t;for(const t of this.children.values())t.startSummary(e,this.wipSummaryLogger);this.wipReferenceSequenceNumber=e}async summarize(e){if(Object(k.a)(this.isTrackingInProgress(),"summarize should not be called when not tracking the summary"),Object(k.a)(void 0!==this.wipSummaryLogger,"wipSummaryLogger should have been set in startSummary or ctor"),this.canReuseHandle&&!e&&!this.hasChanged()){const e=this.latestSummary;if(void 0!==e){this.wipLocalPaths={localPath:e.localPath,additionalPath:e.additionalPath},this.wipSkipRecursion=!0;const t=pt();return t.handleNodeCount++,{summary:{type:3,handle:e.fullPath.path,handleType:1},stats:t}}}try{const t=await this.summarizeInternalFn(e);return this.wipLocalPaths={localPath:mn.create(t.id)},{summary:t.summary,stats:t.stats}}catch(e){if(this.throwOnError||this.trackingSequenceNumber<this._changeSequenceNumber)throw e;const t=this.latestSummary,n=this.initialSummary;let r,o;if(void 0!==t)r={fromSummary:!0,summaryNode:t},o=t.localPath;else{if(void 0===(null==n?void 0:n.summary))throw e;r={fromSummary:!1,initialSummary:n.summary},o=mn.create(n.id)}this.wipSummaryLogger.logException({eventName:"SummarizingWithBasePlusOps",category:"error"},e);const s=function(e,t){let n=mn.create(fn);const r=new yt;if(r.addBlob("_outstandingOps",JSON.stringify(t)),e.fromSummary){const t=e.summaryNode;void 0!==t.additionalPath&&(n=n.concat(t.additionalPath)),r.addHandle(fn,1,t.fullPath.path)}else r.addWithStats(fn,e.initialSummary);const o=r.getSummaryTree();return Object.assign(Object.assign({},o),{additionalPath:n})}(r,this.outstandingOps);return this.wipLocalPaths={localPath:o,additionalPath:s.additionalPath},this.wipSkipRecursion=!0,{summary:s.summary,stats:s.stats}}}completeSummary(e){this.completeSummaryCore(e,void 0,!1)}completeSummaryCore(e,t,n){Object(k.a)(void 0!==this.wipSummaryLogger,"wipSummaryLogger should have been set in startSummary or ctor"),Object(k.a)(void 0!==this.wipReferenceSequenceNumber,"Not tracking a summary");let r=this.wipLocalPaths;if(n){const e=this.latestSummary;if(void 0===e)return void this.clearSummary();r={localPath:e.localPath,additionalPath:e.additionalPath}}Object(k.a)(!!r,"Tracked summary local paths not set");const o=new pn(Object.assign(Object.assign({},r),{referenceSequenceNumber:this.wipReferenceSequenceNumber,basePath:t})),s=o.fullPathForChildren;for(const t of this.children.values())t.completeSummaryCore(e,s,this.wipSkipRecursion||n);this.pendingSummaries.set(e,o),this.clearSummary()}clearSummary(){this.wipReferenceSequenceNumber=void 0,this.wipLocalPaths=void 0,this.wipSkipRecursion=!1,this.wipSummaryLogger=void 0;for(const e of this.children.values())e.clearSummary()}async refreshLatestSummary(e,t,n,r){if(void 0!==e){const t=this.pendingSummaries.get(e);if(void 0!==t)return void this.refreshLatestSummaryFromPending(e,t.referenceSequenceNumber)}const o=await t(),s=await async function(e,t){const n=e.trees[".protocol"].blobs.attributes;return(await t(n)).sequenceNumber}(o,n);return this.refreshLatestSummaryFromSnapshot(s,o,void 0,mn.create(""),r,n)}refreshLatestSummaryFromPending(e,t){const n=this.pendingSummaries.get(e);if(void 0!==n){Object(k.a)(t===n.referenceSequenceNumber,`Pending summary reference sequence number should be consistent: ${n.referenceSequenceNumber} != ${t}`),this.pendingSummaries.delete(e),this.refreshLatestSummaryCore(t),this.latestSummary=n;for(const n of this.children.values())n.refreshLatestSummaryFromPending(e,t)}else Object(k.a)(void 0===this.latestSummary,"Not found pending summary, but this node has previously completed a summary")}async refreshLatestSummaryFromSnapshot(e,t,n,r,o,s){if(this.referenceSequenceNumber>=e)return;this.refreshLatestSummaryCore(e);const{baseSummary:i,pathParts:a}=gn(t,o);this.latestSummary=new pn({referenceSequenceNumber:e,basePath:n,localPath:r});const{childrenTree:u,childrenPathPart:c}=bn(i);void 0!==c&&a.push(c),a.length>0&&(this.latestSummary.additionalPath=mn.createAndConcat(a));const d=this.latestSummary.fullPathForChildren;await Promise.all(Array.from(this.children).filter(([e])=>void 0!==u.trees[e]).map(async([t,n])=>n.refreshLatestSummaryFromSnapshot(e,u.trees[t],d,mn.create(t),o,s)))}refreshLatestSummaryCore(e){for(const[t,n]of this.pendingSummaries)n.referenceSequenceNumber<e&&this.pendingSummaries.delete(t);for(;this.outstandingOps.length>0&&this.outstandingOps[0].sequenceNumber<=e;)this.outstandingOps.shift()}async loadBaseSummary(e,t){const n=gn(e,this.defaultLogger),r=await n.getOutstandingOps(t),{childrenPathPart:o}=bn(n.baseSummary);if(void 0!==o&&n.pathParts.push(o),n.pathParts.length>0&&(Object(k.a)(!!this.latestSummary,"Should have latest summary defined during loadBaseSummary"),this.latestSummary.additionalPath=mn.createAndConcat(n.pathParts)),r.length>0){const e=r[r.length-1].sequenceNumber;Object(k.a)(e<=this.trackingSequenceNumber,"When loading base summary, expected outstanding ops <= tracking sequence number")}return{baseSummary:n.baseSummary,outstandingOps:r}}recordChange(e){const t=this.outstandingOps[this.outstandingOps.length-1];void 0!==t&&Object(k.a)(t.sequenceNumber<e.sequenceNumber,`Out of order change recorded: ${t.sequenceNumber} > ${e.sequenceNumber}`),this.invalidate(e.sequenceNumber),this.trackingSequenceNumber=e.sequenceNumber,this.outstandingOps.push(e)}invalidate(e){e>this._changeSequenceNumber&&(this._changeSequenceNumber=e)}hasChanged(){return this._changeSequenceNumber>this.referenceSequenceNumber}createChild(e,t,n,r={}){Object(k.a)(!this.children.has(t),"Create SummarizerNode child already exists");const o=this.getCreateDetailsForChild(t,n),s=new vn(this.defaultLogger,e,r,o.changeSequenceNumber,o.latestSummary,o.initialSummary,this.wipSummaryLogger);return this.maybeUpdateChildState(s),this.children.set(t,s),s}getChild(e){return this.children.get(e)}getCreateDetailsForChild(e,t){var n,r;let o,s,i;const a=this.latestSummary;switch(t.type){case lt.CreateSummarizerNodeSource.FromAttach:if(void 0!==a&&t.sequenceNumber<=a.referenceSequenceNumber)s=a.createForChild(e);else{const n=wt(t.snapshot);o={sequenceNumber:t.sequenceNumber,id:e,summary:n}}i=t.sequenceNumber;break;case lt.CreateSummarizerNodeSource.FromSummary:void 0===this.initialSummary&&Object(k.a)(!!a,"Cannot create child from summary if parent does not have latest summary");case lt.CreateSummarizerNodeSource.Local:{const u=this.initialSummary;if(void 0!==u){const r=null===(n=u.summary)||void 0===n?void 0:n.summary.tree[e];let s;t.type===lt.CreateSummarizerNodeSource.FromSummary&&Object(k.a)(!!r,"Missing child summary tree"),void 0!==r&&(Object(k.a)(1===r.type,"Child summary object is not a tree"),s={summary:r,stats:bt(r)}),o={sequenceNumber:u.sequenceNumber,id:e,summary:s}}s=null==a?void 0:a.createForChild(e),i=null!==(r=null==a?void 0:a.referenceSequenceNumber)&&void 0!==r?r:-1;break}default:{const e=t.type;Object(dt.a)(t,"Unexpected CreateSummarizerNodeSource: "+e)}}return{initialSummary:o,latestSummary:s,changeSequenceNumber:i}}maybeUpdateChildState(e){this.isTrackingInProgress()&&(e.wipReferenceSequenceNumber=this.wipReferenceSequenceNumber)}isTrackingInProgress(){return void 0!==this.wipReferenceSequenceNumber}}class yn extends pn{constructor(e,t){super(t),this.serializedUsedRoutes=e}}class _n extends vn{constructor(e,t,n,r,o,s,i,a,u){super(e,async e=>this.summarizeInternal(e,!0),n,r,o,s,i),this.summarizeFn=t,this.getGCDataFn=a,this._usedRoutes=[""],this.gcDisabled=!0===n.gcDisabled,this.gcDetailsInInitialSummaryP=new l.b(async()=>{const e=await(null==u?void 0:u());return null!=e?e:{usedRoutes:[]}})}get usedRoutes(){return this._usedRoutes}async loadInitialGCSummaryDetails(){if(void 0===this.referenceUsedRoutes){const e=await this.gcDetailsInInitialSummaryP;this.referenceUsedRoutes=e.usedRoutes,void 0!==e.gcData&&(this.gcData=jt(e.gcData))}}async summarize(e,t=!0){if(await this.loadInitialGCSummaryDetails(),!this.gcDisabled&&this.isTrackingInProgress()&&Object(k.a)(void 0!==this.wipSerializedUsedRoutes,"wip used routes should be set if tracking a summary"),t){const t=await super.summarize(e),n=void 0!==this.gcData?jt(this.gcData):{gcNodes:{}};return Object.assign(Object.assign({},t),{gcData:n})}return this.summarizeInternal(e,t)}async summarizeInternal(e,t){const n=await this.summarizeFn(e,t);return void 0!==n.gcData&&(this.gcData=jt(n.gcData)),n}async getGCData(){if(Object(k.a)(!this.gcDisabled,"Getting GC data should not be called when GC is disabled!"),Object(k.a)(void 0!==this.getGCDataFn,"GC data cannot be retrieved without getGCDataFn"),await this.loadInitialGCSummaryDetails(),!this.hasDataChanged()&&void 0!==this.gcData)return jt(this.gcData);const e=await this.getGCDataFn();return this.gcData=jt(e),e}startSummary(e,t){this.gcDisabled||(Object(k.a)(void 0===this.wipSerializedUsedRoutes,"We should not already be tracking used routes when to track a new summary"),this.wipSerializedUsedRoutes=JSON.stringify(this.usedRoutes)),super.startSummary(e,t)}completeSummaryCore(e,t,n){let r;if(this.gcDisabled||(r=this.wipSerializedUsedRoutes,Object(k.a)(void 0!==r,"We should have been tracking used routes")),super.completeSummaryCore(e,t,n),!this.gcDisabled){const t=this.pendingSummaries.get(e);if(void 0!==t){const n=new yn(r,t);this.pendingSummaries.set(e,n)}}}clearSummary(){this.wipSerializedUsedRoutes=void 0,super.clearSummary()}refreshLatestSummaryFromPending(e,t){if(!this.gcDisabled){const t=this.pendingSummaries.get(e);void 0!==t&&(this.referenceUsedRoutes=JSON.parse(t.serializedUsedRoutes))}return super.refreshLatestSummaryFromPending(e,t)}async refreshLatestSummaryFromSnapshot(e,t,n,r,o,s){if(!this.gcDisabled){const n=t.blobs[lt.gcBlobKey];if(void 0!==n){const t=await s(n);if(this.referenceSequenceNumber>=e)return;this.referenceUsedRoutes=t.usedRoutes}}return super.refreshLatestSummaryFromSnapshot(e,t,n,r,o,s)}createChild(e,t,n,r={},o,s){var i;Object(k.a)(!this.children.has(t),"Create SummarizerNode child already exists");const a=this.getCreateDetailsForChild(t,n),u=new _n(this.defaultLogger,e,Object.assign(Object.assign({},r),{gcDisabled:null!==(i=r.gcDisabled)&&void 0!==i?i:this.gcDisabled}),a.changeSequenceNumber,a.latestSummary,a.initialSummary,this.wipSummaryLogger,o,s);return this.maybeUpdateChildState(u),this.children.set(t,u),u}getChild(e){return this.children.get(e)}isReferenced(){return this.usedRoutes.includes("")||this.usedRoutes.includes("/")}updateUsedRoutes(e){this._usedRoutes=e.sort(),!this.gcDisabled&&this.isTrackingInProgress()&&(this.wipSerializedUsedRoutes=JSON.stringify(this.usedRoutes))}hasChanged(){return this.hasDataChanged()||this.hasUsedStateChanged()}hasDataChanged(){return super.hasChanged()}hasUsedStateChanged(){return!this.gcDisabled&&(void 0===this.referenceUsedRoutes||JSON.stringify(this.usedRoutes)!==JSON.stringify(this.referenceUsedRoutes))}maybeUpdateChildState(e){this.isTrackingInProgress()&&e.updateUsedRoutes(e.usedRoutes),super.maybeUpdateChildState(e)}}class wn{constructor(e,t,n){this.path=e,this.runtime=t,this.routeContext=n,this.absolutePath=ut(e,this.routeContext)}get IFluidRouter(){return this}get IFluidHandleContext(){return this}attachGraph(){throw new Error("can't attach container runtime form within container!")}get isAttached(){return this.runtime.attachState!==j.Detached}async resolveHandle(e){return this.runtime.resolveHandle(e)}}const kn=m()("fluid:process-loader");kn("Package: @fluidframework/container-runtime - Version: 0.34.1");var Sn,jn=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/timer.js");class Cn{constructor(e){this.runtime=e,this.everConnected=!1,this.stopDeferred=new l.a,this.runtime.connected?this.everConnected=!0:this.runtime.once("connected",()=>this.everConnected=!0),this.runtime.on("disconnected",()=>{this.everConnected&&this.stop()})}async waitStart(){if(!this.runtime.connected){if(this.everConnected)return{started:!1,message:"DisconnectedBeforeRun"};const e=new Promise(e=>this.runtime.once("connected",e));if(await Promise.race([e,this.stopDeferred.promise]),!this.runtime.connected)return{started:!1,message:"NeverConnectedBeforeRun"}}if(void 0===this.runtime.clientId)throw Error("clientId should be defined if connected.");return{started:!0,clientId:this.runtime.clientId}}async waitStopped(){return this.stopDeferred.promise}stop(){this.stopDeferred.resolve()}}!function(e){e[e.Local=0]="Local",e[e.Broadcast=1]="Broadcast",e[e.Acked=2]="Acked",e[e.Nacked=-1]="Nacked"}(Sn||(Sn={}));class xn{constructor(e,t){this.clientId=e,this.clientSequenceNumber=t,this.state=Sn.Local,this.defSummaryOp=new l.a,this.defSummaryAck=new l.a}static createLocal(e,t){return new xn(e,t)}static createFromOp(e){const t=new xn(e.clientId,e.clientSequenceNumber);return t.broadcast(e),t}get summaryOp(){return this._summaryOp}get summaryAckNack(){return this._summaryAckNack}hasBeenAcked(){return this.state===Sn.Acked}broadcast(e){return Object(k.a)(this.state===Sn.Local),this._summaryOp=e,this.defSummaryOp.resolve(),this.state=Sn.Broadcast,!0}ackNack(e){return Object(k.a)(this.state===Sn.Broadcast),this._summaryAckNack=e,this.defSummaryAck.resolve(),this.state=e.type===q.a.SummaryAck?Sn.Acked:Sn.Nacked,!0}async waitBroadcast(){return await this.defSummaryOp.promise,this._summaryOp}async waitAckNack(){return await this.defSummaryAck.promise,this._summaryAckNack}}class On{constructor(e,t){this.clientId=e,this.summaryCollection=t,this.localSummaries=new Map,this._disposed=!1}get disposed(){return this._disposed}watchSummary(e){let t=this.localSummaries.get(e);return t||(t=xn.createLocal(this.clientId,e),this.localSummaries.set(t.clientSequenceNumber,t)),t}waitFlushed(){return this.summaryCollection.waitFlushed()}tryGetSummary(e){return this.localSummaries.get(e)}setSummary(e){this.localSummaries.set(e.clientSequenceNumber,e)}dispose(){this.summaryCollection.removeWatcher(this.clientId),this._disposed=!0}}class En{constructor(e,t){this.initialSequenceNumber=e,this.logger=t,this.summaryWatchers=new Map,this.pendingSummaries=new Map,this.refreshWaitNextAck=new l.a}get latestAck(){return this.lastAck}createWatcher(e){const t=new On(e,this);return this.summaryWatchers.set(e,t),t}removeWatcher(e){this.summaryWatchers.delete(e)}async waitFlushed(){for(;this.pendingSummaries.size>0;){const e=Array.from(this.pendingSummaries,([,e])=>e.waitAckNack());await Promise.all(e)}return this.lastAck}async waitSummaryAck(e){for(;!this.lastAck||this.lastAck.summaryOp.referenceSequenceNumber<e;)await this.refreshWaitNextAck.promise;return this.lastAck}handleOp(e){switch(e.type){case q.a.Summarize:return void this.handleSummaryOp(e);case q.a.SummaryAck:return void this.handleSummaryAck(e);case q.a.SummaryNack:return void this.handleSummaryNack(e);default:return}}handleSummaryOp(e){let t;const n=this.summaryWatchers.get(e.clientId);n&&(t=n.tryGetSummary(e.clientSequenceNumber),t&&t.broadcast(e)),t||(t=xn.createFromOp(e),n&&n.setSummary(t)),this.pendingSummaries.set(e.sequenceNumber,t)}handleSummaryAck(e){const t=e.contents.summaryProposal.summarySequenceNumber,n=this.pendingSummaries.get(t);n?(n.ackNack(e),this.pendingSummaries.delete(t),(!this.lastAck||t>this.lastAck.summaryAckNack.contents.summaryProposal.summarySequenceNumber)&&(this.lastAck=n,this.refreshWaitNextAck.resolve(),this.refreshWaitNextAck=new l.a)):t>=this.initialSequenceNumber&&this.logger.sendErrorEvent({eventName:"SummaryAckWithoutOp",sequenceNumber:e.sequenceNumber,summarySequenceNumber:t,initialSequenceNumber:this.initialSequenceNumber})}handleSummaryNack(e){const t=e.contents.summaryProposal.summarySequenceNumber,n=this.pendingSummaries.get(t);n&&(n.ackNack(e),this.pendingSummaries.delete(t))}}class In extends ct{async get(){throw Error("Do not try to get a summarizer object from the handle. Reference it directly.")}attach(){}bind(e){}}const An="summarizingError";class Nn extends p.b{constructor(e,t=!1){super(e),this.logged=t,this.errorType=An,this.canRetry=!0}}const Tn=(e,t)=>new Nn(e,t),Fn=e=>void 0!==e&&void 0===e.timerResult;class Pn{constructor(e,t,n,r){this.configuration=e,this.trySummarize=t,this.lastOpSeqNumber=n,this._lastAttempted=r,this._lastAcked=r,this.idleTimer=new jn.b(this.configuration.idleTime,()=>this.trySummarize("idle"))}get lastAttempted(){return this._lastAttempted}get lastAcked(){return this._lastAcked}initialize(e){this._lastAttempted=e,this._lastAcked=e}recordAttempt(e){this._lastAttempted={refSequenceNumber:null!=e?e:this.lastOpSeqNumber,summaryTime:Date.now()}}ackLastSent(){this._lastAcked=this.lastAttempted}run(){this.idleTimer.clear();const e=Date.now()-this.lastAcked.summaryTime,t=this.lastOpSeqNumber-this.lastAcked.refSequenceNumber;e>this.configuration.maxTime?this.trySummarize("maxTime"):t>this.configuration.maxOps?this.trySummarize("maxOps"):this.idleTimer.restart()}dispose(){this.idleTimer.clear()}}class Rn{constructor(e,t,n,r,o,s,i,a,u=!1,c){this.clientId=e,this.onBehalfOfClientId=t,this.summaryWatcher=r,this.configuration=o,this.internalsProvider=s,this.immediateSummary=u,this.raiseSummarizingError=c,this.stopping=!1,this._disposed=!1,this.summarizeCount=0,this.tryWhileSummarizing=!1,this.tryGetCorrelatedLogger=e=>this.heuristics.lastAttempted.refSequenceNumber===e?this.logger:void 0,this.logger=new p.a(n,"Running",void 0,{summaryGenTag:()=>this.summarizeCount}),this.heuristics=new Pn(o,e=>this.trySummarize(e),i,a),this.summarizeTimer=new jn.b(2e4,()=>this.summarizeTimerHandler(2e4,1));const d=Math.min(this.configuration.maxAckWaitTime,12e4);this.pendingAckTimer=new jn.a(d,()=>{this.raiseSummarizingError("SummaryAckWaitTimeout"),this.logger.sendErrorEvent({eventName:"SummaryAckWaitTimeout",maxAckWaitTime:d,refSequenceNumber:this.heuristics.lastAttempted.refSequenceNumber,summarySequenceNumber:this.heuristics.lastAttempted.summarySequenceNumber,timePending:Date.now()-this.heuristics.lastAttempted.summaryTime})})}static async start(e,t,n,r,o,s,i,a,u,c){const d=new Rn(e,t,n,r,o,s,i,a,u,c);return await d.waitStart(),u?d.trySummarize("immediate"):d.heuristics.run(),d}get disposed(){return this._disposed}dispose(){this.summaryWatcher.dispose(),this.heuristics.dispose(),this.summarizeTimer.clear(),this.pendingAckTimer.clear(),this._disposed=!0}handleSystemOp(e){switch(e.type){case q.a.ClientLeave:{const t=JSON.parse(e.data);if(t===this.clientId||t===this.onBehalfOfClientId)return}case q.a.ClientJoin:case q.a.Propose:case q.a.Reject:return void this.handleOp(void 0,e);default:return}}handleOp(e,t){void 0===e&&(this.heuristics.lastOpSeqNumber=t.sequenceNumber,t.type===q.a.Save?this.trySummarize(`;${t.clientId}: ${t.contents}`):this.heuristics.run())}async waitStop(){var e,t;this.disposed||(this.stopping?await(null===(e=this.summarizing)||void 0===e?void 0:e.promise):(this.stopping=!0,this.heuristics.lastOpSeqNumber-this.heuristics.lastAcked.refSequenceNumber>50&&(this.trySummarize("lastSummary"),await(null===(t=this.summarizing)||void 0===t?void 0:t.promise))))}async waitStart(){const e=await Promise.race([this.summaryWatcher.waitFlushed(),this.pendingAckTimer.start()]);this.pendingAckTimer.clear(),Fn(e)&&this.heuristics.initialize({refSequenceNumber:e.summaryOp.referenceSequenceNumber,summaryTime:e.summaryOp.timestamp,summarySequenceNumber:e.summaryOp.sequenceNumber})}trySummarize(e){void 0===this.summarizing?(this.summarizing=new l.a,(async()=>{!0!==await this.summarize(e,!1)&&await this.summarize(e,!0)})().finally(()=>{var e;null===(e=this.summarizing)||void 0===e||e.resolve(),this.summarizing=void 0,!this.tryWhileSummarizing||this.stopping||this.disposed||(this.tryWhileSummarizing=!1,this.heuristics.run())}).catch(e=>{this.logger.sendErrorEvent({eventName:"UnexpectedSummarizeError"},e)})):this.tryWhileSummarizing=!0}async summarize(e,t){this.summarizeTimer.start();try{return await this.summarizeCore(e,t)}finally{this.summarizeTimer.clear(),this.pendingAckTimer.clear()}}async summarizeCore(e,t){++this.summarizeCount;const n=await this.generateSummaryWithLogging(e,t);if(this.heuristics.recordAttempt(null==n?void 0:n.referenceSequenceNumber),!n||!n.submitted)return void this.raiseSummarizingError("Error while generating or submitting summary");const r=this.pendingAckTimer.start().catch(()=>{}),o=this.summaryWatcher.watchSummary(n.clientSequenceNumber),s=await Promise.race([o.waitBroadcast(),r]);if(!Fn(s))return;this.heuristics.lastAttempted.summarySequenceNumber=s.sequenceNumber,this.logger.sendTelemetryEvent({eventName:"SummaryOp",timeWaiting:Date.now()-this.heuristics.lastAttempted.summaryTime,refSequenceNumber:s.referenceSequenceNumber,summarySequenceNumber:s.sequenceNumber,handle:s.contents.handle});const i=await Promise.race([o.waitAckNack(),r]);return Fn(i)?(this.logger.sendTelemetryEvent({eventName:i.type===q.a.SummaryAck?"SummaryAck":"SummaryNack",category:i.type===q.a.SummaryAck?"generic":"error",timeWaiting:Date.now()-this.heuristics.lastAttempted.summaryTime,summarySequenceNumber:i.contents.summaryProposal.summarySequenceNumber,error:i.type===q.a.SummaryNack?i.contents.errorMessage:void 0,handle:i.type===q.a.SummaryAck?i.contents.handle:void 0}),this.pendingAckTimer.clear(),i.type===q.a.SummaryAck?(this.heuristics.ackLastSent(),this.immediateSummary=!1,!0):(this.raiseSummarizingError("SummaryNack"),!1)):void 0}async generateSummaryWithLogging(e,t){const n=p.d.start(this.logger,{eventName:"GenerateSummary",message:e,timeSinceLastAttempt:Date.now()-this.heuristics.lastAttempted.summaryTime,timeSinceLastSummary:Date.now()-this.heuristics.lastAcked.summaryTime,safe:t||void 0});let r;try{r=await this.internalsProvider.generateSummary(this.immediateSummary,t,this.logger)}catch(e){return void n.cancel({category:"error"},e)}if(this.summarizeTimer.clear(),!r)return void n.cancel();const o=Object.assign(Object.assign(Object.assign({},r),r.summaryStats),{refSequenceNumber:r.referenceSequenceNumber,opsSinceLastAttempt:r.referenceSequenceNumber-this.heuristics.lastAttempted.refSequenceNumber,opsSinceLastSummary:r.referenceSequenceNumber-this.heuristics.lastAcked.refSequenceNumber});return o.summaryStats=void 0,o.referenceSequenceNumber=void 0,r.submitted?n.end(o):n.cancel(o),r}summarizeTimerHandler(e,t){if(this.logger.sendPerformanceEvent({eventName:"SummarizeTimeout",timeoutTime:e,timeoutCount:t}),t<5){const n=2*e;this.summarizeTimer.start(n,()=>this.summarizeTimerHandler(n,t+1))}}}class Dn extends c.EventEmitter{constructor(e,t,n,r,o,s){var i;super(),this.runtime=t,this.configurationGetter=n,this.internalsProvider=r,this.immediateSummary=!1,this.stopped=!1,this.stopDeferred=new l.a,this._disposed=!1,this.logger=p.a.create(this.runtime.logger,"Summarizer"),this.runCoordinator=new Cn(t),s?(this.immediateSummary=!0,this.summaryCollection=s):this.summaryCollection=new En(this.runtime.deltaManager.initialSequenceNumber,this.logger),this.runtime.deltaManager.inbound.on("op",e=>this.summaryCollection.handleOp(e)),null===(i=this.runtime.previousState.nextSummarizerD)||void 0===i||i.resolve(this),this.innerHandle=new In(this,e,o)}get IFluidLoadable(){return this}get IFluidRouter(){return this}get IFluidRunnable(){return this}get ISummarizer(){return this}get handle(){return this.innerHandle}async run(e){try{await this.runCore(e)}catch(e){const t=Object.assign(Object.assign({logged:!1},N(e)),{errorType:An});throw this.emit("summarizingError",t),e}finally{this.runtime.connected&&(this.runningSummarizer&&await this.runningSummarizer.waitStop(),this.runtime.closeFn()),this.dispose()}}stop(e){this.stopped||(this.stopped=!0,this.logger.sendTelemetryEvent({eventName:"StoppingSummarizer",onBehalfOf:this.onBehalfOfClientId,reason:e}),this.stopDeferred.resolve())}updateOnBehalfOf(e){this.onBehalfOfClientId=e}async request(e){return{mimeType:"fluid/object",status:200,value:this}}async runCore(e){this.onBehalfOfClientId=e;const t=await this.runCoordinator.waitStart();if(!1===t.started)return void this.logger.sendTelemetryEvent({eventName:"NotStarted",reason:t.message,onBehalfOf:e});if(!1===this.runtime.deltaManager.active)return void this.logger.sendTelemetryEvent({eventName:"NotStarted",reason:"CannotWrite",onBehalfOf:e});if(this.runtime.summarizerClientId!==this.onBehalfOfClientId&&this.runtime.summarizerClientId!==this.runtime.clientId)return void this.logger.sendTelemetryEvent({eventName:"NotStarted",reason:"DifferentComputedSummarizer",computedSummarizer:this.runtime.summarizerClientId,onBehalfOf:e,clientId:this.runtime.clientId});this.logger.sendTelemetryEvent({eventName:"RunningSummarizer",onBehalfOf:e,initSummarySeqNumber:this.summaryCollection.initialSequenceNumber});const n={refSequenceNumber:this.summaryCollection.initialSequenceNumber,summaryTime:Date.now()},r=await Rn.start(t.clientId,e,this.logger,this.summaryCollection.createWatcher(t.clientId),this.configurationGetter(),this,this.runtime.deltaManager.lastSequenceNumber,n,this.immediateSummary,e=>{this._disposed||this.emit("summarizingError",Tn("Summarizer: "+e,!0))});this.runningSummarizer=r,this.immediateSummary=!1,this.handleSummaryAcks().catch(e=>{this.logger.sendErrorEvent({eventName:"HandleSummaryAckFatalError"},e),this.emit("summarizingError",Tn("Summarizer: HandleSummaryAckFatalError",!0)),this.stop("HandleSummaryAckFatalError")}),this.systemOpListener=e=>r.handleSystemOp(e),this.runtime.deltaManager.inbound.on("op",this.systemOpListener),this.opListener=(e,t)=>r.handleOp(e,t),this.runtime.on("batchEnd",this.opListener),await Promise.race([this.runCoordinator.waitStopped(),this.stopDeferred.promise])}dispose(){this._disposed=!0,this.runningSummarizer&&(this.runningSummarizer.dispose(),this.runningSummarizer=void 0),this.systemOpListener&&this.runtime.deltaManager.inbound.off("op",this.systemOpListener),this.opListener&&this.runtime.removeListener("batchEnd",this.opListener)}async setSummarizer(){return this.runtime.nextSummarizerD=new l.a,this.runtime.nextSummarizerD.promise}async generateSummary(e,t,n){if(this.onBehalfOfClientId===this.runtime.summarizerClientId||this.runtime.clientId===this.runtime.summarizerClientId)return this.internalsProvider.generateSummary(e,t,n);this.stop("parentNoLongerSummarizer")}async handleSummaryAcks(){var e;let t=this.summaryCollection.initialSequenceNumber;for(;this.runningSummarizer;){const n=null!==(e=this.runningSummarizer.tryGetCorrelatedLogger(t))&&void 0!==e?e:this.logger;try{const e=await this.summaryCollection.waitSummaryAck(t);t=e.summaryOp.referenceSequenceNumber,await this.internalsProvider.refreshLatestSummaryAck(e.summaryOp.contents.handle,e.summaryAckNack.contents.handle,n)}catch(e){n.sendErrorEvent({eventName:"HandleSummaryAckError",refSequenceNumber:t},e)}t++}}}var Mn,Ln=n("../notebook-dds/node_modules/@fluidframework/common-utils/lib/heap.js");!function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(Mn||(Mn={}));const Bn="summarizer";class qn{constructor(){this.min={clientId:"",sequenceNumber:-1,isSummarizer:!1}}compare(e,t){return e.sequenceNumber-t.sequenceNumber}}class zn{constructor(){this.heap=new Ln.a(new qn),this.heapMembers=new Map,this.summarizerCount=0}addClient(e,t){var n;const r=(null===(n=t.client.details)||void 0===n?void 0:n.type)===Bn,o=this.heap.add({clientId:e,sequenceNumber:t.sequenceNumber,isSummarizer:r});this.heapMembers.set(e,o),r&&this.summarizerCount++}removeClient(e){const t=this.heapMembers.get(e);t&&(this.heap.remove(t),this.heapMembers.delete(e),t.value.isSummarizer&&this.summarizerCount--)}getFirstClientId(){return this.heap.count()>0?this.heap.peek().value.clientId:void 0}getSummarizerCount(){return this.summarizerCount}}var Hn;!function(e){e[e.Off=0]="Off",e[e.Starting=1]="Starting",e[e.Running=2]="Running",e[e.Stopping=3]="Stopping",e[e.Disabled=-1]="Disabled"}(Hn||(Hn={}));const Un=e=>20*(Math.pow(2,e)-1);class Vn{constructor(e,t,n){this.delayWindowMs=e,this.maxDelayMs=t,this.delayFunction=n,this.startTimes=[]}get attempts(){return this.startTimes.length}getDelay(){const e=Date.now();this.startTimes=this.startTimes.filter(t=>e-t<this.delayWindowMs);const t=Math.min(this.delayFunction(this.startTimes.length),this.maxDelayMs);return this.startTimes.push(e),this.startTimes=this.startTimes.map(e=>e+t),t===this.maxDelayMs&&this.startTimes.shift(),t}}class $n extends c.EventEmitter{constructor(e,t,n,r,o,s,i=!1,a=5e3){var u,c;super(),this.context=e,this.summariesEnabled=t,this.enableWorker=n,this.setNextSummarizer=o,this.nextSummarizerP=s,this.quorumHeap=new zn,this.connected=!1,this.state=Hn.Off,this._disposed=!1,this.startThrottler=new Vn(6e4,3e4,Un),this.opsUntilFirstConnect=-1,this.logger=p.a.create(r,"SummaryManager",void 0,{clientId:()=>this.latestClientId}),this.connected=e.connected,this.connected&&this.setClientId(e.clientId);const d=e.quorum.getMembers();for(const[e,t]of d)this.quorumHeap.addClient(e,t);e.quorum.on("addMember",(e,t)=>{-1===this.opsUntilFirstConnect&&e===this.clientId&&(this.opsUntilFirstConnect=t.sequenceNumber-this.context.deltaManager.initialSequenceNumber),this.quorumHeap.addClient(e,t),this.refreshSummarizer()}),e.quorum.on("removeMember",e=>{this.quorumHeap.removeClient(e),this.refreshSummarizer()}),this.initialDelayTimer=i?void 0:new jn.a(a,()=>{}),this.initialDelayP=null!==(c=null===(u=this.initialDelayTimer)||void 0===u?void 0:u.start())&&void 0!==c?c:Promise.resolve(),this.refreshSummarizer()}get summarizer(){return this.summarizerClientId}get disposed(){return this._disposed}setConnected(e){this.updateConnected(!0,e)}setDisconnected(){this.updateConnected(!1)}setClientId(e){this.clientId=e,void 0!==e&&(this.latestClientId=e,void 0!==this.runningSummarizer&&this.runningSummarizer.updateOnBehalfOf(e))}on(e,t){return super.on(e,t)}updateConnected(e,t){this.connected!==e&&(this.connected=e,this.setClientId(t),this.refreshSummarizer())}getShouldSummarizeState(){return this.connected?this.clientId!==this.summarizer?{shouldSummarize:!1,stopReason:"parentShouldNotSummarize"}:this.disposed?{shouldSummarize:!1,stopReason:"disposed"}:void 0!==this.nextSummarizerP?{shouldSummarize:!0,shouldStart:!0}:this.quorumHeap.getSummarizerCount()>0?{shouldSummarize:!0,shouldStart:!1}:{shouldSummarize:!0,shouldStart:!0}:{shouldSummarize:!1,stopReason:"parentNotConnected"}}refreshSummarizer(){const e=this.quorumHeap.getFirstClientId();e!==this.summarizerClientId&&(this.summarizerClientId=e,this.emit("summarizer",e));const t=this.getShouldSummarizeState();switch(this.state){case Hn.Off:return void(t.shouldSummarize&&t.shouldStart&&this.start());case Hn.Starting:return;case Hn.Running:return void(!1===t.shouldSummarize&&this.stop(t.stopReason));case Hn.Stopping:case Hn.Disabled:default:return}}raiseContainerWarning(e){this.context.raiseContainerWarning(e)}start(){if(!this.summariesEnabled)return this.logger.sendTelemetryEvent({eventName:"SummariesDisabled"}),void(this.state=Hn.Disabled);if(this.context.clientDetails.type===Bn)return void(this.state=Hn.Disabled);this.state=Hn.Starting;const e=this.startThrottler.getDelay();e>=3e4&&this.raiseContainerWarning(Tn("SummaryManager: CreateSummarizer Max Throttle Delay",!1)),this.createSummarizer(e).then(e=>{this.setNextSummarizer(e.setSummarizer()),e.on("summarizingError",e=>this.raiseContainerWarning(e)),this.run(e)},e=>{this.logger.sendErrorEvent({eventName:"CreateSummarizerError",attempt:this.startThrottler.attempts},e),this.tryRestart()})}run(e){this.state=Hn.Running;const t=this.latestClientId;this.runningSummarizer=e,p.d.timedExecAsync(this.logger,{eventName:"RunningSummarizer",attempt:this.startThrottler.attempts},async()=>e.run(t)).finally(()=>{this.runningSummarizer=void 0,this.nextSummarizerP=void 0,this.tryRestart()});const n=this.getShouldSummarizeState();!1===n.shouldSummarize&&this.stop(n.stopReason)}tryRestart(){const e=this.getShouldSummarizeState();e.shouldSummarize&&e.shouldStart?this.start():this.state=Hn.Off}stop(e){this.state=Hn.Stopping,this.runningSummarizer?this.runningSummarizer.stop(e):(this.logger.sendErrorEvent({eventName:"StopCalledWithoutRunningSummarizer",reason:e}),this.state=Hn.Off)}async createSummarizer(e){this.logger.sendTelemetryEvent({eventName:"CreatingSummarizer",delayMs:e,opsUntilFirstConnect:this.opsUntilFirstConnect});const t=e>0,n=this.opsUntilFirstConnect<4e3;if((t||n)&&await Promise.all([n?this.initialDelayP:Promise.resolve(),t?new Promise(t=>setTimeout(t,e)):Promise.resolve()]),this.nextSummarizerP)return this.nextSummarizerP;const r=this.context.loader,o={headers:{[a.cache]:!1,[a.clientDetails]:{capabilities:{interactive:!1},type:Bn},[Mn.summarizingClient]:!0,[a.reconnect]:!1,[a.sequenceNumber]:this.context.deltaManager.lastSequenceNumber,[a.executionContext]:this.enableWorker?"worker":void 0},url:"/_summarizer"},s=await r.request(o);if(200!==s.status||"fluid/object"!==s.mimeType&&"fluid/component"!==s.mimeType)return Promise.reject(new Error("Invalid summarizer route"));return s.value.ISummarizer||Promise.reject(new Error("Fluid object does not implement ISummarizer"))}dispose(){var e;null===(e=this.initialDelayTimer)||void 0===e||e.clear(),this._disposed=!0}}class Wn{constructor(e,t){this.logger=t,this.processingTimeIncrement=10,this.totalProcessingTime=Wn.processingTime,this.isScheduling=!1,this.schedulingCount=0,this.deltaManager=e,this.deltaManager.inbound.on("idle",()=>{this.inboundQueueIdle()})}batchBegin(){this.processingStartTime||(this.processingStartTime=h.a.now())}batchEnd(){if(this.shouldRunScheduler()){this.isScheduling||(this.isScheduling=!0,this.schedulingCount%2e3==0&&(this.schedulingLog={numberOfOps:this.deltaManager.inbound.length,numberOfTurns:1,totalProcessingTime:0}));const e=h.a.now()-this.processingStartTime;e>this.totalProcessingTime&&(this.deltaManager.inbound.pause(),setTimeout(()=>{this.deltaManager.inbound.resume()}),this.processingStartTime=void 0,this.totalProcessingTime+=this.processingTimeIncrement,this.schedulingLog&&(this.schedulingLog.numberOfTurns++,this.schedulingLog.totalProcessingTime+=e))}}inboundQueueIdle(){this.schedulingLog&&(this.schedulingLog.totalProcessingTime+=h.a.now()-this.processingStartTime,this.logger.sendTelemetryEvent({eventName:"InboundOpsProcessingTime",numberOfOps:this.schedulingLog.numberOfOps,numberOfTurns:this.schedulingLog.numberOfTurns,processingTime:this.schedulingLog.totalProcessingTime}),this.schedulingLog=void 0),this.isScheduling&&(this.isScheduling=!1,this.schedulingCount++),this.processingStartTime=void 0,this.totalProcessingTime=Wn.processingTime}shouldRunScheduler(){return this.deltaManager.inbound.length>0}}Wn.processingTime=20;class Kn{constructor(e,t,n){this.clientId=e,this.deltaManager=t,this.pongCount=0,this.socketLatency=0,this.firstConnection=!0,this.bootTime=h.a.now(),this.connectionStartTime=0,this.gap=0,this.logger=p.a.create(n,"OpPerf"),this.deltaManager.on("pong",e=>this.recordPingTime(e)),this.deltaManager.on("submitOp",e=>this.beforeOpSubmit(e)),this.deltaManager.on("beforeOpProcessing",e=>this.beforeProcessingOp(e)),this.deltaManager.on("connect",(e,t)=>{this.clientId=e.clientId,void 0!==t&&(this.connectionOpSeqNumber=this.deltaManager.lastKnownSeqNumber,this.gap=t,this.connectionStartTime=h.a.now(),this.gap<=0&&this.reportGettingUpToDate())}),this.deltaManager.on("disconnect",()=>{this.clientSequenceNumberForLatencyStatistics=void 0,this.connectionOpSeqNumber=void 0,this.firstConnection=!1})}reportGettingUpToDate(){this.connectionOpSeqNumber=void 0,this.logger.sendPerformanceEvent({eventName:"ConnectionSpeed",duration:h.a.now()-this.connectionStartTime,ops:this.gap,timeToConnect:this.firstConnection?p.e.formatTick(this.connectionStartTime-this.bootTime):void 0,firstConnection:this.firstConnection})}recordPingTime(e){this.pongCount++,this.socketLatency+=e,100===this.pongCount&&(this.logger.sendTelemetryEvent({eventName:"DeltaLatency",value:this.socketLatency/100}),this.pongCount=0,this.socketLatency=0)}beforeOpSubmit(e){void 0===this.clientSequenceNumberForLatencyStatistics&&e.clientSequenceNumber%500==1&&(this.opSendTimeForLatencyStatistics=Date.now(),this.clientSequenceNumberForLatencyStatistics=e.clientSequenceNumber)}beforeProcessingOp(e){const t=e.sequenceNumber;t===this.connectionOpSeqNumber&&this.reportGettingUpToDate(),t%1e3==0&&(void 0!==this.opSendTimeForLatencyStatisticsForMsnStatistics&&this.logger.sendPerformanceEvent({eventName:"MsnStatistics",sequenceNumber:t,msnDistance:this.deltaManager.lastSequenceNumber-this.deltaManager.minimumSequenceNumber,duration:e.timestamp-this.opSendTimeForLatencyStatisticsForMsnStatistics}),this.opSendTimeForLatencyStatisticsForMsnStatistics=e.timestamp),this.clientId===e.clientId&&this.clientSequenceNumberForLatencyStatistics===e.clientSequenceNumber&&(Object(k.a)(void 0!==this.opSendTimeForLatencyStatistics),this.logger.sendPerformanceEvent({eventName:"OpRoundtripTime",sequenceNumber:t,duration:Date.now()-this.opSendTimeForLatencyStatistics}),this.clientSequenceNumberForLatencyStatistics=void 0)}}class Gn{constructor(e){this.containerRuntime=e,this.pendingStates=new ne.a,this.pendingMessagesCount=0,this.isProcessingBatch=!1}get connected(){return this.containerRuntime.connected}hasPendingMessages(){return 0!==this.pendingMessagesCount}onSubmitMessage(e,t,n,r,o){const s={type:"message",messageType:e,clientSequenceNumber:t,content:n,localOpMetadata:r,opMetadata:o};this.pendingStates.push(s),this.pendingMessagesCount++}onFlushModeUpdated(e){if(e===lt.FlushMode.Automatic){const e=this.pendingStates.peekBack();if("flush"===(null==e?void 0:e.type)&&this.pendingStates.removeBack(),"flushMode"===(null==e?void 0:e.type)&&e.flushMode===lt.FlushMode.Manual)return void this.pendingStates.removeBack()}const t={type:"flushMode",flushMode:e};this.pendingStates.push(t)}onFlush(){if(this.containerRuntime.flushMode===lt.FlushMode.Automatic)return;const e=this.pendingStates.peekBack();"message"===(null==e?void 0:e.type)&&this.pendingStates.push({type:"flush"})}processPendingLocalMessage(e){this.maybeProcessBatchBegin(e);const t=this.peekNextPendingState();if(Object(k.a)("message"===t.type,"No pending message found for this remote message"),this.pendingStates.shift(),t.clientSequenceNumber===e.clientSequenceNumber)return this.pendingMessagesCount--,this.isProcessingBatch&&this.maybeProcessBatchEnd(e),t.localOpMetadata;{const n=new A("Unexpected ack received",{clientId:e.clientId,sequenceNumber:e.sequenceNumber,clientSequenceNumber:e.clientSequenceNumber,expectedClientSequenceNumber:t.clientSequenceNumber});this.containerRuntime.closeFn(n)}}maybeProcessBatchBegin(e){const t=this.peekNextPendingState();"flush"!==t.type&&"flushMode"!==t.type||("flushMode"===t.type&&Object(k.a)(t.flushMode===lt.FlushMode.Manual,"Flush mode should be manual when processing batch begin"),Object(k.a)(!this.isProcessingBatch&&void 0===this.pendingBatchBeginMessage,"The pending batch state indicates we are already processing a batch"),this.pendingBatchBeginMessage=e,this.isProcessingBatch=!0,this.pendingStates.shift())}maybeProcessBatchEnd(e){var t,n;const r=this.peekNextPendingState();if("flush"!==r.type&&"flushMode"!==r.type)return;"flushMode"===r.type&&(Object(k.a)(r.flushMode===lt.FlushMode.Automatic,"Flush mode is set to Manual in the middle of processing a batch"),this.pendingStates.shift()),Object(k.a)(void 0!==this.pendingBatchBeginMessage,"There is no pending batch begin message");const o=null===(t=this.pendingBatchBeginMessage.metadata)||void 0===t?void 0:t.batch;if(this.pendingBatchBeginMessage===e)Object(k.a)(void 0===o,"Batch with single message should not have batch metadata");else{const t=null===(n=e.metadata)||void 0===n?void 0:n.batch;Object(k.a)(!0===o,"Did not receive batch begin metadata"),Object(k.a)(!1===t,"Did not receive batch end metadata")}this.pendingBatchBeginMessage=void 0,this.isProcessingBatch=!1}peekNextPendingState(){const e=this.pendingStates.peekFront();return Object(k.a)(!!e,"No pending state found for the remote message"),e}replayPendingStates(){Object(k.a)(this.connected,"The connection state is not consistent with the runtime"),Object(k.a)(this.clientId!==this.containerRuntime.clientId,"replayPendingStates called twice for same clientId!"),this.clientId=this.containerRuntime.clientId;let e=this.pendingStates.length;if(0===e)return;this.pendingMessagesCount=0;const t=this.containerRuntime.flushMode;for(;e>0;){const t=this.pendingStates.shift();switch(t.type){case"message":this.containerRuntime.reSubmitFn(t.messageType,t.content,t.localOpMetadata,t.opMetadata);break;case"flushMode":this.containerRuntime.setFlushMode(t.flushMode);break;case"flush":this.containerRuntime.flush()}e--}this.containerRuntime.setFlushMode(t)}}class Jn{constructor(e,t,n,r){this.path=e,this.routeContext=t,this.get=n,this.attachGraph=r,this.absolutePath=ut(e,this.routeContext)}get IFluidHandle(){return this}get isAttached(){return!0}bind(e){throw new Error("Cannot bind to blob handle")}}class Zn{constructor(e,t,n){this.routeContext=e,this.getStorage=t,this.sendBlobAttachOp=n,this.blobIds=new Set}async getBlob(e){return new Jn(`${Zn.basePath}/${e}`,this.routeContext,async()=>this.getStorage().readBlob(e),()=>null)}async createBlob(e){const t=await this.getStorage().createBlob(e);return new Jn(`${Zn.basePath}/${t.id}`,this.routeContext,async()=>this.getStorage().readBlob(t.id),()=>this.sendBlobAttachOp(t.id))}addBlobId(e){this.blobIds.add(e)}load(e){e&&Object.values(e.blobs).map(e=>this.addBlobId(e))}snapshot(){return{entries:[...this.blobIds].map(e=>new mt.a(e,e))}}}Zn.basePath="_blobs";class Xn{constructor(e){this.notBoundContexts=new Set,this._contexts=new Map,this.deferredContexts=new Map,this.disposeOnce=new Pt.a(()=>{for(const[e,t]of this.deferredContexts)t.promise.then(e=>{e.dispose()}).catch(t=>{this._logger.sendErrorEvent({eventName:"FluidDataStoreContextDisposeError",fluidDataStoreId:e},t)})}),this.dispose=()=>this.disposeOnce.value,this._logger=p.a.create(e)}[Symbol.iterator](){return this._contexts.entries()}get disposed(){return this.disposeOnce.evaluated}notBoundLength(){return this.notBoundContexts.size}isNotBound(e){return this.notBoundContexts.has(e)}has(e){return this._contexts.has(e)}get(e){return this._contexts.get(e)}getUnbound(e){if(void 0!==this._contexts.get(e)&&this.notBoundContexts.has(e))return this._contexts.get(e)}addUnbound(e){const t=e.id;Object(k.a)(!this._contexts.has(t),"Creating store with existing ID"),this._contexts.set(t,e),this.notBoundContexts.add(t),this.ensureDeferred(t)}async getBoundOrRemoted(e,t){const n=this.ensureDeferred(e);if(t||n.isCompleted)return n.promise}ensureDeferred(e){const t=this.deferredContexts.get(e);if(t)return t;const n=new l.a;return this.deferredContexts.set(e,n),n}bind(e){const t=this.notBoundContexts.delete(e);Object(k.a)(t,"The given id was not found in notBoundContexts to delete"),this.resolveDeferred(e)}resolveDeferred(e){const t=this._contexts.get(e);Object(k.a)(!!t,"Cannot find context to resolve to"),Object(k.a)(!this.notBoundContexts.has(e),"Expected this id to already be removed from notBoundContexts");const n=this.deferredContexts.get(e);Object(k.a)(!!n,"Cannot find deferred to resolve"),n.resolve(t)}addBoundOrRemoted(e){const t=e.id;Object(k.a)(!this._contexts.has(t),"Creating store with existing ID"),this._contexts.set(t,e),this.ensureDeferred(t),this.resolveDeferred(t)}}const Yn=".chunks",Qn=[".protocol",".logTail",".serviceProtocol",".blobs"],er=".component";function tr(e,t){return{pkg:JSON.stringify(e),snapshotFormatVersion:"0.1",isRootDataStore:t}}function nr(e,t){const n=tr(e,t);return new mt.b(er,JSON.stringify(n))}class rr extends z.a{constructor(e,t,n,r,o,s,i,a,u,c){super(),this._containerRuntime=e,this.id=t,this.existing=n,this.storage=r,this.scope=o,this.bindState=i,this.isLocalDataStore=a,this.pkg=c,this._disposed=!1,this.detachedRuntimeCreation=!1,this.loaded=!1,this.pending=[],Object(k.a)(-1===t.indexOf("/"),"Data store ID contains slash: "+t),this._attachState=this.containerRuntime.attachState!==j.Detached&&n?this.containerRuntime.attachState:j.Detached,this.bindToContext=()=>{Object(k.a)(this.bindState===C.NotBound),this.bindState=C.Binding,Object(k.a)(void 0!==this.channel),u(this.channel),this.bindState=C.Bound},this.summarizerNode=s(async(e,t)=>this.summarizeInternal(e,t),async()=>this.getGCDataInternal(),async()=>this.getInitialGCSummaryDetails())}get documentId(){return this._containerRuntime.id}get packagePath(){return Object(k.a)(void 0!==this.pkg),this.pkg}get options(){return this._containerRuntime.options}get clientId(){return this._containerRuntime.clientId}get deltaManager(){return this._containerRuntime.deltaManager}get connected(){return this._containerRuntime.connected}get leader(){return this._containerRuntime.leader}get snapshotFn(){return this._containerRuntime.snapshotFn}get branch(){return this._containerRuntime.branch}get loader(){return this._containerRuntime.loader}get containerRuntime(){return this._containerRuntime}get isLoaded(){return this.loaded}get hostRuntime(){return this._containerRuntime}get baseSnapshot(){return this._baseSnapshot}get disposed(){return this._disposed}get attachState(){return this._attachState}get IFluidDataStoreRegistry(){return this.registry}async isRoot(){return(await this.getInitialSnapshotDetails()).isRootDataStore}dispose(){this._disposed||(this._disposed=!0,this.channelDeferred&&this.channelDeferred.promise.then(e=>{e.dispose()}).catch(e=>{this._containerRuntime.logger.sendErrorEvent({eventName:"ChannelDisposeError",fluidDataStoreId:this.id},e)}))}rejectDeferredRealize(e){const t=new Error(e);throw t.containsPII=!0,t}async realize(){return Object(k.a)(!this.detachedRuntimeCreation),this.channelDeferred||(this.channelDeferred=new l.a,this.realizeCore().catch(e=>{var t;null===(t=this.channelDeferred)||void 0===t||t.reject(e)})),this.channelDeferred.promise}async factoryFromPackagePath(e){let t;Object(k.a)(this.pkg===e);let n,r=this._containerRuntime.IFluidDataStoreRegistry;for(const o of e)r||this.rejectDeferredRealize(`No registry for ${n} package`),n=o,t=await r.get(o),t||this.rejectDeferredRealize("Registry does not contain entry for the package "+o),r=t.IFluidDataStoreRegistry;const o=null==t?void 0:t.IFluidDataStoreFactory;return void 0===o&&this.rejectDeferredRealize(`Can't find factory for ${n} package`),{factory:o,registry:r}}async realizeCore(){const e=await this.getInitialSnapshotDetails();this._baseSnapshot=e.snapshot;const t=e.pkg,{factory:n,registry:r}=await this.factoryFromPackagePath(t);Object(k.a)(void 0===this.registry),this.registry=r;const o=await n.instantiateDataStore(this);Object(k.a)(void 0!==o),this.bindRuntime(o)}setConnectionState(e,t){this.verifyNotClosed(),this.loaded&&(Object(k.a)(this.connected===e),this.channel.setConnectionState(e,t))}process(e,t,n){var r,o;this.verifyNotClosed();const s=e.contents,i=Object.assign(Object.assign({},e),{type:s.type,contents:s.content});if(this.summarizerNode.recordChange(i),this.loaded)return null===(r=this.channel)||void 0===r?void 0:r.process(i,t,n);Object(k.a)(!t,"local store channel is not loaded"),null===(o=this.pending)||void 0===o||o.push(i)}processSignal(e,t){var n;this.verifyNotClosed(),this.loaded&&(null===(n=this.channel)||void 0===n||n.processSignal(e,t))}getQuorum(){return this._containerRuntime.getQuorum()}getAudience(){return this._containerRuntime.getAudience()}async summarize(e=!1,t=!0){return this.summarizerNode.summarize(e,t)}async summarizeInternal(e,t){await this.realize();const n=await this.channel.summarize(e,t),{pkg:r,isRootDataStore:o}=await this.getInitialSnapshotDetails(),s=tr(r,o);vt(n,er,JSON.stringify(s));const i={usedRoutes:this.summarizerNode.usedRoutes,gcData:n.gcData};return vt(n,lt.gcBlobKey,JSON.stringify(i)),this.summarizerNode.isReferenced()||(n.summary.unreferenced=!0),Object.assign(Object.assign({},n),{id:this.id})}async getGCData(){return this.summarizerNode.getGCData()}async getGCDataInternal(){return await this.realize(),Object(k.a)(void 0!==this.channel,"Channel should not be undefined when running GC"),void 0===this.channel.getGCData?{gcNodes:{}}:this.channel.getGCData()}updateUsedRoutes(e){this.summarizerNode.updateUsedRoutes(e),this.loaded&&this.updateChannelUsedRoutes()}updateChannelUsedRoutes(){if(Object(k.a)(this.loaded,"Channel should be loaded when updating used routes"),Object(k.a)(void 0!==this.channel,"Channel should be present when data store is loaded"),void 0!==this.channel.updateUsedRoutes){const e=this.summarizerNode.usedRoutes.filter(e=>"/"!==e&&""!==e);this.channel.updateUsedRoutes(e)}}async request(e){return(await this.realize()).request(e)}submitMessage(e,t,n){this.verifyNotClosed(),Object(k.a)(!!this.channel);const r={content:t,type:e};this._containerRuntime.submitDataStoreOp(this.id,r,n)}setChannelDirty(e){this.verifyNotClosed();const t=this.deltaManager.lastSequenceNumber;this.summarizerNode.invalidate(t);const n=this.summarizerNode.getChild(e);n&&n.invalidate(t)}submitSignal(e,t){return this.verifyNotClosed(),Object(k.a)(!!this.channel),this._containerRuntime.submitDataStoreSignal(this.id,e,t)}raiseContainerWarning(e){this.containerRuntime.raiseContainerWarning(e)}updateLeader(e){this.loaded&&(e?this.emit("leader"):this.emit("notleader"))}bindRuntime(e){var t;if(this.channel)throw new Error("Runtime already bound");try{Object(k.a)(!this.detachedRuntimeCreation),Object(k.a)(void 0!==this.channelDeferred),Object(k.a)(void 0!==this.pkg);const t=this.pending;if(t.length>0)for(const n of t)e.process(n,!1,void 0);this.pending=void 0,this.loaded=!0,this.channel=e,Object.freeze(this.pkg),this.updateChannelUsedRoutes(),this.channelDeferred.resolve(this.channel)}catch(e){null===(t=this.channelDeferred)||void 0===t||t.reject(e)}this._containerRuntime.notifyDataStoreInstantiated(this)}async getAbsoluteUrl(e){if(this.attachState===j.Attached)return this._containerRuntime.getAbsoluteUrl(e)}reSubmit(e,t){Object(k.a)(!!this.channel,"Channel must exist when resubmitting ops");const n=e;this.channel.reSubmit(n.type,n.content,t)}verifyNotClosed(){if(this._disposed)throw new Error("Context is closed")}getCreateChildSummarizerNodeFn(e,t){return(n,r,o)=>this.summarizerNode.createChild(n,e,t,{throwOnFailure:!0},r,o)}async uploadBlob(e){return this.containerRuntime.uploadBlob(e)}}class or extends rr{constructor(e,t,n,r,o,s,i){super(n,e,!0,r,o,s,C.Bound,!1,()=>{throw new Error("Already attached")},i),this.initSnapshotValue=t,this.initialSnapshotDetailsP=new l.b(async()=>{var e,t;let n,r=!0;if("string"==typeof this.initSnapshotValue){const t=(await this.storage.getVersions(this.initSnapshotValue,1))[0];n=null!==(e=await this.storage.getSnapshotTree(t))&&void 0!==e?e:void 0}else n=this.initSnapshotValue;const o=async e=>Object(R.a)(this.storage,e);if(n){const e=await this.summarizerNode.loadBaseSummary(n,o);n=e.baseSummary,this.pending=e.outstandingOps.concat(this.pending)}if(n&&void 0!==n.blobs[".component"]){const e=await o(n.blobs[".component"]);let s;switch(e.snapshotFormatVersion){case void 0:s=e.pkg.startsWith('["')&&e.pkg.endsWith('"]')?JSON.parse(e.pkg):[e.pkg];break;case 2:n=n.trees[lt.channelsTreeName];case"0.1":s=JSON.parse(e.pkg);break;default:Object(dt.a)(e.snapshotFormatVersion,"Invalid snapshot format version "+e.snapshotFormatVersion)}this.pkg=s,r=null===(t=e.isRootDataStore)||void 0===t||t}return{pkg:this.pkg,snapshot:n,isRootDataStore:r}}),this.gcDetailsInInitialSummaryP=new l.b(async()=>this.initSnapshotValue&&"string"!=typeof this.initSnapshotValue&&void 0!==this.initSnapshotValue.blobs[lt.gcBlobKey]?Object(R.a)(this.storage,this.initSnapshotValue.blobs[lt.gcBlobKey]):{})}async getInitialSnapshotDetails(){return this.initialSnapshotDetailsP}async getInitialGCSummaryDetails(){return this.gcDetailsInInitialSummaryP}generateAttachMessage(){throw new Error("Cannot attach remote store")}}class sr extends rr{constructor(e,t,n,r,o,s,i,a,u,c){super(n,e,void 0!==a,r,o,s,a?C.Bound:C.NotBound,!0,i,t),this.snapshotTree=a,this.isRootDataStore=u,this.createProps=c,this.attachListeners()}attachListeners(){this.once("attaching",()=>{Object(k.a)(this.attachState===j.Detached,"Should move from detached to attaching"),this._attachState=j.Attaching}),this.once("attached",()=>{Object(k.a)(this.attachState===j.Attaching,"Should move from attaching to attached"),this._attachState=j.Attached})}generateAttachMessage(){Object(k.a)(void 0!==this.channel,"There should be a channel when generating attach message"),Object(k.a)(void 0!==this.pkg,"pkg should be available in local data store context"),Object(k.a)(void 0!==this.isRootDataStore,"isRootDataStore should be available in local data store context");const e=this.channel.getAttachSummary(),t=tr(this.pkg,this.isRootDataStore);vt(e,er,JSON.stringify(t));const n={usedRoutes:this.summarizerNode.usedRoutes,gcData:e.gcData};vt(e,lt.gcBlobKey,JSON.stringify(n));const r=St(e.summary);return{id:this.id,snapshot:r,type:this.pkg[this.pkg.length-1]}}async getInitialSnapshotDetails(){return Object(k.a)(void 0!==this.pkg,"pkg should be available in local data store"),Object(k.a)(void 0!==this.isRootDataStore,"isRootDataStore should be available in local data store"),{pkg:this.pkg,snapshot:this.snapshotTree,isRootDataStore:this.isRootDataStore}}async getInitialGCSummaryDetails(){return{}}}class ir extends sr{constructor(e,t,n,r,o,s,i,a,u,c){super(e,t,n,r,o,s,i,a,u,c)}}class ar extends sr{constructor(e,t,n,r,o,s,i,a,u){super(e,t,n,r,o,s,i,a,u),this.detachedRuntimeCreation=!0}async attachRuntime(e,t){Object(k.a)(this.detachedRuntimeCreation),Object(k.a)(void 0===this.channelDeferred);const n=e.IFluidDataStoreFactory,r=await this.factoryFromPackagePath(this.pkg);Object(k.a)(r.factory===n),Object(k.a)(void 0===this.registry),this.registry=r.registry,this.detachedRuntimeCreation=!1,this.channelDeferred=new l.a,super.bindRuntime(t),this.isRootDataStore&&t.bindToContext()}async getInitialSnapshotDetails(){if(this.detachedRuntimeCreation)throw new Error("Detached Fluid Data Store context can't be realized! Please attach runtime first!");return super.getInitialSnapshotDetails()}}class ur{constructor(e,t,n,r,o,s=new Xn(o)){var i;this.baseSnapshot=e,this.runtime=t,this.submitAttachFn=n,this.getCreateChildSummarizerNodeFn=r,this.contexts=s,this.pendingAttach=new Map,this.attachOpFiredForDataStore=new Set,this.disposeOnce=new Pt.a(()=>this.contexts.dispose()),this.dispose=()=>this.disposeOnce.value,this.logger=p.a.create(o);const a=new Map;if(e)for(const[t,n]of Object.entries(e.trees))a.set(t,n);for(const[e,t]of a){let n;if(this.runtime.attachState!==j.Detached)n=new or(e,t,this.runtime,this.runtime.storage,this.runtime.scope,this.getCreateChildSummarizerNodeFn(e,{type:lt.CreateSummarizerNodeSource.FromSummary}));else{let r;if("object"!=typeof t)throw new Error("Snapshot should be there to load from!!");const o=t,s=Object(R.b)(o.blobs,o.blobs[".component"]);if("0.1"!==s.snapshotFormatVersion&&2!==s.snapshotFormatVersion)throw new Error("Invalid snapshot format version "+s.snapshotFormatVersion);r=JSON.parse(s.pkg),n=new ir(e,r,this.runtime,this.runtime.storage,this.runtime.scope,this.getCreateChildSummarizerNodeFn(e,{type:lt.CreateSummarizerNodeSource.FromSummary}),e=>this.bindFluidDataStore(e),o,null===(i=s.isRootDataStore)||void 0===i||i)}this.contexts.addBoundOrRemoted(n)}}processAttachMessage(e,t){var n,r;const o=e.contents;if(t)return Object(k.a)(this.pendingAttach.has(o.id)),null===(n=this.contexts.get(o.id))||void 0===n||n.emit("attached"),void this.pendingAttach.delete(o.id);if(this.contexts.has(o.id)){const t=new A("Duplicate data store created with existing ID",{sequenceNumber:e.sequenceNumber,clientId:e.clientId,referenceSequenceNumber:e.referenceSequenceNumber});throw this.logger.sendErrorEvent({eventName:"DuplicateDataStoreId"},t),t}const s=new Map;let i;o.snapshot&&(i=Object(F.a)(o.snapshot.entries,s));const a=[o.type],u=new or(o.id,i,this.runtime,new P.a(this.runtime.storage,s),this.runtime.scope,this.getCreateChildSummarizerNodeFn(o.id,{type:lt.CreateSummarizerNodeSource.FromAttach,sequenceNumber:e.sequenceNumber,snapshot:null!==(r=o.snapshot)&&void 0!==r?r:{entries:[nr(a,!0)]}}),a);this.contexts.addBoundOrRemoted(u),Promise.resolve().then(async()=>u.realize())}bindFluidDataStore(e){const t=e.id,n=this.contexts.getUnbound(t);if(Object(k.a)(!!n,"Could not find unbound context to bind"),this.runtime.attachState!==j.Detached){n.emit("attaching");const e=n.generateAttachMessage();this.pendingAttach.set(t,e),this.submitAttachFn(e),this.attachOpFiredForDataStore.add(t)}this.contexts.bind(e.id)}createDetachedDataStoreCore(e,t,n=Object(d.a)()){const r=new ar(n,e,this.runtime,this.runtime.storage,this.runtime.scope,this.getCreateChildSummarizerNodeFn(n,{type:lt.CreateSummarizerNodeSource.Local}),e=>this.bindFluidDataStore(e),void 0,t);return this.contexts.addUnbound(r),r}_createFluidDataStoreContext(e,t,n,r){const o=new ir(t,e,this.runtime,this.runtime.storage,this.runtime.scope,this.getCreateChildSummarizerNodeFn(t,{type:lt.CreateSummarizerNodeSource.Local}),e=>this.bindFluidDataStore(e),void 0,n,r);return this.contexts.addUnbound(o),o}get disposed(){return this.disposeOnce.evaluated}updateLeader(){for(const[,e]of this.contexts)e.updateLeader(this.runtime.leader)}resubmitDataStoreOp(e,t){const n=e,r=this.contexts.get(n.address);Object(k.a)(!!r,"There should be a store context for the op"),r.reSubmit(n.contents,t)}processFluidDataStoreOp(e,t,n){const r=e.contents,o=Object.assign(Object.assign({},e),{contents:r.contents}),s=this.contexts.get(r.address);Object(k.a)(!!s,"There should be a store context for the op"),s.process(o,t,n)}async getDataStore(e,t){const n=await this.contexts.getBoundOrRemoted(e,t);if(void 0===n)throw new Error(`DataStore ${e} does not yet exist or is not yet bound`);return n.realize()}processSignal(e,t,n){const r=this.contexts.get(e);if(!r)return Object(k.a)(!n,"Missing datastore for local signal"),void this.logger.sendTelemetryEvent({eventName:"SignalFluidDataStoreNotFound",fluidDataStoreId:e});r.processSignal(t,n)}setConnectionState(e,t){for(const[n,r]of this.contexts)try{r.setConnectionState(e,t)}catch(e){this.logger.sendErrorEvent({eventName:"SetConnectionStateError",clientId:t,fluidDataStore:n},e)}}setAttachState(e){let t;t=e===j.Attaching?"attaching":"attached";for(const[,e]of this.contexts)this.contexts.isNotBound(e.id)||e.emit(t)}async snapshot(){const e=Array.from(this.contexts).map(async([e,t])=>{const n=await t.summarize(!0,!1);return Object(k.a)(1===n.summary.type,"summarize should always return a tree when fullTree is true"),{fluidDataStoreId:e,snapshot:St(n.summary)}}),t=[],n=await Promise.all(e);n.sort((e,t)=>null==e?void 0:e.fluidDataStoreId.localeCompare(t.fluidDataStoreId));for(const e of n)t.push(new mt.d(e.fluidDataStoreId,e.snapshot));return t}async summarize(e,t){const n=new xt,r=new yt;return await Promise.all(Array.from(this.contexts).filter(([e,t])=>(Object(k.a)(t.attachState!==j.Attaching),t.attachState===j.Attached)).map(async([o,s])=>{const i=await s.summarize(e,t);r.addWithStats(o,i),void 0!==i.gcData&&n.prefixAndAddNodes(o,i.gcData.gcNodes)})),n.addNode("/",await this.getOutboundRoutes()),Object.assign(Object.assign({},r.getSummaryTree()),{gcData:n.getGCData()})}createSummary(){const e=new yt;let t;do{const n=e.summary.tree;t=this.contexts.notBoundLength(),Array.from(this.contexts).filter(([e,t])=>!(this.contexts.isNotBound(e)||n[e]||this.attachOpFiredForDataStore.has(e))).map(([t,n])=>{let r;n.isLoaded?r=wt(n.generateAttachMessage().snapshot,!0):(Object(k.a)(!!this.baseSnapshot,"BaseSnapshot should be there as detached container loaded from snapshot"),r=kt(this.baseSnapshot.trees[t])),e.addWithStats(t,r)})}while(t!==this.contexts.notBoundLength());return e.getSummaryTree()}async getGCData(){const e=new xt;return await Promise.all(Array.from(this.contexts).filter(([e,t])=>t.attachState===j.Attached).map(async([t,n])=>{const r=await n.getGCData();e.prefixAndAddNodes(t,r.gcNodes)})),e.addNode("/",await this.getOutboundRoutes()),e.getGCData()}updateUsedRoutes(e){var t;const n=Ct(e);for(const[e]of n)Object(k.a)(this.contexts.has(e),"Used route does not belong to any known data store");for(const[e,r]of this.contexts)r.updateUsedRoutes(null!==(t=n.get(e))&&void 0!==t?t:[])}async getOutboundRoutes(){const e=[];for(const[t,n]of this.contexts)await n.isRoot()&&e.push("/"+t);return e}}var cr;!function(e){e.FluidDataStoreOp="component",e.Attach="attach",e.ChunkedOp="chunkedOp",e.BlobAttach="blobAttach"}(cr||(cr={}));const dr={idleTime:5e3,maxTime:6e4,maxOps:1e3,maxAckWaitTime:12e4};function lr(e){switch(e.type){case cr.FluidDataStoreOp:case cr.ChunkedOp:case cr.Attach:case cr.BlobAttach:case q.a.Operation:return!0;default:return!1}}class hr{constructor(e,t,n){this.deltaManager=e,this.emitter=t,this.logger=n,this.localPaused=!1,this.deltaScheduler=new Wn(this.deltaManager,p.a.create(this.logger,"DeltaScheduler")),this.deltaManager.on("prepareSend",e=>{if(0===e.length)return;const t=e[0].metadata;if(!t||!t.batch)return;if(1===e.length)return void delete t.batch;const n=e[e.length-1];n.metadata=Object.assign(Object.assign({},n.metadata),{batch:!1})}),this.deltaManager.inbound.on("push",e=>{this.trackPending(e),this.updatePauseState(e.sequenceNumber)});const r=this.deltaManager.inbound.toArray();for(const e of r)this.trackPending(e);this.updatePauseState(this.deltaManager.lastSequenceNumber)}beginOperation(e){var t;if(this.batchClientId!==e.clientId){this.batchClientId&&(this.emitter.emit("batchEnd","Did not receive real batchEnd message",void 0),this.deltaScheduler.batchEnd(),this.logger.sendTelemetryEvent({eventName:"BatchEndNotReceived",clientId:this.batchClientId,sequenceNumber:e.sequenceNumber})),this.emitter.emit("batchBegin",e),this.deltaScheduler.batchBegin();const n=null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.batch;this.batchClientId=n?e.clientId:void 0}}endOperation(e,t){var n;if(e)return this.batchClientId=void 0,this.emitter.emit("batchEnd",e,t),void this.deltaScheduler.batchEnd();this.updatePauseState(t.sequenceNumber);const r=null===(n=null==t?void 0:t.metadata)||void 0===n?void 0:n.batch;return this.batchClientId&&!1!==r?void 0:(this.batchClientId=void 0,this.emitter.emit("batchEnd",void 0,t),void this.deltaScheduler.batchEnd())}setPaused(e){this.localPaused!==e&&(this.localPaused=e,e?this.deltaManager.inbound.pause():this.deltaManager.inbound.resume())}updatePauseState(e){0!==this.deltaManager.inbound.length&&(!this.pauseSequenceNumber||e+1<this.pauseSequenceNumber)?this.setPaused(!1):this.setPaused(!0)}trackPending(e){const t=e.metadata;if(!lr(e))return this.pauseSequenceNumber=void 0,void(this.pauseClientId=void 0);const n=t?t.batch:void 0;this.pauseClientId===e.clientId?void 0!==n&&(this.pauseSequenceNumber=n?e.sequenceNumber:void 0,this.pauseClientId=n?this.pauseClientId:void 0):(this.pauseSequenceNumber=n?e.sequenceNumber:void 0,this.pauseClientId=n?e.clientId:void 0)}}const fr="_scheduler";class mr extends at{constructor(e){super([...e,ln.registryEntry])}}class pr extends z.a{constructor(e,t,n={snapshotFormatVersion:void 0},r,o={generateSummaries:!0,enableWorker:!1},s,i){var a,u;super(),this.context=e,this.registry=t,this.runtimeOptions=o,this.containerScope=s,this.requestHandler=i,this.runtimeVersion="0.34.1",this.tasks=[],this._flushMode=lt.FlushMode.Automatic,this.needsFlush=!1,this.flushTrigger=!1,this._leader=!1,this._disposed=!1,this.dirtyDocument=!1,this.emitDirtyDocumentEvent=!0,this._connected=this.context.connected,this.chunkMap=new Map(r),this.IFluidHandleContext=new wn("",this),this.IFluidSerializer=new ft(this.IFluidHandleContext),this.logger=p.a.create(e.logger,void 0,{runtimeVersion:"0.34.1"}),this._logger=p.a.create(this.logger,"ContainerRuntime"),this.latestSummaryAck={proposalHandle:void 0,ackHandle:null===(a=this.context.getLoadedFromVersion())||void 0===a?void 0:a.id};const c=this.deltaManager.initialSequenceNumber;var d,l,h;this.summarizerNode=((e,t,n,r,o={},s,i)=>new _n(e,t,o,n,void 0===r?void 0:pn.createForRoot(r),void 0,void 0,s,i))(this.logger,async(e,t)=>this.summarizeInternal(e,t),c,e.baseSnapshot?c:void 0,{canReuseHandle:!1,throwOnFailure:!0,gcDisabled:this.runtimeOptions.disableGC}),this.dataStores=new ur(function(e,t){if(e){if(void 0!==t){const t=e.trees[lt.channelsTreeName];return Object(k.a)(!!t,`expected ${lt.channelsTreeName} tree in snapshot`),t}{const t={};for(const[n,r]of Object.entries(e.trees))Qn.includes(n)||(t[n]=r);return Object.assign(Object.assign({},e),{trees:t})}}}(e.baseSnapshot,n.snapshotFormatVersion),this,e=>this.submit(cr.Attach,e),(e,t)=>(n,r,o)=>this.summarizerNode.createChild(n,e,t,void 0,r,o),this._logger),this.blobManager=new Zn(this.IFluidHandleContext,()=>this.storage,e=>this.submit(cr.BlobAttach,void 0,void 0,{blobId:e})),this.blobManager.load(null===(u=e.baseSnapshot)||void 0===u?void 0:u.trees[".blobs"]),this.scheduleManager=new hr(e.deltaManager,this,p.a.create(this.logger,"ScheduleManager")),this.deltaSender=this.deltaManager,this.pendingStateManager=new Gn(this),this.context.quorum.on("removeMember",e=>{this.clearPartialChunks(e)}),this.context.quorum.on("addProposal",e=>{"code"!==e.key&&"code2"!==e.key||this.emit("codeDetailsProposed",e.value,e)}),void 0===this.context.previousRuntimeState||void 0===this.context.previousRuntimeState.state?this.previousState={}:this.previousState=this.context.previousRuntimeState.state,this.summarizer=new Dn("/_summarizer",this,()=>this.summaryConfiguration,this,this.IFluidHandleContext,this.previousState.summaryCollection),this.summaryManager=new $n(e,!1!==this.runtimeOptions.generateSummaries,!!this.runtimeOptions.enableWorker,this.logger,e=>{this.nextSummarizerP=e},this.previousState.nextSummarizerP,!!this.previousState.reload,this.runtimeOptions.initialSummarizerDelayMs),this.connected&&this.summaryManager.setConnected(this.context.clientId),this.deltaManager.on("readonly",e=>{Object(k.a)(e===this.deltaManager.readonly,"inconsistent readonly property/event state"),Object(k.a)(!e||!this.connected,"Unsafe to transition to read-only state!"),this.replayPendingStates()}),d=this.context.clientId,l=this.deltaManager,h=this.logger,new Kn(d,l,h)}get IContainerRuntime(){return this}get IContainerRuntimeDirtyable(){return this}get IFluidRouter(){return this}static async load(e,t,n,r,o=e.scope){var s;void 0===e.deltaManager.lastSequenceNumber&&Object.defineProperty(e.deltaManager,"lastSequenceNumber",{get:()=>e.deltaManager.referenceSequenceNumber});const i=new mr(t),a=async t=>{var n;const r=null===(n=e.baseSnapshot)||void 0===n?void 0:n.blobs[t];if(e.baseSnapshot&&r)return e.storage?Object(R.a)(e.storage,r):Object(R.b)(e.baseSnapshot.blobs,r)},u=null!==(s=await a(Yn))&&void 0!==s?s:[],c=await a(".metadata"),d=new pr(e,i,c,u,r,o,n);return e.existing||await d.createRootDataStore(ln.type,fr),d.subscribeToLeadership(),d}get id(){return this.context.id}get existing(){return this.context.existing}get options(){return this.context.options}get clientId(){return this.context.clientId}get clientDetails(){return this.context.clientDetails}get deltaManager(){return this.context.deltaManager}get storage(){return this.context.storage}get branch(){return this.context.branch}get snapshotFn(){return this.context.snapshotFn}get reSubmitFn(){return this.reSubmit}get closeFn(){return this.context.closeFn}get loader(){return this.context.loader}get flushMode(){return this._flushMode}get scope(){return this.containerScope}get IFluidDataStoreRegistry(){return this.registry}get attachState(){return void 0!==this.context.attachState?this.context.attachState:this.context.isAttached()?j.Attached:j.Detached}get connected(){return this._connected}get leader(){return this._leader}get summarizerClientId(){return this.summaryManager.summarizer}get summaryConfiguration(){var e,t;return Object.assign(Object.assign(Object.assign({},dr),null===(t=null===(e=this.context)||void 0===e?void 0:e.serviceConfiguration)||void 0===t?void 0:t.summary),this.runtimeOptions.summaryConfigOverrides)}get disposed(){return this._disposed}dispose(e){this._disposed||(this._disposed=!0,this.logger.sendTelemetryEvent({eventName:"ContainerRuntimeDisposed",category:"generic",isDirty:this.isDocumentDirty(),lastSequenceNumber:this.deltaManager.lastSequenceNumber,attachState:this.attachState,message:null==e?void 0:e.message}),this.summaryManager.dispose(),this.summarizer.dispose(),this.dataStores.dispose(),this.emit("dispose"),this.removeAllListeners())}get IFluidTokenProvider(){if(this.options&&this.options.intelligence)return{intelligence:this.options.intelligence}}get IFluidConfiguration(){return this.context.configuration}async request(e){const t=st.create(e);return"_summarizer"===t.pathParts[0]&&1===t.pathParts.length?{status:200,mimeType:"fluid/object",value:this.summarizer}:void 0!==this.requestHandler?this.requestHandler(t,this):{status:404,mimeType:"text/plain",value:"resource not found"}}async resolveHandle(e){var t;const n=st.create(e),r=n.pathParts[0];if("_channels"===r)return this.resolveHandle(n.createSubRequest(1));if(r===Zn.basePath&&n.isLeaf(2)){const e=await this.blobManager.getBlob(n.pathParts[1]);return e?{status:200,mimeType:"fluid/object",value:e.get()}:{status:404,mimeType:"text/plain",value:"blob not found"}}if(n.pathParts.length>0){const o="boolean"==typeof(null===(t=e.headers)||void 0===t?void 0:t.wait)?e.headers.wait:void 0,s=await this.getDataStore(r,o),i=n.createSubRequest(1);return Object(k.a)(i.url.startsWith("/"),"Expected createSubRequest url to include a leading slash"),s.IFluidRouter.request(i)}return{status:404,mimeType:"text/plain",value:"resource not found"}}async snapshot(){const e={entries:await this.dataStores.snapshot()};return this.chunkMap.size>0&&e.entries.push(new mt.b(Yn,JSON.stringify([...this.chunkMap]))),e}addContainerBlobsToSummary(e){if(this.chunkMap.size>0){const t=JSON.stringify([...this.chunkMap]);vt(e,Yn,t)}var t,n;n=wt(this.blobManager.snapshot(),!1),(t=e).summary.tree[".blobs"]=n.summary,t.stats=pt(t.stats,n.stats)}async requestSnapshot(e){return this.context.requestSnapshot(e)}async stop(){this.verifyNotClosed();const e=await this.snapshot(),t={reload:!0,summaryCollection:this.summarizer.summaryCollection,nextSummarizerP:this.nextSummarizerP,nextSummarizerD:this.nextSummarizerD};return this.dispose(new Error("ContainerRuntimeStopped")),{snapshot:e,state:t}}replayPendingStates(){if(!this.canSendOps())return;const e=this.dirtyDocument;this.dirtyDocument=!1,this.emitDirtyDocumentEvent=!1,this.pendingStateManager.replayPendingStates();const t=this.dirtyDocument;this.dirtyDocument=e,this.emitDirtyDocumentEvent=!0,this.updateDocumentDirtyState(t)}setConnectionState(e,t){this.verifyNotClosed();const n=this._connected!==e;this._connected=e,n&&this.replayPendingStates(),this.dataStores.setConnectionState(e,t),W(this._logger,this,e,t),e?(Object(k.a)(!!t),this.summaryManager.setConnected(t)):this.summaryManager.setDisconnected()}process(e,t){var n;if(this.verifyNotClosed(),!lr(e))return;let r,o=Object.assign({},e);this.scheduleManager.beginOperation(o);try{let e;switch(o=function(e){if(e.type===q.a.Operation){if(void 0!==e.contents.address&&void 0===e.contents.type)e.type=cr.FluidDataStoreOp;else{const t=e.contents;Object(k.a)(void 0!==t.type),e.type=t.type,e.contents=t.contents}Object(k.a)(lr(e))}return e}(o),o=this.processRemoteChunkedMessage(o),t&&(o.type!==cr.ChunkedOp&&(e=this.pendingStateManager.processPendingLocalMessage(o)),this.pendingStateManager.hasPendingMessages()||this.updateDocumentDirtyState(!1)),o.type){case cr.Attach:this.dataStores.processAttachMessage(o,t);break;case cr.FluidDataStoreOp:this.dataStores.processFluidDataStoreOp(o,t,e);break;case cr.BlobAttach:Object(k.a)(null===(n=null==o?void 0:o.metadata)||void 0===n?void 0:n.blobId),this.blobManager.addBlobId(o.metadata.blobId)}this.emit("op",o)}catch(e){throw r=e,e}finally{this.scheduleManager.endOperation(r,o)}}processSignal(e,t){const n=e.content,r={clientId:e.clientId,content:n.contents.content,type:n.contents.type};void 0!==n.address?this.dataStores.processSignal(n.address,r,t):this.emit("signal",r,t)}async getRootDataStore(e,t=!0){return this.dataStores.getDataStore(e,t)}async getDataStore(e,t=!0){return this.dataStores.getDataStore(e,t)}notifyDataStoreInstantiated(e){const t=e.packagePath[e.packagePath.length-1],n="/"+e.packagePath.slice(0,e.packagePath.length-1).join("/");this.emit("fluidDataStoreInstantiated",t,n,!e.existing)}setFlushMode(e){e!==this._flushMode&&(this.deltaSender||e!==lt.FlushMode.Manual?(e===lt.FlushMode.Automatic&&this.flush(),this._flushMode=e,this.pendingStateManager.onFlushModeUpdated(e)):kn("DeltaManager does not yet support flush modes"))}flush(){if(this.deltaSender){if(this.pendingStateManager.onFlush(),this.needsFlush)return this.needsFlush=!1,this.deltaSender.flush()}else kn("DeltaManager does not yet support flush modes")}orderSequentially(e){if(this.flushMode===lt.FlushMode.Manual)e();else{const t=this.flushMode;this.setFlushMode(lt.FlushMode.Manual);try{e()}finally{this.flush(),this.setFlushMode(t)}}}async createDataStore(e){return this._createDataStore(e,!1)}async createRootDataStore(e,t){const n=await this._createDataStore(e,!0,t);return n.bindToContext(),n}createDetachedRootDataStore(e,t){return this.dataStores.createDetachedDataStoreCore(e,!0,t)}createDetachedDataStore(e){return this.dataStores.createDetachedDataStoreCore(e,!1)}async _createDataStoreWithProps(e,t,n=Object(d.a)()){return this.dataStores._createFluidDataStoreContext(Array.isArray(e)?e:[e],n,!1,t).realize()}async _createDataStore(e,t,n=Object(d.a)()){return this.dataStores._createFluidDataStoreContext(Array.isArray(e)?e:[e],n,t).realize()}canSendOps(){return this.connected&&!this.deltaManager.readonly}getQuorum(){return this.context.quorum}getAudience(){return this.context.audience}raiseContainerWarning(e){this.context.raiseContainerWarning(e)}registerTasks(e,t){this.verifyNotClosed(),this.tasks=e,this.version=t,this.leader&&this.runTaskAnalyzer()}isDocumentDirty(){return this.dirtyDocument}isMessageDirtyable(e){return Object(k.a)(!0===lr(e),"Message passed for dirtyable check should be a container runtime message"),this.isContainerMessageDirtyable(e.type,e.contents)}isContainerMessageDirtyable(e,t){if(e===cr.Attach){if(t.id===fr)return!1}else if(e===cr.FluidDataStoreOp&&t.address===fr)return!1;return!0}submitSignal(e,t){this.verifyNotClosed();const n={address:void 0,contents:{type:e,content:t}};return this.context.submitSignalFn(n)}submitDataStoreSignal(e,t,n){const r={address:e,contents:{type:t,content:n}};return this.context.submitSignalFn(r)}async summarize(e=!1,t=!0){const n=await this.summarizerNode.summarize(e,t);return Object(k.a)(1===n.summary.type,"Container Runtime's summarize should always return a tree"),n}async summarizeInternal(e,t){const n=await this.dataStores.summarize(e,t);return this.addContainerBlobsToSummary(n),Object.assign(Object.assign({},n),{id:""})}setAttachState(e){e===j.Attaching?Object(k.a)(this.attachState===j.Attaching,"Container Context should already be in attaching state"):Object(k.a)(this.attachState===j.Attached,"Container Context should already be in attached state"),this.dataStores.setAttachState(e)}createSummary(){const e=this.dataStores.createSummary();return this.addContainerBlobsToSummary(e),e.summary}async getAbsoluteUrl(e){if(void 0===this.context.getAbsoluteUrl)throw new Error("Driver does not implement getAbsoluteUrl");if(this.attachState===j.Attached)return this.context.getAbsoluteUrl(e)}async generateSummary(e=!1,t=!1,n){const r=this.deltaManager.lastSequenceNumber,o=`Summary @${r}:${this.deltaManager.minimumSequenceNumber}`;this.summarizerNode.startSummary(r,n);try{await this.deltaManager.inbound.pause();const s={referenceSequenceNumber:r,submitted:!1};if(!this.connected)return Object.assign(Object.assign({},s),{reason:"disconnected"});if(!this.runtimeOptions.disableGC){const e=await this.dataStores.getGCData(),{referencedNodeIds:t}=function(e,t,n){const r=new Set,o=["/"];for(const t of o){if(r.has(t))continue;r.add(t);const n=e[t];void 0!==n&&o.push(...n)}const s=[],i=[];for(const t of Object.keys(e))r.has(t)?s.push(t):i.push(t);return{referencedNodeIds:s,deletedNodeIds:i}}(e.gcNodes,0,this.logger);this.summarizerNode.updateUsedRoutes([""]);const n=t.filter(e=>"/"!==e);this.dataStores.updateUsedRoutes(n)}const i=hn.a.start(),a=await this.summarize(e||t,!0),u={summaryStats:a.stats,generateDuration:i.trace().duration};if(!this.connected)return Object.assign(Object.assign(Object.assign({},s),u),{reason:"disconnected"});const c=this.deltaManager.lastSequenceNumber;Object(k.a)(c===r,`lastSequenceNumber changed while paused. ${c} !== ${r}`);const d=await this.storage.uploadSummaryWithContext(a.summary,this.latestSummaryAck);if(t){const e=await this.getVersionFromStorage(this.id);await this.refreshLatestSummaryAck(void 0,e.id,new p.a(n,void 0,{safeSummary:!0}),e)}const l=this.latestSummaryAck.ackHandle,h={handle:d,head:l,message:o,parents:l?[l]:[]},f={handle:d,uploadDuration:i.trace().duration};if(!this.connected)return Object.assign(Object.assign(Object.assign(Object.assign({},s),u),f),{reason:"disconnected"});Object(k.a)(this.deltaManager.lastSequenceNumber===r,`lastSequenceNumber changed before the summary op could be submitted. ${this.deltaManager.lastSequenceNumber} !== ${r}`);const m=this.submitSystemMessage(q.a.Summarize,h);return this.summarizerNode.completeSummary(d),Object.assign(Object.assign(Object.assign(Object.assign({},s),u),f),{submitted:!0,clientSequenceNumber:m,submitOpDuration:i.trace().duration})}finally{this.summarizerNode.clearSummary(),this.deltaManager.inbound.resume()}}processRemoteChunkedMessage(e){if(e.type!==cr.ChunkedOp)return e;const t=e.clientId,n=e.contents;if(this.addChunk(t,n),n.chunkId===n.totalChunks){const r=Object.assign({},e),o=this.chunkMap.get(t).join("");return r.contents=JSON.parse(o),r.type=n.originalType,this.clearPartialChunks(t),r}return e}addChunk(e,t){let n=this.chunkMap.get(e);void 0===n&&(n=[],this.chunkMap.set(e,n)),Object(k.a)(t.chunkId===n.length+1),n.push(t.contents)}clearPartialChunks(e){this.chunkMap.has(e)&&this.chunkMap.delete(e)}updateDocumentDirtyState(e){this.dirtyDocument!==e&&(this.dirtyDocument=e,this.emitDirtyDocumentEvent&&this.emit(e?"dirtyDocument":"savedDocument"))}submitDataStoreOp(e,t,n){const r={address:e,contents:t};this.submit(cr.FluidDataStoreOp,r,n)}async uploadBlob(e){return this.blobManager.createBlob(e)}submit(e,t,n,r){this.verifyNotClosed();let o=-1;if(this.canSendOps()){const n=JSON.stringify(t),s=this.context.deltaManager.maxMessageSize;this.flushMode!==lt.FlushMode.Manual||this.needsFlush||(r=Object.assign(Object.assign({},r),{batch:!0}),this.needsFlush=!0,this.flushTrigger||Promise.resolve().then(()=>{this.flushTrigger=!1,this.flush()})),o=!n||n.length<=s?this.submitRuntimeMessage(e,t,this._flushMode===lt.FlushMode.Manual,r):this.submitChunkedMessage(e,n,s)}this.pendingStateManager.onSubmitMessage(e,o,t,n,r),this.isContainerMessageDirtyable(e,t)&&this.updateDocumentDirtyState(!0)}submitChunkedMessage(e,t,n){const r=t.length,o=Math.floor((r-1)/n)+1;let s=0,i=0;for(let r=1;r<=o;r+=1){const a={chunkId:r,contents:t.substr(s,n),originalType:e,totalChunks:o};s+=n,i=this.submitRuntimeMessage(cr.ChunkedOp,a,!1)}return i}submitSystemMessage(e,t){this.verifyNotClosed(),Object(k.a)(this.connected);const n=this.flushMode===lt.FlushMode.Manual&&this.needsFlush;return n&&this._logger.sendErrorEvent({eventName:"submitSystemMessageError",type:e}),this.context.submitFn(e,t,n)}submitRuntimeMessage(e,t,n,r){const o={type:e,contents:t};return this.context.submitFn(q.a.Operation,o,n,r)}verifyNotClosed(){if(this._disposed)throw new Error("Runtime is closed")}reSubmit(e,t,n,r){switch(e){case cr.FluidDataStoreOp:this.dataStores.resubmitDataStoreOp(t,n);break;case cr.Attach:this.submit(e,t,n);break;case cr.ChunkedOp:throw new Error("chunkedOp not expected here");case cr.BlobAttach:this.submit(e,t,n,r);break;default:Object(dt.a)(e,"Unknown ContainerMessageType: "+e)}}subscribeToLeadership(){this.context.clientDetails.capabilities.interactive&&(this.getScheduler().then(e=>{const t="leader";e.pick(t,async()=>{Object(k.a)(!this._leader),this.updateLeader(!0)}),e.on("lost",e=>{e===t&&(Object(k.a)(this._leader),this._leader=!1,this.updateLeader(!1))})}).catch(e=>{this.closeFn(N(e))}),this.context.quorum.on("removeMember",()=>{this.leader&&this.runTaskAnalyzer()}))}async getTaskManager(){return async function(e,t){const n={url:""},r=await e.request(n);return 200!==r.status||"fluid/object"!==r.mimeType?Promise.reject(new Error("Not found")):(Object(k.a)(r.value),r.value)}(await this.getDataStore(fr,!0))}async getScheduler(){return(await this.getTaskManager()).IAgentScheduler}updateLeader(e){this._leader=e,this.leader?(Object(k.a)(void 0===this.clientId||this.connected&&this.deltaManager&&this.deltaManager.active),this.emit("leader")):this.emit("notleader"),this.dataStores.updateLeader(),this.leader&&this.runTaskAnalyzer()}runTaskAnalyzer(){const e=void 0===this.clientId?{browser:this.tasks,robot:[]}:function(e,t,n){const r=[...t].filter(e=>(e=>{var t,n,r,o;return!(null===(o=null===(r=null===(n=null===(t=e.client)||void 0===t?void 0:t.details)||void 0===n?void 0:n.capabilities)||void 0===r?void 0:r.interactive)||void 0===o||o)})(e[1])).map(e=>e[1].client.details.type),o=n.filter(e=>!r.includes(e));if(o.length>0){const n=t.get(e);Object(k.a)(!!n);const r=n.client&&n.client.permission?n.client.permission:[];return{browser:o.filter(e=>r&&r.includes(e)),robot:o.filter(e=>r&&!r.includes(e))}}}(this.clientId,this.getQuorum().getMembers(),this.tasks);if(e&&(e.browser.length>0||e.robot.length>0)){if(e.browser.length>0){const t={tasks:e.browser,version:this.version};kn("Requesting local help for "+e.browser),this.emit("localHelp",t)}if(e.robot.length>0){const t={tasks:e.robot,version:this.version};kn("Requesting remote help for "+e.robot),this.submitSystemMessage(q.a.RemoteHelp,t)}}}async refreshLatestSummaryAck(e,t,n,r){this.latestSummaryAck={proposalHandle:e,ackHandle:t},await this.summarizerNode.refreshLatestSummary(e,async()=>{const e=p.d.start(n,{eventName:"RefreshLatestSummaryGetSnapshot",hasVersion:!!r}),o={};let s;try{const e=hn.a.start(),n=null!=r?r:await this.getVersionFromStorage(t);o.getVersionDuration=e.trace().duration,s=await this.getSnapshotFromStorage(n),o.getSnapshotDuration=e.trace().duration}catch(t){throw e.cancel(o,t),t}return e.end(o),s},async e=>Object(R.a)(this.storage,e),n)}async getVersionFromStorage(e){const t=await this.storage.getVersions(e,1);return Object(k.a)(!!t&&!!t[0],"Failed to get version from storage"),t[0]}async getSnapshotFromStorage(e){const t=await this.storage.getSnapshotTree(e);return Object(k.a)(!!t,"Failed to get snapshot from storage"),t}}var gr=n("../notebook-dds/node_modules/@fluidframework/container-runtime-definitions/dist/index.js");class br{constructor(e){this.parent=e,this.providers=new Map}get IFluidDependencySynthesizer(){return this}get registeredTypes(){return this.providers.keys()}register(e,t){if(this.has(e))throw new Error(`Attempting to register a provider of type ${e} that already exists`);this.providers.set(e,t)}unregister(e){this.providers.has(e)&&this.providers.delete(e)}synthesize(e,t){const n=Object.values(e),r=Object.values(t);if(n===[]&&r===[])return{};const o=this.generateRequired(t),s=this.generateOptional(e);return Object.assign(Object.assign({},o),s)}has(...e){return e.every(e=>this.providers.has(e))}getProvider(e){return this.providers.get(e)||(this.parent?this.parent.getProvider(e):void 0)}generateRequired(e){const t=Object.values(e);return Object.assign({},...Array.from(t,e=>{const t=this.getProvider(e);if(!t)throw new Error("Object attempted to be created without registered required provider "+e);return this.resolveProvider(t,e)}))}generateOptional(e){const t=Object.values(e);return Object.assign({},...Array.from(t,e=>{const t=this.getProvider(e);return t?this.resolveProvider(t,e):{get[e](){return Promise.resolve(void 0)}}}))}resolveProvider(e,t){if("function"==typeof e){const n=this;return{get[t](){if(e&&"function"==typeof e)return Promise.resolve(e(n)).then(e=>{if(e)return e[t]})}}}return{get[t](){if(e)return Promise.resolve(e).then(e=>{if(e)return e[t]})}}}}const vr="default";class yr extends class{constructor(e,t=[],n=[],r){this.registryEntries=e,this.providerEntries=t,this.requestHandlers=n,this.runtimeOptions=r,this.registry=new at(e)}get IFluidDataStoreRegistry(){return this.registry}get IRuntimeFactory(){return this}async instantiateRuntime(e){const t=e.scope.IFluidDependencySynthesizer,n=new br(t);for(const e of Array.from(this.providerEntries))n.register(e.type,e.provider);const r=e.scope;r.IFluidDependencySynthesizer=n;const o=await pr.load(e,this.registryEntries,function(...e){const t=new it;return t.pushHandler(...e),async(e,n)=>t.handleRequest(e,n)}(...this.requestHandlers,nt),this.runtimeOptions,r);return n.register(gr.IContainerRuntime,o),o.existing||await this.containerInitializingFirstTime(o),await this.containerHasInitialized(o),o}async containerInitializingFirstTime(e){}async containerHasInitialized(e){}}{constructor(e,t,n=[],r=[],o){super(t,n,[...r,(vr,async(e,t)=>{const n=st.create(e);if(0===n.pathParts.length)return t.IFluidHandleContext.resolveHandle({url:"/default"+n.query,headers:e.headers})}),nt],o),this.defaultFactory=e}async containerInitializingFirstTime(e){await e.createRootDataStore(this.defaultFactory.type,vr)}}yr.defaultDataStoreId=vr;var _r=n("./node_modules/rxjs/index.js"),wr=n("./node_modules/rxjs/operators/index.js");const kr=n("../notebook-dds/node_modules/path-browserify/index.js").posix;class Sr{get type(){return Sr.Type}get attributes(){return Sr.Attributes}async load(e,t,n,r){const o=new jr(t,e,r);return await o.load(n),o}create(e,t){const n=new jr(t,e,Sr.Attributes);return n.initializeLocal(),n}}Sr.Type="https://graph.microsoft.com/types/directory",Sr.Attributes={type:Sr.Type,snapshotFormatVersion:"0.1",packageVersion:"0.34.1"};class jr extends Ut{constructor(e,t,n){super(e,t,n),this[Symbol.toStringTag]="SharedDirectory",this.root=new Cr(this,this.runtime,this.serializer,kr.sep),this.messageHandlers=new Map,this.localValueMaker=new Yt(this.serializer),this.setMessageHandlers(),this.root.on("containedValueChanged",(e,t)=>{this.emit("containedValueChanged",e,t,this)})}static create(e,t){return e.createChannel(t,Sr.Type)}static getFactory(){return new Sr}get absolutePath(){return this.root.absolutePath}get(e){return this.root.get(e)}async wait(e){return this.root.wait(e)}set(e,t){return this.root.set(e,t),this}delete(e){return this.root.delete(e)}clear(){this.root.clear()}has(e){return this.root.has(e)}get size(){return this.root.size}forEach(e){this.root.forEach(e)}[Symbol.iterator](){return this.root[Symbol.iterator]()}entries(){return this.root.entries()}keys(){return this.root.keys()}values(){return this.root.values()}createSubDirectory(e){return this.root.createSubDirectory(e)}getSubDirectory(e){return this.root.getSubDirectory(e)}hasSubDirectory(e){return this.root.hasSubDirectory(e)}deleteSubDirectory(e){return this.root.deleteSubDirectory(e)}subdirectories(){return this.root.subdirectories()}getWorkingDirectory(e){const t=this.makeAbsolute(e);if(t===kr.sep)return this.root;let n=this.root;const r=t.substr(1).split(kr.sep);for(const e of r)if(n=n.getSubDirectory(e),!n)return;return n}snapshotCore(e){return function(e,t){const n={entries:[]};let r=0;const o=[],s=[],i={};for(s.push([e,i]);s.length>0;){const[e,i]=s.pop();for(const[s,a]of e.getSerializedStorage(t)){i.storage||(i.storage={});const t={type:a.type,value:a.value&&JSON.parse(a.value)};if(a.value&&a.value.length>=8192){const i={};let a=i;if(e.absolutePath!==kr.sep)for(const t of e.absolutePath.substr(1).split(kr.sep)){const e={};a.subdirectories={[t]:e},a=e}a.storage={[s]:t};const u="blob"+r;r++,o.push(u),Object(mt.e)(n,u,i)}else i.storage[s]=t}for(const[t,n]of e.subdirectories()){i.subdirectories||(i.subdirectories={});const e={};i.subdirectories[t]=e,s.push([n,e])}}const a={blobs:o,content:i};return Object(mt.e)(n,"header",a),n}(this.root,e)}submitDirectoryMessage(e,t){this.submitLocalMessage(e,t)}makeDirectoryValueOpEmitter(e,t){return{emit:(n,r,o)=>{const s={key:e,path:t,type:"act",value:{opName:n,value:o}};this.submitDirectoryMessage(s,void 0);const i={key:e,path:t,previousValue:r};this.emit("valueChanged",i,!0,null,this)}}}onDisconnect(){Vt(`Directory ${this.id} is now disconnected`)}reSubmitCore(e,t){const n=e,r=this.messageHandlers.get(n.type);Object(k.a)(void 0!==r,"Missing message handler for message type: "+n.type),r.submit(n,t)}async loadCore(e){const t=await e.readBlob("header"),n=Object(ae.c)(t,"utf8"),r=JSON.parse(n),o=r;Array.isArray(o.blobs)?(this.populate(o.content),await Promise.all(o.blobs.map(async t=>{const n=await e.readBlob(t),r=JSON.parse(Object(ae.c)(n,"utf8"));this.populate(r)}))):this.populate(r)}populate(e){const t=[];for(t.push([this.root,e]);t.length>0;){const[e,n]=t.pop();if(n.subdirectories)for(const[r,o]of Object.entries(n.subdirectories)){let n=e.getSubDirectory(r);n||(n=new Cr(this,this.runtime,this.serializer,kr.join(e.absolutePath,r)),e.populateSubDirectory(r,n)),t.push([n,o])}if(n.storage)for(const[t,r]of Object.entries(n.storage)){const n=this.makeLocal(t,e.absolutePath,r);e.populateStorage(t,n)}}}registerCore(){const e=new Array;e.push(this.root);for(const t of e){for(const e of t.values())Ut.is(e)&&e.bindToContext();for(const[,n]of t.subdirectories())e.push(n)}}processCore(e,t,n){if(e.type===q.a.Operation){const r=e.contents,o=this.messageHandlers.get(r.type);Object(k.a)(void 0!==o,"Missing message handler for message type: "+e.type),o.process(r,t,e,n)}}makeAbsolute(e){return kr.resolve(kr.sep,e)}makeLocal(e,t,n){return n.type===Gt[Gt.Plain]||n.type===Gt[Gt.Shared]?this.localValueMaker.fromSerializable(n):this.localValueMaker.fromSerializableValueType(n,this.makeDirectoryValueOpEmitter(e,t))}setMessageHandlers(){this.messageHandlers.set("clear",{process:(e,t,n,r)=>{const o=this.getWorkingDirectory(e.path);o&&o.processClearMessage(e,t,n,r)},submit:(e,t)=>{const n=this.getWorkingDirectory(e.path);n&&n.submitClearMessage(e)}}),this.messageHandlers.set("delete",{process:(e,t,n,r)=>{const o=this.getWorkingDirectory(e.path);o&&o.processDeleteMessage(e,t,n,r)},submit:(e,t)=>{const n=this.getWorkingDirectory(e.path);n&&n.submitKeyMessage(e)}}),this.messageHandlers.set("set",{process:(e,t,n,r)=>{const o=this.getWorkingDirectory(e.path);if(o){const s=t?void 0:this.makeLocal(e.key,e.path,e.value);o.processSetMessage(e,s,t,n,r)}},submit:(e,t)=>{const n=this.getWorkingDirectory(e.path);n&&n.submitKeyMessage(e)}}),this.messageHandlers.set("createSubDirectory",{process:(e,t,n,r)=>{const o=this.getWorkingDirectory(e.path);o&&o.processCreateSubDirectoryMessage(e,t,n,r)},submit:(e,t)=>{const n=this.getWorkingDirectory(e.path);n&&n.submitSubDirectoryMessage(e)}}),this.messageHandlers.set("deleteSubDirectory",{process:(e,t,n,r)=>{const o=this.getWorkingDirectory(e.path);o&&o.processDeleteSubDirectoryMessage(e,t,n,r)},submit:(e,t)=>{const n=this.getWorkingDirectory(e.path);n&&n.submitSubDirectoryMessage(e)}}),this.messageHandlers.set("act",{process:(e,t,n,r)=>{const o=this.getWorkingDirectory(e.path);if(!o)return;const s=o.getLocalValue(e.key);if(!s)return;const i=s.getOpHandler(e.value.opName),a=s.value,u=this.serializer.parse(JSON.stringify(e.value.value));i.process(a,u,t,n);const c={key:e.key,path:e.path,previousValue:a};this.emit("valueChanged",c,t,n,this)},submit:(e,t)=>{this.submitDirectoryMessage(e,t)}})}}class Cr extends z.a{constructor(e,t,n,r){super(),this.directory=e,this.runtime=t,this.serializer=n,this.absolutePath=r,this[Symbol.toStringTag]="SubDirectory",this._storage=new Map,this._subdirectories=new Map,this.pendingKeys=new Map,this.pendingSubDirectories=new Map,this.pendingMessageId=-1,this.pendingClearMessageId=-1}has(e){return this._storage.has(e)}get(e){var t;return null===(t=this._storage.get(e))||void 0===t?void 0:t.value}async wait(e){return this._storage.has(e)?this._storage.get(e).value:new Promise((t,n)=>{const r=n=>{this.absolutePath===n.path&&e===n.key&&(t(this._storage.get(e).value),this.directory.removeListener("valueChanged",r))};this.directory.on("valueChanged",r)})}set(e,t){if(null==e)throw new Error("Undefined and null keys are not supported");const n=this.directory.localValueMaker.fromInMemory(t),r=Jt(n,this.serializer,this.directory.handle);if(this.setCore(e,n,!0,null),!this.directory.isAttached())return this;const o={key:e,path:this.absolutePath,type:"set",value:r};return this.submitKeyMessage(o),this}createSubDirectory(e){if(null==e)throw new Error("SubDirectory name may not be undefined or null");if(e.includes(kr.sep))throw new Error("SubDirectory name may not contain "+kr.sep);this.createSubDirectoryCore(e,!0,null);const t=this._subdirectories.get(e);if(!this.directory.isAttached())return t;const n={path:this.absolutePath,subdirName:e,type:"createSubDirectory"};return this.submitSubDirectoryMessage(n),t}getSubDirectory(e){return this._subdirectories.get(e)}hasSubDirectory(e){return this._subdirectories.has(e)}deleteSubDirectory(e){const t=this.deleteSubDirectoryCore(e,!0,null);if(!this.directory.isAttached())return t;const n={path:this.absolutePath,subdirName:e,type:"deleteSubDirectory"};return this.submitSubDirectoryMessage(n),t}subdirectories(){return this._subdirectories.entries()}getWorkingDirectory(e){return this.directory.getWorkingDirectory(this.makeAbsolute(e))}delete(e){const t=this.deleteCore(e,!0,null);if(!this.directory.isAttached())return t;const n={key:e,path:this.absolutePath,type:"delete"};return this.submitKeyMessage(n),t}clear(){if(this.clearCore(!0,null),!this.directory.isAttached())return;const e={path:this.absolutePath,type:"clear"};this.submitClearMessage(e)}forEach(e){this._storage.forEach((t,n,r)=>{e(t.value,n,r)})}get size(){return this._storage.size}entries(){const e=this._storage.entries();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:[t.value[0],t.value[1].value],done:!1}},[Symbol.iterator](){return this}}}keys(){return this._storage.keys()}values(){const e=this._storage.values();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:t.value.value,done:!1}},[Symbol.iterator](){return this}}}[Symbol.iterator](){return this.entries()}processClearMessage(e,t,n,r){if(t){Object(k.a)(void 0!==r,`pendingMessageId is missing from the local client's ${e.type} operation`);const t=r;this.pendingClearMessageId===t&&(this.pendingClearMessageId=-1)}else this.clearExceptPendingKeys(),this.directory.emit("clear",t,e,this.directory)}processDeleteMessage(e,t,n,r){this.needProcessStorageOperation(e,t,n,r)&&this.deleteCore(e.key,t,n)}processSetMessage(e,t,n,r,o){this.needProcessStorageOperation(e,n,r,o)&&this.setCore(e.key,t,n,r)}processCreateSubDirectoryMessage(e,t,n,r){this.needProcessSubDirectoryOperations(e,t,n,r)&&this.createSubDirectoryCore(e.subdirName,t,n)}processDeleteSubDirectoryMessage(e,t,n,r){this.needProcessSubDirectoryOperations(e,t,n,r)&&this.deleteSubDirectoryCore(e.subdirName,t,n)}submitClearMessage(e){const t=++this.pendingMessageId;this.directory.submitDirectoryMessage(e,t),this.pendingClearMessageId=t}submitKeyMessage(e){const t=++this.pendingMessageId;this.directory.submitDirectoryMessage(e,t),this.pendingKeys.set(e.key,t)}submitSubDirectoryMessage(e){const t=++this.pendingMessageId;this.directory.submitDirectoryMessage(e,t),this.pendingSubDirectories.set(e.subdirName,t)}*getSerializedStorage(e){for(const[t,n]of this._storage){const r=[t,n.makeSerialized(e,this.directory.handle)];yield r}}populateStorage(e,t){this._storage.set(e,t)}populateSubDirectory(e,t){this._subdirectories.set(e,t)}getLocalValue(e){return this._storage.get(e)}makeAbsolute(e){return kr.resolve(this.absolutePath,e)}needProcessStorageOperation(e,t,n,r){if(-1!==this.pendingClearMessageId)return t&&Object(k.a)(void 0!==r&&r<this.pendingClearMessageId,"Received out of order storage op when there is an unackd clear message"),!1;if(this.pendingKeys.has(e.key)){if(t){Object(k.a)(void 0!==r,`pendingMessageId is missing from the local client's ${e.type} operation`);const t=r;this.pendingKeys.get(e.key)===t&&this.pendingKeys.delete(e.key)}return!1}return!t}needProcessSubDirectoryOperations(e,t,n,r){if(this.pendingSubDirectories.has(e.subdirName)){if(t){Object(k.a)(void 0!==r,`pendingMessageId is missing from the local client's ${e.type} operation`);const t=r;this.pendingSubDirectories.get(e.subdirName)===t&&this.pendingSubDirectories.delete(e.subdirName)}return!1}return!t}clearExceptPendingKeys(){const e=new Map;this.pendingKeys.forEach((t,n,r)=>{e.set(n,this._storage.get(n))}),this._storage.clear(),e.forEach((e,t,n)=>{this._storage.set(t,e)})}clearCore(e,t){this._storage.clear(),this.directory.emit("clear",e,t,this.directory)}deleteCore(e,t,n){const r=this.get(e),o=this._storage.delete(e);if(o){const o={key:e,path:this.absolutePath,previousValue:r};this.directory.emit("valueChanged",o,t,n,this.directory);const s={key:e,previousValue:r};this.emit("containedValueChanged",s,t,this)}return o}setCore(e,t,n,r){const o=this.get(e);this._storage.set(e,t);const s={key:e,path:this.absolutePath,previousValue:o};this.directory.emit("valueChanged",s,n,r,this.directory);const i={key:e,previousValue:o};this.emit("containedValueChanged",i,n,this)}createSubDirectoryCore(e,t,n){this._subdirectories.has(e)||this._subdirectories.set(e,new Cr(this.directory,this.runtime,this.serializer,kr.join(this.absolutePath,e)))}deleteSubDirectoryCore(e,t,n){return this._subdirectories.delete(e)}}class xr extends me.a{constructor(e){super(),this._disposed=!1,this.runtime=e.runtime,this.context=e.context,this.providers=e.providers,this.initProps=e.initProps,Object(k.a)(void 0===this.runtime._dataObject),this.runtime._dataObject=this,this.innerHandle=new ct(this,"",this.runtime.objectsRoutingContext),this.runtime.once("dispose",()=>{this._disposed=!0,this.dispose()})}get disposed(){return this._disposed}get id(){return this.runtime.id}get IFluidRouter(){return this}get IFluidLoadable(){return this}get IFluidHandle(){return this.innerHandle}get handle(){return this.innerHandle}static async getDataObject(e){const t=e._dataObject;return Object(k.a)(void 0!==t,"Runtime has no DataObject!"),await t.finishInitialization(),t}async request(e){return this,"/"===(t=e).url||""===t.url?{mimeType:"fluid/object",status:200,value:this}:{mimeType:"text/plain",status:404,value:"unknown request url: "+t.url};var t}get url(){return this.context.id}async finishInitialization(){return void 0!==this.initializeP||(this.initializeP=this.initializeInternal()),this.initializeP}async initializeInternal(){var e;await this.preInitialize(),this.runtime.existing?(Object(k.a)(void 0===this.initProps),await this.initializingFromExisting()):await this.initializingFirstTime(null!==(e=this.context.createProps)&&void 0!==e?e:this.initProps),await this.hasInitialized()}async getFluidObjectFromDirectory(e,t,n){const r=n?n(e,t):t.get(e);if("string"==typeof r){const n=await this.requestFluidObject_UNSAFE(r);return n.IFluidLoadable&&n.handle&&t.set(e,n.handle),n}{const t=null==r?void 0:r.IFluidHandle;return await(t?t.get():this.requestFluidObject_UNSAFE(e))}}async requestFluidObject_UNSAFE(e){return ot("/"+e,this.context.containerRuntime).get()}async getService(e){return ot("/_services/"+e,this.context.containerRuntime).get()}async preInitialize(){}async initializingFirstTime(e){}async initializingFromExisting(){}async hasInitialized(){}dispose(){super.dispose()}}class Or extends xr{constructor(){super(...arguments),this.rootDirectoryId="root"}async request(e){const t=e.url,n=st.create({url:e.url});if("bigBlobs"===n.pathParts[0]){const e=this.root.get(n.pathParts.join("/"));return void 0===e?{mimeType:"text/plain",status:404,value:`request ${t} not found`}:{mimeType:"fluid/object",status:200,value:e}}return super.request(e)}get root(){if(!this.internalRoot)throw new Error(this.getUninitializedErrorString("root"));return this.internalRoot}get taskManager(){if(!this.internalTaskManager)throw new Error(this.getUninitializedErrorString("taskManager"));return this.internalTaskManager}async initializeInternal(){this.internalTaskManager=await this.context.containerRuntime.getTaskManager(),this.runtime.existing?(this.internalRoot=await this.runtime.getChannel(this.rootDirectoryId),this.internalRoot.attributes.type===en.Type&&this.runtime.logger.send({category:"generic",eventName:"MapDataObject",message:"Legacy document, SharedMap is masquerading as SharedDirectory in DataObject"})):(this.internalRoot=jr.create(this.runtime,this.rootDirectoryId),this.internalRoot.bindToContext()),await super.initializeInternal()}getUninitializedErrorString(e){return e+" must be initialized before being accessed."}}async function Er(e,t,n,r,o,s){let i=o;i=qt(async(e,t)=>(await xr.getDataObject(t)).request(e),i);const a=new i(t,n),u=new e({runtime:a,context:t,providers:new br(t.scope.IFluidDependencySynthesizer).synthesize(r,{}),initProps:s});return a.existing||await u.finishInitialization(),{instance:u,runtime:a}}class Ir extends class{constructor(e,t,n,r,o,s=Bt){if(this.type=e,this.ctor=t,this.optionalProviders=r,this.runtimeClass=s,""===this.type)throw new Error("undefined type member");void 0!==o&&(this.registry=new at(o)),this.sharedObjectRegistry=new Map(n.map(e=>[e.type,e]))}get IFluidDataStoreFactory(){return this}get IFluidDataStoreRegistry(){return this.registry}get registryEntry(){return[this.type,Promise.resolve(this)]}async instantiateDataStore(e){const{runtime:t}=await Er(this.ctor,e,this.sharedObjectRegistry,this.optionalProviders,this.runtimeClass);return t}async createChildInstance(e,t){return this.createNonRootInstanceCore(e.containerRuntime,[...e.packagePath,this.type],t)}async createPeerInstance(e,t){return this.createNonRootInstanceCore(e.containerRuntime,e.packagePath,t)}async createInstance(e,t){return this.createNonRootInstanceCore(e,[this.type],t)}async createRootInstance(e,t,n){const r=t.createDetachedRootDataStore([this.type],e);return this.createInstanceCore(r,n)}async createNonRootInstanceCore(e,t,n){const r=e.createDetachedDataStore(t);return this.createInstanceCore(r,n)}async createInstanceCore(e,t){const{instance:n,runtime:r}=await Er(this.ctor,e,this.sharedObjectRegistry,this.optionalProviders,this.runtimeClass,t);return await e.attachRuntime(this,r),n}}{constructor(e,t,n=[],r,o,s=Bt){const i=[...n];n.find(e=>e.type===Sr.Type)||i.push(jr.getFactory()),n.find(e=>e.type===en.Type)||i.push(tn.getFactory()),super(e,t,i,r,o,s)}}class Ar{get type(){return Ar.Type}get attributes(){return Ar.Attributes}async load(e,t,n,r){const o=new Tr(t,e,r);return await o.load(n),o}create(e,t){const n=new Tr(t,e,this.attributes);return n.initializeLocal(),n}}Ar.Type="https://graph.microsoft.com/types/cell",Ar.Attributes={type:Ar.Type,snapshotFormatVersion:"0.1",packageVersion:"0.34.1"};const Nr=m()("fluid:cell");Nr("Package: @fluidframework/cell - Version: 0.34.1");class Tr extends Ut{constructor(e,t,n){super(e,t,n),this.messageId=-1,this.messageIdObserved=-1}static create(e,t){return e.createChannel(t,Ar.Type)}static getFactory(){return new Ar}get(){return this.data}set(e){if(Ut.is(e))throw new Error("SharedObject sets are no longer supported. Instead set the SharedObject handle.");const t={type:Gt[Gt.Plain],value:this.toSerializable(e,this.serializer)};if(this.setCore(e),!this.isAttached())return;const n={type:"setCell",value:t};this.submitLocalMessage(n,++this.messageId)}delete(){this.deleteCore(),this.isAttached()&&this.submitLocalMessage({type:"deleteCell"},++this.messageId)}empty(){return void 0===this.data}snapshotCore(e){const t={type:Gt[Gt.Plain],value:this.toSerializable(this.data,e)};return{entries:[{mode:B.a.File,path:"header",type:B.b.Blob,value:{contents:JSON.stringify(t),encoding:"utf-8"}}]}}async loadCore(e){const t=await e.readBlob("header"),n=Object(ae.c)(t,"utf8"),r=void 0!==n?JSON.parse(n):{type:Gt[Gt.Plain],value:void 0};this.data=this.fromSerializable(r)}initializeLocalCore(){this.data=void 0}registerCore(){Ut.is(this.data)&&this.data.bindToContext()}onDisconnect(){Nr(`Cell ${this.id} is now disconnected`)}processCore(e,t,n){if(this.messageId===this.messageIdObserved){if(e.type===q.a.Operation&&!t){const t=e.contents;switch(t.type){case"setCell":this.setCore(this.fromSerializable(t.value));break;case"deleteCell":this.deleteCore();break;default:throw new Error("Unknown operation")}}}else if(t){const e=n;Object(k.a)(void 0!==e&&e<=this.messageId,"messageId is incorrect from from the local client's ACK"),this.messageIdObserved=n}}setCore(e){this.data=e,this.emit("valueChanged",e)}deleteCore(){this.data=void 0,this.emit("delete")}toSerializable(e,t){if(void 0===e)return e;const n=t.stringify(e,this.handle);return JSON.parse(n)}fromSerializable(e){let t=e.value;return e.type===Gt[Gt.Shared]&&(t={type:"__fluid_handle__",url:e.value}),void 0!==t?this.serializer.parse(JSON.stringify(t)):t}}var Fr=Object(f.debug)("aznb:dds"),Pr=n("../notebook-dds/node_modules/immutable/dist/immutable.es.js");class Rr{constructor(){this.items=[]}push(e){this.items.push(e)}empty(){return 0===this.items.length}top(){return this.items[this.items.length-1]}pop(){return this.items.pop()}}function Dr(e){if(void 0!==e&&!e.isHead)return e.next.prev=e.prev,e.prev.next=e.next,e}function Mr(e){return new Br(!1,e)}function Lr(){return new Br(!0,void 0)}class Br{constructor(e,t){this.isHead=e,this.data=t,this.prev=this,this.next=this}clear(){this.isHead&&(this.prev=this,this.next=this)}add(e){const t=Mr(e);return this.prev.next=t,t.next=this,t.prev=this.prev,this.prev=t,t}dequeue(){if(!this.empty())return Dr(this.next).data}enqueue(e){return this.add(e)}walk(e){for(let t=this.next;!t.isHead;t=t.next)e(t.data,t)}some(e,t){const n=[];for(let r=t?this.prev:this.next;!r.isHead;r=t?r.prev:r.next){const o=r.data;e(o,r)&&(t?n.unshift(o):n.push(o))}return n}count(){let e,t;for(e=this.next,t=0;!e.isHead;t++)e=e.next;return t}first(){if(!this.empty())return this.next.data}last(){if(!this.empty())return this.prev.data}empty(){return this.next===this}pushEntry(e){e.isHead=!1,e.next=this.next,e.prev=this,this.next=e,e.next.prev=e}push(e){const t=Mr(e);t.data=e,t.isHead=!1,t.next=this.next,t.prev=this,this.next=t,t.next.prev=t}popEntry(e){return this.next.isHead?void 0:Dr(this.next)}insertEntry(e){return e.isHead=!1,this.prev.next=e,e.next=this,e.prev=this.prev,this.prev=e,e}insertAfter(e){const t=Mr(e);return t.next=this.next,t.prev=this,this.next=t,t.next.prev=t,t}insertBefore(e){const t=Mr(e);return this.insertEntryBefore(t)}insertEntryBefore(e){return this.prev.next=e,e.next=this,e.prev=this.prev,this.prev=e,e}}Number.MIN_VALUE;class qr{constructor(e,t){this.comp=t,this.L=[t.min];for(let t=0,n=e.length;t<n;t++)this.add(e[t])}count(){return this.L.length-1}peek(){return this.L[1]}get(){const e=this.L[1];return this.L[1]=this.L[this.count()],this.L.pop(),this.fixdown(1),e}add(e){this.L.push(e),this.fixup(this.count())}fixup(e){for(;e>1&&this.comp.compare(this.L[e>>1],this.L[e])>0;){const t=this.L[e>>1];this.L[e>>1]=this.L[e],this.L[e]=t,e>>=1}}fixdown(e){for(;e<<1<=this.count();){let t=e<<1;if(t<this.count()&&this.comp.compare(this.L[t],this.L[t+1])>0&&t++,this.comp.compare(this.L[e],this.L[t])<=0)break;const n=this.L[e];this.L[e]=this.L[t],this.L[t]=n,e=t}}}class zr{constructor(e,t){this.compareKeys=e,this.aug=t}makeNode(e,t,n,r){const o={key:e,data:t,color:n,size:r};return this.aug&&this.aug.init&&this.aug.init(o),o}isRed(e){return!!e&&0==e.color}nodeSize(e){return e?e.size:0}size(){return this.nodeSize(this.root)}isEmpty(){return!this.root}get(e){if(void 0!==e)return this.nodeGet(this.root,e)}nodeGet(e,t){for(;e;){const n=this.compareKeys(t,e.key);if(n<0)e=e.left;else{if(!(n>0))return e;e=e.right}}}contains(e){return this.get(e)}gather(e,t){const n=[];return void 0!==e&&this.nodeGather(this.root,n,e,t),n}nodeGather(e,t,n,r){e&&(r.continueSubtree(e.left,n)&&this.nodeGather(e.left,t,n,r),r.matchNode(e,n)&&t.push(e),r.continueSubtree(e.right,n)&&this.nodeGather(e.right,t,n,r))}put(e,t,n){void 0!==e&&(void 0===t?this.remove(e):(this.root=this.nodePut(this.root,e,t,n),this.root.color=1))}nodePut(e,t,n,r){if(e){const o=this.compareKeys(t,e.key);if(o<0)e.left=this.nodePut(e.left,t,n,r);else if(o>0)e.right=this.nodePut(e.right,t,n,r);else if(r){const o=r(t,e.key,n,e.data);o.key&&(e.key=o.key),o.data?e.data=o.data:e.data=n}else e.data=n;return this.isRed(e.right)&&!this.isRed(e.left)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e.size=this.nodeSize(e.left)+this.nodeSize(e.right)+1,this.aug&&this.updateLocal(e),e}return this.makeNode(t,n,0,1)}updateLocal(e){this.aug&&(this.isRed(e.left)&&this.aug.update(e.left),this.isRed(e.right)&&this.aug.update(e.right),this.aug.update(e))}removeMin(){this.root&&(this.isRed(this.root.left)||this.isRed(this.root.right)||(this.root.color=0),this.root=this.nodeRemoveMin(this.root),this.root&&(this.root.color=1))}nodeRemoveMin(e){if(e.left)return this.isRed(e.left)||this.isRed(e.left.left)||(e=this.moveRedLeft(e)),e.left=this.nodeRemoveMin(e.left),this.balance(e)}removeMax(){this.root&&(this.isRed(this.root.left)||this.isRed(this.root.right)||(this.root.color=0),this.root=this.nodeRemoveMax(this.root),this.root&&(this.root.color=1))}nodeRemoveMax(e){if(this.isRed(e.left)&&(e=this.rotateRight(e)),e.right)return this.isRed(e.right)||this.isRed(e.right.left)||(e=this.moveRedRight(e)),e.right=this.nodeRemoveMax(e.right),this.balance(e)}remove(e){if(void 0!==e){if(!this.contains(e))return;this.isRed(this.root.left)||this.isRed(this.root.right)||(this.root.color=0),this.root=this.nodeRemove(this.root,e)}}nodeRemove(e,t){if(this.compareKeys(t,e.key)<0)this.isRed(e.left)||this.isRed(e.left.left)||(e=this.moveRedLeft(e)),e.left=this.nodeRemove(e.left,t);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),0==this.compareKeys(t,e.key)&&!e.right)return;if(this.isRed(e.right)||this.isRed(e.right.left)||(e=this.moveRedRight(e)),0==this.compareKeys(t,e.key)){const t=this.nodeMin(e.right);e.key=t.key,e.data=t.data,e.right=this.nodeRemoveMin(e.right)}else e.right=this.nodeRemove(e.right,t)}return this.balance(e)}height(){return this.nodeHeight(this.root)}nodeHeight(e){return void 0===e?-1:1+Math.max(this.nodeHeight(e.left),this.nodeHeight(e.right))}floor(e){if(!this.isEmpty())return this.nodeFloor(this.root,e)}nodeFloor(e,t){if(e){const n=this.compareKeys(t,e.key);if(0==n)return e;if(n<0)return this.nodeFloor(e.left,t);return this.nodeFloor(e.right,t)||e}}ceil(e){if(!this.isEmpty())return this.nodeCeil(this.root,e)}nodeCeil(e,t){if(e){const n=this.compareKeys(t,e.key);if(0==n)return e;if(n>0)return this.nodeCeil(e.right,t);return this.nodeCeil(e.left,t)||e}}min(){if(this.root)return this.nodeMin(this.root)}nodeMin(e){return e.left?this.nodeMin(e.left):e}max(){if(this.root)return this.nodeMax(this.root)}nodeMax(e){return e.right?this.nodeMax(e.right):e}rotateRight(e){const t=e.left;return e.left=t.right,t.right=e,t.color=t.right.color,t.right.color=0,t.size=e.size,e.size=this.nodeSize(e.left)+this.nodeSize(e.right)+1,this.aug&&(this.updateLocal(e),this.updateLocal(t)),t}rotateLeft(e){const t=e.right;return e.right=t.left,t.left=e,t.color=t.left.color,t.left.color=0,t.size=e.size,e.size=this.nodeSize(e.left)+this.nodeSize(e.right)+1,this.aug&&(this.updateLocal(e),this.updateLocal(t)),t}oppositeColor(e){return 1==e?0:1}flipColors(e){e.color=this.oppositeColor(e.color),e.left.color=this.oppositeColor(e.left.color),e.right.color=this.oppositeColor(e.right.color)}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}balance(e){let t=e;return this.isRed(t.right)&&(t=this.rotateLeft(t)),this.isRed(t.left)&&this.isRed(t.left.left)&&(t=this.rotateRight(t)),this.isRed(t.left)&&this.isRed(t.right)&&this.flipColors(t),t.size=this.nodeSize(t.left)+this.nodeSize(t.right)+1,this.aug&&this.aug.update(t),t}mapRange(e,t,n,r){this.nodeMap(this.root,e,n,r)}map(e,t){this.nodeMap(this.root,e,t)}keys(){const e=[],t={showStructure:!0,infix:t=>(e.push(t.key),!0)};return this.walk(t),e}walk(e){this.nodeWalk(this.root,e)}nodeWalk(e,t){let n=!0;return e&&(t.pre&&(t.showStructure||1===e.color)&&(n=t.pre(e)),e.left&&(n=this.nodeWalk(e.left,t)),n&&t.infix&&(t.showStructure||1===e.color)&&(n=t.infix(e)),n&&(n=this.nodeWalk(e.right,t)),n&&t.post&&(t.showStructure||1===e.color)&&(n=t.post(e))),n}nodeMap(e,t,n,r,o){if(!e)return!0;void 0===r&&(r=this.nodeMin(e).key),void 0===o&&(o=this.nodeMax(e).key);const s=this.compareKeys(r,e.key),i=this.compareKeys(o,e.key);let a=!0;return s<0&&(a=this.nodeMap(e.left,t,n,r,o)),a&&s<=0&&i>=0&&(a=t(e,n)),a&&i>0&&(a=this.nodeMap(e.right,t,n,r,o)),a}diag(){console.log("Height is "+this.height())}}const Hr=(e,t)=>e.compare(t);class Ur{constructor(){this.intervals=new zr(Hr,this),this.diag=!1,this.timePut=!1,this.putTime=0,this.putCount=0}printTiming(){console.log(`put total = ${this.putTime} avg=${(this.putTime/this.putCount).toFixed(2)}`)}remove(e){this.intervals.remove(e)}put(e,t){let n;if(t&&(n=(e,n)=>({key:t(e,n)})),this.timePut){const t=hn.a.start();this.intervals.put(e,{minmax:e.clone()},n),this.putTime+=1e3*t.trace().duration,this.putCount++}else this.intervals.put(e,{minmax:e.clone()},n)}map(e){const t={infix:t=>(e(t.key),!0),showStructure:!0};this.intervals.walk(t)}match(e){return this.intervals.gather(e,this)}matchNode(e,t){return!!e&&e.key.overlaps(t)}continueSubtree(e,t){const n=!!e&&e.data.minmax.overlaps(t);return this.diag&&!n&&e&&console.log(`skipping subtree of size ${e.size} key ${t.toString()}`),n}update(e){e.left&&e.right?e.data.minmax=e.key.union(e.left.data.minmax.union(e.right.data.minmax)):e.left?e.data.minmax=e.key.union(e.left.data.minmax):e.right?e.data.minmax=e.key.union(e.right.data.minmax):e.data.minmax=e.key.clone()}}var Vr,$r;function Wr(e,t,n,r){switch(void 0===t&&(t=e.defaultValue),e.name){case"incr":t+=n,e.minValue&&t<e.minValue&&(t=e.minValue);break;case"consensus":if(void 0===t)t={value:n,seq:r};else{const e=t;-1===e.seq&&(e.seq=r)}}return t}function Kr(e,t){if(e){if(!t)return!1;for(const n in e){if(void 0===t[n])return!1;if("object"==typeof t[n]){if(!Kr(e[n],t[n]))return!1}else if(t[n]!==e[n])return!1}for(const n in t)if(void 0===e[n])return!1}else if(t)return!1;return!0}function Gr(e,t,n,r){if(void 0!==t){"object"!=typeof t&&console.log("oh my "+t);for(const o in t){const s=t[o];null===s?delete e[o]:n&&"rewrite"!==n.name?e[o]=Wr(n,e[o],s,r):e[o]=s}}return e}function Jr(e,t,n,r){return(!e||n&&"rewrite"===n.name)&&(e=Zr()),Gr(e,t,n,r),e}function Zr(){const e=Object.create(null);return e.__=void 0,delete e.__,e}!function(e){e[e.Simple=0]="Simple",e[e.Tile=1]="Tile",e[e.NestBegin=2]="NestBegin",e[e.NestEnd=4]="NestEnd",e[e.RangeBegin=16]="RangeBegin",e[e.RangeEnd=32]="RangeEnd",e[e.SlideOnRemove=64]="SlideOnRemove",e[e.Transient=256]="Transient"}(Vr||(Vr={})),function(e){e[e.Simple=0]="Simple",e[e.Nest=1]="Nest",e[e.SlideOnRemove=2]="SlideOnRemove",e[e.Transient=4]="Transient"}($r||($r={}));class Xr{constructor(e,t,n=0,r=Vr.Simple){this.client=e,this.offset=n,this.refType=r,this.segment=t}min(e){return this.compare(e)<0?this:e}max(e){return this.compare(e)>0?this:e}compare(e){return this.segment===e.segment?this.offset-e.offset:void 0===this.segment||void 0!==e.segment&&this.segment.ordinal<e.segment.ordinal?-1:1}toPosition(){return this.segment&&this.segment.parent?this.getOffset()+this.client.getPosition(this.segment):Xr.DetachedPosition}hasTileLabels(){return!!this.getTileLabels()}hasRangeLabels(){return!!this.getRangeLabels()}hasTileLabel(e){return vo(this,e)}hasRangeLabel(e){return yo(this,e)}getTileLabels(){return go(this)}getRangeLabels(){return bo(this)}isLeaf(){return!1}addProperties(e,t){this.properties=Jr(this.properties,e,t)}getSegment(){return this.segment}getOffset(){var e;return(null===(e=this.segment)||void 0===e?void 0:e.removedSeq)?0:this.offset}getProperties(){return this.properties}}Xr.DetachedPosition=-1;class Yr{constructor(e,t=new Array(e.cachedLength)){this.segment=e,this.hierRefCount=0,this.refCount=0,this.refsByOffset=t}static append(e,t){t.localRefs&&!t.localRefs.empty&&(e.localRefs||(e.localRefs=new Yr(e)),e.localRefs.append(t.localRefs))}[Symbol.iterator](){const e=[];for(const t of this.refsByOffset)t&&(t.before&&e.push(t.before[Symbol.iterator]()),t.at&&e.push(t.at[Symbol.iterator]()),t.after&&e.push(t.after[Symbol.iterator]()));return{next(){for(;e.length>0;){const t=e[0].next();if(!0!==t.done)return t;e.shift()}return{value:void 0,done:!0}},[Symbol.iterator](){return this}}}clear(){this.refCount=0,this.hierRefCount=0;const e=e=>{e&&e.forEach(e=>{e.segment===this.segment&&(e.segment=void 0)})};for(let t=0;t<this.refsByOffset.length;t++){const n=this.refsByOffset[t];n&&(e(n.before),e(n.at),e(n.before),this.refsByOffset[t]=void 0)}}get empty(){return 0===this.refCount}addLocalRef(e){const t=this.refsByOffset[e.offset];void 0===t?this.refsByOffset[e.offset]={at:[e]}:t.at.push(e),(e.hasRangeLabels()||e.hasTileLabels())&&this.hierRefCount++,this.refCount++}removeLocalRef(e){const t=t=>{if(t){const n=t.indexOf(e);if(n>=0)return t.splice(n,1),(e.hasRangeLabels()||e.hasTileLabels())&&this.hierRefCount--,this.refCount--,e}},n=this.refsByOffset[e.offset];if(void 0!==n){let e=t(n.before);if(e)return e;if(e=t(n.at),e)return e;if(e=t(n.after),e)return e}}append(e){if(e&&!e.empty){this.hierRefCount+=e.hierRefCount,this.refCount+=e.refCount,e.hierRefCount=0;for(const t of e)t.segment=this.segment,t.offset+=this.refsByOffset.length;this.refsByOffset.push(...e.refsByOffset)}}split(e,t){if(!this.empty){const n=new Yr(t,this.refsByOffset.splice(e,this.refsByOffset.length-e));t.localRefs=n;for(const r of n)r.segment=t,r.offset-=e,(r.hasRangeLabels()||r.hasTileLabels())&&(this.hierRefCount--,n.hierRefCount++),this.refCount--,n.refCount++}}addBeforeTombstones(...e){const t=[];for(const n of e)for(const e of n)e.refType&Vr.SlideOnRemove?(t.push(e),e.segment=this.segment,e.offset=0,(e.hasRangeLabels()||e.hasTileLabels())&&this.hierRefCount++,this.refCount++):e.segment=void 0;t.length>0&&(void 0===this.refsByOffset[0]?this.refsByOffset[0]={before:t}:void 0===this.refsByOffset[0].before?this.refsByOffset[0].before=t:this.refsByOffset[0].before.unshift(...t))}addAfterTombstones(...e){const t=[];for(const n of e)for(const e of n)e.refType&Vr.SlideOnRemove?(t.push(e),e.segment=this.segment,e.offset=this.segment.cachedLength-1,(e.hasRangeLabels()||e.hasTileLabels())&&this.hierRefCount++,this.refCount++):e.segment=void 0;if(t.length>0){const e=this.refsByOffset[this.segment.cachedLength-1];void 0===e?this.refsByOffset[this.segment.cachedLength-1]={after:t}:void 0===e.after?e.after=t:e.after.push(...t)}}}class Qr{constructor(){this.oridinalSortedItems=[]}get size(){return this.oridinalSortedItems.length}get items(){return this.oridinalSortedItems}addOrUpdate(e,t){const n=this.findOrdinalPosition(this.getOrdinal(e));n.exists?t&&t(this.oridinalSortedItems[n.index],e):this.oridinalSortedItems.splice(n.index,0,e)}remove(e){const t=this.findOrdinalPosition(this.getOrdinal(e));return!!t.exists&&(this.oridinalSortedItems.splice(t.index,1),!0)}has(e){return this.findOrdinalPosition(this.getOrdinal(e)).exists}getOrdinal(e){const t=e;return t&&t.segment?t.segment.ordinal:e.ordinal}findOrdinalPosition(e,t,n){if(0===this.oridinalSortedItems.length)return{exists:!1,index:0};if(void 0===t||void 0===n)return this.findOrdinalPosition(e,0,this.oridinalSortedItems.length-1);const r=t+Math.floor((n-t)/2);return this.getOrdinal(this.oridinalSortedItems[r])>e?t===r?{exists:!1,index:r}:this.findOrdinalPosition(e,t,r-1):this.getOrdinal(this.oridinalSortedItems[r])<e?r===n?{exists:!1,index:r+1}:this.findOrdinalPosition(e,r+1,n):{exists:!0,index:r}}}class eo{constructor(e){this.segment=e,this.trackingGroups=new Set}link(e){e&&(this.trackingGroups.has(e)||this.trackingGroups.add(e),e.has(this.segment)||e.link(this.segment))}unlink(e){e.has(this.segment)&&e.unlink(this.segment),this.trackingGroups.delete(e)}copyTo(e){this.trackingGroups.forEach(t=>e.trackingCollection.link(t))}get empty(){return 0===this.trackingGroups.size}matches(e){if(!e||this.trackingGroups.size!==e.trackingGroups.size)return!1;for(const t of this.trackingGroups.values())if(!e.trackingGroups.has(t))return!1;return!0}}function to(e,t){let n=-1,r=0,o=e.length-1;for(;r<=o;){const s=r+Math.floor((o-r)/2);e[s].seq<=t?((n<0||e[n].seq<e[s].seq)&&(n=s),r=s+1):o=s-1}return n}class no{constructor(e){this.minSeq=e,this.minLength=0,this.segmentCount=0,this.partialLengths=[],this.clientSeqNumbers=[]}static combine(e,t,n,r=!1){const o=no.combineBranch(e,t,n,0,r);if(e.localBranchId>0){o.downstreamPartialLengths=[];for(let s=0;s<e.localBranchId;s++)o.downstreamPartialLengths[s]=no.combineBranch(e,t,n,s+1,r)}return o}static combineBranch(e,t,n,r,o=!1){let s,i=new no(n.minSeq);function a(e){if(!e)return;const t=new zr(jo);return e.map(e=>(t.put(e.data.clientId,Object.assign({},e.data)),!0)),t}function u(e){const t=e.seq;let n=0;if(s){if(s.seq===e.seq)return s.seglen+=e.seglen,s.len+=e.seglen,void function(e,t){const n=e.overlapRemoveClients;n?t.overlapRemoveClients&&t.overlapRemoveClients.map(e=>{const t=n.get(e.key);return t?t.data.seglen+=e.data.seglen:n.put(e.data.clientId,Object.assign({},e.data)),!0}):e.overlapRemoveClients=a(t.overlapRemoveClients)}(s,e);n=s.len,i.addClientSeqNumberFromPartial(s)}s={clientId:e.clientId,len:n+e.seglen,overlapRemoveClients:a(e.overlapRemoveClients),seglen:e.seglen,seq:t},i.partialLengths.push(s)}no.fromLeaves(e,r,i,t,n);const c=[];for(let s=0;s<t.childCount;s++){const i=t.children[s];if(!i.isLeaf()){const t=i;o&&(t.partialLengths=no.combine(e,t,n,!0)),c.push(t.partialLengths.partialLengthsForBranch(r))}}let d=c.length;if(0!==d){i.partialLengths.length>0&&(c.push(i),d++,i=new no(n.minSeq));const e=new Array(d),t=new Array(d);for(let n=0;n<d;n++)e[n]=0,t[n]=c[n].partialLengths.length,i.minLength+=c[n].minLength,i.segmentCount+=c[n].segmentCount;let r,o=0;for(;o>=0;){o=-1;for(let n=0;n<d;n++)if(e[n]<t[n]){const t=c[n].partialLengths[e[n]];(o<0||t.seq<r.seq)&&(o=n,r=t)}o>=0&&(u(r),e[o]++)}s&&i.addClientSeqNumberFromPartial(s)}return no.options.zamboni&&i.zamboni(n),no.options.verify&&i.verify(),i}static fromLeaves(e,t,n,r,o){function s(e,t){return-1!==e&&e<=t}n.minLength=0,n.segmentCount=r.childCount;for(let i=0;i<r.childCount;i++){const a=r.children[i];if(a.isLeaf()){const r=a,i=e.getBranchId(r.clientId);if(i<=t){s(r.seq,o.minSeq)?n.minLength+=r.cachedLength:-1!==r.seq&&no.insertSegment(n,r);const a=e.getRemovalInfo(t,i,r);s(a.removedSeq,o.minSeq)?n.minLength-=r.cachedLength:void 0!==a.removedSeq&&-1!==a.removedSeq&&no.insertSegment(n,r,a)}}}const i=n.partialLengths,a=i.length;let u=0;for(let e=0;e<a;e++)i[e].len=u+i[e].seglen,u=i[e].len,n.addClientSeqNumberFromPartial(i[e]);no.options.verify&&n.verify()}static getOverlapClients(e,t){const n=new zr(jo);for(const r of e)n.put(r,{clientId:r,seglen:t});return n}static accumulateRemoveClientOverlap(e,t,n){if(e.overlapRemoveClients)for(const r of t){const t=e.overlapRemoveClients.get(r);t?t.data.seglen+=n:e.overlapRemoveClients.put(r,{clientId:r,seglen:n})}else e.overlapRemoveClients=no.getOverlapClients(t,n)}static insertSegment(e,t,n){let r,o=t.seq,s=t.cachedLength,i=t.clientId;n&&(o=n.removedSeq,s=-s,i=n.removedClientId,n.removedClientOverlap&&(r=n.removedClientOverlap));const a=e.partialLengths,u=a.length;let c=0;for(;c<u&&!(a[c].seq>=o);c++);if(c<u&&a[c].seq===o)a[c].seglen+=s,r&&no.accumulateRemoveClientOverlap(a[c],r,s);else{let e;if(e=r?{seq:o,clientId:i,len:0,seglen:s,overlapRemoveClients:no.getOverlapClients(r,s)}:{seq:o,clientId:i,len:0,seglen:s},c<u){for(let e=u;e>c;e--)a[e]=a[e-1];a[c]=e}else a.push(e)}}static addSeq(e,t,n,r){let o,s,i=to(e,t);if(i>=0){const n=e[i];n.seq===t?(o=n,i=to(e,t-1),i>=0&&(s=e[i])):s=n}void 0===o?(o={clientId:r,seglen:n,seq:t},e.push(o)):o.seglen=n,o.len=void 0!==s?o.seglen+s.len:o.seglen}update(e,t,n,r,o){const s=e.getBranchId(r);if(0===s&&this.updateBranch(e,0,t,n,r,o),e.localBranchId>0)for(let i=0;i<e.localBranchId;i++){const a=i+1;s<=a&&this.downstreamPartialLengths[i].updateBranch(e,a,t,n,r,o)}}getPartialLength(e,t,n){const r=e.getBranchId(n);return Bo.traceTraversal&&console.log("plen branch "+r),r>0?this.downstreamPartialLengths[r-1].getBranchPartialLength(t,n):this.getBranchPartialLength(t,n)}toString(e,t=0){let n=this.branchToString(e);if(this.downstreamPartialLengths)for(let r=0,o=this.downstreamPartialLengths.length;r<o;r++)n+="\n",n+=Io(t),n+=this.downstreamPartialLengths[r].branchToString(e,r+1);return n}getBranchPartialLength(e,t){let n=this.minLength;const r=to(this.partialLengths,e),o=this.cliLatest(t),s=this.clientSeqNumbers[t];if(r>=0){if(n+=this.partialLengths[r].len,o>=0){const r=s[o];if(r.seq>e){n+=r.len;const o=this.cliLatestLEQ(t,e);o>=0&&(n-=s[o].len)}}}else o>=0&&(n+=s[o].len);return n}zamboni(e){function t(t){const n=to(t,e.minSeq);let r=0;if(n>=0){r=t[n].len;const e=t.length;if(n<=e-1){const o=e-n-1;for(let e=0;e<o;e++)t[e]=t[e+n+1],t[e].len-=r;t.length=o}}return r}this.minLength+=t(this.partialLengths);for(const e in this.clientSeqNumbers){const n=this.clientSeqNumbers[e];n&&t(n)}}addClientSeqNumber(e,t,n){void 0===this.clientSeqNumbers[e]&&(this.clientSeqNumbers[e]=[]);const r=this.clientSeqNumbers[e];let o=n;r.length>0&&(o+=r[r.length-1].len),r.push({seq:t,len:o,seglen:n})}addClientSeqNumberFromPartial(e){this.addClientSeqNumber(e.clientId,e.seq,e.seglen),e.overlapRemoveClients&&e.overlapRemoveClients.map(t=>(this.addClientSeqNumber(t.data.clientId,e.seq,t.data.seglen),!0))}updateBranch(e,t,n,r,o,s){let i=0,a=0;for(let o=0;o<n.childCount;o++){const s=n.children[o];if(s.isLeaf()){const n=s,o=e.getBranchId(n.clientId),u=e.getRemovalInfo(t,o,n);n.seq===r?u.removedSeq!==r&&(i+=n.cachedLength):u.removedSeq===r&&(i-=n.cachedLength),a++}else{const e=s.partialLengths.partialLengthsForBranch(t),n=e.partialLengths,o=to(n,r);if(o>=0){const e=n[o];e.seq===r&&(i+=e.seglen)}a+=e.segmentCount}}this.segmentCount=a,no.addSeq(this.partialLengths,r,i,o),void 0===this.clientSeqNumbers[o]&&(this.clientSeqNumbers[o]=[]),no.addSeq(this.clientSeqNumbers[o],r,i),no.options.zamboni&&this.zamboni(s),no.options.verify&&this.verify()}partialLengthsForBranch(e){return e>0?this.downstreamPartialLengths[e-1]:this}cliLatestLEQ(e,t){const n=this.clientSeqNumbers[e];return n?to(n,t):-1}cliLatest(e){const t=this.clientSeqNumbers[e];return t&&t.length>0?t.length-1:-1}branchToString(e,t=0){let n="";for(const e of this.partialLengths)n+=`(${e.seq},${e.len}) `;for(const t in this.clientSeqNumbers)if(this.clientSeqNumbers[t].length>0){n+="Client ",n+=e?""+e(+t):""+t,n+="[";for(const e of this.clientSeqNumbers[t])n+=`(${e.seq},${e.len})`;n+="]"}return n=`Br ${t}, min(seq ${this.minSeq}): ${this.minLength}; sc: ${this.segmentCount};${n}`,n}verifyPartialLengths(e,t){if(0===e.length)return 0;let n=0,r=0,o=0;for(const s of e)o++,Object(k.a)(this.minSeq<=s.seq),Object(k.a)(n<s.seq),n=s.seq,r+=s.seglen,r!==s.len&&Object(k.a)(!1),t||this.minLength+s.len<0&&Object(k.a)(!1),s.overlapRemoveClients&&(Object(k.a)(!t),o+=s.overlapRemoveClients.size());return o}verify(){if(this.clientSeqNumbers){let e=0;for(const t of this.clientSeqNumbers)t&&(e+=this.verifyPartialLengths(t,!0));Object(k.a)(!!this.partialLengths);const t=this.verifyPartialLengths(this.partialLengths,!1);Object(k.a)(t===e)}else Object(k.a)(!this.partialLengths)}}no.options={verify:!1,zamboni:!0};class ro{constructor(e){this.segment=e,this.segmentGroups=Lr()}get size(){return this.segmentGroups.count()}get empty(){return this.segmentGroups.empty()}enqueue(e){this.segmentGroups.enqueue(e),e.segments.push(this.segment)}dequeue(){return this.segmentGroups.dequeue()}clear(){this.segmentGroups.clear()}copyTo(e){this.segmentGroups.walk(t=>e.segmentGroups.enqueue(t))}}class oo{constructor(e){this.segment=e,this.pendingRewriteCount=0}ackPendingProperties(e){var t,n;e.combiningOp&&"rewrite"===e.combiningOp.name&&this.pendingRewriteCount--;for(const r of Object.keys(e.props))void 0!==(null===(t=this.pendingKeyUpdateCount)||void 0===t?void 0:t[r])&&(Object(k.a)(this.pendingKeyUpdateCount[r]>0),this.pendingKeyUpdateCount[r]--,0===(null===(n=this.pendingKeyUpdateCount)||void 0===n?void 0:n[r])&&delete this.pendingKeyUpdateCount[r])}addProperties(e,t,n,r){var o;this.segment.properties||(this.segment.properties=Zr(),this.pendingKeyUpdateCount=Zr());const s=r&&r.collaborating;if(this.pendingRewriteCount>0&&-1!==n&&s)return;const i=t&&"rewrite"===t.name,a=i?void 0:t||void 0,u=e=>{var t;return!(-1!==n&&void 0!==(null===(t=this.pendingKeyUpdateCount)||void 0===t?void 0:t[e])&&!a)},c={};if(i){s&&-1===n&&this.pendingRewriteCount++;for(const t of Object.keys(this.segment.properties))!e[t]&&u(t)&&(c[t]=this.segment.properties[t],delete this.segment.properties[t])}for(const t of Object.keys(e)){if(s)if(-1===n)void 0===(null===(o=this.pendingKeyUpdateCount)||void 0===o?void 0:o[t])&&(this.pendingKeyUpdateCount[t]=0),this.pendingKeyUpdateCount[t]++;else if(!u(t))continue;const r=this.segment.properties[t];let i;c[t]=void 0===r?null:r,i=a?Wr(a,r,i,n):e[t],null===i?delete this.segment.properties[t]:this.segment.properties[t]=i}return c}copyTo(e){if(this.segment.properties){e.properties=Zr();for(const t of Object.keys(this.segment.properties))e.properties[t]=this.segment.properties[t];if(this.segment.propertyManager){e.propertyManager=new oo(e),e.propertyManager.pendingRewriteCount=this.pendingRewriteCount,e.propertyManager.pendingKeyUpdateCount=Zr();for(const t of Object.keys(this.pendingKeyUpdateCount))e.propertyManager.pendingKeyUpdateCount[t]=this.pendingKeyUpdateCount[t]}}}hasPendingProperties(){return this.pendingRewriteCount>0||Object.keys(this.pendingKeyUpdateCount).length>0}}class so{constructor(){this.index=0,this.ordinal="",this.cachedLength=0}isLeaf(){return!1}}function io(e,t){const n=e.getTileLabels();if(n)for(const r of n)t[r]=e}function ao(e,t){const n=e.getTileLabels();if(n)for(const r of n)void 0===t[r]&&(t[r]=e)}function uo(e,t){for(const n in t){const r=t[n];if(!r.empty()){let t=e[n];void 0===t&&(t=new Rr,e[n]=t);for(const e of r.items)co(t,e)}}}function co(e,t){if(t.refType&Vr.NestBegin)return e.push(t),!0;{const n=e.top();return n&&n.refType&Vr.NestBegin?e.pop():e.push(t),!1}}function lo(e){const t=[];if(e)for(let n=0,r=e.length;n<r;n++)t.push(e.charCodeAt(n));return t}class ho extends so{constructor(e){super(),this.childCount=e,this.children=new Array(8)}hierBlock(){}setOrdinal(e,t){let n,r=this.childCount;8===r&&(r=7),Object(k.a)(r>=1&&r<=7);const o=1<<8-(r+1);if(0===t)n=o-1;else{const e=this.children[t-1].ordinal;n=e.charCodeAt(e.length-1)+o}e.ordinal=this.ordinal+String.fromCharCode(n),ho.traceOrdinals&&console.log(`so: prnt chld prev ${lo(this.ordinal)} ${lo(e.ordinal)} ${t>0?lo(this.children[t-1].ordinal):"NA"}`),Object(k.a)(e.ordinal.length===this.ordinal.length+1),t>0&&Object(k.a)(e.ordinal>this.children[t-1].ordinal)}assignChild(e,t,n=!0){e.parent=this,e.index=t,n&&this.setOrdinal(e,t),this.children[t]=e}}ho.traceOrdinals=!1;class fo extends ho{constructor(e){super(e),this.rightmostTiles=Zr(),this.leftmostTiles=Zr(),this.rangeStacks=Zr()}addNodeReferences(e,t){!function(e,t,n,r,o){function s(e,t){let n=o[e];void 0===n&&(n=new Rr,o[e]=n),co(n,t)}if(t.isLeaf()){const o=t;if(e.localNetLength(o)>0)if(_o.is(o)){const t=o.getId();if(t&&e.mapIdToSegment(t,o),o.refType&Vr.Tile&&(io(o,n),ao(o,r)),o.refType&(Vr.NestBegin|Vr.NestEnd)&&o.getRangeLabels())for(const e of o.getRangeLabels())s(e,o)}else{const e=t;if(e.localRefs&&void 0!==e.localRefs.hierRefCount&&e.localRefs.hierRefCount>0)for(const t of e.localRefs)if(t.refType&Vr.Tile&&(io(t,n),ao(t,r)),t.refType&(Vr.NestBegin|Vr.NestEnd))for(const e of t.getRangeLabels())s(e,t)}}else{const e=t;uo(o,e.rangeStacks),Gr(n,e.rightmostTiles),function(e,t){if(void 0!==t){"object"!=typeof t&&console.log("oh my "+t);for(const n in t)void 0===e[n]&&(e[n]=t[n])}}(r,e.leftmostTiles)}}(e,t,this.rightmostTiles,this.leftmostTiles,this.rangeStacks)}hierBlock(){return this}hierToString(e){let t="";for(const n in this.rangeStacks){const r=this.rangeStacks[n];t+=Io(e),t+=n+": ";for(const e of r.items)t+=e.toString()+" ";t+="\n"}return t}}class mo extends so{constructor(){super(),this.clientId=-1,this.seq=0,this.segmentGroups=new ro(this),this.trackingCollection=new eo(this)}addProperties(e,t,n,r){return this.propertyManager||(this.propertyManager=new oo(this)),this.propertyManager.addProperties(e,t,n,r)}hasProperty(e){return!!this.properties&&void 0!==this.properties[e]}isLeaf(){return!0}cloneInto(e){e.clientId=this.clientId,e.properties=function(e){if(void 0===e)return;const t=Zr();for(const n in e){const r=e[n];null!==r&&(t[n]=r)}return t}(this.properties),e.removedClientId=this.removedClientId,e.removedSeq=this.removedSeq,e.seq=this.seq}canAppend(e){return!1}addSerializedProps(e){this.properties&&(e.props=this.properties)}ack(e,t,n){const r=this.segmentGroups.dequeue();switch(Object(k.a)(r===e),t.op.type){case 2:return Object(k.a)(!!this.propertyManager),this.propertyManager.ackPendingProperties(t.op),!0;case 0:return Object(k.a)(-1===this.seq),this.seq=t.sequencedMessage.sequenceNumber,this.localSeq=void 0,!0;case 1:const e=n.getBranchId(this.clientId),r=n.getRemovalInfo(n.localBranchId,e,this);return Object(k.a)(!!r),Object(k.a)(!!r.removedSeq),this.localRemovedSeq=void 0,-1===r.removedSeq?(r.removedSeq=t.sequencedMessage.sequenceNumber,!0):(Bo.diagOverlappingRemove&&console.log(`grump @seq ${t.sequencedMessage.sequenceNumber} cli ${To(n,n.collabWindow.clientId)} from ${r.removedSeq} text ${n.toString()}`),!1);default:throw new Error(t.op.type+" is in unrecognized operation type")}}splitAt(e){if(e>0){const t=this.createSplitSegmentAt(e);if(t){if(this.propertyManager&&this.propertyManager.copyTo(t),t.parent=this.parent,t.ordinal=this.ordinal+String.fromCharCode(0),t.removedClientId=this.removedClientId,t.removedSeq=this.removedSeq,t.localRemovedSeq=this.localRemovedSeq,this.removalsByBranch){t.removalsByBranch=[];for(let e=0,n=this.removalsByBranch.length;e<n;e++){const n=this.removalsByBranch[e];n&&(t.removalsByBranch[e]={removedClientId:n.removedClientId,removedSeq:n.removedSeq,removedClientOverlap:n.removedClientOverlap?[...n.removedClientOverlap]:void 0})}}t.seq=this.seq,t.localSeq=this.localSeq,t.clientId=this.clientId,this.removedClientOverlap&&(t.removedClientOverlap=[...this.removedClientOverlap]),this.segmentGroups.copyTo(t),this.trackingCollection.copyTo(t),this.localRefs&&this.localRefs.split(e,t)}return t}}}const po="referenceRangeLabels",go=e=>e.refType&Vr.Tile&&e.properties?e.properties.referenceTileLabels:void 0,bo=e=>e.refType&(Vr.NestBegin|Vr.NestEnd)&&e.properties?e.properties.referenceRangeLabels:void 0;function vo(e,t){const n=e.getTileLabels();if(n)for(const e of n)if(t===e)return!0;return!1}function yo(e,t){const n=e.getRangeLabels();if(n)for(const e of n)if(t===e)return!0;return!1}class _o extends mo{constructor(e){super(),this.refType=e,this.type=_o.type,this.cachedLength=1}static is(e){return e.type===_o.type}static make(e,t){const n=new _o(e);return t&&n.addProperties(t),n}toJSONObject(){const e={marker:{refType:this.refType}};return super.addSerializedProps(e),e}static fromJSONObject(e){if(e&&"object"==typeof e&&"marker"in e)return _o.make(e.marker.refType,e.props)}clone(){const e=_o.make(this.refType,this.properties);return this.cloneInto(e),e}getSegment(){return this}getOffset(){return 0}hasSimpleType(e){return!!this.properties&&this.properties.markerSimpleType===e}getProperties(){return this.properties}getId(){if(this.properties&&this.properties.markerId)return this.properties.markerId}hasTileLabels(){return!!this.getTileLabels()}hasRangeLabels(){return!!this.getRangeLabels()}hasTileLabel(e){return vo(this,e)}hasRangeLabel(e){return yo(this,e)}getTileLabels(){return go(this)}getRangeLabels(){return bo(this)}toString(){let e="";this.refType&Vr.Tile&&(e+="Tile"),this.refType&Vr.NestBegin&&(e.length>0&&(e+="; "),e+="RangeBegin"),this.refType&Vr.NestEnd&&(e.length>0&&(e+="; "),e+="RangeEnd");let t="";const n=this.getId();n&&(e+=` (${n}) `);const r=this.getTileLabels();if(r){t+="tile -- ";for(let e=0,n=r.length;e<n;e++)e>0&&(t+="; "),t+=r[e]}const o=this.getRangeLabels();if(o){let e="begin";this.refType&Vr.NestEnd&&(e="end"),r&&(t+=" "),t+=`range ${e} -- `;const n=o;for(let e=0,r=n.length;e<r;e++)e>0&&(t+="; "),t+=n[e]}let s="";return this.properties&&(s+=JSON.stringify(this.properties,(e,t)=>{const n=!!t&&t.IFluidHandle;return n?`#Handle(${n.routeContext.path}/${n.path})`:t})),`M ${e}: ${t} ${s}`}createSplitSegmentAt(e){}canAppend(e){return!1}append(){throw new Error("Can not append to marker")}}var wo;_o.type="Marker",function(e){e[e.Go=0]="Go",e[e.Stop=1]="Stop",e[e.Yield=2]="Yield"}(wo||(wo={}));class ko{constructor(e,t,n,r,o,s,i,a,u=0){this.block=e,this.actions=t,this.pos=n,this.refSeq=r,this.clientId=o,this.context=s,this.start=i,this.end=a,this.childIndex=u,this.op=wo.Go}}class So{constructor(){this.clientId=-1,this.collaborating=!1,this.minSeq=0,this.currentSeq=0,this.localSeq=0}loadFrom(e){this.clientId=e.clientId,this.collaborating=e.collaborating,this.minSeq=e.minSeq,this.currentSeq=e.currentSeq}}const jo=(e,t)=>e-t,Co=(e,t)=>e.localeCompare(t);function xo(){return hn.a.start()}function Oo(e){return 1e3*e.trace().duration}const Eo=[""," ","  "];function Io(e){if(void 0===Eo[e]){Eo[e]="";for(let t=0;t<e;t++)Eo[e]+=" "}return Eo[e]}class Ao{constructor(){this.clientCollections=Zr()}set(e,t,n){let r=this.clientCollections[e];r||(r=Zr(),this.clientCollections[e]=r),r[t]=n}get(e,t){const n=this.clientCollections[e];if(n)return n[t]}getLength(e,t){const n=this.get(e,t);let r=0;if(n)for(const e of n)r+=e.cachedLength;return r}removeClient(e){this.clientCollections[e]=void 0}}const No={min:{maxSeq:-2},compare:(e,t)=>e.maxSeq-t.maxSeq};function To(e,t){return e.getLongClientId?e.getLongClientId(t):t.toString()}function Fo(e,t){for(const n of t.rangeLabels)if(e.hasRangeLabel(n)){let r=t.stacks[n];void 0===r&&(r=new Rr,t.stacks[n]=r),co(r,e)}}function Po(e,t,n,r,o,s,i){return _o.is(e)&&e.refType&(Vr.NestBegin|Vr.NestEnd)&&Fo(e,i),!1}function Ro(e,t,n,r,o,s,i){if(e.isLeaf()){const t=e;i.mergeTree.localNetLength(t)>0&&_o.is(t)&&t.refType&(Vr.NestBegin|Vr.NestEnd)&&Fo(t,i)}else{const t=e;uo(i.stacks,t.rangeStacks)}return!0}function Do(e,t,n,r,o,s,i){return _o.is(e)&&e.hasTileLabel(i.tileLabel)&&(i.tile=e),!1}function Mo(e,t,n,r,o,s,i){if(e.isLeaf()){const t=e;i.mergeTree.localNetLength(t)>0&&_o.is(t)&&t.hasTileLabel(i.tileLabel)&&(i.tile=t)}else{const t=e;let n;n=i.posPrecedesTile?t.rightmostTiles[i.tileLabel]:t.leftmostTiles[i.tileLabel],void 0!==n&&(i.tile=n)}return!0}const Lo={min:{minRequired:Number.MIN_VALUE,onMinGE:()=>{Object(k.a)(!1)}},compare:(e,t)=>e.minRequired-t.minRequired};class Bo{constructor(e){this.options=e,this.windowTime=0,this.packTime=0,this.ordTime=0,this.maxOrdTime=0,this.collabWindow=new So,this.idToSegment=Zr(),this.clientIdToBranchId=[],this.localBranchId=0,this.splitLeafSegment=(e,t)=>{if(!(t>0&&e))return{};const n=e.splitAt(t);return this.mergeTreeMaintenanceCallback&&this.mergeTreeMaintenanceCallback({operation:-2,deltaSegments:[{segment:e},{segment:n}]},void 0),{next:n}},this.blockUpdateActions=Bo.initBlockUpdateActions,this.root=this.makeBlock(0)}makeBlock(e){let t;return t=Bo.blockUpdateMarkers?new fo(e):new ho(e),t.ordinal="",t}clone(){const e=new Bo(this.options);e.root=e.blockClone(this.root)}blockClone(e,t){const n=this.makeBlock(e.childCount);for(let r=0;r<e.childCount;r++){const o=e.children[r];if(o.isLeaf()){const e=this.segmentClone(o);n.assignChild(e,r),t&&t.push(e)}else n.assignChild(this.blockClone(o,t),r)}return this.nodeUpdateLengthNewStructure(n),this.nodeUpdateOrdinals(n),n}segmentClone(e){return e.clone()}localNetLength(e){const t=this.getBranchId(e.clientId);let n=e;return this.localBranchId>t&&(n=this.getRemovalInfo(this.localBranchId,t,e)),void 0!==n.removedSeq?0:e.cachedLength}getBranchId(e){return this.clientIdToBranchId.length>e&&e>=0?this.clientIdToBranchId[e]:-1===e?0:this.localBranchId}mapIdToSegment(e,t){this.idToSegment[e]=t}addNode(e,t){const n=e.childCount++;return e.assignChild(t,n,!1),n}reloadFromSegments(e){Object(k.a)(!this.collabWindow.collaborating);const t=e=>{const n=Math.ceil(e.length/7),r=new Array(n);for(let t=0,o=0;o<n;o++){const n=r[o]=this.makeBlock(0);for(let r=0;r<7&&t<e.length;r++,t++)this.addNode(n,e[t]);this.blockUpdate(n)}return 1===r.length?r[0]:t(r)};e.length>0?(this.root=t(e),this.nodeUpdateOrdinals(this.root)):this.root=this.makeBlock(0)}startCollaboration(e,t,n,r){this.collabWindow.clientId=e,this.collabWindow.minSeq=t,this.collabWindow.collaborating=!0,this.collabWindow.currentSeq=n,this.localBranchId=r,this.segmentsToScour=new qr([],No),this.pendingSegments=Lr(),this.nodeUpdateLengthNewStructure(this.root,!0)}addToLRUSet(e,t){!0!==e.parent.needsScour&&t>this.collabWindow.currentSeq&&(e.parent.needsScour=!0,this.segmentsToScour.add({segment:e,maxSeq:t}))}underflow(e){return e.childCount<4}scourNode(e,t){let n;for(let r=0;r<e.childCount;r++){const o=e.children[r];if(o.isLeaf()){const e=o;if(e.segmentGroups.empty)if(void 0!==e.removedSeq){const r=this.getBranchId(e.clientId);this.getBranchId(e.removedClientId)!==r||e.removedSeq>this.collabWindow.minSeq?t.push(e):e.trackingCollection.empty?(Bo.traceZRemove&&console.log(`${this.getLongClientId(this.collabWindow.clientId)}: Zremove ${e.text}; cli ${this.getLongClientId(e.clientId)}`),this.mergeTreeMaintenanceCallback&&this.mergeTreeMaintenanceCallback({operation:-3,deltaSegments:[{segment:e}]},void 0),e.parent=void 0):t.push(e),n=void 0}else e.seq<=this.collabWindow.minSeq?n&&n.canAppend(e)&&Kr(n.properties,e.properties)&&n.trackingCollection.matches(e.trackingCollection)&&this.getBranchId(n.clientId)===this.getBranchId(e.clientId)&&this.localNetLength(e)>0?(Bo.traceAppend&&console.log(`${this.getLongClientId(this.collabWindow.clientId)}: append ${n.text} + ${e.text}; cli ${this.getLongClientId(n.clientId)} + cli ${this.getLongClientId(e.clientId)}`),n.append(e),this.mergeTreeMaintenanceCallback&&this.mergeTreeMaintenanceCallback({operation:-1,deltaSegments:[{segment:n},{segment:e}]},void 0),e.parent=void 0,e.trackingCollection.trackingGroups.forEach(t=>t.unlink(e))):(t.push(e),n=this.localNetLength(e)>0?e:void 0):(t.push(e),n=void 0);else t.push(e),n=void 0}else t.push(o),n=void 0}}packParent(e){const t=e.children;let n,r;const o=[];for(n=0;n<e.childCount;n++)r=t[n],this.scourNode(r,o),r.parent=void 0;const s=o.length;let i=Math.min(7,Math.floor(s/4));i<1&&(i=1);const a=Math.floor(s/i);let u=s%i;const c=new Array(8);let d=0;for(let t=0;t<i;t++){let n=a;u>0&&(n++,u--);const r=this.makeBlock(n);for(let e=0;e<n;e++){const t=o[d++];r.assignChild(t,e,!1)}r.parent=e,c[t]=r,this.nodeUpdateLengthNewStructure(r)}d!==s&&console.log(`total count ${s} readCount ${d}`),e.children=c;for(let t=0;t<i;t++)e.assignChild(c[t],t,!1);e.childCount=i,this.underflow(e)&&e.parent?this.packParent(e.parent):(this.nodeUpdateOrdinals(e),this.blockUpdatePathLengths(e,-1,-1,!0))}zamboniSegments(e=Bo.zamboniSegmentsMaxCount){if(!this.collabWindow.collaborating)return;let t;Bo.options.measureWindowTime&&(t=xo());for(let t=0;t<e;t++){let e=this.segmentsToScour.peek();if(!e||e.maxSeq>this.collabWindow.minSeq)break;if(e=this.segmentsToScour.get(),e.segment.parent&&!1!==e.segment.parent.needsScour){const t=e.segment.parent,n=[];this.scourNode(t,n),t.needsScour=!1;const r=n.length;if(r<t.childCount){t.childCount=r,t.children=n;for(let e=0;e<r;e++)t.assignChild(n[e],e,!1);if(this.underflow(t)&&t.parent){let e;Bo.options.measureWindowTime&&(e=xo()),this.packParent(t.parent),Bo.options.measureWindowTime&&(this.packTime+=Oo(e))}else this.nodeUpdateOrdinals(t),this.blockUpdatePathLengths(t,-1,-1,!0)}}}Bo.options.measureWindowTime&&(this.windowTime+=Oo(t))}getCollabWindow(){return this.collabWindow}getStats(){const e=t=>{const n={maxHeight:0,nodeCount:0,leafCount:0,removedLeafCount:0,liveCount:0,histo:[]};for(let e=0;e<8;e++)n.histo[e]=0;for(let r=0;r<t.childCount;r++){const o=t.children[r];let s=1;if(o.isLeaf())n.leafCount++,void 0!==o.removedSeq&&n.removedLeafCount++;else{const t=e(o);s=1+t.maxHeight,n.nodeCount+=t.nodeCount,n.leafCount+=t.leafCount,n.removedLeafCount+=t.removedLeafCount,n.liveCount+=t.liveCount;for(let e=0;e<8;e++)n.histo[e]+=t.histo[e]}s>n.maxHeight&&(n.maxHeight=s)}return n.histo[t.childCount]++,n.nodeCount++,n.liveCount+=t.childCount,n},t=e(this.root);return Bo.options.measureWindowTime&&(t.windowTime=this.windowTime,t.packTime=this.packTime,t.ordTime=this.ordTime,t.maxOrdTime=this.maxOrdTime),t}findHistorialPosition(e,t,n,r){return this.findHistorialPositionFromClient(e,t,n,r)}findHistorialPositionFromClient(e,t,n,r){if(Object(k.a)(t<n),e<this.getLength(t,r)){Object(k.a)(n<=this.collabWindow.currentSeq);const o=this.getContainingSegment(e,t,r);Object(k.a)(void 0!==o.segment);const s=this.getPosition(o.segment,n,r)+o.offset;return Object(k.a)(void 0!==s),s}return e}findHistorialRangeFromClient(e,t,n,r,o){const s=[];return this.mapRange({leaf:(e,t,n,o,i,a)=>{if(this.nodeLength(e,r,o)>0){const t=this.getPosition(e,r,o);i<0&&(i=0),a>e.cachedLength&&(a=e.cachedLength),s.push({start:t+i,end:t+a})}return!0}},n,o,void 0,e,t),s}findHistorialRange(e,t,n,r,o){return this.findHistorialRangeFromClient(e,t,n,r,o)}getLength(e,t){return this.blockLength(this.root,e,t)}get length(){return this.root.cachedLength}getPosition(e,t,n){let r,o=0,s=e.parent;for(;s;){const i=s.children;for(let a=0;a<s.childCount;a++){const s=i[a];if(r&&s===r||s===e)break;o+=this.nodeLength(s,t,n)}r=s,s=s.parent}return o}cloneSegments(e,t,n=0,r){void 0===r&&(r=this.blockLength(this.root,e,t));const o={segments:[]};return this.mapRange({leaf:(e,t,n,r,o,s,i)=>(i.segments.push(e.clone()),!0)},e,t,o,n,r),o.segments}getContainingSegment(e,t,n){let r,o;return this.searchBlock(this.root,e,0,t,n,{leaf:(e,t,n,s,i)=>(r=e,o=i,!1)},void 0),{segment:r,offset:o}}blockLength(e,t,n){return this.collabWindow.collaborating&&n!==this.collabWindow.clientId?e.partialLengths.getPartialLength(this,t,n):e.cachedLength}getRemovalInfo(e,t,n){if(e>t){const r=e-t-1;return n.removalsByBranch||(n.removalsByBranch=[]),n.removalsByBranch[r]||(n.removalsByBranch[r]={}),n.removalsByBranch[r]}return n}nodeLength(e,t,n){if(this.collabWindow.collaborating&&this.collabWindow.clientId!==n){const r=this.getBranchId(n);if(e.isLeaf()){const o=e,s=this.getBranchId(o.clientId);if(s<=r&&(o.clientId===n||-1!==o.seq&&o.seq<=t)){let e=o;return r>s&&(e=this.getRemovalInfo(r,s,o)),void 0!==e.removedSeq&&(e.removedClientId===n||e.removedClientOverlap&&e.removedClientOverlap.includes(n)||-1!==e.removedSeq&&e.removedSeq<=t)?0:o.cachedLength}return 0}return e.partialLengths.getPartialLength(this,t,n)}return e.isLeaf()?this.localNetLength(e):e.cachedLength}addMinSeqListener(e,t){this.minSeqListeners||(this.minSeqListeners=new qr([],Lo)),this.minSeqListeners.add({minRequired:e,onMinGE:t})}notifyMinSeqListeners(){if(this.minSeqListeners)for(;this.minSeqListeners.count()>0&&this.minSeqListeners.peek().minRequired<=this.collabWindow.minSeq;)this.minSeqListeners.get().onMinGE(this.collabWindow.minSeq)}setMinSeq(e){Object(k.a)(e<=this.collabWindow.currentSeq),Object(k.a)(this.collabWindow.minSeq<=e),e>this.collabWindow.minSeq&&(this.collabWindow.minSeq=e,Bo.options.zamboniSegments&&this.zamboniSegments(),this.notifyMinSeqListeners())}referencePositionToLocalPosition(e,t=this.collabWindow.currentSeq,n=this.collabWindow.clientId){const r=e.getSegment();return r&&r.parent?(r.removedSeq?0:e.getOffset())+this.getPosition(r,t,n):Xr.DetachedPosition}getStackContext(e,t,n){const r={mergeTree:this,stacks:Zr(),rangeLabels:n};return this.search(e,0,t,{leaf:Po,shift:Ro},r),r.stacks}findTile(e,t,n,r=!0){const o={mergeTree:this,posPrecedesTile:r,tileLabel:n};if(r?this.search(e,0,t,{leaf:Do,shift:Mo},o):this.backwardSearch(e,0,t,{leaf:Do,shift:Mo},o),o.tile){let e;if(o.tile.isLeaf()){const n=o.tile;e=this.getPosition(n,0,t)}else e=o.tile.toPosition();return{tile:o.tile,pos:e}}}search(e,t,n,r,o){return this.searchBlock(this.root,e,0,t,n,r,o)}searchBlock(e,t,n,r,o,s,i){const a=e.children;s&&s.pre&&s.pre(e,n,r,o,void 0,void 0,i);const u=s&&s.contains;for(let c=0;c<e.childCount;c++){const e=a[c],d=this.nodeLength(e,r,o);if(!u&&t<d||u&&u(e,t,r,o,void 0,void 0,i))return e.isLeaf()?(s&&s.leaf&&s.leaf(e,n,r,o,t,-1,i),e):this.searchBlock(e,t,n,r,o,s,i);s&&s.shift&&s.shift(e,n,r,o,t,void 0,i),t-=d,n+=d}s&&s.post&&s.post(e,n,r,o,void 0,void 0,i)}backwardSearch(e,t,n,r,o){const s=this.getLength(t,n);if(!(e>s))return this.backwardSearchBlock(this.root,e,s,t,n,r,o)}backwardSearchBlock(e,t,n,r,o,s,i){const a=e.children;s&&s.pre&&s.pre(e,n,r,o,void 0,void 0,i);const u=s&&s.contains;for(let c=e.childCount-1;c>=0;c--){const e=a[c],d=n-this.nodeLength(e,r,o);if(!u&&t>=d||u&&u(e,t,r,o,void 0,void 0,i))return e.isLeaf()?(s&&s.leaf&&s.leaf(e,d,r,o,t,-1,i),e):this.backwardSearchBlock(e,t,n,r,o,s,i);s&&s.shift&&s.shift(e,d,r,o,t,void 0,i),n=d}s&&s.post&&s.post(e,n,r,o,void 0,void 0,i)}updateRoot(e){if(void 0!==e){const t=this.makeBlock(2);t.assignChild(this.root,0,!1),t.assignChild(e,1,!1),this.root=t,this.nodeUpdateOrdinals(this.root),this.nodeUpdateLengthNewStructure(this.root)}}ackPendingSegment(e,t=!1){const n=e.sequencedMessage.sequenceNumber,r=this.pendingSegments.dequeue(),o=[];let s=!1;if(void 0!==r){t&&console.log(`segment group has ${r.segments.length} segments`);const i=[];r.segments.map(t=>{s=!t.ack(r,e,this)||s,Bo.options.zamboniSegments&&this.addToLRUSet(t,n),o.includes(t.parent)||o.push(t.parent),i.push({segment:t})}),this.mergeTreeMaintenanceCallback&&this.mergeTreeMaintenanceCallback({deltaSegments:i,operation:-4},e);const a=this.collabWindow.clientId;for(const e of o)this.blockUpdatePathLengths(e,n,a,s)}Bo.options.zamboniSegments&&this.zamboniSegments()}addToPendingList(e,t,n){return void 0===t&&(t={segments:[],localSeq:n},this.pendingSegments.enqueue(t)),e.segmentGroups.enqueue(t),t}getMarkerFromId(e){return this.idToSegment[e]}posFromRelativePos(e,t=this.collabWindow.currentSeq,n=this.collabWindow.clientId){let r,o=-1;return e.id&&(r=this.getMarkerFromId(e.id)),r&&(o=this.getPosition(r,t,n),e.before?void 0!==e.offset&&(o-=e.offset):(o+=r.cachedLength,void 0!==e.offset&&(o+=e.offset))),o}insertSegments(e,t,n,r,o,s){this.ensureIntervalBoundary(e,n,r),Bo.traceOrdinals&&this.ordinalIntegrity();const i=-1===o?++this.collabWindow.localSeq:void 0;this.blockInsert(e,n,r,o,i,t),this.mergeTreeDeltaCallback&&void 0!==s&&this.mergeTreeDeltaCallback(s,{operation:0,deltaSegments:t.map(e=>({segment:e}))}),Bo.traceOrdinals&&this.ordinalIntegrity(),this.collabWindow.collaborating&&Bo.options.zamboniSegments&&-1!==o&&this.zamboniSegments()}insertAtReferencePosition(e,t,n){if(0===t.cachedLength)return;if(t.parent||t.removedSeq||0!==t.seq)throw new Error("Cannot insert segment that has already been inserted.");const r=e=>{let t=e.parent,n=t;for(;void 0!==t;){if(t.childCount>=8){const e=this.split(t);t===this.root?(this.updateRoot(e),n=void 0):(this.insertChildNode(t.parent,e,t.index+1),n=e.parent,this.blockUpdateLength(t.parent,-1,o))}else this.blockUpdateLength(t,-1,o);t=t.parent}n&&this.nodeUpdateOrdinals(n)},o=this.collabWindow.clientId,s=e.getSegment(),i=e.getOffset(),a=this.nodeLength(s,this.collabWindow.currentSeq,o);let u=s;if(0!==i&&0!==a){const e=this.splitLeafSegment(s,i);Object(k.a)(!!e.next),this.insertChildNode(s.parent,e.next,s.index+1),r(e.next),u=e.next}if(this.leftExcursion(u,e=>!e.isLeaf()||0===this.nodeLength(e,this.collabWindow.currentSeq,o)&&(this.breakTie(0,0,e,this.collabWindow.currentSeq,o)&&(u=e),!0)),this.collabWindow.collaborating?(t.localSeq=++this.collabWindow.localSeq,t.seq=-1):t.seq=0,t.clientId=o,_o.is(t)){const e=t.getId();e&&this.mapIdToSegment(e,t)}this.insertChildNode(u.parent,t,u.index),r(t),this.mergeTreeDeltaCallback&&this.mergeTreeDeltaCallback(n,{deltaSegments:[{segment:t}],operation:0}),this.collabWindow.collaborating&&this.addToPendingList(t,void 0,t.localSeq)}resolveRemoteClientPosition(e,t,n){const r=this.getContainingSegment(e,t,n),o=this.getCollabWindow();return r&&r.segment?this.getPosition(r.segment,o.currentSeq,o.clientId)+r.offset:e===this.getLength(t,n)?this.getLength(o.currentSeq,o.clientId):void 0}insertChildNode(e,t,n){Object(k.a)(e.childCount<8);for(let t=e.childCount;t>n;t--)e.children[t]=e.children[t-1],e.children[t].index=t;e.childCount++,e.assignChild(t,n,!1)}blockInsert(e,t,n,r,o,s){let i=!1;const a=(e,t,n,r)=>(-1===e.seq&&(Bo.diagInsertTie&&console.log(`@cli ${To(this,this.collabWindow.clientId)}: promoting continue due to seq ${e.seq} text ${e.toString()} ref ${n}`),i=!0),!1),u=e=>(i=!1,this.rightExcursion(e,a),Bo.diagInsertTie&&i&&console.log(`@cli ${To(this,this.collabWindow.clientId)}: attempting continue with seq ${r}  ref ${t} `),i);let c;const d=e=>{this.collabWindow.collaborating&&(-1===e.seq&&n===this.collabWindow.clientId?c=this.addToPendingList(e,c,o):e.seq>this.collabWindow.minSeq&&Bo.options.zamboniSegments&&this.addToLRUSet(e,e.seq))},l=(e,t,n)=>{const r={};return e?(r.replaceCurrent=n.candidateSegment,r.next=e):r.next=n.candidateSegment,r};let h=e;for(const e of s)if(i=!1,e.cachedLength>0){if(e.seq=r,e.localSeq=o,e.clientId=n,_o.is(e)){const t=e.getId();t&&this.mapIdToSegment(t,e)}const s=this.insertingWalk(this.root,h,t,n,r,{leaf:l,candidateSegment:e,continuePredicate:u});if(void 0===e.parent)throw new Error("MergeTree insert failed: "+JSON.stringify({currentSeq:this.collabWindow.currentSeq,minSeq:this.collabWindow.minSeq,segSeq:e.seq}));this.updateRoot(s),d(e),h+=e.cachedLength}}ensureIntervalBoundary(e,t,n){const r=this.insertingWalk(this.root,e,t,n,-2,{leaf:this.splitLeafSegment});this.updateRoot(r)}breakTie(e,t,n,r,o,s){if(n.isLeaf()){if(0===e){const e=n,t=this.getBranchId(o),s=this.getBranchId(e.clientId),i=this.getRemovalInfo(t,s,e);if(i.removedSeq&&i.removedSeq<=r&&-1!==i.removedSeq)return!1;if(o===this.collabWindow.clientId)return!0;if(-1!==n.seq)return!0}return!1}return!0}leftExcursion(e,t){let n=!0,r=e,o=r.parent;for(;o;){const e=o.children;let s,i,a=!1;for(s=o.childCount-1;s>=0;s--)if(i=e[s],a){if(i.isLeaf())n=t(i,0,0,this.collabWindow.clientId,0,0,void 0);else{const e=i;n=this.nodeMapReverse(e,t,0,0,this.collabWindow.clientId)}if(!n)return}else a=r===i;r=o,o=o.parent}}rightExcursion(e,t){const n={leaf:t};let r=!0,o=e,s=o.parent;for(;s;){const e=s.children;let i,a,u=!1;for(i=0;i<s.childCount;i++)if(a=e[i],u){if(a.isLeaf())r=t(a,0,0,this.collabWindow.clientId,0,0,void 0);else{const e=a;r=this.nodeMap(e,n,0,0,this.collabWindow.clientId,void 0)}if(!r)return}else u=o===a;o=s,s=s.parent}}insertingWalk(e,t,n,r,o,s){const i=e.children;let a,u,c,d,l=!1;for(a=0;a<e.childCount;a++){u=i[a];const h=this.nodeLength(u,n,r);if(Bo.traceTraversal){let e;if(!u.isLeaf()&&this.collabWindow.collaborating)e="minLength: "+u.partialLengths.minLength;else{const t=u;e=`cli: ${To(this,t.clientId)} seq: ${t.seq} text: ${t.toString()}`,void 0!==t.removedSeq&&(e+=` rcli: ${To(this,t.removedClientId)} rseq: ${t.removedSeq}`)}console.log(`@tcli: ${To(this,this.collabWindow.clientId)} len: ${h} pos: ${t} ${e}`)}if(t<h||t===h&&this.breakTie(t,h,u,n,r,s.candidateSegment)){if(l=!0,u.isLeaf()){Bo.traceTraversal&&console.log(`@tcli: ${To(this,this.collabWindow.clientId)}: leaf action`);const n=u,r=s.leaf(n,t,s);if(r.replaceCurrent&&(Bo.traceOrdinals&&console.log("assign from leaf with block ord "+lo(e.ordinal)),e.assignChild(r.replaceCurrent,a,!1),r.replaceCurrent.ordinal=u.ordinal),!r.next)return void(s.structureChange&&this.nodeUpdateLengthNewStructure(e));c=r.next,a++}else{const i=u,l=this.insertingWalk(i,t,n,r,o,s);if(void 0===l)return void(s.structureChange?this.nodeUpdateLengthNewStructure(e):this.blockUpdateLength(e,o,r));if(l===Bo.theUnfinishedNode){Bo.traceTraversal&&console.log(`@cli ${To(this,this.collabWindow.clientId)} unfinished bus pos ${t} len ${h}`),t-=h;continue}c=l,d=l,a++}break}t-=h}if(Bo.traceTraversal&&!l&&t>0&&console.log(`inserting walk fell through pos ${t} len: ${this.blockLength(this.root,n,r)}`),!c&&0===t){if(-1!==o&&s.continuePredicate&&s.continuePredicate(e))return Bo.theUnfinishedNode;Bo.traceTraversal&&console.log(`@tcli: ${To(this,this.collabWindow.clientId)}: leaf action pos 0`),c=s.leaf(void 0,t,s).next}if(c){for(let t=e.childCount;t>a;t--)e.children[t]=e.children[t-1],e.children[t].index=t;return e.assignChild(c,a,!1),e.childCount++,e.setOrdinal(c,a),e.childCount<8?(d&&(Bo.traceOrdinals&&console.log("split ord "+lo(d.ordinal)),this.nodeUpdateOrdinals(d)),void(s.structureChange?this.nodeUpdateLengthNewStructure(e):this.blockUpdateLength(e,o,r))):this.split(e)}}split(e){const t=this.makeBlock(4);e.childCount=4,this.nodeUpdateOrdinals(e);for(let n=0;n<4;n++)t.assignChild(e.children[4+n],n,!1),e.children[4+n]=void 0;return this.nodeUpdateLengthNewStructure(e),this.nodeUpdateLengthNewStructure(t),t}ordinalIntegrity(){console.log("chk ordnls"),this.nodeOrdinalIntegrity(this.root)}nodeOrdinalIntegrity(e){const t=e.ordinal.length;for(let n=0;n<e.childCount;n++){const r=e.children[n];r.ordinal?(t!==r.ordinal.length-1&&console.log("node integrity issue"),n>0&&r.ordinal<=e.children[n-1].ordinal&&(console.log("node sib integrity issue"),console.log(`??: prnt chld prev ${lo(e.ordinal)} ${lo(r.ordinal)} ${n>0?lo(e.children[n-1].ordinal):"NA"}`)),r.isLeaf()||this.nodeOrdinalIntegrity(r)):(console.log("node child ordinal not set "+n),console.log("??: prnt "+lo(e.ordinal)))}}nodeUpdateOrdinals(e){let t;Bo.traceOrdinals&&console.log("update ordinals for children of node with ordinal "+lo(e.ordinal)),Bo.options.measureOrdinalTime&&(t=xo());for(let t=0;t<e.childCount;t++){const n=e.children[t];e.setOrdinal(n,t),n.isLeaf()||this.nodeUpdateOrdinals(n)}if(t){const e=Oo(t);e>this.maxOrdTime&&(this.maxOrdTime=e),this.ordTime+=e}}addOverlappingClient(e,t){e.removedClientOverlap||(e.removedClientOverlap=[]),Bo.diagOverlappingRemove&&console.log(`added cli ${To(this,t)} to rseq: ${e.removedSeq}`),e.removedClientOverlap.push(t)}annotateRange(e,t,n,r,o,s,i,a){this.ensureIntervalBoundary(e,o,s),this.ensureIntervalBoundary(t,o,s);const u=[],c=-1===i?++this.collabWindow.localSeq:void 0;let d;this.mapRange({leaf:e=>{const t=e.addProperties(n,r,i,this.collabWindow);return u.push({segment:e,propertyDeltas:t}),this.collabWindow.collaborating&&(-1===i?d=this.addToPendingList(e,d,c):Bo.options.zamboniSegments&&this.addToLRUSet(e,i)),!0}},o,s,void 0,e,t),this.mergeTreeDeltaCallback&&this.mergeTreeDeltaCallback(a,{operation:2,deltaSegments:u}),this.collabWindow.collaborating&&-1!==i&&Bo.options.zamboniSegments&&this.zamboniSegments()}markRangeRemoved(e,t,n,r,o,s=!1,i){let a;this.ensureIntervalBoundary(e,n,r),this.ensureIntervalBoundary(t,n,r);const u=[],c=[],d=-1===o?++this.collabWindow.localSeq:void 0;if(this.mapRange({leaf:(e,t,n,i)=>{const l=this.getBranchId(r),h=this.getBranchId(e.clientId);for(let t=l;t<=this.localBranchId;t++){const n=this.getRemovalInfo(t,h,e);void 0!==n.removedSeq?(Bo.diagOverlappingRemove&&console.log(`yump @seq ${o} cli ${To(this,this.collabWindow.clientId)}: overlaps deleted segment ${n.removedSeq} text '${e.toString()}'`),s=!0,-1===n.removedSeq?(n.removedClientId=r,n.removedSeq=o,e.localRemovedSeq=void 0):this.addOverlappingClient(n,r)):(n.removedClientId=r,n.removedSeq=o,e.localRemovedSeq=d,u.push({segment:e}),e.localRefs&&!e.localRefs.empty&&t===this.localBranchId&&c.push(e.localRefs),e.localRefs=void 0)}return this.collabWindow.collaborating&&(-1===this.getRemovalInfo(this.localBranchId,h,e).removedSeq&&r===this.collabWindow.clientId?a=this.addToPendingList(e,a,d):Bo.options.zamboniSegments&&this.addToLRUSet(e,o)),!0},post:(e,t,n,i)=>(s?this.nodeUpdateLengthNewStructure(e):this.blockUpdateLength(e,o,r),!0)},n,r,void 0,e,t),c.length>0){const t=this.getLength(n,r);let o;if(e<t)o=this.getContainingSegment(e,n,r).segment,Object(k.a)(!!o),o.localRefs||(o.localRefs=new Yr(o)),o.localRefs.addBeforeTombstones(...c);else if(t>0)o=this.getContainingSegment(t-1,n,r).segment,Object(k.a)(!!o),o.localRefs||(o.localRefs=new Yr(o)),o.localRefs.addAfterTombstones(...c);else for(const e of c)e.clear();o&&this.blockUpdatePathLengths(o.parent,-2,-1)}this.mergeTreeDeltaCallback&&this.mergeTreeDeltaCallback(i,{operation:1,deltaSegments:u}),this.collabWindow.collaborating&&-1!==o&&Bo.options.zamboniSegments&&this.zamboniSegments()}nodeUpdateLengthNewStructure(e,t=!1){this.blockUpdate(e),this.collabWindow.collaborating&&(e.partialLengths=no.combine(this,e,this.collabWindow,t))}removeLocalReference(e,t){e.localRefs&&e.localRefs.removeLocalRef(t)&&this.blockUpdatePathLengths(e.parent,-2,-1)}addLocalReference(e){const t=e.segment;let n=t.localRefs;n||(n=new Yr(t),t.localRefs=n),n.addLocalRef(e),this.blockUpdatePathLengths(t.parent,-2,-1)}blockUpdate(e){let t=0;const n=e.hierBlock();n&&(n.rightmostTiles=Zr(),n.leftmostTiles=Zr(),n.rangeStacks={});for(let o=0;o<e.childCount;o++){const s=e.children[o];t+=(this,(r=s).isLeaf()?this.localNetLength(r):r.cachedLength),n&&n.addNodeReferences(this,s),this.blockUpdateActions&&this.blockUpdateActions.child(e,o)}var r;e.cachedLength=t}blockUpdatePathLengths(e,t,n,r=!1){let o=e;for(;void 0!==o;)r?this.nodeUpdateLengthNewStructure(o):this.blockUpdateLength(o,t,n),o=o.parent}blockUpdateLength(e,t,n){this.blockUpdate(e),this.collabWindow.collaborating&&-1!==t&&-2!==t&&(void 0!==e.partialLengths&&Bo.options.incrementalUpdate&&-2!==n?e.partialLengths.update(this,e,t,n,this.collabWindow):e.partialLengths=no.combine(this,e,this.collabWindow))}map(e,t,n,r){this.nodeMap(this.root,e,0,t,n,r)}mapRange(e,t,n,r,o,s,i=!1){i&&(o&&this.ensureIntervalBoundary(o,t,n),s&&this.ensureIntervalBoundary(s,t,n)),this.nodeMap(this.root,e,0,t,n,r,o,s)}nodeToString(e,t,n=0){t+=Io(n),t+=`Node (len ${e.cachedLength}) p len (${e.parent?e.parent.cachedLength:0}) ord ${lo(e.ordinal)} with ${e.childCount} segs:\n`,Bo.blockUpdateMarkers&&(t+=Io(n),t+=e.hierToString(n)),this.collabWindow.collaborating&&(t+=Io(n),t+=e.partialLengths.toString(e=>To(this,e),n)+"\n");const r=e.children;for(let o=0;o<e.childCount;o++){const e=r[o];if(e.isLeaf()){const r=e;t+=Io(n+4),t+=`cli: ${To(this,r.clientId)} seq: ${r.seq} ord: ${lo(r.ordinal)}`;const o=this.getBranchId(r.clientId),s=this.localBranchId,i=this.getRemovalInfo(s,o,r);void 0!==i.removedSeq&&(t+=` rcli: ${To(this,i.removedClientId)} rseq: ${i.removedSeq}`),t+="\n",t+=Io(n+4),t+=r.toString(),t+="\n"}else t=this.nodeToString(e,t,n+4)}return t}toString(){return this.nodeToString(this.root,"",0)}incrementalBlockMap(e){for(;!e.empty();){const t=e.top();if(t.op!==wo.Go)return;if(0===t.childIndex&&(void 0===t.start&&(t.start=0),void 0===t.end&&(t.end=this.blockLength(t.block,t.refSeq,t.clientId)),t.actions.pre&&t.actions.pre(t)),t.op===wo.Go&&t.childIndex<t.block.childCount){const n=t.block.children[t.childIndex],r=this.nodeLength(n,t.refSeq,t.clientId);if(Bo.traceIncrTraversal&&n.isLeaf()&&console.log(`considering (r ${t.refSeq} c ${To(this,t.clientId)}) seg with text ${n.text} len ${r} seq ${n.seq} rseq ${n.removedSeq} cli ${To(this,n.clientId)}`),r>0&&t.start<r&&t.end>0)if(n.isLeaf())Bo.traceIncrTraversal&&console.log("action on seg with text "+n.text),t.actions.leaf(n,t);else{const r=new ko(n,t.actions,t.pos,t.refSeq,t.clientId,t.context,t.start,t.end,0);e.push(r)}t.pos+=r,t.start-=r,t.end-=r,t.childIndex++}else t.childIndex===t.block.childCount&&(t.op===wo.Go&&t.actions.post&&t.actions.post(t),e.pop())}}nodeMap(e,t,n,r,o,s,i,a){void 0===i&&(i=0),void 0===a&&(a=this.blockLength(e,r,o));let u=!0;if(t.pre&&(u=t.pre(e,n,r,o,i,a,s),!u))return!0;const c=e.children;for(let d=0;d<e.childCount;d++){const e=c[d],l=this.nodeLength(e,r,o);if(Bo.traceTraversal){let t;if(!e.isLeaf()&&this.collabWindow.collaborating)t="minLength: "+e.partialLengths.minLength;else{const n=e;t=`cli: ${To(this,n.clientId)} seq: ${n.seq} text: '${n.toString()}'`,void 0!==n.removedSeq&&(t+=` rcli: ${To(this,n.removedClientId)} rseq: ${n.removedSeq}`)}console.log(`@tcli ${To(this,this.collabWindow.clientId)}: map len: ${l} start: ${i} end: ${a} ${t}`)}if(u&&a>0&&l>0&&i<l&&(e.isLeaf()?(Bo.traceTraversal&&console.log(`@tcli ${To(this,this.collabWindow.clientId)}: map leaf action`),t.leaf&&(u=t.leaf(e,n,r,o,i,a,s))):u&&(u=this.nodeMap(e,t,n,r,o,s,i,a))),!u)break;t.shift&&t.shift(e,n,r,o,i,a,s),n+=l,i-=l,a-=l}return u&&t.post&&(u=t.post(e,n,r,o,i,a,s)),u}walkAllSegments(e,t,n){let r=!0;const o=e.children;for(let s=0;r&&s<e.childCount;s++){const e=o[s];r=e.isLeaf()?t(e,n):this.walkAllSegments(e,t,n)}return r}nodeMapReverse(e,t,n,r,o){let s=!0;const i=e.children;for(let a=e.childCount-1;a>=0;a--){const e=i[a];if(s&&(e.isLeaf()?s=t(e,n,r,o,0,0,void 0):s&&(s=this.nodeMapReverse(e,t,n,r,o))),!s)break}return s}}function qo(e,t,n,r){return{combiningOp:r,pos1:e,pos2:t,props:n,type:2}}function zo(e,t,n){return{pos1:e,pos2:t,register:n,type:1}}function Ho(e,t){return Uo(e,t.toJSONObject())}function Uo(e,t){return{pos1:e,seg:t,type:0}}function Vo(...e){return{ops:e,type:3}}function $o(e,t,n,r,o,s){let i;switch(void 0!==t.version&&n.send({eventName:"MergeTreeChunk:serializeAsMinSupportedVersion",category:"generic",fromChunkVersion:t.version,toChunkVersion:void 0}),t.version){case void 0:i=t,i.headerMetadata=Go(e,i,r);break;case"1":const n=t,o=e===Jo.header?n.headerMetadata:void 0;i={version:void 0,chunkStartSegmentIndex:n.startIndex,chunkLengthChars:n.length,chunkSegmentCount:n.segmentCount,segmentTexts:n.segments,totalLengthChars:null==o?void 0:o.totalLength,totalSegmentCount:null==o?void 0:o.totalSegmentCount,chunkSequenceNumber:null==o?void 0:o.sequenceNumber,chunkMinSequenceNumber:null==o?void 0:o.minSequenceNumber,headerMetadata:o};break;default:throw new Error(`Unsupported chunk path: ${e} version: ${t.version}`)}return o.stringify(i,s)}function Wo(e,t,n,r,o,s){const i=Ko(e,t,n,r);return o.stringify(i,s)}function Ko(e,t,n,r){switch(t.version){case void 0:{const n=t;return{version:"1",length:n.chunkLengthChars,segmentCount:n.chunkSegmentCount,headerMetadata:Go(e,n,r),segments:n.segmentTexts,startIndex:n.chunkStartSegmentIndex}}case"1":return t;default:throw new Error(`Unsupported chunk path: ${e} version: ${t.version}`)}}function Go(e,t,n){if(e===Jo.header){if(void 0!==t.headerMetadata)return t.headerMetadata;const e=[{id:Jo.header}];return t.chunkLengthChars<t.totalLengthChars&&e.push({id:Jo.body}),{orderedChunkMetadata:e,minSequenceNumber:t.chunkMinSequenceNumber,sequenceNumber:t.chunkSequenceNumber,totalLength:t.totalLengthChars,totalSegmentCount:t.totalSegmentCount}}}Bo.TextSegmentGranularity=256,Bo.zamboniSegmentsMaxCount=2,Bo.options={incrementalUpdate:!0,insertAfterRemovedSegs:!0,measureOrdinalTime:!0,measureWindowTime:!0,zamboniSegments:!0},Bo.traceAppend=!1,Bo.traceZRemove=!1,Bo.traceOrdinals=!1,Bo.traceGatherText=!1,Bo.diagInsertTie=!1,Bo.skipLeftShift=!0,Bo.diagOverlappingRemove=!1,Bo.traceTraversal=!1,Bo.traceIncrTraversal=!1,Bo.theUnfinishedNode={childCount:-1},Bo.blockUpdateMarkers=!0;class Jo{constructor(e,t,n,r){var o,s;this.mergeTree=e,this.filename=n,this.onCompletion=r,this.logger=p.a.create(t,"Snapshot"),this.chunkSize=null!==(s=null===(o=null==e?void 0:e.options)||void 0===o?void 0:o.mergeTreeSnapshotChunkSize)&&void 0!==s?s:Jo.sizeOfFirstChunk}getSeqLengthSegs(e,t,n,r=0){const o=[];let s=0,i=0;for(;s<n&&r+i<e.length;){const n=e[r+i];o.push(n),s+=t[r+i],i++}return{version:void 0,chunkStartSegmentIndex:r,chunkSegmentCount:i,chunkLengthChars:s,totalLengthChars:this.header.segmentsTotalLength,totalSegmentCount:e.length,chunkSequenceNumber:this.header.seq,segmentTexts:o}}emit(e,t,n){var r,o;const s=this.getSeqLengthSegs(this.segments,this.segmentLengths,this.chunkSize);let i=s.chunkLengthChars,a=s.chunkSegmentCount;const u={entries:[{mode:B.a.File,path:Jo.header,type:B.b.Blob,value:{contents:$o(Jo.header,s,this.logger,this.mergeTree.options,t,n),encoding:"utf-8"}}]};if(s.chunkSegmentCount<s.totalSegmentCount){const e=this.getSeqLengthSegs(this.segments,this.segmentLengths,this.header.segmentsTotalLength,s.chunkSegmentCount);i+=e.chunkLengthChars,a+=e.chunkSegmentCount,u.entries.push({mode:B.a.File,path:Jo.body,type:B.b.Blob,value:{contents:$o(Jo.body,e,this.logger,this.mergeTree.options,t,n),encoding:"utf-8"}})}return this.logger.shipAssert(i===this.header.segmentsTotalLength,{eventName:"emit: mismatch in segmentsTotalLength"}),this.logger.shipAssert(a===s.totalSegmentCount,{eventName:"emit: mismatch in totalSegmentCount"}),void 0!==e&&e.length>0&&u.entries.push({mode:B.a.File,path:null!==(o=null===(r=this.mergeTree.options)||void 0===r?void 0:r.catchUpBlobName)&&void 0!==o?o:Jo.catchupOps,type:B.b.Blob,value:{contents:t?t.stringify(e,n):JSON.stringify(e),encoding:"utf-8"}}),u}extractSync(){const e=this.mergeTree.getCollabWindow();this.seq=e.minSeq,this.header={segmentsTotalLength:this.mergeTree.getLength(this.mergeTree.collabWindow.minSeq,-2),seq:this.mergeTree.collabWindow.minSeq};const t=[];let n;this.mergeTree.map({leaf:(e,r,o,s,i,a)=>(-1!=e.seq&&e.seq<=this.seq&&(void 0===e.removedSeq||-1==e.removedSeq||e.removedSeq>this.seq)&&(n&&n.canAppend(e)&&Kr(n.properties,e.properties)?(n=n.clone(),n.append(e.clone())):(n&&t.push(n),n=e)),!0)},this.seq,-2,void 0),n&&t.push(n),this.segments=[],this.segmentLengths=[];let r=0;return t.map(e=>{r+=e.cachedLength,this.segments.push(e.toJSONObject()),this.segmentLengths.push(e.cachedLength)}),this.header.segmentsTotalLength!=r&&(this.logger.sendErrorEvent({eventName:"SegmentsTotalLengthMismatch",totalLength:r,segmentsTotalLength:this.header.segmentsTotalLength}),this.header.segmentsTotalLength=r),this.segments}}Jo.header="header",Jo.body="body",Jo.catchupOps="catchupOps",Jo.sizeOfFirstChunk=1e4;class Zo{constructor(e,t,n,r){var o,s;this.mergeTree=e,this.filename=n,this.onCompletion=r,this.logger=p.a.create(t,"Snapshot"),this.chunkSize=null!==(s=null===(o=null==e?void 0:e.options)||void 0===o?void 0:o.mergeTreeSnapshotChunkSize)&&void 0!==s?s:Zo.chunkSize;const{currentSeq:i,minSeq:a}=e.getCollabWindow();this.header={minSequenceNumber:a,sequenceNumber:i,orderedChunkMetadata:[],totalLength:0,totalSegmentCount:0},this.segments=[],this.segmentLengths=[]}getSeqLengthSegs(e,t,n,r=0){const o=[];let s=0,i=0;for(;s<n&&r+i<e.length;){const n=e[r+i];o.push(n),s+=t[r+i],i++}return{version:"1",segmentCount:i,length:s,segments:o,startIndex:r,headerMetadata:void 0}}emit(e,t){const n=[];this.header.totalSegmentCount=0,this.header.totalLength=0;do{const e=this.getSeqLengthSegs(this.segments,this.segmentLengths,this.chunkSize,this.header.totalSegmentCount);n.push(e),this.header.totalSegmentCount+=e.segmentCount,this.header.totalLength+=e.length}while(this.header.totalSegmentCount<this.segments.length);const r=n.shift();r.headerMetadata=this.header,r.headerMetadata.orderedChunkMetadata=[{id:Jo.header}];const o=n.map((n,r)=>{const o=`${Jo.body}_${r}`;return this.header.orderedChunkMetadata.push({id:o}),{mode:B.a.File,path:o,type:B.b.Blob,value:{contents:Wo(o,n,this.logger,this.mergeTree.options,e,t),encoding:"utf-8"}}});return{entries:[{mode:B.a.File,path:Jo.header,type:B.b.Blob,value:{contents:Wo(Jo.header,r,this.logger,this.mergeTree.options,e,t),encoding:"utf-8"}},...o]}}extractSync(){const e=this.mergeTree,t=this.header.minSequenceNumber,n=(e,t)=>{this.segments.push(e),this.segmentLengths.push(t)},r=e=>{e&&n(e.toJSONObject(),e.cachedLength)};let o;return e.walkAllSegments(e.root,s=>{if(-1===s.seq||s.removedSeq<=t)return!0;if(s.seq<=t&&(void 0===s.removedSeq||-1===s.removedSeq))o?o.canAppend(s)&&Kr(o.properties,s.properties)?(o=o.clone(),o.append(s.clone())):(r(o),o=s):o=s;else{r(o),o=void 0;const i={json:s.toJSONObject()};s.seq>t&&(i.seq=s.seq,i.client=e.getLongClientId(s.clientId)),void 0!==s.removedSeq&&(Object(k.a)(-1!==s.removedSeq&&s.removedSeq>t),i.removedSeq=s.removedSeq,i.removedClient=e.getLongClientId(s.removedClientId)),Object(k.a)(void 0!==i.seq&&void 0!==i.client||void 0!==i.removedSeq&&void 0!==i.removedClient),n(i,s.cachedLength)}return!0},this),r(o),this.segments}static async loadChunk(e,t,n,r,o){const s=await e.readBlob(t),i=Object(ae.c)(s,"utf8");return Zo.processChunk(t,i,n,r,o)}static processChunk(e,t,n,r,o){return Ko(e,o?o.parse(t):JSON.parse(t),0,r)}}Zo.chunkSize=1e4;class Xo{constructor(e,t,n,r,o){this.runtime=e,this.client=t,this.mergeTree=n,this.serializer=o,this.specToSegment=e=>{let t;return function(e){return!!e&&"object"==typeof e&&"json"in e}(e)?(t=this.client.specToSegment(e.json),t.clientId=void 0!==e.client?this.client.getOrAddShortClientId(e.client):-2,t.seq=void 0!==e.seq?e.seq:0,void 0!==e.removedSeq&&(t.removedSeq=e.removedSeq),void 0!==e.removedClient&&(t.removedClientId=this.client.getOrAddShortClientId(e.removedClient))):(t=this.client.specToSegment(e),t.seq=0,t.clientId=-2),t},this.logger=p.a.create(r,"SnapshotLoader")}async initialize(e){const t=e.readBlob(Jo.header).then(e=>(Object(k.a)(!!e),this.loadHeader(Object(ae.c)(e,"utf8")))),n=this.loadBodyAndCatchupOps(t,e);return n.catch(e=>this.logger.sendErrorEvent({eventName:"CatchupOpsLoadFailure"},e)),await t,{catchupOpsP:n}}async loadBodyAndCatchupOps(e,t){const n=t.list(""),r=await e;await this.loadBody(r,t);const o=await n;if(o.length===r.headerMetadata.orderedChunkMetadata.length+1)return r.headerMetadata.orderedChunkMetadata.forEach(e=>o.splice(o.indexOf(e.id),1)),Object(k.a)(1===o.length,"There should be only one blob with catch up ops: "+o.length),this.loadCatchupOps(t.readBlob(o[0]));if(o.length!==r.headerMetadata.orderedChunkMetadata.length)throw new Error("Unexpected blobs in snapshot");return[]}loadHeader(e){var t;const n=Zo.processChunk(Jo.header,e,this.logger,this.mergeTree.options,this.serializer),r=n.segments.map(this.specToSegment);if(this.mergeTree.reloadFromSegments(r),void 0===n.headerMetadata)throw new Error("header metadata not available");return this.runtime.attachState!==j.Detached&&this.client.startOrUpdateCollaboration(null!==(t=this.runtime.clientId)&&void 0!==t?t:"snapshot",void 0!==n.headerMetadata.minSequenceNumber?n.headerMetadata.minSequenceNumber:n.headerMetadata.sequenceNumber,n.headerMetadata.sequenceNumber),n}async loadBody(e,t){if(this.runtime.logger.shipAssert(e.length<=e.headerMetadata.totalLength,{eventName:"Mismatch in totalLength"}),this.runtime.logger.shipAssert(e.segmentCount<=e.headerMetadata.totalSegmentCount,{eventName:"Mismatch in totalSegmentCount"}),e.segmentCount===e.headerMetadata.totalSegmentCount)return;const n=[];let r=e.length;for(let o=1;o<e.headerMetadata.orderedChunkMetadata.length;o++){const s=await Zo.loadChunk(t,e.headerMetadata.orderedChunkMetadata[o].id,this.logger,this.mergeTree.options,this.serializer);r+=s.length,n.push(...s.segments.map(this.specToSegment))}this.runtime.logger.shipAssert(r===e.headerMetadata.totalLength,{eventName:"Mismatch in totalLength"}),this.runtime.logger.shipAssert(e.segmentCount+n.length===e.headerMetadata.totalSegmentCount,{eventName:"Mismatch in totalSegmentCount"});const o=this.mergeTree,s=(e,t,n)=>{o.insertSegments(o.root.cachedLength,e,0,t,n,void 0)},i=[],a=()=>{i.length>0&&s(i,-2,0)};for(const e of n){const t=e.clientId,n=e.seq;-2===t&&0===n?i.push(e):(a(),s([e],t,n))}a()}async loadCatchupOps(e){return JSON.parse(Object(ae.c)(await e,"utf8"))}}class Yo extends mo{constructor(e){super(),this.text=e,this.type=Yo.type,this.cachedLength=e.length}static is(e){return e.type===Yo.type}static make(e,t){const n=new Yo(e);return t&&n.addProperties(t),n}static fromJSONObject(e){if("string"==typeof e)return new Yo(e);if(e&&"object"==typeof e&&"text"in e){const t=e;return Yo.make(t.text,t.props)}}toJSONObject(){return this.properties?{text:this.text,props:this.properties}:this.text}clone(e=0,t){const n=this.text.substring(e,t),r=Yo.make(n,this.properties);return this.cloneInto(r),r}canAppend(e){return!this.text.endsWith("\n")&&Yo.is(e)&&(this.cachedLength<=Bo.TextSegmentGranularity||e.cachedLength<=Bo.TextSegmentGranularity)}toString(){return this.text}append(e){if(!Yo.is(e))throw new Error("can only append text segment");Yr.append(this,e),this.text+=e.text,this.cachedLength=this.text.length}removeRange(e,t){let n="";const r=this.text.length;return e>0&&(n+=this.text.substring(0,e)),t<r&&(n+=this.text.substring(t)),this.text=n,this.cachedLength=n.length,0===n.length}createSplitSegmentAt(e){if(e>0){const t=this.text.substring(e);return this.text=this.text.substring(0,e),this.cachedLength=this.text.length,new Yo(t)}}}function Qo(e){return!0===e.parallelArrays}Yo.type="TextSegment";class es{constructor(e){this.mergeTree=e,this.gatherText=(e,t,n,r,o,s,i)=>{if(Yo.is(e)){Bo.traceGatherText&&console.log(`@cli ${this.mergeTree.getLongClientId(this.mergeTree.collabWindow.clientId)} gather seg seq ${e.seq} rseq ${e.removedSeq} text ${e.text}`);let t="",n="";if(Qo(i)){const r=[],o=[];e.properties&&e.properties["font-weight"]&&r.push("b"),e.properties&&e.properties["text-decoration"]&&r.push("u");const s=[];if(r.length>0){for(const e of r)i.tagsInProgress.includes(e)||(t+=`<${e}>`,o.push(e));for(const e of i.tagsInProgress)r.includes(e)||(n+=`</${e}>`,s.push(e));for(const e of o.reverse())i.tagsInProgress.push(e)}else for(const e of i.tagsInProgress)n+=`</${e}>`,s.push(e);for(const e of s){const t=i.tagsInProgress.indexOf(e);t>=0&&i.tagsInProgress.splice(t,1)}}i.textSegment.text+=n,i.textSegment.text+=t,o<=0&&s>=e.text.length?i.textSegment.text+=e.text:(o<0&&(o=0),s>=e.text.length?i.textSegment.text+=e.text.substring(o):i.textSegment.text+=e.text.substring(o,s))}else if(i.placeholder&&i.placeholder.length>0)if("*"===i.placeholder){const t=e;i.textSegment.text+="\n"+t.toString()}else for(let t=0;t<e.cachedLength;t++)i.textSegment.text+=i.placeholder;else if(Qo(i)){const t=e;t.hasTileLabel(i.parallelMarkerLabel)&&(i.parallelMarkers.push(t),i.parallelText.push(i.textSegment.text),i.textSegment.text="")}return!0}}getTextAndMarkers(e,t,n,r,o){const s=this.getValidRange(r,o,e,t),i={parallelArrays:!0,parallelMarkerLabel:n,parallelMarkers:[],parallelText:[],tagsInProgress:[],textSegment:new Yo("")};return Bo.traceGatherText&&console.log(`get text on cli ${To(this.mergeTree,this.mergeTree.collabWindow.clientId)} ref cli ${To(this.mergeTree,t)} refSeq ${e}`),this.mergeTree.mapRange({leaf:this.gatherText},e,t,i,s.start,s.end),{parallelText:i.parallelText,parallelMarkers:i.parallelMarkers}}getText(e,t,n="",r,o){const s=this.getValidRange(r,o,e,t),i={textSegment:new Yo(""),placeholder:n};return Bo.traceGatherText&&console.log(`get text on cli ${To(this.mergeTree,this.mergeTree.collabWindow.clientId)} ref cli ${To(this.mergeTree,t)} refSeq ${e}`),this.mergeTree.mapRange({leaf:this.gatherText},e,t,i,s.start,s.end),i.textSegment.text}getValidRange(e,t,n,r){return{end:null!=t?t:this.mergeTree.getLength(n,r),start:null!=e?e:0}}}class ts{constructor(e,t,n){this.specToSegment=e,this.logger=t,this.verboseOps=!1,this.noVerboseRemoteAnnotate=!1,this.measureOps=!1,this.registerCollection=new Ao,this.accumTime=0,this.localTime=0,this.localOps=0,this.accumWindowTime=0,this.accumWindow=0,this.accumOps=0,this.maxWindowTime=0,this.clientNameToIds=new zr(Co),this.shortClientIdMap=[],this.shortClientBranchIdMap=[],this.pendingConsensus=new Map,this.mergeTree=new Bo(n),this.mergeTree.getLongClientId=e=>this.getLongClientId(e),this.mergeTree.clientIdToBranchId=this.shortClientBranchIdMap}get mergeTreeDeltaCallback(){return this.mergeTree.mergeTreeDeltaCallback}set mergeTreeDeltaCallback(e){this.mergeTree.mergeTreeDeltaCallback=e}get mergeTreeMaintenanceCallback(){return this.mergeTree.mergeTreeMaintenanceCallback}set mergeTreeMaintenanceCallback(e){this.mergeTree.mergeTreeMaintenanceCallback=e}peekPendingSegmentGroups(e=1){var t,n;if(1===e)return null===(t=this.mergeTree.pendingSegments)||void 0===t?void 0:t.last();let r=0;return null===(n=this.mergeTree.pendingSegments)||void 0===n?void 0:n.some(()=>r<e&&(r++,!0),!0)}annotateMarkerNotifyConsensus(e,t,n){const r=this.annotateMarker(e,t,{name:"consensus"});if(r){const t={callback:n,marker:e};return this.pendingConsensus.set(e.getId(),t),r}}annotateMarker(e,t,n){const r=function(e,t,n){const r=e.getId();if(r)return{combiningOp:n,props:t,relativePos1:{id:r,before:!0},relativePos2:{id:r},type:2}}(e,t,n);return this.applyAnnotateRangeOp({op:r})?r:void 0}annotateRangeLocal(e,t,n,r){const o=qo(e,t,n,r);if(this.applyAnnotateRangeOp({op:o}))return o}removeRangeLocal(e,t,n){const r=zo(e,t,n);if(this.applyRemoveRangeOp({op:r}))return r}insertSegmentLocal(e,t){if(t.cachedLength<=0)return;const n=Ho(e,t);return this.applyInsertOp({op:n})?n:void 0}insertAtReferencePositionLocal(e,t){const n=this.mergeTree.referencePositionToLocalPosition(e,this.getCurrentSeq(),this.getClientId());if(n===Xr.DetachedPosition)return;const r=Ho(n,t),o={op:r};let s;return this.measureOps&&(s=hn.a.start()),this.mergeTree.insertAtReferencePosition(e,t,o),this.completeAndLogOp(o,this.getClientSequenceArgs(o),{start:r.pos1},s),r}pasteLocal(e,t){const n=function(e,t){return{pos1:e,register:t,type:0}}(e,t);if(this.applyInsertOp({op:n}))return n}copyLocal(e,t,n){const r=function(e,t,n){return{pos1:e,pos2:t,register:n,type:0}}(e,t,n);if(this.applyInsertOp({op:r}))return r}walkSegments(e,t,n,r,o=!1){this.mergeTree.mapRange({leaf:e},this.getCurrentSeq(),this.getClientId(),r,t,n,o)}getCollabWindow(){return this.mergeTree.getCollabWindow()}getPosition(e){return void 0===(null==e?void 0:e.parent)?-1:this.mergeTree.getPosition(e,this.getCurrentSeq(),this.getClientId())}addLocalReference(e){return this.mergeTree.addLocalReference(e)}removeLocalReference(e){return this.mergeTree.removeLocalReference(e.segment,e)}posFromRelativePos(e){return this.mergeTree.posFromRelativePos(e)}getMarkerFromId(e){return this.mergeTree.getMarkerFromId(e)}applyRemoveRangeOp(e){Object(k.a)(1===e.op.type);const t=e.op,n=this.getClientSequenceArgs(e),r=this.getValidOpRange(t,n);if(!r)return!1;let o;return t.register&&this.copy(r,t.register,n),this.measureOps&&(o=hn.a.start()),this.mergeTree.markRangeRemoved(r.start,r.end,n.referenceSequenceNumber,n.clientId,n.sequenceNumber,!1,e),this.completeAndLogOp(e,n,r,o),!0}applyAnnotateRangeOp(e){Object(k.a)(2===e.op.type);const t=e.op,n=this.getClientSequenceArgs(e),r=this.getValidOpRange(t,n);if(!r)return!1;let o;return this.measureOps&&(o=hn.a.start()),this.mergeTree.annotateRange(r.start,r.end,t.props,t.combiningOp,n.referenceSequenceNumber,n.clientId,n.sequenceNumber,e),this.completeAndLogOp(e,n,r,o),!0}applyInsertOp(e){Object(k.a)(0===e.op.type);const t=e.op,n=this.getClientSequenceArgs(e),r=this.getValidOpRange(t,n);if(!r)return!1;let o,s;if(t.seg)o=[this.specToSegment(t.seg)];else if(t.register){if(r.end)return this.copy(r,t.register,n),-1===n.sequenceNumber&&this.mergeTree.pendingSegments.enqueue({segments:[],localSeq:this.getCollabWindow().localSeq}),!0;o=this.registerCollection.get(this.getLongClientId(n.clientId),t.register)}return!(!o||0===o.length||(this.measureOps&&(s=hn.a.start()),this.mergeTree.insertSegments(r.start,o,n.referenceSequenceNumber,n.clientId,n.sequenceNumber,e),this.completeAndLogOp(e,n,r,s),0))}completeAndLogOp(e,t,n,r){e.sequencedMessage?(Object(k.a)(this.mergeTree.getCollabWindow().currentSeq<t.sequenceNumber,"Incoming remote op sequence# <= local collabWindow's currentSequence#"),Object(k.a)(this.mergeTree.getCollabWindow().minSeq<=e.sequencedMessage.minimumSequenceNumber,"Incoming remote op minSequence# < local collabWindow's minSequence#"),r&&(this.accumTime+=Oo(r),this.accumOps++,this.accumWindow+=this.getCurrentSeq()-this.getCollabWindow().minSeq)):r&&(this.localTime+=Oo(r),this.localOps++),!this.verboseOps||e.sequencedMessage&&this.noVerboseRemoteAnnotate||console.log(`@cli ${this.getLongClientId(this.getCollabWindow().clientId)} seq ${t.sequenceNumber} ${e.op.type} local ${!e.sequencedMessage} start ${n.start} end ${n.end} refseq ${t.referenceSequenceNumber} cli ${t.clientId}`)}getValidOpRange(e,t){let n=e.pos1;void 0===n&&e.relativePos1&&(n=this.mergeTree.posFromRelativePos(e.relativePos1,t.referenceSequenceNumber,t.clientId));let r=e.pos2;if(void 0===r&&e.relativePos2&&(r=this.mergeTree.posFromRelativePos(e.relativePos2,t.referenceSequenceNumber,t.clientId)),t.clientId===this.getClientId()){const o=this.getLength(),s=[];if((void 0===n||n<0||n>o||n===o&&0!==e.type)&&s.push("start"),0===e.type&&void 0===r||(void 0===r||r<=n)&&s.push("end"),s.length>0)return void this.logger.sendErrorEvent({currentSeq:this.getCurrentSeq(),end:r,eventName:"InvalidOpRange",invalidPositions:s.toString(),length:o,opPos1:e.pos1,opPos1Relative:void 0!==e.relativePos1,opPos2:e.pos2,opPos2Relative:void 0!==e.relativePos2,opRefSeq:t.referenceSequenceNumber,opSeq:t.sequenceNumber,opType:e.type,start:n})}return{start:n,end:r}}getClientSequenceArgs(e){if(e.sequencedMessage)return{clientId:this.getShortClientId(e.sequencedMessage.clientId),referenceSequenceNumber:e.sequencedMessage.referenceSequenceNumber,sequenceNumber:e.sequencedMessage.sequenceNumber};{const e=this.getCollabWindow();return{clientId:e.clientId,referenceSequenceNumber:e.currentSeq,sequenceNumber:this.getLocalSequenceNumber()}}}copy(e,t,n){const r=this.mergeTree.cloneSegments(n.referenceSequenceNumber,n.clientId,e.start,e.end);this.registerCollection.set(this.getLongClientId(n.clientId),t,r)}ackPendingSegment(e){const t=e=>{var t;let n;this.measureOps&&(n=hn.a.start()),this.mergeTree.ackPendingSegment(e,this.verboseOps),2===e.op.type&&e.op.combiningOp&&"consensus"===e.op.combiningOp.name&&this.updateConsensusProperty(e.op,e.sequencedMessage),n&&(this.accumTime+=Oo(n),this.accumOps++,this.accumWindow+=this.getCurrentSeq()-this.getCollabWindow().minSeq),this.verboseOps&&console.log(`@cli ${this.getLongClientId(this.getCollabWindow().clientId)} ack seq # ${null===(t=e.sequencedMessage)||void 0===t?void 0:t.sequenceNumber}`)};if(3===e.op.type)for(const n of e.op.ops)t({groupOp:e.op,op:n,sequencedMessage:e.sequencedMessage});else t(e)}cloneFromSegments(){const e=new ts(this.specToSegment,this.logger,this.mergeTree.options),t=this.mergeTree.blockClone(this.mergeTree.root,[]);return e.mergeTree.root=t,e}getOrAddShortClientId(e,t=0){return this.clientNameToIds.get(e)||this.addLongClientId(e,t),this.getShortClientId(e)}getShortClientId(e){return this.clientNameToIds.get(e).data.clientId}getLongClientId(e){return e>=0?this.shortClientIdMap[e]:"original"}addLongClientId(e,t=0){this.clientNameToIds.put(e,{branchId:t,clientId:this.shortClientIdMap.length}),this.shortClientIdMap.push(e),this.shortClientBranchIdMap.push(t)}getBranchId(e){return this.shortClientBranchIdMap[e]}findReconnectionPostition(e,t){Object(k.a)(t<=this.mergeTree.collabWindow.localSeq,"localSeq greater than collab window");let n=0;return this.mergeTree.walkAllSegments(this.mergeTree.root,r=>r!==e&&((void 0===r.localSeq||r.localSeq<=t)&&(void 0===r.removedSeq||r.localRemovedSeq>t)&&(n+=r.cachedLength),!0)),n}resetPendingDeltaToOps(e,t){var n,r;Object(k.a)(!!t,"Segment group undefined");const o=null===(n=this.mergeTree.pendingSegments)||void 0===n?void 0:n.dequeue();Object(k.a)(t===o,"Segment group not at head of merge tree pending queue");const s=[];for(const n of t.segments.sort((e,t)=>e.ordinal<t.ordinal?-1:1)){const o=n.segmentGroups.dequeue();Object(k.a)(t===o,"Segment group not at head of segment pending queue");const i=this.findReconnectionPostition(n,t.localSeq);let a;switch(e.type){case 2:Object(k.a)(!0===(null===(r=n.propertyManager)||void 0===r?void 0:r.hasPendingProperties()),"Segment has no pending properties"),a=qo(i,i+n.cachedLength,e.props,e.combiningOp);break;case 0:Object(k.a)(-1===n.seq),a=Ho(i,n);break;case 1:void 0!==n.localRemovedSeq&&(a=zo(i,i+n.cachedLength));break;default:throw new Error("Invalid op type")}if(a){const e={segments:[],localSeq:t.localSeq};n.segmentGroups.enqueue(e),this.mergeTree.pendingSegments.enqueue(e),s.push(a)}}return s}applyRemoteOp(e){const t=e.op,n=e.sequencedMessage;switch(this.getOrAddShortClientId(n.clientId),t.type){case 0:this.applyInsertOp(e);break;case 1:this.applyRemoveRangeOp(e);break;case 2:this.applyAnnotateRangeOp(e);break;case 3:for(const e of t.ops)this.applyRemoteOp({op:e,groupOp:t,sequencedMessage:n})}}applyMsg(e){var t;const n=e.origin?0:this.mergeTree.localBranchId;if(this.getOrAddShortClientId(e.clientId,n),e.type===q.a.Operation){const n={op:e.contents,sequencedMessage:e};(null===(t=n.sequencedMessage)||void 0===t?void 0:t.clientId)===this.longClientId?this.ackPendingSegment(n):this.applyRemoteOp(n)}this.updateSeqNumbers(e.minimumSequenceNumber,e.sequenceNumber)}updateSeqNumbers(e,t){const n=this.mergeTree.getCollabWindow();Object(k.a)(n.currentSeq<=t,"Incoming op sequence# < local collabWindow's currentSequence#"),n.currentSeq=t,Object(k.a)(e<=t,"Incoming op sequence# < minSequence#"),this.updateMinSeq(e)}resolveRemoteClientPosition(e,t,n){const r=this.getOrAddShortClientId(n);return this.mergeTree.resolveRemoteClientPosition(e,t,r)}regeneratePendingOp(e,t){const n=hn.a.start();try{const r=[];if(3===e.type)if(Array.isArray(t)){Object(k.a)(e.ops.length===t.length,"Number of ops in 'resetOp' must match the number of segment groups provided.");for(let n=0;n<e.ops.length;n++)r.push(...this.resetPendingDeltaToOps(e.ops[n],t[n]))}else Object(k.a)(1===e.ops.length,"Number of ops in 'resetOp' must match the number of segment groups provided."),r.push(...this.resetPendingDeltaToOps(e.ops[0],t));else Object(k.a)(3!==e.type),Object(k.a)(!Array.isArray(t)),r.push(...this.resetPendingDeltaToOps(e,t));return 1===r.length?r[0]:Vo(...r)}finally{this.logger.sendPerformanceEvent({eventName:"MergeTree:RegeneratePendingOp",category:"performance",duration:Oo(n)})}}createTextHelper(){return new es(this.mergeTree)}snapshot(e,t,n,r){var o;const s=e.deltaManager,i=s.minimumSequenceNumber;if(this.updateSeqNumbers(i,s.lastSequenceNumber),Object(k.a)(this.getCollabWindow().minSeq===i),!0===(null===(o=this.mergeTree.options)||void 0===o?void 0:o.newMergeTreeSnapshotFormat)){Object(k.a)(void 0===r||0===r.length,"New format should not emit catchup ops");const e=new Zo(this.mergeTree,this.logger);return e.extractSync(),e.emit(n,t)}{const e=new Jo(this.mergeTree,this.logger);return e.extractSync(),e.emit(r,n,t)}}async load(e,t,n){return new Xo(e,this,this.mergeTree,this.logger,n).initialize(t)}getStackContext(e,t){return this.mergeTree.getStackContext(e,this.getCollabWindow().clientId,t)}getLocalSequenceNumber(){return this.getCollabWindow().collaborating?-1:0}localTransaction(e){for(const t of e.ops){const n={op:t,groupOp:e};switch(t.type){case 0:this.applyInsertOp(n);break;case 2:this.applyAnnotateRangeOp(n);break;case 1:this.applyRemoveRangeOp(n)}}}updateConsensusProperty(e,t){const n=e.relativePos1.id,r=this.pendingConsensus.get(n);r&&r.marker.addProperties(e.props,e.combiningOp,t.sequenceNumber),this.mergeTree.addMinSeqListener(t.sequenceNumber,()=>r.callback(r.marker))}updateMinSeq(e){let t;if(this.measureOps&&(t=hn.a.start()),this.mergeTree.setMinSeq(e),t){const e=Oo(t);this.accumWindowTime+=e,e>this.maxWindowTime&&(this.maxWindowTime=e)}}getContainingSegment(e){const t=this.mergeTree.getCollabWindow();return this.mergeTree.getContainingSegment(e,t.currentSeq,t.clientId)}getPropertiesAtPosition(e){const t=this.getCollabWindow();let n;this.verboseOps&&console.log(`getPropertiesAtPosition cli ${this.getLongClientId(t.clientId)} ref seq ${t.currentSeq}`);const r=this.getContainingSegment(e).segment;return r&&(n=r.properties),n}getRangeExtentsOfPosition(e){const t=this.getCollabWindow();let n,r;this.verboseOps&&console.log(`getRangeExtentsOfPosition cli ${this.getLongClientId(t.clientId)} ref seq ${t.currentSeq}`);const o=this.getContainingSegment(e).segment;return o&&(n=this.getPosition(o),r=n+o.cachedLength),{posStart:n,posAfterEnd:r}}getCurrentSeq(){return this.getCollabWindow().currentSeq}getClientId(){return this.getCollabWindow().clientId}getLength(){return this.mergeTree.length}startOrUpdateCollaboration(e,t=0,n=0,r=0){if(void 0!==e)if(void 0===this.longClientId)this.longClientId=e,this.addLongClientId(this.longClientId,r),this.mergeTree.startCollaboration(this.getShortClientId(this.longClientId),t,n,r);else{const t=this.longClientId,n=this.clientNameToIds.get(t).data;this.longClientId=e,this.clientNameToIds.put(e,n),this.shortClientIdMap[n.clientId]=e}}findTile(e,t,n=!0){const r=this.getClientId();return this.mergeTree.findTile(e,r,t,n)}}class ns{constructor(e,t){this.storage=e,this.path=t,Object(k.a)(!t.endsWith("/"))}async read(e){return this.storage.read(`${this.path}/${e}`)}async readBlob(e){return this.storage.readBlob(`${this.path}/${e}`)}async contains(e){return this.storage.contains(`${this.path}/${e}`)}async list(e){return this.storage.list(`${this.path}/${e}`)}}const rs="0.34.1",os=m()("fluid:sequence");os("Package: @fluidframework/sequence - Version: 0.34.1");class ss{constructor(e,t,n){this.start=e,this.end=t,n&&this.addProperties(n)}getAdditionalPropertySets(){return this.auxProps}addPropertySet(e){void 0===this.auxProps&&(this.auxProps=[]),this.auxProps.push(e)}serialize(e){let t=0;e&&(t=e.getCurrentSeq());const n={end:this.end,intervalType:0,sequenceNumber:t,start:this.start};return this.properties&&(n.properties=this.properties),n}clone(){return new ss(this.start,this.end,this.properties)}compare(e){const t=this.start-e.start;return 0===t?this.end-e.end:t}overlaps(e){return this.start<e.end&&this.end>=e.start}union(e){return new ss(Math.min(this.start,e.start),Math.max(this.end,e.end),this.properties)}getProperties(){return this.properties}addProperties(e,t){this.properties=Jr(this.properties,e,t)}}class is{constructor(e,t,n,r){this.start=e,this.end=t,this.intervalType=n,r&&this.addProperties(r)}serialize(e){const t=this.start.toPosition(),n={end:this.end.toPosition(),intervalType:this.intervalType,sequenceNumber:e.getCurrentSeq(),start:t};return this.properties&&(n.properties=this.properties),n}clone(){return new is(this.start,this.end,this.intervalType)}compare(e){const t=this.start.compare(e.start);return 0===t?this.end.compare(e.end):t}overlaps(e){const t=this.start.compare(e.end)<0&&this.end.compare(e.start)>=0;return this.checkMergeTree&&this.checkOverlaps(e,t),t}union(e){return new is(this.start.min(e.start),this.end.max(e.end),this.intervalType)}addProperties(e,t){this.properties=Jr(this.properties,e,t)}overlapsPos(e,t){const n=this.start.toPosition();return this.start.toPosition()>e&&n<t}checkOverlaps(e,t){const n=this.start.toPosition(),r=e.start.toPosition(),o=this.end.toPosition(),s=e.end.toPosition();(n<s&&r<o)!==t&&(console.log(`check mismatch: res ${t} ${this.start.segment===e.end.segment} ${e.start.segment===this.end.segment}`),console.log(`as ${n} ae ${o} bs ${r} be ${s}`),console.log(`as ${lo(this.start.segment.ordinal)}@${this.start.offset}`),console.log(`ae ${lo(this.end.segment.ordinal)}@${this.end.offset}`),console.log(`bs ${lo(e.start.segment.ordinal)}@${e.start.offset}`),console.log(`be ${lo(e.end.segment.ordinal)}@${e.end.offset}`),console.log(this.checkMergeTree.nodeToString(e.start.segment.parent,"")))}}function as(e,t,n){const r=e.getContainingSegment(t);if(r&&r.segment){const t=new Xr(e,r.segment,r.offset,n);return n!==Vr.Transient&&e.addLocalReference(t),t}return new Xr(e,void 0)}function us(e,t,n,r,o){let s=Vr.RangeBegin,i=Vr.RangeEnd;o===$r.Nest?(s=Vr.NestBegin,i=Vr.NestEnd):o===$r.Transient&&(s=Vr.Transient,i=Vr.Transient),o&$r.SlideOnRemove&&(s|=Vr.SlideOnRemove,i|=Vr.SlideOnRemove);const a=as(r,t,s),u=as(r,n,i);if(a&&u){a.pairedRef=u,u.pairedRef=a;const t={[po]:[e]};return a.addProperties(t),u.addProperties(t),new is(a,u,o,t)}}class cs{constructor(e,t,n){this.client=e,this.label=t,this.helpers=n,this.intervalTree=new Ur,this.endIntervalTree=new zr(n.compareEnds)}addConflictResolver(e){this.conflictResolver=e,this.endConflictResolver=(e,t)=>{const n=this.conflictResolver(e,t);return{data:n,key:n}}}map(e){this.intervalTree.map(e)}findOverlappingIntervals(e,t){if(this.intervalTree.intervals.isEmpty())return[];{const n=this.helpers.create("transient",e,t,this.client,$r.Transient);return this.intervalTree.match(n).map(e=>e.key)}}previousInterval(e){const t=this.helpers.create("transient",e,e,this.client,$r.Transient),n=this.endIntervalTree.floor(t);if(n)return n.data}nextInterval(e){const t=this.helpers.create("transient",e,e,this.client,$r.Transient),n=this.endIntervalTree.ceil(t);if(n)return n.data}removeInterval(e,t){const n=this.helpers.create("transient",e,t,this.client,$r.Transient);return this.intervalTree.remove(n),this.endIntervalTree.remove(n),n}createInterval(e,t,n){return this.helpers.create(this.label,e,t,this.client,n)}addInterval(e,t,n,r){const o=this.createInterval(e,t,n);return o&&(o.addProperties(r),this.label&&this.label.length>0&&(o.properties.referenceRangeLabels=[this.label]),this.intervalTree.put(o,this.conflictResolver),this.endIntervalTree.put(o,o,this.endConflictResolver)),o}serialize(){const e=this.client;return this.intervalTree.intervals.keys().map(t=>t.serialize(e))}}const ds=(e,t)=>e.end.compare(t.end);class ls{get name(){return ls.Name}get factory(){return ls._factory}get ops(){return ls._ops}}ls.Name="sharedStringIntervalCollection",ls._factory=new class{load(e,t=[]){return new gs({compareEnds:ds,create:us},!0,e,t)}store(e){return e.serializeInternal()}},ls._ops=new Map([["add",{process:(e,t,n,r)=>{n||e.addInternal(t,n,r)}}],["delete",{process:(e,t,n,r)=>{n||e.deleteInterval(t,n,r)}}]]);const hs=(e,t)=>e.end-t.end;function fs(e,t,n,r){let o;return e&&e.length>0&&(o={[po]:[e]}),new ss(t,n,o)}class ms{get name(){return ms.Name}get factory(){return ms._factory}get ops(){return ms._ops}}ms.Name="sharedIntervalCollection",ms._factory=new class{load(e,t=[]){const n=new gs({compareEnds:hs,create:fs},!1,e,t);return n.attachGraph(void 0,""),n}store(e){return e.serializeInternal()}},ms._ops=new Map([["add",{process:(e,t,n,r)=>{n||e.addInternal(t,n,r)}}],["delete",{process:(e,t,n,r)=>{n||e.deleteInterval(t,n,r)}}]]);class ps extends c.EventEmitter{constructor(e,t,n,r,o){if(super(),this.client=e,this.emitter=o,this.localCollection=new cs(e,n,r),t)for(const e of t)this.localCollection.addInterval(e.start,e.end,e.intervalType,e.properties)}attachDeserializer(e){this.attachDeserializerCore(e)}addConflictResolver(e){this.localCollection.addConflictResolver(e)}findOverlappingIntervals(e,t){return this.localCollection.findOverlappingIntervals(e,t)}map(e){this.localCollection.map(e)}previousInterval(e){return this.localCollection.previousInterval(e)}nextInterval(e){return this.localCollection.nextInterval(e)}on(e,t){return super.on(e,t)}add(e,t,n,r){let o=0;this.client&&(o=this.client.getCurrentSeq());const s={end:t,intervalType:n,properties:r,sequenceNumber:o,start:e};this.addInternal(s,!0,void 0)}delete(e,t){let n=0;this.client&&(n=this.client.getCurrentSeq());const r={start:e,end:t,sequenceNumber:n,intervalType:$r.Transient};this.deleteInterval(r,!0,void 0)}addInternal(e,t,n){const r=this.localCollection.addInterval(e.start,e.end,e.intervalType,e.properties);return r&&(t?this.emitter.emit("add",void 0,e):this.onDeserialize&&this.onDeserialize(r)),this.emit("addInterval",r,t,n),this}deleteInterval(e,t,n){const r=this.localCollection.removeInterval(e.start,e.end);return r&&(t?this.emitter.emit("delete",void 0,e):this.onDeserialize&&this.onDeserialize(r)),this.emit("deleteInterval",r,t,n),this}serializeInternal(){return this.localCollection.serialize()}attachDeserializerCore(e){e&&(this.onDeserialize=e,this.localCollection.map(e=>{this.onDeserialize(e)}))}}class gs{constructor(e,t,n,r){this.helpers=e,this.requiresClient=t,this.emitter=n,this.savedSerializedIntervals=r}get attached(){return!!this.view}attachGraph(e,t){if(this.view)throw new Error("Only supports one Sequence attach");if(void 0===e&&this.requiresClient)throw new Error("Client required for this collection");this.view=new ps(e,this.savedSerializedIntervals,t,this.helpers,this.emitter),this.savedSerializedIntervals=void 0}add(e,t,n,r){if(!this.view)throw new Error("attach must be called prior to adding intervals");this.view.add(e,t,n,r)}delete(e,t){if(!this.view)throw new Error("attach must be called prior to deleting intervals");this.view.delete(e,t)}addConflictResolver(e){this.view.addConflictResolver(e)}async getView(e){return this.view?(e&&this.view.attachDeserializer(e),this.view):Promise.reject(new Error("attachSequence must be called prior to retrieving the view"))}addInternal(e,t,n){if(!this.view)throw new Error("attachSequence must be called");return this.view.addInternal(e,t,n)}deleteInterval(e,t,n){if(!this.view)throw new Error("attach must be called prior to deleting intervals");this.view.deleteInterval(e,t,n)}serializeInternal(){if(!this.view)throw new Error("attachSequence must be called");return this.view.serializeInternal()}}class bs{constructor(e,t){this.deltaArgs=e,this.mergeTreeClient=t,this.isEmpty=0===e.deltaSegments.length,this.deltaOperation=e.operation,this.sortedRanges=new _s(()=>{const e=new Qr;return this.deltaArgs.deltaSegments.forEach(t=>{const n={operation:this.deltaArgs.operation,position:this.mergeTreeClient.getPosition(t.segment),propertyDeltas:t.propertyDeltas,segment:t.segment};e.addOrUpdate(n)}),e}),this.pFirst=new _s(()=>{if(!this.isEmpty)return this.sortedRanges.value.items[0]}),this.pLast=new _s(()=>{if(!this.isEmpty)return this.sortedRanges.value.items[this.sortedRanges.value.size-1]})}get ranges(){return this.sortedRanges.value.items}get clientId(){return this.mergeTreeClient.longClientId}get first(){return this.pFirst.value}get last(){return this.pLast.value}}class vs extends bs{constructor(e,t,n){super(t,n),this.opArgs=e,this.isLocal=void 0===e.sequencedMessage}}class ys extends bs{constructor(e,t,n){super(t,n),this.opArgs=e}}class _s{constructor(e){this.valueGenerator=e,this.pEvaluated=!1}get evaluated(){return this.pEvaluated}get value(){return this.pEvaluated||(this.pEvaluated=!0,this.pValue=this.valueGenerator()),this.pValue}}const ws="header",ks="content";class Ss extends Ut{constructor(e,t,n,r){super(t,e,n),this.dataStoreRuntime=e,this.id=t,this.segmentFromSpec=r,this.loadedDeferred=new l.a,this.loadedDeferredOutgoingOps=[],this.deferIncomingOps=!0,this.loadedDeferredIncomingOps=[],this.messagesSinceMSNChange=[],this.loadedDeferred.promise.catch(e=>{this.logger.sendErrorEvent({eventName:"SequenceLoadFailed"},e)}),this.client=new ts(r,p.a.create(this.logger,"SharedSegmentSequence.MergeTreeClient"),e.options),super.on("newListener",e=>{switch(e){case"sequenceDelta":this.client.mergeTreeDeltaCallback||(this.client.mergeTreeDeltaCallback=(e,t)=>{this.emit("sequenceDelta",new vs(e,t,this.client),this)});break;case"maintenance":this.client.mergeTreeMaintenanceCallback||(this.client.mergeTreeMaintenanceCallback=(e,t)=>{this.emit("maintenance",new ys(t,e,this.client),this)})}}),super.on("removeListener",e=>{switch(e){case"sequenceDelta":0===super.listenerCount(e)&&(this.client.mergeTreeDeltaCallback=void 0);break;case"maintenance":0===super.listenerCount(e)&&(this.client.mergeTreeMaintenanceCallback=void 0)}}),this.intervalMapKernel=new Qt(this.serializer,this.handle,(e,t)=>this.submitLocalMessage(e,t),()=>this.isAttached(),[new ls])}get loaded(){return this.loadedDeferred.promise}static createOpsFromDelta(e){const t=[];for(const n of e.ranges)switch(e.deltaOperation){case 2:{const e=t[t.length-1],r={};for(const e of Object.keys(n.propertyDeltas))r[e]=void 0===n.segment.properties[e]?null:n.segment.properties[e];e&&e.pos2===n.position&&Kr(e.props,r)?e.pos2+=n.segment.cachedLength:t.push(qo(n.position,n.position+n.segment.cachedLength,r,void 0));break}case 0:t.push(Uo(n.position,n.segment.clone().toJSONObject()));break;case 1:{const e=t[t.length-1];(null==e?void 0:e.pos1)===n.position?e.pos2+=n.segment.cachedLength:t.push(zo(n.position,n.position+n.segment.cachedLength));break}}return t}removeRange(e,t){const n=this.client.removeRangeLocal(e,t);return n&&this.submitSequenceMessage(n),n}cut(e,t,n){const r=this.client.removeRangeLocal(e,t,n);r&&this.submitSequenceMessage(r)}paste(e,t){const n=this.client.pasteLocal(e,t);return n&&this.submitSequenceMessage(n),e}copy(e,t,n){const r=this.client.copyLocal(e,t,n);r&&this.submitSequenceMessage(r)}groupOperation(e){this.client.localTransaction(e),this.submitSequenceMessage(e)}getContainingSegment(e){return this.client.getContainingSegment(e)}getLength(){return this.client.getLength()}getPosition(e){return this.client.getPosition(e)}annotateRange(e,t,n,r){const o=this.client.annotateRangeLocal(e,t,n,r);o&&this.submitSequenceMessage(o)}getPropertiesAtPosition(e){return this.client.getPropertiesAtPosition(e)}getRangeExtentsOfPosition(e){return this.client.getRangeExtentsOfPosition(e)}createPositionReference(e,t,n){const r=new Xr(this.client,e,t,n);return n!==Vr.Transient&&this.addLocalReference(r),r}localRefToPos(e){return e.segment?e.offset+this.getPosition(e.segment):-1}resolveRemoteClientPosition(e,t,n){return this.client.resolveRemoteClientPosition(e,t,n)}submitSequenceMessage(e){if(!this.isAttached())return;const t=Wt(e,this.serializer,this.handle),n=this.client.peekPendingSegmentGroups(3===e.type?e.ops.length:1);this.loadedDeferred.isCompleted?this.submitLocalMessage(t,n):this.loadedDeferredOutgoingOps.push([t,n])}addLocalReference(e){return this.client.addLocalReference(e)}removeLocalReference(e){return this.client.removeLocalReference(e)}posFromRelativePos(e){return this.client.posFromRelativePos(e)}walkSegments(e,t,n,r,o=!1){return this.client.walkSegments(e,t,n,r,o)}getStackContext(e,t){return this.client.getStackContext(e,t)}getCurrentSeq(){return this.client.getCurrentSeq()}insertAtReferencePosition(e,t){const n=this.client.insertAtReferencePositionLocal(e,t);n&&this.submitSequenceMessage(n)}async waitIntervalCollection(e){return this.intervalMapKernel.wait(this.getIntervalCollectionPath(e))}getIntervalCollection(e){const t=this.getIntervalCollectionPath(e);return this.intervalMapKernel.has(t)||this.intervalMapKernel.createValueType(t,ls.Name,void 0),this.intervalMapKernel.get(t)}snapshotCore(e){const t=[];return t.push({mode:B.a.File,path:ws,type:B.b.Blob,value:{contents:this.intervalMapKernel.serialize(e),encoding:"utf-8"}}),t.push({mode:B.a.Directory,path:ks,type:B.b.Tree,value:this.snapshotMergeTree(e)}),{entries:t}}replaceRange(e,t,n){const r=Math.max(e,t),o=this.client.insertSegmentLocal(r,n);if(o)if(e!==t){const n=this.client.removeRangeLocal(e,t);this.submitSequenceMessage(Vo(o,n))}else this.submitSequenceMessage(o)}onConnect(){this.client.startOrUpdateCollaboration(this.runtime.clientId)}onDisconnect(){os(this.id+" is now disconnected")}reSubmitCore(e,t){this.intervalMapKernel.trySubmitMessage(e,t)||this.submitSequenceMessage(this.client.regeneratePendingOp(e,t))}async loadCore(e){var t;if(await e.contains(ws)){const t=await e.readBlob(ws),n=Object(ae.c)(t,"utf8");this.intervalMapKernel.populate(n)}try{const{catchupOpsP:n}=await this.client.load(this.runtime,new ns(e,ks),this.serializer),r=n.then(e=>{e.forEach(e=>{const t=this.client.getCollabWindow();if(e.minimumSequenceNumber<t.minSeq||e.referenceSequenceNumber<t.minSeq||e.sequenceNumber<=t.minSeq||e.sequenceNumber<=t.currentSeq)throw new Error("Invalid catchup operations in snapshot: "+JSON.stringify({op:{seq:e.sequenceNumber,minSeq:e.minimumSequenceNumber,refSeq:e.referenceSequenceNumber},collabWindow:{seq:t.currentSeq,minSeq:t.minSeq}}));this.processMergeTreeMsg(e)}),this.loadFinished()}).catch(e=>{this.loadFinished(e)});!0!==(null===(t=this.dataStoreRuntime.options)||void 0===t?void 0:t.sequenceInitializeFromHeaderOnly)&&await r}catch(e){this.loadFinished(e)}}processCore(e,t,n){this.deferIncomingOps?(Object(k.a)(!t,"Unexpected local op when loading not finished"),this.loadedDeferredIncomingOps.push(e)):(Object(k.a)(e.type===q.a.Operation,"Sequence message not operation"),this.intervalMapKernel.tryProcessMessage(e,t,n)||this.processMergeTreeMsg(e))}registerCore(){for(const e of this.intervalMapKernel.values())Ut.is(e)&&e.bindToContext();this.client.startOrUpdateCollaboration(this.runtime.clientId)}didAttach(){var e;this.isAttached()&&this.client.startOrUpdateCollaboration(null!==(e=this.runtime.clientId)&&void 0!==e?e:"attached")}initializeLocalCore(){super.initializeLocalCore(),this.loadFinished()}snapshotMergeTree(e){Object(k.a)(this.loadedDeferred.isCompleted,"Snapshot called when not fully loaded");const t=this.runtime.deltaManager.minimumSequenceNumber;return this.processMinSequenceNumberChanged(t),this.messagesSinceMSNChange.forEach(e=>e.minimumSequenceNumber=t),this.client.snapshot(this.runtime,this.handle,e,this.messagesSinceMSNChange)}processMergeTreeMsg(e){var t,n;const r=Kt(e,this.serializer),o=[];function s(e){o.push(...Ss.createOpsFromDelta(e))}const i=r.referenceSequenceNumber!==r.sequenceNumber-1;let a=r;!0!==(null===(t=this.runtime.options)||void 0===t?void 0:t.newMergeTreeSnapshotFormat)&&i&&this.on("sequenceDelta",s),this.client.applyMsg(r),!0!==(null===(n=this.runtime.options)||void 0===n?void 0:n.newMergeTreeSnapshotFormat)&&(i&&(this.removeListener("sequenceDelta",s),a=Object.assign(Object.assign({},r),{referenceSequenceNumber:a.sequenceNumber-1,contents:1!==o.length?Vo(...o):o[0]})),this.messagesSinceMSNChange.push(a),this.messagesSinceMSNChange.length>20&&this.messagesSinceMSNChange[20].sequenceNumber<r.minimumSequenceNumber&&this.processMinSequenceNumberChanged(r.minimumSequenceNumber))}getIntervalCollectionPath(e){return"intervalCollections/"+e}processMinSequenceNumberChanged(e){let t=0;for(;t<this.messagesSinceMSNChange.length&&!(this.messagesSinceMSNChange[t].sequenceNumber>e);t++);0!==t&&(this.messagesSinceMSNChange=this.messagesSinceMSNChange.slice(t))}loadFinished(e){if(!this.loadedDeferred.isCompleted){if(this.initializeIntervalCollections(),e)throw this.loadedDeferred.reject(e),e;for(this.deferIncomingOps=!1;this.loadedDeferredIncomingOps.length>0;)this.processCore(this.loadedDeferredIncomingOps.shift(),!1,void 0);for(this.loadedDeferred.resolve();this.loadedDeferredOutgoingOps.length>0;){const e=this.loadedDeferredOutgoingOps.shift();this.reSubmitCore(e[0],e[1])}}}initializeIntervalCollections(){this.intervalMapKernel.eventEmitter.on("valueChanged",e=>{const t=this.intervalMapKernel.get(e.key);t.attached||t.attachGraph(this.client,e.key)});for(const e of this.intervalMapKernel.keys())this.intervalMapKernel.get(e).attachGraph(this.client,e)}}class js extends mo{constructor(e){super(),this.items=e,this.type=js.typeString,this.cachedLength=e.length}static is(e){return e.type===js.typeString}static fromJSONObject(e){if(e&&"object"==typeof e&&"items"in e){const t=new js(e.items);return e.props&&t.addProperties(e.props),t}}toJSONObject(){const e={items:this.items};return super.addSerializedProps(e),e}clone(e=0,t){const n=this.items.slice(e,t),r=new js(n);return this.cloneInto(r),r}canAppend(e){return js.is(e)&&(this.cachedLength<=128||e.cachedLength<=128)}toString(){return this.items.toString()}append(e){if(!js.is(e))throw new Error("can only append another run segment");Yr.append(this,e),this.items=this.items.concat(e.items),this.cachedLength=this.items.length}removeRange(e,t){let n=[];const r=this.items.length;return e>0&&(n=n.concat(this.items.slice(0,e))),t<r&&(n=n.concat(this.items.slice(t))),this.items=n,this.cachedLength=this.items.length,0===this.items.length}createSplitSegmentAt(e){if(e>0){const t=this.items.slice(e);return this.items=this.items.slice(0,e),this.cachedLength=this.items.length,new js(t)}}}js.typeString="SubSequence";class Cs extends Ss{constructor(e,t,n,r){super(e,t,n,r),this.id=t}insert(e,t,n){const r=new js(t);n&&r.addProperties(n);const o=this.client.insertSegmentLocal(e,r);o&&this.submitSequenceMessage(o)}remove(e,t){this.removeRange(e,t)}getItemCount(){return this.getLength()}getItems(e,t){const n=[];let r;return void 0!==t&&t<=e||(this.walkSegments(e=>(js.is(e)&&(void 0===r&&(r=e),n.push(...e.items)),!0),e,t),void 0!==r&&n.splice(0,e-this.getPosition(r)),void 0!==t&&n.splice(t-e)),n}}class xs extends Cs{constructor(e,t,n){super(e,t,n,As.segmentFromSpec),this.id=t}static create(e,t){return e.createChannel(t,As.Type)}static getFactory(){return new As}getRange(e,t){return this.getItems(e,t)}}class Os extends Ss{constructor(e,t,n){super(e,t,n,Es.segmentFromSpec),this.id=t,this.mergeTreeTextHelper=this.client.createTextHelper()}static create(e,t){return e.createChannel(t,Es.Type)}static getFactory(){return new Es}get ISharedString(){return this}insertMarkerRelative(e,t,n){const r=new _o(t);n&&r.addProperties(n);const o=this.posFromRelativePos(e),s=this.client.insertSegmentLocal(o,r);s&&this.submitSequenceMessage(s)}insertMarker(e,t,n){const r=new _o(t);n&&r.addProperties(n);const o=this.client.insertSegmentLocal(e,r);return o&&this.submitSequenceMessage(o),o}insertTextRelative(e,t,n){const r=new Yo(t);n&&r.addProperties(n);const o=this.posFromRelativePos(e),s=this.client.insertSegmentLocal(o,r);s&&this.submitSequenceMessage(s)}insertText(e,t,n){const r=new Yo(t);n&&r.addProperties(n);const o=this.client.insertSegmentLocal(e,r);o&&this.submitSequenceMessage(o)}replaceText(e,t,n,r){this.replaceRange(e,t,Yo.make(n,r))}removeText(e,t){return this.removeRange(e,t)}annotateMarkerNotifyConsensus(e,t,n){const r=this.client.annotateMarkerNotifyConsensus(e,t,n);r&&this.submitSequenceMessage(r)}annotateMarker(e,t,n){const r=this.client.annotateMarker(e,t,n);r&&this.submitSequenceMessage(r)}findTile(e,t,n=!0){return this.client.findTile(e,t,n)}getTextAndMarkers(e){const t=this.client.getCollabWindow();return this.mergeTreeTextHelper.getTextAndMarkers(t.currentSeq,t.clientId,e)}getText(e,t){const n=this.client.getCollabWindow();return this.mergeTreeTextHelper.getText(n.currentSeq,n.clientId,"",e,t)}getTextWithPlaceholders(){const e=this.client.getCollabWindow();return this.mergeTreeTextHelper.getText(e.currentSeq,e.clientId," ")}getTextRangeWithPlaceholders(e,t){const n=this.client.getCollabWindow();return this.mergeTreeTextHelper.getText(n.currentSeq,n.clientId," ",e,t)}getTextRangeWithMarkers(e,t){const n=this.client.getCollabWindow();return this.mergeTreeTextHelper.getText(n.currentSeq,n.clientId,"*",e,t)}getMarkerFromId(e){return this.client.getMarkerFromId(e)}}class Es{static segmentFromSpec(e){const t=Yo.fromJSONObject(e);if(t)return t;return _o.fromJSONObject(e)||void 0}get type(){return Es.Type}get attributes(){return Es.Attributes}async load(e,t,n,r){const o=new Os(e,t,r);return await o.load(n),o}create(e,t){const n=new Os(e,t,this.attributes);return n.initializeLocal(),n}}Es.Type="https://graph.microsoft.com/types/mergeTree",Es.Attributes={type:Es.Type,snapshotFormatVersion:"0.1",packageVersion:rs};class Is{static segmentFromSpec(e){const t=e;if(t.items){const e=new js(t.items);return t.props&&e.addProperties(t.props),e}}get type(){return Is.Type}get attributes(){return Is.Attributes}async load(e,t,n,r){const o=new Ns(e,t,r);return await o.load(n),o}create(e,t){const n=new Ns(e,t,this.attributes);return n.initializeLocal(),n}}Is.Type="https://graph.microsoft.com/types/mergeTree/object-sequence",Is.Attributes={type:Is.Type,snapshotFormatVersion:"0.1",packageVersion:rs};class As{static segmentFromSpec(e){const t=e;if(t.items){const e=new js(t.items);return t.props&&e.addProperties(t.props),e}}get type(){return As.Type}get attributes(){return As.Attributes}async load(e,t,n,r){const o=new xs(e,t,r);return await o.load(n),o}create(e,t){const n=new xs(e,t,this.attributes);return n.initializeLocal(),n}}As.Type="https://graph.microsoft.com/types/mergeTree/number-sequence",As.Attributes={type:As.Type,snapshotFormatVersion:"0.1",packageVersion:rs};class Ns extends Cs{constructor(e,t,n){super(e,t,n,Is.segmentFromSpec),this.id=t}static create(e,t){return e.createChannel(t,Is.Type)}static getFactory(){return new Is}getRange(e,t){return this.getItems(e,t)}}var Ts=n("../notebook-dds/node_modules/@nteract/commutable/lib/index.js");class Fs extends Or{get model(){return this}initializingFirstTime(e){return i(this,void 0,void 0,(function*(){const t=Os.create(this.runtime),n=tn.create(this.runtime),r=Tr.create(this.runtime),o=Ns.create(this.runtime);let s;if(e){s=e.id;const{cell:i}=e;if(i.has("cell_type")&&"code"===i.cell_type){t.insertText(0,i.source),i.metadata.forEach((e,t)=>{n.set(t,e)}),r.set(i.execution_count);const e=i.outputs.map(e=>({value:e.toJS()})).toArray();o.insert(0,e)}}this.root.set("cellId",s).set("source",t.handle).set("metadata",n.handle).set("executionCount",r.handle).set("outputs",o.handle)}))}hasInitialized(){return i(this,void 0,void 0,(function*(){this.source=yield this.root.get("source").get(),this.metadata=yield this.root.get("metadata").get(),this.executionCount=yield this.root.get("executionCount").get(),this.outputs=yield this.root.get("outputs").get(),this.outputsObservable=Object(_r.fromEvent)(this.outputs,"op").pipe(Object(wr.filter)(([,e])=>!e),Object(wr.mergeMap)(([e])=>{const t=e.contents;switch(t.type){case 0:if("number"==typeof t.pos1&&t.seg&&t.seg.items instanceof Array)return Object(_r.of)({event:"append",cellId:this.id,output:t.seg.items[0]});break;case 1:if("number"==typeof t.pos1&&"number"==typeof t.pos2)return Object(_r.of)({event:"clear",cellId:this.id})}return _r.EMPTY})),this.sourceObservable=Object(_r.fromEvent)(this.source,"sequenceDelta").pipe(Object(wr.filter)(([e])=>!e.isLocal),Object(wr.map)(([,e])=>e.getText())),this.metadataObservable=Object(_r.fromEvent)(this.metadata,"op").pipe(Object(wr.filter)(([e,t])=>!t&&"set"===e.contents.type),Object(wr.map)(([e])=>({cellId:this.id,key:e.contents.key,value:e.contents.value.value})))}))}get id(){return this.root.get("cellId")}get outputs$(){return this.outputsObservable}get source$(){return this.sourceObservable}get metadata$(){return this.metadataObservable}asImmutable(){const e=new Map;this.metadata.forEach((t,n)=>e.set(n,t));const t=this.outputs.getItems(0).map(e=>Object(Ts.createImmutableOutput)(e.value));return Object(Ts.createCodeCell)({source:this.source.getText(),metadata:Object(Pr.Map)(e),execution_count:this.executionCount.get(),outputs:Object(Pr.List)(t)})}getSource(){return this.source}lastOutputCreatedBy(){const e=this.outputs.getItemCount();if(0!==e)return this.outputs.getItems(e-1)[0].createdBy}appendOutput(e){this.outputs.insert(this.outputs.getItemCount(),[e])}clearOutputs(){const e=this.outputs.getItemCount();0!==e&&this.outputs.remove(0,e)}updateMetadata(e,t){this.metadata.set(e,t)}}Fs.Factory=new Ir("@aznb/codecell",Fs,[Tr.getFactory(),tn.getFactory(),Ns.getFactory(),Os.getFactory()],{});class Ps extends Or{get model(){return this}initializingFirstTime(e){return i(this,void 0,void 0,(function*(){const t=Tr.create(this.runtime),n=Os.create(this.runtime),r=tn.create(this.runtime);let o;if(e){o=e.id;const{cell:s}=e;t.set(s.cell_type),n.insertText(0,s.source),s.metadata.forEach((e,t)=>{r.set(t,e)})}this.root.set("cellId",o).set("cellType",t.handle).set("source",n.handle).set("metadata",r.handle)}))}hasInitialized(){return i(this,void 0,void 0,(function*(){this.cellType=yield this.root.get("cellType").get(),this.source=yield this.root.get("source").get(),this.metadata=yield this.root.get("metadata").get(),this.sourceObservable=Object(_r.fromEvent)(this.source,"sequenceDelta").pipe(Object(wr.filter)(([e])=>!e.isLocal),Object(wr.map)(([,e])=>e.getText()))}))}get id(){return this.root.get("cellId")}get source$(){return this.sourceObservable}asImmutable(){const e=new Map;return this.metadata.forEach((t,n)=>e.set(n,t)),"markdown"===this.cellType.get()?Object(Ts.makeMarkdownCell)({source:this.source.getText(),metadata:Object(Pr.Map)(e)}):Object(Ts.makeRawCell)({source:this.source.getText(),metadata:Object(Pr.Map)(e)})}getSource(){return this.source}}Ps.Factory=new Ir("@aznb/textcell",Ps,[Tr.getFactory(),tn.getFactory(),Os.getFactory()],{});class Rs extends Or{constructor(){super(...arguments),this.debug=Fr.extend("notebook","|"),this.cellMetadataSubject=new _r.Subject,this.notebookMetadataSubject=new _r.Subject,this.outputsSubject=new _r.Subject}get model(){return this}get cells$(){return this.cellsObservable}get outputs$(){return this.outputsSubject}get version$(){return this.versionObservable}get notebookMetadata$(){return this.notebookMetadataSubject}get cellMetadata$(){return this.cellMetadataSubject}asImmutable(){return i(this,void 0,void 0,(function*(){const e=new Map;for(const[t,n]of this.cellMap){const r=(yield n.get()).model.asImmutable();e.set(t,r)}return Object(Ts.createNotebook)({cellOrder:Object(Pr.List)(this.cellOrder.getItems(0)),cellMap:Object(Pr.Map)(e),metadata:Object(Pr.Map)(this.metadata)})}))}getOutputAnnotations(){return i(this,void 0,void 0,(function*(){const e=new Map;for(const[t,n]of this.cellMap){const r=yield n.get();if(tt(r)){const n=r.lastOutputCreatedBy();n&&e.set(t,n)}}return e}))}getCell(e){return i(this,void 0,void 0,(function*(){const t=yield this.cellMap.wait(e);return(yield t.get()).model}))}insertCell(e,t,n){return i(this,void 0,void 0,(function*(){const r=yield this.createCellComponent(e,n);this.cellMap.set(e,r);let o=0;if(t){const e=this.cellOrder.getItems(0).indexOf(t);o=-1===e?this.cellOrder.getItemCount():e+1}this.cellOrder.insert(o,[e])}))}deleteCell(e){const t=this.cellOrder.getItems(0).indexOf(e);-1!==t&&this.cellOrder.remove(t,t+1),this.cellMap.delete(e)}replaceCell(e,t){return i(this,void 0,void 0,(function*(){const n=yield this.createCellComponent(e,t);this.cellMap.set(e,n)}))}moveCell(e,t,n){const r=this.cellOrder.getItems(0).indexOf(e),o=this.cellOrder.getItems(0).indexOf(t)+(n?0:1),s=o-(r<o?1:0),i=zo(r,r+1),a=Ho(s,new js([e]));try{this.cellOrder.groupOperation(Vo(i,a))}catch(e){console.error(e)}}updateMetadata(e,t){this.metadata.set(e,t)}getVersion(){return this.version.get()}setVersion(e){this.version.set(e)}initializingFirstTime(e){return i(this,void 0,void 0,(function*(){this.debug("Initializing new component");const t=Ns.create(this.runtime),n=tn.create(this.runtime),r=tn.create(this.runtime),{notebook:o,version:s}=e,i=Tr.create(this.runtime);i.set(s),t.insert(0,o.cellOrder.toArray());for(const e of o.cellOrder){const t=o.cellMap.get(e),r=yield this.createCellComponent(e,t);n.set(e,r)}o.metadata.forEach((e,t)=>{r.set(t,e)}),this.root.set("cellMap",n.handle).set("cellOrder",t.handle).set("version",i.handle).set("metadata",r.handle)}))}initializingFromExisting(){return i(this,void 0,void 0,(function*(){this.debug("Initializing existing component");const e=this.root.get("version");if(e)this.version=yield e.get();else{const e=Tr.create(this.runtime);this.root.set("version",e.handle),this.version=e.get()}}))}hasInitialized(){return i(this,void 0,void 0,(function*(){this.debug("Component has initialized",this.runtime.documentId,this.url),this.version=yield this.root.get("version").get(),this.cellMap=yield this.root.get("cellMap").get(),this.cellOrder=yield this.root.get("cellOrder").get(),this.metadata=yield this.root.get("metadata").get(),this.configureVersion().configureMetadata(),yield this.configureCells()}))}dispose(){this.debug("Disposing component"),super.dispose()}configureVersion(){return this.versionObservable=Object(_r.fromEvent)(this.version,"op").pipe(Object(wr.filter)(([e,t])=>!t&&"setCell"===e.contents.type&&e.contents.value.value),Object(wr.map)(([e])=>e.contents.value.value)),this}configureMetadata(){return this.metadataObservable=Object(_r.fromEvent)(this.metadata,"op").pipe(Object(wr.filter)(([e,t])=>!t&&"set"===e.contents.type),Object(wr.map)(([e])=>({key:e.contents.key,value:e.contents.value.value}))),this.metadataObservable.subscribe(e=>this.notebookMetadataSubject.next(e)),this}configureCells(){return i(this,void 0,void 0,(function*(){const e=Object(_r.fromEvent)(this.cellOrder,"op").pipe(Object(wr.filter)(([,e])=>!e),Object(wr.mergeMap)(([e])=>{const t=e.contents;switch(t.type){case 0:if("number"==typeof t.pos1&&t.seg&&t.seg.items instanceof Array){const e=t.seg.items[0];return Object(_r.of)({event:"insert",id:e,pos:t.pos1})}break;case 1:if("number"==typeof t.pos1&&"number"==typeof t.pos2)return Object(_r.of)({event:"remove",pos:t.pos1});break;case 3:if(t&&t.ops instanceof Array&&2===t.ops.length){const e=t.ops[0],n=t.ops[1];return Object(_r.of)({event:"move",pos1:e.pos1,pos2:n.pos1})}}return _r.EMPTY})),t=Object(_r.fromEvent)(this.cellMap,"valueChanged").pipe(Object(wr.filter)(([e])=>e.previousValue),Object(wr.map)(([e,t])=>({event:"replace",id:e.key,local:t})));this.cellsObservable=Object(_r.merge)(e,t);const n=[];Object(_r.fromEvent)(this.cellMap,"op").pipe(Object(wr.filter)(([e])=>"set"===e.contents.type),Object(wr.map)(([e])=>[e.contents.key,e.contents.value.value])).subscribe(([e])=>i(this,void 0,void 0,(function*(){const t=yield this.getCell(e);if(tt(t)){const e=t.outputs$.subscribe(e=>this.outputsSubject.next(e)),r=t.metadata$.subscribe(e=>this.cellMetadataSubject.next(e));n.push(e,r)}})));for(const e of this.cellMap.values()){const t=yield e.get();if(tt(t.model)){const e=t.model.outputs$.subscribe(e=>this.outputsSubject.next(e)),r=t.model.metadata$.subscribe(e=>this.cellMetadataSubject.next(e));n.push(e,r)}}return this}))}createCellComponent(e,t){return i(this,void 0,void 0,(function*(){switch((t=null!=t?t:Object(Ts.createCodeCell)()).cell_type){case"code":return(yield Fs.Factory.createInstance(this.context.containerRuntime,{id:e,cell:t})).handle;case"markdown":case"raw":return(yield Ps.Factory.createInstance(this.context.containerRuntime,{id:e,cell:t})).handle}}))}}Rs.Factory=new Ir("@aznb/notebook",Rs,[Tr.getFactory(),tn.getFactory(),Ns.getFactory()],{},[Fs.Factory.registryEntry,Ps.Factory.registryEntry]);class Ds extends Or{constructor(){super(...arguments),this.debug=Fr.extend("presence","|"),this.subscriptions=[]}updatePresence(e){const{id:t}=this.context.options.user;this.presence.set(this.runtime.clientId,{userId:t,location:e})}initializingFirstTime(){return i(this,void 0,void 0,(function*(){this.debug("Initializing new component"),this.root.set("documentUsers",tn.create(this.runtime).handle).set("presence",tn.create(this.runtime).handle)}))}initializingFromExisting(){return i(this,void 0,void 0,(function*(){this.debug("Initializing existing component"),yield this.refresh()}))}refresh(){return i(this,void 0,void 0,(function*(){const e=yield this.root.get("presence").get(),t=this.runtime.getAudience();[...e.keys()].forEach(n=>{t.getMember(n)||(this.debug("inactive member",n),e.delete(n))})}))}hasInitialized(){return i(this,void 0,void 0,(function*(){this.debug("Component has initialized",this.runtime.documentId,this.url),this.documentUsers=yield this.root.get("documentUsers").get(),this.presence=yield this.root.get("presence").get();const{id:e,displayName:t}=this.context.options.user,n={displayName:t};this.documentUsers.set(e,n),this.configureConnectedPeers().configureAudience().configurePresence()}))}dispose(){this.debug("Disposing component"),this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions.splice(0),super.dispose()}configurePresence(){const e=this.peers$.pipe(Object(wr.filter)(e=>0!==e.removed.length),Object(wr.switchMap)(({removed:e})=>Object(_r.of)(...e))),t=this.peers$.pipe(Object(wr.filter)(e=>0!==e.added.length),Object(wr.switchMap)(({added:e})=>Object(_r.of)(...e)));return this.presence$=new _r.Observable(n=>{this.peers$.value.connected.forEach(({peerId:e,userId:t})=>{n.next({peerId:e,userId:t});const r=this.presence.get(e);r&&n.next({peerId:e,userId:t,location:null==r?void 0:r.location})}),this.presence.on("op",(e,t)=>{if("delete"===e.contents.type)n.next({peerId:e.contents.key});else if(!t){const t=e.contents.value.value,r=Object.assign({},t.location);n.next({peerId:e.contents.key,userId:t.userId,location:r})}});const r=[e.subscribe(({peerId:e})=>{n.next({peerId:e})}),t.subscribe(({peerId:e,userId:t})=>{n.next({peerId:e,userId:t});const r=this.presence.get(e);r&&n.next({peerId:e,userId:t,location:null==r?void 0:r.location})})];return()=>r.forEach(e=>e.unsubscribe())}),this}configureAudience(){const e=([e,t],n)=>[e,{userId:e,displayName:t.displayName,presence:n.includes(e)?Ke.active:Ke.inactive}],t=[...this.peers$.value.connected.values()].map(({userId:e})=>e),n=new Map([...this.documentUsers].map(n=>e(n,t))),r=new _r.BehaviorSubject({snapshot:n,updated:[]});return this.subscriptions.push(this.peers$.subscribe(({connected:t})=>{const n=[...t.values()].map(({userId:e})=>e),o=r.value.snapshot,s=new Map([...o].map(t=>e(t,n))),i=[...s.values()].filter(({userId:e,presence:t})=>o.get(e).presence!==t).map(({userId:e})=>e);0!==i.length&&r.next({snapshot:s,updated:i})}),Object(_r.fromEvent)(this.documentUsers,"valueChanged").pipe(Object(wr.filter)(([,e])=>!e)).subscribe(([{key:e}])=>{const t=this.documentUsers.get(e),n=r.value.snapshot,o=new Map([...n]);o.set(e,Object.assign(Object.assign({},t),{userId:e,presence:Ke.active})),r.next({snapshot:o,updated:[e]})})),this.audience$=new _r.Observable(e=>{[...r.value.snapshot.values()].forEach(t=>{e.next(Object.assign({},t))});const t=r.subscribe(({snapshot:t,updated:n})=>{n.forEach(n=>e.next(t.get(n)))});return()=>t.unsubscribe()}),this}configureConnectedPeers(){const e=this.runtime.getAudience(),t=([e,t])=>t.details.capabilities.interactive&&t.user.id&&e!==this.runtime.clientId,n=()=>new Map([...e.getMembers()].filter(t).map(([e,t])=>[e,{peerId:e,userId:t.user.id}])),r=n();this.peers$=new _r.BehaviorSubject({connected:r,removed:[],added:[]});const o=Object(_r.fromEvent)(e,"addMember").pipe(Object(wr.filter)(t),Object(wr.tap)(([e,t])=>this.debug("Member added",e,null==t?void 0:t.user)),Object(wr.map)(([e,t])=>({peerId:e,userId:t.user.id}))),s=Object(_r.fromEvent)(e,"removeMember").pipe(Object(wr.filter)(e=>this.peers$.value.connected.has(e)),Object(wr.tap)(e=>this.debug("Member removed",e)),Object(wr.map)(e=>({peerId:e,userId:null}))),i=Object(_r.merge)(o,s).pipe(Object(wr.debounceTime)(1500),Object(wr.map)(()=>{const e=this.peers$.value.connected,t=n(),r=[...t.values()].filter(({peerId:t})=>!e.has(t)),o=[...e.values()].filter(({peerId:e})=>!t.has(e));return{connected:t,added:r,removed:o}}));return this.subscriptions.push(i.subscribe(e=>this.peers$.next(e))),this}}Ds.Factory=new Ir("@aznb/presence",Ds,[tn.getFactory()],{});const Ms="notebook",Ls="checkpoint",Bs="presence";class qs extends Or{constructor(){super(...arguments),this.debug=Fr.extend("ROOT","|")}get model$(){return this.notebookObservable}get checkpoint$(){return this.checkpointObservable}getModel(){return i(this,void 0,void 0,(function*(){const e=this.notebookSlot.get();if(e)return yield e.get()}))}resetModel(e){return i(this,void 0,void 0,(function*(){this.debug("Resetting notebook model");const t=yield Rs.Factory.createChildInstance(this.context,e);return this.notebookSlot.set(t.handle),t}))}recordCheckpoint(e){this.checkpointSlot.set(e)}get leader$(){return this.leaderObservable}getPresence(){return i(this,void 0,void 0,(function*(){const e=this.presenceSlot.get();return yield e.get()}))}initializingFirstTime(){return i(this,void 0,void 0,(function*(){this.debug("Initializing new component");const e=Tr.create(this.runtime);this.root.set(Ms,e.handle);const t=Tr.create(this.runtime);this.root.set(Ls,t.handle),yield this.initializePresence()}))}initializingFromExisting(){return i(this,void 0,void 0,(function*(){if(this.debug("Initializing existing component"),!this.root.has(Ms)){const e=Tr.create(this.runtime);this.root.set(Ms,e.handle)}if(!this.root.has(Ls)){const e=Tr.create(this.runtime);this.root.set(Ls,e.handle)}this.root.has(Bs)||(yield this.initializePresence())}))}hasInitialized(){return i(this,void 0,void 0,(function*(){this.debug("Component has initialized",this.runtime.documentId,this.url),this.notebookSlot=yield this.root.get(Ms).get(),this.presenceSlot=yield this.root.get(Bs).get(),this.checkpointSlot=yield this.root.get(Ls).get(),this.configureNotebook().configureLeader().configureCheckpoint()}))}dispose(){this.debug("Disposing component"),super.dispose()}initializePresence(){return i(this,void 0,void 0,(function*(){const e=Tr.create(this.runtime),t=yield Ds.Factory.createChildInstance(this.context);e.set(t.handle),this.root.set(Bs,e.handle)}))}configureNotebook(){return this.notebookObservable=Object(_r.fromEvent)(this.notebookSlot,"op").pipe(Object(wr.filter)(([e,t])=>!t&&"setCell"===e.contents.type&&e.contents.value.value),Object(wr.map)(([e])=>{var t;return null===(t=e.contents.value.value)||void 0===t?void 0:t.url})),this}configureLeader(){return this.leaderObservable=Object(_r.merge)(Object(_r.of)(this.context.leader),Object(_r.fromEvent)(this.context,"leader").pipe(Object(wr.mapTo)(!0)),Object(_r.fromEvent)(this.context,"notleader").pipe(Object(wr.mapTo)(!1))),this.leader$.subscribe(e=>this.debug((e?"":"NOT ")+"LEADER NOW",this.runtime.clientId)),this}configureCheckpoint(){return this.checkpointObservable=new _r.Observable(e=>{const t=this.checkpointSlot.get();t&&e.next(t),Object(_r.fromEvent)(this.checkpointSlot,"op").pipe(Object(wr.filter)(([e,t])=>!t&&"setCell"===e.contents.type),Object(wr.map)(([e])=>e.contents.value.value)).subscribe(e)}),this}}qs.Factory=new Ir("@aznb/root",qs,[Tr.getFactory()],{},[Rs.Factory.registryEntry,Ds.Factory.registryEntry]);const zs=new yr(qs.Factory,new Map([qs.Factory.registryEntry,Rs.Factory.registryEntry,Ps.Factory.registryEntry,Fs.Factory.registryEntry]),void 0,void 0,{generateSummaries:!0});var Hs=n("../notebook-dds/node_modules/@fluidframework/server-lambdas/dist/index.js"),Us=n("../notebook-dds/node_modules/@fluidframework/server-memory-orderer/dist/index.js"),Vs=n("../notebook-dds/node_modules/@fluidframework/server-services-client/lib/auth.js"),$s=n("../notebook-dds/node_modules/@fluidframework/server-services-core/dist/index.js"),Ws=n("../notebook-dds/node_modules/@fluidframework/server-test-utils/dist/index.js");class Ks{constructor(e,t){this.id=e,this.server=t,this.events=new c.EventEmitter,this.rooms=new Set,this.subscriber=new Us.WebSocketSubscriber(this)}on(e,t){this.events.on(e,t)}async join(e){this.server.pubsub.subscribe(e,this.subscriber),this.rooms.add(e)}send(e,...t){this.events.emit(e,...t)}emit(e,...t){this.events.emit(e,...t)}broadcastToRoom(e,t,...n){this.server.pubsub.publish(e,t,...n)}emitToRoom(e,t,...n){this.server.pubsub.publish(e,t,...n)}removeListener(e,t){this.events.removeListener(e,t)}disconnect(e){for(const e of this.rooms)this.server.pubsub.unsubscribe(e,this.subscriber);this.emit("disconnect")}}class Gs{constructor(e){this.pubsub=e,this.events=new c.EventEmitter}on(e,t){this.events.on(e,t)}async close(){return this.events.removeAllListeners(),Promise.resolve()}createConnection(){const e=new Ks(Object(d.a)(),this);return this.events.emit("connection",e,{url:"TestWebSocket"}),e}}class Js{constructor(e,t,n,r,o,s,i,a,u,c){this.storage=e,this.databaseManager=t,this.tenantManager=n,this.taskMessageSender=r,this.permission=o,this.tokenGenerator=s,this.createHistorian=i,this.logger=a,this.serviceConfiguration=u,this.pubsub=c,this.map=new Map}async hasPendingWork(){return Promise.all(this.map.values()).then(e=>{for(const t of e)if(t.hasPendingWork())return!0;return!1})}async getOrderer(e,t){const n=`${e}/${t}`;if(!this.map.has(n)){const r=this.createLocalOrderer(e,t);this.map.set(n,r)}return this.map.get(n)}async createLocalOrderer(e,t){const n=await this.createHistorian(e),r=new Re.a(n),o=await Us.LocalOrderer.load(this.storage,this.databaseManager,e,t,this.taskMessageSender,this.tenantManager,this.permission,this.tokenGenerator,this.logger,r,void 0,this.pubsub,void 0,void 0,void 0,void 0,void 0,this.serviceConfiguration),s=[o.broadcasterLambda,o.deliLambda,o.foremanLambda,o.scribeLambda,o.scriptoriumLambda];return await Promise.all(s.map(async e=>{if("created"===e.state)return new Promise(t=>e.once("started",()=>t()))})),o}}class Zs{constructor(e,t,n,r,o,s){this.webSocketServer=e,this.databaseManager=t,this.ordererManager=n,this.testDbFactory=r,this.documentStorage=o,this.logger=s}static create(e=new Ws.TestDbFactory({}),t){const n=new Us.PubSub,r=new Gs(n),o=new $s.MongoManager(e),s=new Ws.TestTenantManager(void 0,void 0,e.testDatabase),i=new $s.MongoDatabaseManager(o,"nodes","documents","deltas","scribeDeltas"),a=new Ws.TestDocumentStorage(i,s),u=Ws.DebugLogger.create("fluid-server:LocalDeltaConnectionServer"),c=new Js(a,i,s,new $s.EmptyTaskMessageSender,{},Vs.a,async()=>new Ws.TestHistorian(e.testDatabase),u,t,n);return Object(Hs.configureWebSocketServices)(r,c,s,a,new Ws.TestClientManager,new $s.DefaultMetricClient,u),new Zs(r,i,c,e,a,u)}async hasPendingWork(){return this.ordererManager.hasPendingWork()}connectWebSocket(e,t,n,r,o){const s=this.webSocketServer.createConnection(),i={client:r,id:t,mode:r.mode,tenantId:e,token:n,versions:o},a=new Promise((e,t)=>{const n=[],r=[],o=(e,t)=>{this.logger.info("Queued early ops: "+t.length),n.push(...t)};s.on("op",o);const a=e=>{this.logger.info("Queued early signals"),r.push(e)};s.on("signal",a),s.on("connect_error",e=>{t(e)}),s.on("connect_document_success",t=>{s.removeListener("op",o),s.removeListener("signal",a),n.length>0&&(t.initialMessages.push(...n),t.initialMessages.sort((e,t)=>e.sequenceNumber-t.sequenceNumber)),r.length>0&&t.initialSignals.push(...r),e(t)}),s.on("connect_document_error",t),s.emit("connect_document",i)});return[s,a]}}var Xs=n("../notebook-dds/node_modules/@fluidframework/local-driver/dist/index.js");class Ys{constructor(){this.protocolName="fluid-test:"}createDocumentService(e,t){Object(y.a)(e);const n=Object(u.parse)(e.url),[,r,o]=n.path.split("/");if(!o||!r)throw new Error(`Couldn't parse documentId and/or tenantId. [documentId:${o}][tenantId:${r}]`);return this.factory||(this.testdeltaConn=Zs.create(new Xs.LocalSessionStorageDbFactory(o)),this.factory=new Xs.LocalDocumentServiceFactory(this.testdeltaConn)),this.factory.createDocumentService(e,t)}createContainer(e,t,n){return this.factory.createContainer(e,t,n)}}class Qs{constructor(e){this.user=e,this.tokenKey="tokenKey"}resolve(e){return i(this,void 0,void 0,(function*(){const t=Object(u.parse)(e.url);if("fluid-test:"!==t.protocol||"localhost"!==t.host)return;const[,n,r]=t.pathname.split("/");if("test"!==n||!r)return;const o=decodeURIComponent(n),s=decodeURIComponent(r),i=[ee.a.DocRead,ee.a.DocWrite,ee.a.SummaryWrite];return{endpoints:{deltaStorageUrl:"localhost",ordererUrl:"localhost",storageUrl:"localhost"},tokens:{jwt:Object(Vs.a)(o,s,this.tokenKey,i,this.user)},type:"fluid",url:`fluid-test://localhost/${n}/${r}`}}))}getAbsoluteUrl(e,t){return i(this,void 0,void 0,(function*(){let n=t;n.startsWith("/")&&(n=n.substr(1));const r=e,o=Object(u.parse)(r.url);if(void 0===o.pathname)throw new Error("Url should contain tenant and docId!!");const[,,s]=o.pathname.split("/");return`http://localhost:3000/${s}/${n}`}))}}var ei=n("../notebook-dds/node_modules/jwt-decode/lib/index.js"),ti=n.n(ei);class ni{constructor(e,t,n){this.accessToken=t,this.getFluidAccessToken=n,this.remainingLifetime=30;const[,r,o]=e.pathname.split("/");this.tenantId=decodeURIComponent(r),this.documentId=decodeURIComponent(o),this.fetchTokenInTimer()}isValid(){return!0}fetchOrdererToken(){return i(this,void 0,void 0,(function*(){return this.getOrFetch()}))}fetchStorageToken(){return i(this,void 0,void 0,(function*(){return this.getOrFetch()}))}getOrFetch(e=!0){return i(this,void 0,void 0,(function*(){return this.shouldForceFetch()?(yield this.fetchTokenForce(),this.getOrFetch(!1)):{fromCache:e,jwt:this.accessToken}}))}fetchTokenForce(){return i(this,void 0,void 0,(function*(){this.clearExpirationTimer(),this.accessToken=yield this.fetchTokenInternal(),this.fetchTokenInTimer()}))}fetchTokenInTimer(){this.clearExpirationTimer();const e=this.getLifetime()-this.remainingLifetime;e>0&&(this.expirationTimer=setTimeout(()=>i(this,void 0,void 0,(function*(){this.accessToken=yield this.fetchTokenInternal(),this.fetchTokenInTimer()})),1e3*e))}fetchTokenInternal(){return i(this,void 0,void 0,(function*(){return yield this.getFluidAccessToken(this.tenantId,this.documentId)}))}getLifetime(){const e=ti()(this.accessToken),t=Math.round((new Date).getTime()/1e3);return e.exp-t}clearExpirationTimer(){void 0!==this.expirationTimer&&(clearTimeout(this.expirationTimer),this.expirationTimer=void 0)}shouldForceFetch(){return this.getLifetime()<this.remainingLifetime/2}}class ri{constructor(e,t,n,r){this.documentUrl=e,this.userId=t,this.container=n,this.rootComponent=r,this.eventSubject=new _r.Subject}get root(){return this.rootComponent}get event$(){return this.eventSubject}initialize(){return i(this,void 0,void 0,(function*(){this.container.on("connected",e=>i(this,void 0,void 0,(function*(){this.eventSubject.next({event:"connect",peerId:e})}))).on("disconnected",()=>{this.eventSubject.next({event:"disconnect"})}).on("error",e=>{this.eventSubject.next({event:"error",error:e})}).on("closed",e=>{e&&this.eventSubject.next({event:"error",error:e})})}))}close(){this.container.close()}}class oi{constructor(e){this.headers=e}fetchHeaders(){return i(this,void 0,void 0,(function*(){return{headers:this.headers||{}}}))}}var si=n("../notebook-dds/node_modules/jsonwebtoken/index.js");class ii{constructor(e,t,n){this.user=t,this.secret=n;const[,r,o]=e.pathname.split("/");this.tenantId=decodeURIComponent(r),this.documentId=decodeURIComponent(o)}isValid(){return!0}fetchOrdererToken(){return i(this,void 0,void 0,(function*(){return{fromCache:!0,jwt:this.getSignedToken()}}))}fetchStorageToken(){return i(this,void 0,void 0,(function*(){return{fromCache:!0,jwt:this.getSignedToken()}}))}getSignedToken(){const e=Math.round((new Date).getTime()/1e3),t={documentId:this.documentId,scopes:[ee.a.DocRead,ee.a.DocWrite,ee.a.SummaryWrite],tenantId:this.tenantId,user:this.user,iat:e,exp:e+3600,ver:"1.0"};return si.sign(t,this.secret)}}class ai{static load(e){return i(this,void 0,void 0,(function*(){const{documentUrl:t,guest:n,config:r}=e,o={id:n.userId,displayName:n.displayName};let s,a;const c=Object(u.parse)(t);switch(c.protocol){case"fluid-aznb:":s=new et(r);const e=new ni(c,r.token,r.getFluidAccessToken),t=new oi({fluidserver:r.sessionServerUrl,resourceId:r.resourceId});a=new Ye(e,t,r.getWebsocketToken);break;case"fluid:":s=new et(r);const n=new ii(c,o,r.tenantKey);a=new Oe.a(n);break;case"tinylicious:":s=new et(r);const i=new ii(c,o,r.tenantKey);a=new Oe.a(i);break;case"fluid-test:":s=new Qs(o),a=new Ys;break;default:throw new Error("Unsupported protocol of the Fluid document url")}const d={load:()=>i(this,void 0,void 0,(function*(){return{fluidExport:zs}}))},l={url:t},h=yield s.resolve(l);if(!h||"fluid"!==h.type)throw new Error("Invalid Fluid document url");const f=new xe({urlResolver:s,documentServiceFactory:a,codeLoader:d,options:{user:o,blockUpdateMarkers:!0},logger:new class extends p.e{constructor(){super("aznb")}send(t){if("error"===t.category){const{eventName:n,errorType:r,error:o,message:s,docId:i,loaderVersion:a}=t;e.onLoaderError({eventName:n,errorType:r,error:o,message:s,documentId:i,loaderVersion:a})}}}}),m=yield ai.loadContainer(f,l),g=yield((e,t)=>i(void 0,void 0,void 0,(function*(){let n;try{n=yield(e=>i(void 0,void 0,void 0,(function*(){Fr("resolving data component");const t=yield new Promise((t,n)=>{e.request({url:"/"}).then(t).catch(n),setTimeout(()=>n(new Error("Failed to request the root component due to timeout.")),15e3)});if(200!==t.status||"fluid/object"!==t.mimeType)throw new Error(`Unable to retrieve Fluid object. Status: ${t.status}.`);if(void 0===t.value)throw new Error("Failed to retrieve root component. Empty response from container.");return t.value})))(e)}catch(e){throw Fr("Failed to initialize notebook model",e),e}if(!n)throw Fr("Cannot resolve DDS component."),new Error("Cannot resolve DDS component.");const{documentUrl:r,guest:o}=t,s=new ri(r,o.userId,e,n);return yield s.initialize(),s})))(m,e);return Fr("Document loaded",l.url),g}))}static loadContainer(e,t){return i(this,void 0,void 0,(function*(){let n;Fr("Opening Fluid document",t.url);try{const r=e.resolve(t);Fr("waiting for the loader to resolve the container."),n=yield new Promise((e,t)=>{r.then(e).catch(t),setTimeout(()=>t(new Error("Failed to resolve the container due to timeout.")),15e3)})}catch(e){throw Fr("Failed to load container",e.errorType,e),e}n.on("error",e=>Fr("Container error",e)).on("closed",e=>Fr("Container closed",e)).on("disconnected",()=>Fr("Container disconnected")).on("warning",e=>Fr("Container warning",e));try{yield ai.initializeChaincode(n,{package:{name:"@aznb/notebook-dds",version:"0.3.0",fluid:{browser:{}}},config:{}})}catch(e){throw n.close(),e}return n.hasNullRuntime()&&(yield new Promise(e=>n.once("contextChanged",()=>e()))),n}))}static initializeChaincode(e,t){return i(this,void 0,void 0,(function*(){Fr("initializing chaincode");const n=e.getQuorum();e.connected||(Fr("waiting for the container to get connected"),yield new Promise((t,n)=>{e.once("connected",()=>t()),e.once("closed",e=>n(new Error("Container closed unexpectedly. "+(null==e?void 0:e.message)))),setTimeout(()=>n(new Error("Failed to connect the container due to timeout.")),15e3)})),n.has("code")||(yield n.propose("code",t)),Fr("Code quorum accepted",n.get("code"))}))}}var ui=n("./src/common/diagnostics/index.ts"),ci=n("./src/common/request/endpoint.ts"),di=n("./src/common/util/verify.ts"),li=n("./src/common/util/requires.ts"),hi=n("./src/core/notebook/selectors.ts"),fi=n("./src/core/notebook/utils.ts"),mi=n("./src/features/collaboration/types/index.ts"),pi=n("./node_modules/reselect/es/index.js"),gi=n("./node_modules/@nteract/core/lib/index.js"),bi=n("./src/features/collaboration/featureConstants.ts");const vi=e=>e.features[bi.a],yi=Object(pi.createSelector)(vi,e=>e.tenantId),_i=Object(pi.createSelector)(vi,e=>e.resourceId),wi=Object(pi.createSelector)(vi,e=>e.documentUrl),ki=Object(pi.createSelector)(vi,e=>e.userId),Si=Object(pi.createSelector)(vi,e=>e.sessionStatus),ji=Object(pi.createSelector)(vi,e=>e.connectionStatus),Ci=Object(pi.createSelector)(vi,e=>e.audience),xi=Object(pi.createSelector)(vi,e=>e.presence),Oi=Object(pi.createSelector)(vi,e=>e.cellOutputAnnotations),Ei=Object(pi.createSelector)(vi,e=>e.sessionConfig),Ii=Object(pi.createSelector)(vi,e=>e.isLeader),Ai=Object(pi.createSelector)(vi,e=>e.cellIdMap),Ni=Object(pi.createSelector)(vi,e=>e.reverseCellIdMap),Ti=(e,t)=>{const n=Oi(e);if(n)return n.get(t,void 0)},Fi=(e,t)=>{const n=Ci(e);if(n){const e=n.get(t);return e?e.toJS():void 0}},Pi=e=>{const t=Ci(e);return t?t.filter(e=>e.get("presence")===Ke.active).size:0},Ri=(e,t)=>!t||"joined"!==Si(e)||!0===Ii(e),Di=(e,t)=>{const n=Ai(e);return!!n&&n.has(t)},Mi=(e,t)=>{const n=Ni(e);if(n)return n.get(t)},Li=(e,t)=>{const n=Ai(e);if(n)return n.get(t)},Bi=e=>{const t=Ai(e);return t?t.keys():[]},qi=(e,t)=>{const n=gi.selectors.model(e,{contentRef:t});if(!n||"notebook"!==n.type)return;const r=Bi(e),o=new Set(gi.selectors.notebook.cellOrder(n));let s;for(const e of r)if(!o.has(e)){s=e;break}return s},zi=(e,t)=>{let n,r,o=-1;const s=gi.selectors.model(e,{contentRef:t});if(s&&"notebook"===s.type){const t=new Set([...Bi(e)]),i=gi.selectors.notebook.cellOrder(s);for(let e=0;e<i.size;e++){const r=i.get(e,"");if(!t.has(r)&&""!==r){n=r,o=e;break}}r=o-1>=0?i.get(o-1):void 0}return{pasteCellId:n,insertAfterId:r}};var Hi=n("./src/common/localLogger.ts"),Ui=Object(Hi.a)("collab"),Vi=n("./node_modules/typesafe-actions/dist/index.umd.js");const $i="collaboration/",Wi=Object(Vi.createAction)($i+"updateAudience",e=>(t,n)=>e({userId:t,guestUser:n})),Ki=Object(Vi.createAction)($i+"updatePresence",e=>(t,n,r)=>e({peerId:t,userId:n,location:r})),Gi=Object(Vi.createAction)($i+"setCursorPosition",e=>(t,n,r)=>e({cellId:t,position:n,selection:r})),Ji=Object(Vi.createAction)($i+"updateLeaderElection",e=>t=>e(t)),Zi=Object(Vi.createAction)($i+"updateCellOutputAnnotation",e=>(t,n)=>e({cellId:t,userId:n})),Xi=Object(Vi.createAction)($i+"deleteCellOutputAnnotation",e=>t=>e({cellId:t})),Yi=Object(Vi.createAction)($i+"clearCellOutputAnnotations",e=>()=>e()),Qi=Object(Vi.createAction)($i+"initCellOutputAnnotations",e=>t=>e(t)),ea=Object(Vi.createAction)($i+"initCellIdMap",e=>t=>e(t)),ta=Object(Vi.createAction)($i+"updateCellIdMap",e=>(t,n)=>e({localId:t,remoteId:n})),na=Object(Vi.createAction)($i+"deleteCellIdFromMap",e=>t=>e(t)),ra=Object(Vi.createStandardAction)($i+"error").map((e,t)=>({payload:e,meta:t,error:!0})),oa=Object(Vi.createAction)($i+"attachCellAdapter",e=>(t,n)=>e({cellId:t,contentRef:n})),sa=Object(Vi.createAction)($i+"detachCellAdapter",e=>t=>e({cellId:t})),ia=Object(Vi.createAction)($i+"updateConnectionStatus",e=>t=>e(t));var aa=n("./src/features/monaco/index.ts"),ua=n("./node_modules/crypto-browserify/index.js");const ca=e=>ua.createHash("sha256").update(e).digest();class da{constructor(e,t,n,r){this.cellId=e,this.remoteCell=t,this.contentRef=n,this.dispatch=r,this.ignoreModelContentChanges=!1,this.useBackgroundStrategy()}dispose(){var e;null===(e=this.strategy)||void 0===e||e.dispose(),this.strategy=void 0}bindEditor(e){var t,n;if("interactive"===(null===(t=this.strategy)||void 0===t?void 0:t.type))return;null===(n=this.strategy)||void 0===n||n.dispose(),this.strategy=void 0,Ui("Attach cell editor",this.cellId,this.remoteCell.id);const r=this.remoteCell.getSource();this.verifyAndReport(r,e);const o=e.onDidChangeContent(this.handleEditorModelContentChange.bind(this,r)),i=(t,n)=>{if(!n)try{this.mergeDelta(e,t.contents)}catch(e){Ui(e)}};r.on("op",i),this.strategy={type:"interactive",dispose:()=>Object(s.b)(this,void 0,void 0,(function*(){Ui("Detach cell editor",this.cellId,this.remoteCell.id),o.dispose(),r.off("op",i),this.verifyAndReport(r,e)}))}}unbindEditor(){var e;"interactive"===(null===(e=this.strategy)||void 0===e?void 0:e.type)&&(this.strategy.dispose(),this.strategy=void 0),this.strategy||this.useBackgroundStrategy()}verifyAndReport(e,t){const n=e.getText(),r=ca(n),o=t.getValue(),s=ca(o);return!!r.equals(s)||(Ui("Local and remote cell sources don't match",s,r),this.dispatch(ra("Local and remote cell sources don't match",{errorCode:"collab_cell_source_desync_error",sendToHost:!1})),!1)}useBackgroundStrategy(){var e;if("background"===(null===(e=this.strategy)||void 0===e?void 0:e.type))return;Ui("Attach background cell strategy",this.cellId,this.remoteCell.id);const t=this.remoteCell.source$.subscribe(e=>{this.dispatch(gi.actions.updateCellSource({id:this.cellId,contentRef:this.contentRef,value:e,origin:"remote"}))});this.strategy={type:"background",dispose:()=>{Ui("Detach background cell strategy",this.cellId,this.remoteCell.id),t.unsubscribe()}}}handleEditorModelContentChange(e,t){if(!this.ignoreModelContentChanges)for(const n of t.changes)n.text?0===n.rangeLength?e.insertText(n.rangeOffset,n.text):e.replaceText(n.rangeOffset,n.rangeOffset+n.rangeLength,n.text):(n.rangeLength>0||n.rangeOffset>0)&&e.removeText(n.rangeOffset,n.rangeOffset+n.rangeLength)}mergeDelta(e,t){switch(t.type){case 0:this.mergeInsertDelta(e,t);break;case 1:this.mergeRemoveDelta(e,t);break;case 3:this.mergeDeltaGroup(e,t)}}mergeDeltaGroup(e,t){for(const n of t.ops)this.mergeDelta(e,n)}mergeInsertDelta(e,t){if("number"!=typeof t.pos1||"string"!=typeof t.seg)return;const n=this.offsetsToRange(e,t.pos1,t.pos2),r=t.seg||"";n&&this.applyMonacoEdits(e,[{range:n,text:r}])}mergeRemoveDelta(e,t){if("number"!=typeof t.pos1||"number"!=typeof t.pos2)return;const n=this.offsetsToRange(e,t.pos1,t.pos2);n&&this.applyMonacoEdits(e,[{range:n,text:""}])}applyMonacoEdits(e,t){this.ignoreModelContentChanges=!0;try{e.pushEditOperations([],t,()=>null)}finally{this.ignoreModelContentChanges=!1}}offsetsToRange(e,t,n){const r=e.getPositionAt(t),o="number"==typeof n?e.getPositionAt(n):r;return new aa.c.Range(r.lineNumber,r.column,o.lineNumber,o.column)}}class la{constructor(e,t,n){this.model=e,this.store=t,this.contentRef=n,this.relays=new Map}dispose(){return Object(s.b)(this,void 0,void 0,(function*(){this.relays.forEach(e=>e.dispose()),this.relays.clear()}))}initialize(){return Object(s.b)(this,void 0,void 0,(function*(){const e=Ai(this.store.getState());li.a.notNullOrUndefined(e,"idMap","Cell map must be initialized first.");for(const[t,n]of e.entries())yield this.bindCell(t,n)}))}bindCell(e,t){return Object(s.b)(this,void 0,void 0,(function*(){if(this.relays.has(e))return void Ui(" Cell binding for this cell is already created",e,t);const n=yield this.model.getCell(t);li.a.notNullOrUndefined(n,"remoteCell","Remote cell cannot be found.");const r=new da(e,n,this.contentRef,this.store.dispatch);this.relays.set(e,r)}))}unbindCell(e){const t=this.relays.get(e);this.relays.delete(e),null==t||t.dispose()}bindEditor(e,t){const n=this.relays.get(e);li.a.notNullOrUndefined(n,"relay","Cell binding is not created for the editor.");const r=aa.c.DocumentUri.createCellUri(this.contentRef,e,t),o=aa.c.editor.getModel(r);li.a.notNullOrUndefined(o,"editorModel","Editor cannot be found for the cell."),n.bindEditor(o)}unbindEditor(e){const t=this.relays.get(e);null==t||t.unbindEditor()}}class ha{constructor(e,t,n){this.dds=e,this.store=t,this.contentRef=n}recordCellMetadataUpdate(e,t,n){return Object(s.b)(this,void 0,void 0,(function*(){const r=this.getRemoteCellId(e),o=r?yield this.dds.getCell(r):void 0;tt(o)&&o.updateMetadata(t,n)}))}recordCellOutput(e,t){return Object(s.b)(this,void 0,void 0,(function*(){const n=this.getRemoteCellId(e),r=n?yield this.dds.getCell(n):void 0,o=ki(this.state);if(tt(r)&&o){const e={createdBy:o,value:t};r.appendOutput(e)}}))}recordClearAllOutputs(){return Object(s.b)(this,void 0,void 0,(function*(){for(const e of Bi(this.state))yield this.recordClearOutputs(e)}))}recordClearOutputs(e){return Object(s.b)(this,void 0,void 0,(function*(){const t=this.getRemoteCellId(e),n=t?yield this.dds.getCell(t):void 0;tt(n)&&n.clearOutputs()}))}recordDeleteCell(e,t){if(!t&&Di(this.state,e)){const t=this.getRemoteCellId(e);this.dds.deleteCell(t)}return this.store.dispatch(na(e)),Promise.resolve()}recordFileVersion(e){this.dds.setVersion(e)}recordInsertCell(e,t,n){return Object(s.b)(this,void 0,void 0,(function*(){if(!n){const r=gi.selectors.cell.cellFromState(this.state,{id:e,contentRef:this.contentRef});n=this.newRemoteCellId(e);const o=t?this.getRemoteCellId(t):void 0;yield this.dds.insertCell(n,o,r)}this.store.dispatch(ta(e,n))}))}recordMoveCell(e,t,n){const r=this.getRemoteCellId(e),o=this.getRemoteCellId(t);return r&&o&&this.dds.moveCell(r,o,n),Promise.resolve()}recordNotebookMetadataUpdate(e,t){this.dds.updateMetadata(e,t)}recordReplaceCell(e,t){return Object(s.b)(this,void 0,void 0,(function*(){const t=gi.selectors.cell.cellFromState(this.state,{id:e,contentRef:this.contentRef});if(Di(this.state,e)){const n=this.getRemoteCellId(e);yield this.dds.replaceCell(n,t)}}))}get state(){return this.store.getState()}newRemoteCellId(e){return e}getRemoteCellId(e){return Li(this.state,e)}}var fa,ma,pa,ga=n("./node_modules/immutable/dist/immutable.es.js"),ba=n("./src/core/notebook/index.ts");class va{constructor(e,t,n){this.store=t,this.contentRef=n,this.connect(e)}dispose(){return Object(s.b)(this,void 0,void 0,(function*(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions.splice(0)}))}connect(e){this.subscriptions=[e.cells$.subscribe(this.mergeCellOrderDelta.bind(this,e)),e.outputs$.subscribe(e=>{const t=this.getLocalCellId(e.cellId);switch(e.event){case"append":e.output.createdBy&&this.store.dispatch(Zi(t,e.output.createdBy)),this.store.dispatch(gi.actions.appendOutput({id:t,contentRef:this.contentRef,output:e.output.value,origin:"remote"}));break;case"clear":this.store.dispatch(gi.actions.clearOutputs({id:t,contentRef:this.contentRef,origin:"remote"}))}}),e.notebookMetadata$.subscribe(this.updateNotebookMetadata.bind(this)),e.cellMetadata$.subscribe(this.updateCellMetadata.bind(this)),e.version$.subscribe(e=>{e&&this.store.dispatch(ba.a.updateFileVersion({version:e,origin:"remote"}))})]}get state(){return this.store.getState()}getLocalCellId(e){return Mi(this.state,e)}getNotebookModel(){const e=this.state,t=gi.selectors.model(e,{contentRef:this.contentRef});return t&&"notebook"===t.type?t:null}getCellList(e){return(e=e||this.getNotebookModel())?gi.selectors.notebook.cellOrder(e):ga.default.List()}mergeCellOrderDelta(e,t){return Object(s.b)(this,void 0,void 0,(function*(){switch(t.event){case"insert":yield this.mergeInsertCellDelta(e,t);break;case"remove":this.mergeRemoveCellDelta(t);break;case"move":this.mergeMoveCellDelta(t);break;case"replace":this.mergeReplaceCellDelta(e,t)}}))}mergeInsertCellDelta(e,t){return Object(s.b)(this,void 0,void 0,(function*(){const n=t.id,r=(yield e.getCell(n)).asImmutable();let o;const s=this.getCellList();if(t.pos>0&&t.pos<=s.size&&(o=s.get(t.pos-1)),o)this.store.dispatch(gi.actions.createCellBelow({id:o,contentRef:this.contentRef,cellType:r.cell_type,cell:r,origin:"remote",remoteCellId:n}));else{const e=s.get(0);this.store.dispatch(gi.actions.createCellAbove({id:e,contentRef:this.contentRef,cellType:r.cell_type,cell:r,origin:"remote",remoteCellId:n}))}}))}mergeRemoveCellDelta(e){const t=this.getCellList();if(e.pos>=0&&e.pos<t.size){const n=t.get(e.pos);this.store.dispatch(gi.actions.deleteCell({id:n,contentRef:this.contentRef,origin:"remote"}))}}mergeMoveCellDelta(e){const t=this.getCellList(),n=t.get(e.pos1);let r,o=!0;e.pos2<t.size&&(e.pos2===t.size-1?(r=t.get(-1),o=!1):r=e.pos1<e.pos2?t.get(e.pos2+1):t.get(e.pos2),n&&r&&this.store.dispatch(gi.actions.moveCell({id:n,contentRef:this.contentRef,destinationId:r,above:o,origin:"remote"})))}mergeReplaceCellDelta(e,t){return Object(s.b)(this,void 0,void 0,(function*(){const n=this.getLocalCellId(t.id),r=yield e.getCell(t.id);if(n&&r){const e=r.asImmutable().cell_type;t.local||this.store.dispatch(gi.actions.changeCellType({id:n,contentRef:this.contentRef,to:e,origin:"remote"}))}}))}updateCellMetadata(e){const{cellId:t,key:n,value:r}=e,o=this.getLocalCellId(t);o&&this.store.dispatch(ba.a.setCellMetadata({cellId:o,contentRef:this.contentRef,key:n,value:r,origin:"remote"}))}updateNotebookMetadata(e){const{key:t,value:n}=e;this.store.dispatch(gi.actions.overwriteMetadataField({contentRef:this.contentRef,field:t,value:n,origin:"remote"}))}}class ya{constructor(e,t,n,r){this.document=e,this.store=t,this.dispatch=n,this.contentRef=r}extractDocumentModel(e){return Object(s.b)(this,void 0,void 0,(function*(){Ui("Extracting notebook model from DDS");let t=yield this.document.root.getModel();if(!t||this.shouldSeedModel(t,e)){Ui("Retrieving notebook content to seed the session state.");const n={notebook:yield e.getSeedModel(),version:e.version};t=yield this.document.root.resetModel(n)}else Ui("Will use the DDS model to load notebook content.");return t}))}useDocumentModel(e,t,n){var r;return Object(s.b)(this,void 0,void 0,(function*(){Ui("Loading notebook from DDS snapshot");const o=yield e.asImmutable();this.loadFromSnapshot(o,e.getVersion(),t,n);const s=new Map;this.getCellList().zip(o.cellOrder).forEach(([e,t])=>{s.set(e,t)}),this.dispatch(ea(s));const i=yield e.getOutputAnnotations(),a=new Map;null===(r=Ai(this.state))||void 0===r||r.forEach((e,t)=>{i.has(e)&&a.set(t,i.get(e))}),this.dispatch(Qi(a))}))}extractCheckpoint(e){var t,n;let r=null==e?void 0:e.content;if(!e){const e=Object(fi.d)(this.state,{contentRef:this.contentRef});if("notebook"!==(null==e?void 0:e.type)||!e.content)return;r=e.content}const o=JSON.stringify(r);return{hash:Object(fi.f)(o),version:null!==(n=null===(t=e)||void 0===t?void 0:t.version)&&void 0!==n?n:ba.e.fileVersion(this.state),created:(new Date).toISOString()}}shouldSeedModel(e,t){const n=e.getVersion();if(t.shouldSeedModel)return t.shouldSeedModel(n);const r=t.version;return r?(Ui("Should seed model [source version, model version]?",r,n),r!==n):(Ui("Source version is not provided, will load notebook content from the session."),!1)}loadFromSnapshot(e,t,n,r){var o;try{const s=Object(fi.a)(e);this.dispatch(ba.a.updateFileVersion({version:t,origin:"remote"})),this.dispatch(gi.actions.fetchContentFulfilled({filepath:n,model:Object.assign(Object.assign({},s),{loadType:r}),kernelRef:null!==(o=gi.selectors.kernelRefByContentRef(this.state,{contentRef:this.contentRef}))&&void 0!==o?o:"",contentRef:this.contentRef}))}catch(e){this.dispatch(ra("Failed to load notebook from snapshot. "+e.message,{errorCode:"collab_load_snapshot_error",sendToHost:!1}))}}get state(){return this.store.getState()}getNotebookModel(){const e=this.state,t=gi.selectors.model(e,{contentRef:this.contentRef});return t&&"notebook"===t.type?t:null}getCellList(e){return(e=e||this.getNotebookModel())?gi.selectors.notebook.cellOrder(e):ga.default.List()}}!function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(fa||(fa={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(ma||(ma={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(pa||(pa={}));var _a=[pa.lightBlue,pa.blue,pa.darkBlue,pa.teal,pa.green,pa.darkGreen,pa.lightPink,pa.pink,pa.magenta,pa.purple,pa.orange,pa.lightRed,pa.darkRed,pa.violet,pa.gold,pa.burgundy,pa.warmGray,pa.cyan,pa.rust,pa.coolGray],wa=_a.length;function ka(e){var t=e.primaryText,n=e.text,r=e.initialsColor;return"string"==typeof r?r:function(e){switch(e){case pa.lightBlue:return"#4F6BED";case pa.blue:return"#0078D4";case pa.darkBlue:return"#004E8C";case pa.teal:return"#038387";case pa.lightGreen:case pa.green:return"#498205";case pa.darkGreen:return"#0B6A0B";case pa.lightPink:return"#C239B3";case pa.pink:return"#E3008C";case pa.magenta:return"#881798";case pa.purple:return"#5C2E91";case pa.orange:return"#CA5010";case pa.red:return"#EE1111";case pa.lightRed:return"#D13438";case pa.darkRed:return"#A4262C";case pa.transparent:return"transparent";case pa.violet:return"#8764B8";case pa.gold:return"#986F0B";case pa.burgundy:return"#750B1C";case pa.warmGray:return"#7A7574";case pa.cyan:return"#005B70";case pa.rust:return"#8E562E";case pa.coolGray:return"#69797E";case pa.black:return"#1D1D1D";case pa.gray:return"#393939"}}(r=void 0!==r?r:function(e){var t=pa.blue;if(!e)return t;for(var n=0,r=e.length-1;r>=0;r--){var o=e.charCodeAt(r),s=r%8;n^=(o<<s)+(o>>8-s)}return _a[n%wa]}(n||t))}class Sa{constructor(e,t,n){this.presence=e,this.store=t,this.resolvePersona=n,this.connect(e)}dispose(){return Object(s.b)(this,void 0,void 0,(function*(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions.splice(0)}))}recordCursorPosition(e,t,n){const r={focusedCell:this.getRemoteCellId(e)||"unknown",cursorPosition:t,selectionRange:n};this.presence.updatePresence(r)}connect(e){return Object(s.b)(this,void 0,void 0,(function*(){this.subscriptions=[e.presence$.subscribe(this.updatePresence.bind(this)),e.audience$.subscribe(this.updateAudience.bind(this))]}))}updateAudience(e){let t=this.resolvePersona?this.resolvePersona(e.userId):void 0;t||(t={id:e.userId,userName:e.displayName||"Anonymous Guest"});const n=ka({text:t.userName});this.store.dispatch(Wi(e.userId,{userId:e.userId,userName:t.userName,userInitials:"AP",color:n,presence:e.presence}))}updatePresence(e){const{peerId:t,userId:n,location:r}=e;r&&r.focusedCell&&(r.focusedCell=this.getLocalCellId(r.focusedCell)||"unknown"),this.store.dispatch(Ki(t,n,r))}get state(){return this.store.getState()}getLocalCellId(e){return Mi(this.state,e)}getRemoteCellId(e){return Li(this.state,e)}}class ja{constructor(e,t,n,r){this.document=e,this.contentRef=t,this.store=n,this.handlers=r,this.subscriptions=[],this.adapter=new ya(e,n,n.dispatch,t),this.subscriptions.push(this.document.event$.subscribe(e=>{switch(Ui(" Document event",e),e.event){case"connect":this.dispatch(ia("online"));break;case"disconnect":this.dispatch(ia("offline"));break;case"error":this.dispatch(ra("Collaboration session error is reported: "+e.error.message,{errorCode:"collab_session_error",sendToHost:!0}))}}))}get documentUrl(){return this.document.documentUrl}get userId(){return this.document.userId}reload(e){return Object(s.b)(this,void 0,void 0,(function*(){yield this.disposeSessionServices();const t=yield this.adapter.extractDocumentModel(e);yield this.adapter.useDocumentModel(t,e.filePath,"reload"),yield this.createSessionServices(t)}))}recordCheckpoint(e){const t=this.adapter.extractCheckpoint(e);t&&this.document.root.recordCheckpoint(t)}dispose(){var e;return Object(s.b)(this,void 0,void 0,(function*(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions.splice(0),yield this.disposeSessionServices(),yield this.presence.dispose(),null===(e=this.document)||void 0===e||e.close()}))}initialize(e){return Object(s.b)(this,void 0,void 0,(function*(){Ui("Initializing session");const{sourceModel:t,loadType:n}=e,r=yield this.adapter.extractDocumentModel(t);yield this.adapter.useDocumentModel(r,t.filePath,n),yield this.createSessionServices(r),this.subscriptions.push(this.document.root.checkpoint$.subscribe(e=>{const t=this.adapter.extractCheckpoint();if(e.hash===(null==t?void 0:t.hash))return Ui("Checkpoints match",e),void this.dispatch(gi.actions.saveFulfilled({contentRef:this.contentRef,model:{last_modified:e.created},origin:"remote"}));Ui("Checkpoints do NOT match",e,t)}),this.document.root.model$.subscribe(e=>Object(s.b)(this,void 0,void 0,(function*(){Ui(" New DDS registered",e);const n=yield this.document.root.getModel();yield this.registerModel(n,t.filePath)})),e=>{Ui("Error in model subscription",e)},()=>{Ui("Model subscription exhausted")}),this.document.root.leader$.subscribe(e=>{this.store.dispatch(Ji(e))}));const o=yield this.document.root.getPresence();this.presence=new Sa(o,this.store,this.handlers.resolvePersona)}))}get dispatch(){return this.store.dispatch}createSessionServices(e){return Object(s.b)(this,void 0,void 0,(function*(){this.recorder=new ha(e,this.store,this.contentRef),this.replicator=new va(e,this.store,this.contentRef),this.binder=new la(e,this.store,this.contentRef),yield this.binder.initialize()}))}disposeSessionServices(){return Object(s.b)(this,void 0,void 0,(function*(){try{this.binder&&(yield this.binder.dispose(),yield this.replicator.dispose())}catch(e){Ui("Failed to dispose of session services.",e)}}))}registerModel(e,t){return Object(s.b)(this,void 0,void 0,(function*(){try{yield this.disposeSessionServices(),yield this.adapter.useDocumentModel(e,t,"reload"),yield this.createSessionServices(e)}catch(e){Ui("Failed to register remote model revision",e),this.dispatch(ra("Failed to load notebook from remote revision: "+e.message,{errorCode:"collab_session_error",sendToHost:!0}))}}))}}class Ca{constructor(e,t,n){this.store=e,this.services=t,this.handlers=n}joinSession(e){var t;return Object(s.b)(this,void 0,void 0,(function*(){const n=Object(hi.getDocumentId)(this.state);li.a.notNullOrUndefined(n,"documentId","Document ID is not specified");const r=this.resolveGuest(),o=yield this.getTenantInfo(n,r.userId),i=((e,t)=>{if(li.a.notNullOrUndefined(e,"documentId","Document ID for the collaboration session is not provided."),li.a.notNullOrUndefined(t,"tenantInfo","Tenant is required to establish a collaboration session."),li.a.notNullOrUndefined(t.protocol,"protocol","Protocol is required."),li.a.notNullOrUndefined(t.ordererUrl,"ordererUrl","Orderer URL is required."),"fluid-test"!==t.protocol){const n=new URL(t.ordererUrl),r=t.tenantId,o=encodeURIComponent(r),s=encodeURIComponent(e);return`${t.protocol}://${n.host}/${o}/${s}`}return"fluid-test://localhost/test/"+encodeURIComponent(e)})(n,o),a=null!==(t=_i(this.state))&&void 0!==t?t:"",u=yield ai.load({documentUrl:i,guest:r,config:Object.assign(Object.assign({},o),{resourceId:a,getFluidAccessToken:(e,t)=>Object(s.b)(this,void 0,void 0,(function*(){const n=yield this.getResultFromAzureNotebookServices("/api/collab/tenants/token",e,t,r.userId);if(n)return n.token;throw new Error("Could not fetch new fluid access token")})),getWebsocketToken:()=>Object(s.b)(this,void 0,void 0,(function*(){return yield this.services.tokenStore.getToken()}))}),onLoaderError:e=>{var t,n;const r=mi.collabLogEventPrefix+"/loaderError",o=Object(fi.f)(i);ui.b.logEvent(null!==(t=e.error)&&void 0!==t?t:e.message,r,{properties:{documentUrl:o,eventName:e.eventName,errorType:e.errorType,loaderVersion:e.loaderVersion}}),this.store.dispatch(ra("Fluid document loader error: "+(null!==(n=e.error)&&void 0!==n?n:e.message),{errorCode:"collab_loader_error",sendToHost:!1}))}}),c=new ja(u,e.contentRef,this.store,this.handlers);try{return yield c.initialize(e),c}catch(e){throw yield c.dispose(),e}}))}get state(){return this.store.getState()}resolveGuest(){const e=Object(hi.getUserInfo)(this.state);return di.a.operation(!!e,"Cannot join a collaboration session anonymously."),{userId:`${e.tenantId}:${e.alias}@${e.domain}`,displayName:e.displayName,presence:Ke.active}}getTenantInfo(e,t){return Object(s.b)(this,void 0,void 0,(function*(){let n;if(this.handlers.resolveTenant&&(n=yield this.handlers.resolveTenant(e)),n&&n.ordererUrl){if("fluid-test"===n.ordererUrl)return Object.assign(Object.assign({},n),{protocol:"fluid-test"});const e=new URL(n.ordererUrl);return"localhost"===e.hostname||"127.0.0.1"===e.hostname?Object.assign({protocol:"tinylicious",tenantId:"tinylicious",tenantKey:"12345"},n):Object.assign({protocol:"fluid"},n)}const r=yi(this.state)||"",o=yield this.getResultFromAzureNotebookServices("/api/collab/tenants/",r,e,t);if(o){const e=new URL("/api/proxy/collab/",Object(ci.b)());n={protocol:"fluid-aznb",tenantId:o.id,token:o.token,ordererUrl:e.toString(),sessionServerUrl:o.sessionServerUrl}}if(!n)throw new Error("Unable to resolve collaboration service tenant");return n}))}getResultFromAzureNotebookServices(e,t,n,r){return Object(s.b)(this,void 0,void 0,(function*(){li.a.notNullOrUndefined(e,"servicePath","Collaboration servicePath is not specified."),li.a.notNullOrUndefined(t,"tenantId","Collaboration tenant ID is not specified."),li.a.notNullOrUndefined(n,"documentId","Collaboration document ID is not specified."),li.a.notNullOrUndefined(r,"userId","Collaboration user ID is not specified.");const o=yield this.services.tokenStore.getToken();let s={};o&&(s={Authorization:"Bearer "+o,tenantId:t,documentId:n});const i={id:t,docId:n,userId:r};return yield this.services.azureNotebookServicesRequest.post(e,i,s).catch(e=>{const t=JSON.stringify(e);throw new Error("Tenant request failed with error "+t)})}))}}var xa=n("./src/events/utils.ts"),Oa=n("./src/features/collaboration/actions.ts");class Ea{constructor(e,t,n,r,o){this.store=e,this.contentRef=t,this.eventListeners=n,this.containerEl=r,this.dispatch=e.dispatch,o.onSessionStatusChange&&this.onSessionStatusChange(o.onSessionStatusChange),o.onConnectionStatusChange&&this.onConnectionStatusChange(o.onConnectionStatusChange),o.onLeaderElection&&this.onLeaderElection(o.onLeaderElection),o.onPresenceUpdate&&this.onPresenceUpdate(o.onPresenceUpdate)}get sessionStatus(){return Si(this.state)}get connectionStatus(){var e;return null!==(e=ji(this.state))&&void 0!==e?e:"offline"}get peers(){const e=xi(this.state);return e?[...e.entries()].map(([e,t])=>({id:e,user:{id:t.get("userId")}})):[]}get isLeader(){return!!Ii(this.state)}share(){return Object(s.b)(this,void 0,void 0,(function*(){this.dispatch(Oa.join.request({kind:"share",contentRef:this.contentRef}))}))}join(){return Object(s.b)(this,void 0,void 0,(function*(){this.dispatch(Oa.join.request({kind:"join",contentRef:this.contentRef}))}))}leave(){return this.dispatch(Oa.leave()),Promise.resolve()}onSessionStatusChange(e){Object(xa.a)(this.containerEl,mi.CollaborationEvent.SessionStatusChange,e,this.eventListeners)}onConnectionStatusChange(e){Object(xa.a)(this.containerEl,mi.CollaborationEvent.ConnectionStatusChange,e,this.eventListeners)}onLeaderElection(e){Object(xa.a)(this.containerEl,mi.CollaborationEvent.LeaderElection,e,this.eventListeners)}onPresenceUpdate(e){Object(xa.a)(this.containerEl,mi.CollaborationEvent.PresenceUpdate,e,this.eventListeners)}get state(){return this.store.getState()}}var Ia=n("./node_modules/@nteract/commutable/lib/index.js"),Aa=n("./src/common/telemetry1/telemetryUtils.ts"),Na=n("./src/common/request/request.ts"),Ta=n("./src/common/util/exceptions.ts"),Fa=n("./src/shell/util.ts");class Pa{constructor(e,t){this.store=e,this.featureState=t}fromContent(e,t,n,r){var o,i;return Object(s.b)(this,void 0,void 0,(function*(){const a=Si(this.state),u={filePath:t,version:n.version,getSeedModel:()=>Object(s.b)(this,void 0,void 0,(function*(){let e;return e=n.content&&Object(Fa.k)(n.content)?Object(Ia.fromJS)(JSON.parse(n.content)):Ia.emptyNotebook,e}))};return r||!0!==(null===(o=this.featureState)||void 0===o?void 0:o.shouldAutoJoin)?r&&"joined"===a?yield this.resetSession(u):!(!r||!0!==(null===(i=this.featureState)||void 0===i?void 0:i.shouldAutoJoin))&&(yield this.joinSession(e,u,"reload")):yield this.joinSession(e,u,"create")}))}fromUrl(e,t,n,r,o){var i,a;return Object(s.b)(this,void 0,void 0,(function*(){const u=Si(this.state),c=()=>Object(s.b)(this,void 0,void 0,(function*(){var e;const t=yield Object(Na.a)(n,r);if(t){const n=yield t.text(),r=Object(Fa.h)(n);return function(e){if(e&&!Object(Fa.k)(e))throw Ta.a.InvalidArgumentException("content needs to be a valid notebook format.")}(r.content),null!==(e=r.content)&&void 0!==e?e:""}throw new Error("Failed to fetch notebook content.")})),d={filePath:t,getSeedModel:()=>Object(s.b)(this,void 0,void 0,(function*(){const e=yield c();let t;return t=e&&Object(Fa.k)(e)?Object(Ia.fromJS)(JSON.parse(e)):Ia.emptyNotebook,t}))};return o||!0!==(null===(i=this.featureState)||void 0===i?void 0:i.shouldAutoJoin)?o&&"joined"===u?yield this.resetSession(d):!(!o||!0!==(null===(a=this.featureState)||void 0===a?void 0:a.shouldAutoJoin))&&(yield this.joinSession(e,d,"reload")):yield this.joinSession(e,d,"load")}))}resetSession(e){return Object(s.b)(this,void 0,void 0,(function*(){Object(Aa.d)(mi.reloadEvent);const t=this.featureState.session;try{return yield t.reload(e),!0}catch(e){return this.store.dispatch(ra("Failed to reset collaboration session. "+e.message,{errorCode:"collab_reset_session_error",sendToHost:!1})),!1}finally{const e=null==t?void 0:t.documentUrl,n=e?Object(fi.f)(e):"";Object(Aa.c)(mi.reloadEvent,void 0,{documentUrl:n})}}))}joinSession(e,t,n){return Object(s.b)(this,void 0,void 0,(function*(){if(Object(Aa.d)(mi.joinEvent),this.store.dispatch(Oa.join.request({kind:n,contentRef:e})),"reload"!==n){const n=Object(fi.a)(Ia.emptyNotebook);this.store.dispatch(gi.actions.fetchContentFulfilled({filepath:t.filePath,model:Object.assign(Object.assign({},n),{loadType:"create"}),kernelRef:"",contentRef:e}))}let r=this.featureState.session;r&&(yield r.dispose(),r=null);try{r=yield this.featureState.sessionFactory({contentRef:e,sourceModel:t,loadType:n}),this.featureState.session=r;const{documentUrl:o,userId:s}=r;return this.store.dispatch(Oa.join.success({documentUrl:o,userId:s})),!0}catch(e){return this.store.dispatch(Oa.join.failure({errorMessage:e.message})),!1}}))}get state(){return this.store.getState()}}const Ra={sessionStatus:"inactive",connectionStatus:"offline",presence:void 0,audience:void 0,cellOutputAnnotations:void 0},Da=(e=Ra,t)=>{switch(t.type){case Object(Vi.getType)(Oa.init):const{tenantId:n,resourceId:r}=t.payload;return Object.assign(Object.assign({},e),{tenantId:n,resourceId:r});case Object(Vi.getType)(Oa.join.request):return Object.assign(Object.assign({},e),{sessionStatus:"in-progress",presence:ga.Map(),audience:ga.Map(),cellOutputAnnotations:ga.Map(),cellIdMap:ga.Map(),reverseCellIdMap:ga.Map()});case Object(Vi.getType)(Oa.join.success):const{documentUrl:o,userId:s}=t.payload;return Object.assign(Object.assign({},e),{documentUrl:o,userId:s,sessionStatus:"joined",connectionStatus:"online"});case Object(Vi.getType)(Oa.join.failure):return Object.assign(Object.assign(Object.assign({},e),Ra),{sessionStatus:"failed"});case Object(Vi.getType)(Oa.leave):return Object.assign(Object.assign({},e),Ra);case Object(Vi.getType)(ia):const i=t.payload;return Object.assign(Object.assign({},e),{connectionStatus:i});case Object(Vi.getType)(Zi):{const n=function(e,t){const{cellId:n,userId:r}=e.payload;let o=t.cellOutputAnnotations;return o=o.set(n,r),o}(t,e);return Object.assign(Object.assign({},e),{cellOutputAnnotations:n})}case Object(Vi.getType)(Xi):{const n=function(e,t){const{cellId:n}=e.payload;let r=t.cellOutputAnnotations;return r=r.delete(n),r}(t,e);return Object.assign(Object.assign({},e),{cellOutputAnnotations:n})}case Object(Vi.getType)(Yi):{const t=ga.Map();return Object.assign(Object.assign({},e),{cellOutputAnnotations:t})}case Object(Vi.getType)(Qi):{const n=function(e,t){return ga.Map(e.payload)}(t);return Object.assign(Object.assign({},e),{cellOutputAnnotations:n})}case Object(Vi.getType)(Wi):const a=function(e,t){const{userId:n,guestUser:r}=e.payload;let o=t.audience;return o=r?o.set(n,ga.fromJS(r)):o.delete(n),o}(t,e);return Object.assign(Object.assign({},e),{audience:a});case Object(Vi.getType)(Ki):const u=function(e,t){let n=t.presence;if(e.payload.userId||e.payload.location){const{peerId:t,location:r}=e.payload,o=e.payload.userId||n.getIn([t,"userId"]);n=n.set(t,ga.fromJS({userId:o,location:r}))}else{const{peerId:t}=e.payload;n=n.delete(t)}return n}(t,e);return Object.assign(Object.assign({},e),{presence:u});case Object(Vi.getType)(Ji):const c=t.payload;return Object.assign(Object.assign({},e),{isLeader:c});case Object(Vi.getType)(ea):return function(e,t){let n=e.payload;const r=new Map;n.forEach((e,t)=>r.set(e,t)),n=ga.Map(n);const o=ga.Map(r);return Object.assign(Object.assign({},t),{cellIdMap:n,reverseCellIdMap:o})}(t,e);case Object(Vi.getType)(ta):return function(e,t){let n=t.cellIdMap,r=t.reverseCellIdMap;const{localId:o,remoteId:s}=e.payload;return n&&r&&o&&s&&(n=n.set(o,s),r=r.set(s,o)),Object.assign(Object.assign({},t),{cellIdMap:n,reverseCellIdMap:r})}(t,e);case Object(Vi.getType)(na):return function(e,t){let n=t.cellIdMap,r=t.reverseCellIdMap;const o=e.payload;if(n){const e=n.get(o);e&&r&&(r=r.delete(e)),n=n.delete(o)}return Object.assign(Object.assign({},t),{cellIdMap:n,reverseCellIdMap:r})}(t,e);default:return e}};var Ma=n("./node_modules/redux-observable/dist/esm/operators.js"),La=n("./node_modules/office-ui-fabric-react/lib/components/MessageBar/MessageBar.types.js"),Ba=n("./src/events/index.ts"),qa=n("./src/events/types.ts"),za=n("./src/shell/index.ts"),Ha=n("./src/features/collaboration/index.ts");const Ua=(e,t,n,r)=>{const o=wi(n),s=Ii(n),i=s?s.toString():"",a=r?`${Ha.collabLogEventPrefix}/${r}/${t}`:`${Ha.collabLogEventPrefix}/${t}`,u=r?`${r} ${e}`:e,c=o?Object(fi.f)(o):"";ui.b.logEvent(u,a,{documentUrl:c,isLeader:i})};var Va=[(e,t)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(ia)),Object(wr.withLatestFrom)(t),Object(wr.mergeMap)(([{payload:e},t])=>(Ua("connection status changed",Ha.CollaborationEvent.ConnectionStatusChange,t),Object(_r.of)(Ba.f.sendEvent("connection status changed",{name:Ha.CollaborationEvent.ConnectionStatusChange,type:qa.b.collaboration,param:{connectionStatus:"offline"},sendToHost:!0}))))),(e,t)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(Ji)),Object(wr.withLatestFrom)(t),Object(wr.mergeMap)(([{payload:e},t])=>(Ua("session leader election changed",Ha.CollaborationEvent.LeaderElection,t),Object(_r.of)(Ba.f.sendEvent("session leader election changed",{name:Ha.CollaborationEvent.LeaderElection,type:qa.b.collaboration,param:{isLeader:e},sendToHost:!0}))))),(e,t)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(Ki)),Object(wr.filter)(({payload:e})=>!e.location),Object(wr.withLatestFrom)(t),Object(wr.mergeMap)(([{payload:e},t])=>(Ua("peer presence updated",Ha.CollaborationEvent.PresenceUpdate,t),Object(_r.of)(Ba.f.sendEvent("peer presence updated",{name:Ha.CollaborationEvent.PresenceUpdate,type:qa.b.collaboration,param:{peerId:e.peerId,userId:e.userId},sendToHost:!0}))))),e=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(Ha.actions.init)),Object(wr.mergeMap)(()=>_r.EMPTY)),(e,t,n)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(Ha.actions.join.request)),Object(wr.filter)(({payload:e})=>["share","join"].includes(e.kind)),Object(wr.withLatestFrom)(t),Object(wr.mergeMap)(([{payload:e},t])=>{Object(Aa.d)(Ha.joinEvent);const{contentRef:r,kind:o}=e,i=Object(Ha.getFeatureState)(n),a={filePath:za.d.filePath(t),version:ba.e.fileVersion(t),getSeedModel:()=>Object(s.b)(void 0,void 0,void 0,(function*(){const e=gi.selectors.model(t,{contentRef:r});return e&&"notebook"===e.type?gi.selectors.notebook.notebook(e):Ia.emptyNotebook}))};var u;return Object(_r.from)((u=i.session,Object(s.b)(void 0,void 0,void 0,(function*(){return u&&(yield u.dispose(),u=null),u=yield i.sessionFactory({contentRef:r,sourceModel:"join"===o?a:Object.assign(Object.assign({},a),{shouldSeedModel:()=>!0}),loadType:"reload"})})))).pipe(Object(wr.map)(e=>{i.session=e;const{documentUrl:t,userId:n}=e;return Ha.actions.join.success({documentUrl:t,userId:n})}),Object(wr.catchError)(e=>Object(_r.of)(Ha.actions.join.failure({errorMessage:e.message}))))})),(e,t,n)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(Ha.actions.leave)),Object(wr.withLatestFrom)(t),Object(wr.mergeMap)(([,e])=>{const t=Object(Ha.getFeatureState)(n),r=Ba.f.sendEvent("session status changed",{name:Ha.CollaborationEvent.SessionStatusChange,type:qa.b.collaboration,param:{sessionStatus:Si(e),documentUrl:wi(e)},sendToHost:!0});return Object(_r.from)((o=t.session,Object(s.b)(void 0,void 0,void 0,(function*(){if(!o)throw new Error("Session doesn't exist");yield o.dispose()})))).pipe(Object(wr.switchMap)(()=>Object(_r.of)(r)),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to dispose of the collaboration session. "+e.message,{errorCode:"collab_leave_session_error",sendToHost:!1}),r)),Object(wr.finalize)(()=>t.session=null));var o})),(e,t)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(Wi)),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([{payload:e},t])=>{const{userId:n,guestUser:r}=e;if(n&&n!==ki(t)){const e={userId:n},o=wi(t),s=o?Object(fi.f)(o):"",i=Pi(t),a=i?i.toString():"",u="updateAudience";return r?(ui.b.logEvent("user added to audience",`${Ha.collabLogEventPrefix}/${u}/add`,{documentUrl:s,audienceCount:a}),Object(_r.of)(Ba.f.sendEvent("user added to audience",{name:Ha.CollaborationEvent.UserJoin,type:qa.b.collaboration,param:{user:e},sendToHost:!0}))):(ui.b.logEvent("user removed from audience",`${Ha.collabLogEventPrefix}/${u}/remove`,{documentUrl:s,audienceCount:a}),Object(_r.of)(Ba.f.sendEvent("user removed from audience",{name:Ha.CollaborationEvent.UserLeave,type:qa.b.collaboration,param:{user:e},sendToHost:!0})))}return _r.EMPTY})),(e,t)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)([Ha.actions.join.success,Ha.actions.join.failure])),Object(wr.withLatestFrom)(t),Object(wr.mergeMap)(([{payload:e},t])=>{Ua("session status changed",Ha.CollaborationEvent.SessionStatusChange,t);const{documentUrl:n}=e,r=n?Object(fi.f)(n):"",o=((e,t)=>Ba.f.sendEvent("session status changed",{name:Ha.CollaborationEvent.SessionStatusChange,type:qa.b.collaboration,param:{sessionStatus:Si(e),documentUrl:wi(e),documentId:Object(hi.getDocumentId)(e),duration:t},sendToHost:!0}))(t,Object(Aa.c)(Ha.joinEvent,void 0,{documentUrl:r}));return Object(_r.of)(o)})),e=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(Ha.actions.join.failure)),Object(wr.mergeMap)(({payload:e})=>Object(_r.of)(ra("Failed to join a collaboration session. "+e.errorMessage,{errorCode:"join_session_error",sendToHost:!0,showInErrorBar:!0,errorBarConfig:{level:La.a.error,code:"COLLAB1",context:null}})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.SAVE_FULFILLED),Object(wr.filter)(e=>"remote"!==e.payload.origin),Object(wr.mergeMap)(({payload:e})=>{const t=(e=>{var t;return null===(t=Object(Ha.getFeatureState)(e))||void 0===t?void 0:t.session})(n);return null==t||t.recordCheckpoint(e.model),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to record checkpoint: "+e.message,{errorCode:"collab_record_checkpoint_error",sendToHost:!1}))))],$a=n("./src/core/notebook/components/cellHelper.ts"),Wa=n("./src/common/util/constants.ts"),Ka=n("./src/features/collaboration/feature.ts");const Ga=e=>{var t;return null===(t=Object(Ka.b)(e))||void 0===t?void 0:t.session},Ja=[...Va,(e,t,n)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(oa)),Object(wr.withLatestFrom)(t),Object(wr.mergeMap)(([e,t])=>{const{cellId:r,contentRef:o}=e.payload,s=Ga(n),i=aa.c.getCellLanguage(t,o,r);return null==s||s.binder.bindEditor(r,i),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to attach a cell adapter: "+e.message,{errorCode:"collab_attach_cell_adapter_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(sa)),Object(wr.mergeMap)(({payload:e})=>{const t=Ga(n),{cellId:r}=e;return null==t||t.binder.unbindEditor(r),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to detach a cell adapter: "+e.message,{errorCode:"collab_detach_cell_adapter_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(na)),Object(wr.mergeMap)(({payload:e})=>(Ga(n).binder.unbindCell(e),_r.EMPTY)),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to set cursor position: "+e.message,{errorCode:"collab_setcursor_position_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.APPEND_OUTPUT),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([{payload:e},t])=>{const{id:r,output:o,origin:s}=e,i=Ga(n).recorder;return r&&"remote"!==s&&(i.recordCellOutput(r,o),Ua("collab appendOutput recorded","appendOutput",t,s)),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to append output: "+e.message,{errorCode:"collab_append_output_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.TOGGLE_CELL_INPUT_VISIBILITY,gi.actions.TOGGLE_CELL_OUTPUT_VISIBILITY,gi.actions.TOGGLE_OUTPUT_EXPANSION,Object(Vi.getType)(ba.a.setCellMetadata),Object(Vi.getType)(ba.a.setCellLanguage)),Object(wr.withLatestFrom)(t),Object(wr.filter)(([{payload:e},t])=>e&&"remote"!==e.origin&&"joined"===Si(t)),Object(wr.mergeMap)(([e,t])=>{const{id:r,cellId:o,contentRef:s}=e.payload,i=r||o;let a,u;const c=gi.selectors.model(t,{contentRef:s});if(!c||"notebook"!==c.type)return _r.EMPTY;const d=gi.selectors.notebook.cellById(c,{id:i});if(d){const r=d.get("metadata",$a.b);switch(e.type){case gi.actions.TOGGLE_CELL_INPUT_VISIBILITY:case gi.actions.TOGGLE_CELL_OUTPUT_VISIBILITY:a="jupyter",u=r.get("jupyter");break;case gi.actions.TOGGLE_OUTPUT_EXPANSION:a="collapsed",u=!!r.get("collapsed");break;case Object(Vi.getType)(ba.a.setCellLanguage):a=Wa.b,u=r.get(a);break;case Object(Vi.getType)(ba.a.setCellMetadata):const{key:t,value:n}=e.payload;a=t,u=n}a&&(Ga(n).recorder.recordCellMetadataUpdate(i,a,u),Ua("collab cell Metadata update recorded","updateCellMetadata",t))}return _r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to sync cell meta data: "+e.message,{errorCode:"collab_cell_metadata_sync_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.CHANGE_CELL_TYPE),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([{payload:e},t])=>{const{id:r,to:o,origin:s}=e,i=Ga(n).recorder;return"remote"!==s&&(i.recordReplaceCell(r,o),Ua("collab changeCellType recorded","changeCellType",t,s)),Object(_r.of)(Xi(r))}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed change cell type: "+e.message,{errorCode:"collab_change_celltype_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(wr.filter)(e=>e.type===gi.actions.CLEAR_ALL_OUTPUTS||Object(Vi.isActionOf)(ba.a.clearAllOutputs)(e)),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([{payload:e},t])=>{const r=Ga(n).recorder,o=null==e?void 0:e.origin;return"remote"!==o&&(r.recordClearAllOutputs(),Ua("collab clearAllOutputs recorded","clearAllOuputs",t,o)),Object(_r.of)(Yi())}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to clear all outputs: "+e.message,{errorCode:"collab_clear_all_outputs_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(wr.filter)(e=>e.type===gi.actions.CLEAR_OUTPUTS||Object(Vi.isActionOf)(ba.a.clearOutputs)(e)),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([{payload:e},t])=>{const r=e.id,o=Ga(n).recorder;return r&&"remote"!==e.origin&&(o.recordClearOutputs(r),Ua("collab clearOutputs recorded","clearOuputs",t,e.origin)),Object(_r.of)(Xi(r))}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to clear outputs: "+e.message,{errorCode:"collab_clear_outputs_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.CUT_CELL),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([e,t])=>{const{contentRef:r,origin:o}=e.payload,s=Ga(n).recorder,i=qi(t,r);return i?(s.recordDeleteCell(i),Ua("collab cutCell recorded","cutCell",t,o),Object(_r.of)(Xi(i))):_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to cut cell: "+e.message,{errorCode:"collab_cut_cell_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.DELETE_CELL),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([e,t])=>{const{id:r,origin:o}=e.payload,s=Ga(n).recorder;return r&&("remote"===o?s.recordDeleteCell(r,o):s.recordDeleteCell(r),Ua("collab deleteCell recorded","deleteCell",t,o)),Object(_r.of)(Xi(r))}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to delete cell: "+e.message,{errorCode:"collab_delete_cell_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(ba.a.updateFileVersion)),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([e])=>{const{version:t,origin:r}=e.payload,o=Ga(n).recorder;return"remote"!==r&&t&&o.recordFileVersion(t),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to record last modified time: "+e.message,{errorCode:"collab_last_modified_time_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.CREATE_CELL_BELOW,gi.actions.CREATE_CELL_ABOVE),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([e,t])=>{const{contentRef:r,id:o,origin:s,remoteCellId:i}=e.payload,a=gi.selectors.model(t,{contentRef:r});if(!a||"notebook"!==a.type||!o)return _r.EMPTY;let u,c,d;switch(e.type){case gi.actions.CREATE_CELL_ABOVE:u=Object(hi.cellIdsAbove)(a,{id:o}),u&&u.count()>0&&(d=u.get(-1),c=u.get(-2,void 0));break;case gi.actions.CREATE_CELL_BELOW:u=Object(hi.cellIdsBelow)(t,{contentRef:r,id:o}),u&&u.count()>1&&(d=u.get(1),c=o)}const l=Ga(n).recorder;return d&&("remote"===s&&i?l.recordInsertCell(d,c,i):l.recordInsertCell(d,c),Ua("collab insertCell recorded","insertCell",t,s)),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to insert cell: "+e.message,{errorCode:"collab_insert_cell_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.MOVE_CELL),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([e,t])=>{const{id:r,destinationId:o,above:s,origin:i}=e.payload,a=Ga(n).recorder;return"remote"!==i&&(a.recordMoveCell(r,o,s),Ua("collab moveCell recorded","moveCell",t,i)),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to move cell: "+e.message,{errorCode:"collab_move_cell_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.OVERWRITE_METADATA_FIELD,Object(Vi.getType)(ba.a.setNotebookMetadata),Object(Vi.getType)(ba.a.setNotebookLanguage)),Object(wr.withLatestFrom)(t),Object(wr.filter)(([{payload:e},t])=>e&&"remote"!==e.origin&&"joined"===Si(t)),Object(wr.mergeMap)(([e,t])=>{const{contentRef:r}=e.payload;let o,s;const i=gi.selectors.model(t,{contentRef:r});if(!i||"notebook"!==i.type)return _r.EMPTY;const a=gi.selectors.notebook.metadata(i);if(a)switch(e.type){case Object(Vi.getType)(ba.a.setNotebookMetadata):case Object(Vi.getType)(ba.a.setNotebookLanguage):o=Wa.b,s=a.get(o);break;case gi.actions.OVERWRITE_METADATA_FIELD:const{field:t,value:n}=e.payload;o=t,s=n}return o&&(Ga(n).recorder.recordNotebookMetadataUpdate(o,s),Ua("collab Notebook Metadata update recorded","updateNotebookMetadata",t)),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to sync notebook meta data: "+e.message,{errorCode:"collab_nb_metadata_sync_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(Ma.a)(gi.actions.PASTE_CELL,Object(Vi.getType)(ba.a.pasteAbove)),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([e,t])=>{const{contentRef:r,origin:o}=e.payload,s=Ga(n).recorder,{pasteCellId:i,insertAfterId:a}=zi(t,r);return i&&(s.recordInsertCell(i,a),Ua("collab pasteCell recorded","pasteCell",t,o)),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to paste cell: "+e.message,{errorCode:"collab_paste_cell_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(Gi)),Object(wr.withLatestFrom)(t),Object(wr.filter)(([,e])=>"joined"===Si(e)),Object(wr.mergeMap)(([{payload:e}])=>{const{cellId:t,position:r,selection:o}=e;return Ga(n).presence.recordCursorPosition(t,r,o),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to set curson position: "+e.message,{errorCode:"collab_setcursor_position_error",sendToHost:!1})))),(e,t,n)=>e.pipe(Object(wr.filter)(Object(Vi.isActionOf)(ta)),Object(wr.mergeMap)(({payload:e})=>{const{localId:t,remoteId:r}=e;return Ga(n).binder.bindCell(t,r),_r.EMPTY}),Object(wr.catchError)(e=>Object(_r.of)(ra("Failed to update cell binding: "+e.message,{errorCode:"collab_binder_update_error",sendToHost:!1}))))];var Za=n("./node_modules/react/index.js"),Xa=n.n(Za),Ya=n("./node_modules/react-redux/es/index.js"),Qa=Object(Ya.connect)((e,{id:t})=>({sessionStatus:Si(e),hasRemoteCellId:Di(e,t)}),(e,{contentRef:t,id:n})=>({onCursorPositionChange:t=>{if(t){const{positionLineNumber:r,positionColumn:o,selectionStartLineNumber:s,selectionStartColumn:i}=t;e(Gi(n,{line:r,column:o},{lineStart:s,columnStart:i,lineEnd:r,columnEnd:o}))}},attachAdapter:()=>{e(oa(n,t))},detachAdapter:()=>{e(sa(n))}}))(e=>{const{sessionStatus:t,hasRemoteCellId:n,editorFocused:r,attachAdapter:o,detachAdapter:s}=e;Za.useEffect(()=>{"joined"===t&&n&&(r?o():s())},[t,n,r]),Za.useEffect(()=>s,[]);const i=aa.c.EditorComponent;return Za.createElement(i,e)}),eu=n("./node_modules/office-ui-fabric-react/lib/components/Tooltip/TooltipHost.js"),tu=n("./node_modules/office-ui-fabric-react/lib/common/DirectionalHint.js"),nu=n("./node_modules/@uifabric/utilities/lib/styled.js"),ru=n("./node_modules/@uifabric/utilities/lib/classNamesFunction.js"),ou=n("./node_modules/@uifabric/utilities/lib/properties.js"),su=n("./node_modules/office-ui-fabric-react/lib/components/Tooltip/TooltipHost.types.js"),iu=n("./node_modules/@uifabric/utilities/lib/rtl.js"),au=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,uu=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,cu=/\s+/g,du=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;var lu,hu,fu,mu,pu=n("./node_modules/@uifabric/styling/lib/index.js"),gu=n("./node_modules/office-ui-fabric-react/lib/components/Icon/Icon.js");(fu=hu||(hu={})).size8="20px",fu.size10="20px",fu.size16="16px",fu.size24="24px",fu.size28="28px",fu.size32="32px",fu.size40="40px",fu.size48="48px",fu.size56="56px",fu.size72="72px",fu.size100="100px",fu.size120="120px",function(e){e.size6="6px",e.size8="8px",e.size12="12px",e.size16="16px",e.size20="20px",e.size28="28px",e.size32="32px",e.border="2px"}(mu||(mu={}));var bu=function(e){return{isSize8:e===fa.size8,isSize10:e===fa.size10||e===fa.tiny,isSize16:e===fa.size16,isSize24:e===fa.size24||e===fa.extraExtraSmall,isSize28:e===fa.size28||e===fa.extraSmall,isSize32:e===fa.size32,isSize40:e===fa.size40||e===fa.small,isSize48:e===fa.size48||e===fa.regular,isSize56:e===fa.size56,isSize72:e===fa.size72||e===fa.large,isSize100:e===fa.size100||e===fa.extraLarge,isSize120:e===fa.size120}},vu=((lu={})[fa.tiny]=10,lu[fa.extraExtraSmall]=24,lu[fa.extraSmall]=28,lu[fa.small]=40,lu[fa.regular]=48,lu[fa.large]=72,lu[fa.extraLarge]=100,lu[fa.size8]=8,lu[fa.size10]=10,lu[fa.size16]=16,lu[fa.size24]=24,lu[fa.size28]=28,lu[fa.size32]=32,lu[fa.size40]=40,lu[fa.size48]=48,lu[fa.size56]=56,lu[fa.size72]=72,lu[fa.size100]=100,lu[fa.size120]=120,lu),yu=function(e){return{isAvailable:e===ma.online,isAway:e===ma.away,isBlocked:e===ma.blocked,isBusy:e===ma.busy,isDoNotDisturb:e===ma.dnd,isOffline:e===ma.offline}},_u=Object(ru.a)({cacheSize:100}),wu=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderIcon=function(e,t){return Za.createElement(gu.a,{className:e,iconName:ku(n.props.presence,n.props.isOutOfOffice),style:t})},n}return Object(s.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.coinSize,n=e.isOutOfOffice,r=e.styles,o=e.presence,s=e.theme,i=e.presenceTitle,a=e.presenceColors,u=bu(this.props.size),c=!(u.isSize8||u.isSize10||u.isSize16||u.isSize24||u.isSize28||u.isSize32)&&(!t||t>32),d=t?t/3<40?t/3+"px":"40px":"",l=t?{fontSize:t?t/6<20?t/6+"px":"20px":"",lineHeight:d}:void 0,h=t?{width:d,height:d}:void 0,f=_u(r,{theme:s,presence:o,size:this.props.size,isOutOfOffice:n,presenceColors:a});return o===ma.none?null:Za.createElement("div",{role:"presentation",className:f.presence,style:h,title:i},c&&this._onRenderIcon(f.presenceIcon,l))},t}(Za.Component);function ku(e,t){if(e){var n="SkypeArrow";switch(ma[e]){case"online":return"SkypeCheck";case"away":return t?n:"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return t?n:""}return""}}var Su={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};function ju(e){return{color:e,borderColor:e}}function Cu(e,t){return{selectors:{":before":{border:e+" solid "+t}}}}function xu(e){return{height:e,width:e}}function Ou(e){return{backgroundColor:e}}var Eu=Object(nu.a)(wu,(function(e){var t,n,r,o,s,i,a=e.theme,u=e.presenceColors,c=a.semanticColors,d=a.fonts,l=Object(pu.v)(Su,a),h=bu(e.size),f=yu(e.presence),m=u&&u.available||"#6BB700",p=u&&u.away||"#FFAA44",g=u&&u.busy||"#C43148",b=u&&u.dnd||"#C50F1F",v=u&&u.offline||"#8A8886",y=u&&u.oof||"#B4009E",_=u&&u.background||c.bodyBackground,w=f.isOffline||e.isOutOfOffice&&(f.isAvailable||f.isBusy||f.isAway||f.isDoNotDisturb),k=h.isSize72||h.isSize100?"2px":"1px";return{presence:[l.presence,{position:"absolute",height:mu.size12,width:mu.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid "+_,textAlign:"center",boxSizing:"content-box",backgroundClip:"content-box",MsHighContrastAdjust:"none",selectors:(t={},t[pu.e]={borderColor:"Window",backgroundColor:"WindowText"},t)},(h.isSize8||h.isSize10)&&{right:"auto",top:"7px",left:0,border:0,selectors:(n={},n[pu.e]={top:"9px",border:"1px solid WindowText"},n)},(h.isSize8||h.isSize10||h.isSize24||h.isSize28||h.isSize32)&&xu(mu.size8),(h.isSize40||h.isSize48)&&xu(mu.size12),h.isSize16&&{height:mu.size6,width:mu.size6,borderWidth:"1.5px"},h.isSize56&&xu(mu.size16),h.isSize72&&xu(mu.size20),h.isSize100&&xu(mu.size28),h.isSize120&&xu(mu.size32),f.isAvailable&&{backgroundColor:m,selectors:(r={},r[pu.e]=Ou("Highlight"),r)},f.isAway&&Ou(p),f.isBlocked&&[{selectors:(o={":after":h.isSize40||h.isSize48||h.isSize72||h.isSize100?{content:'""',width:"100%",height:k,backgroundColor:g,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},o[pu.e]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},o)}],f.isBusy&&Ou(g),f.isDoNotDisturb&&Ou(b),f.isOffline&&Ou(v),(w||f.isBlocked)&&[{backgroundColor:_,selectors:(s={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:k+" solid "+g,borderRadius:"50%",boxSizing:"border-box"}},s[pu.e]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},s)}],w&&f.isAvailable&&Cu(k,m),w&&f.isBusy&&Cu(k,g),w&&f.isAway&&Cu(k,y),w&&f.isDoNotDisturb&&Cu(k,b),w&&f.isOffline&&Cu(k,v),w&&f.isOffline&&e.isOutOfOffice&&Cu(k,y)],presenceIcon:[l.presenceIcon,{color:_,fontSize:"6px",lineHeight:mu.size12,verticalAlign:"top",selectors:(i={},i[pu.e]={color:"Window"},i)},h.isSize56&&{fontSize:"8px",lineHeight:mu.size16},h.isSize72&&{fontSize:d.small.fontSize,lineHeight:mu.size20},h.isSize100&&{fontSize:d.medium.fontSize,lineHeight:mu.size28},h.isSize120&&{fontSize:d.medium.fontSize,lineHeight:mu.size32},f.isAway&&{position:"relative",left:w?void 0:"1px"},w&&f.isAvailable&&ju(m),w&&f.isBusy&&ju(g),w&&f.isAway&&ju(y),w&&f.isDoNotDisturb&&ju(b),w&&f.isOffline&&ju(v),w&&f.isOffline&&e.isOutOfOffice&&ju(y)]}}),void 0,{scope:"PersonaPresence"}),Iu=n("./node_modules/office-ui-fabric-react/lib/components/Image/Image.js"),Au=n("./node_modules/office-ui-fabric-react/lib/components/Image/Image.types.js"),Nu=Object(ru.a)({cacheSize:100}),Tu=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderCoin=function(e){var t=n.props,r=t.coinSize,o=t.styles,s=t.imageUrl,i=t.imageAlt,a=t.imageShouldFadeIn,u=t.imageShouldStartVisible,c=t.theme,d=t.showUnknownPersonaCoin;if(!s)return null;var l=n.props.size,h=Nu(o,{theme:c,size:l,showUnknownPersonaCoin:d}),f=r||vu[l];return Za.createElement(Iu.a,{className:h.image,imageFit:Au.b.cover,src:s,width:f,height:f,alt:i,shouldFadeIn:a,shouldStartVisible:u,onLoadingStateChange:n._onPhotoLoadingStateChange})},n._onRenderInitials=function(e){var t=e.imageInitials,r=e.allowPhoneInitials;if(e.showUnknownPersonaCoin)return Za.createElement(gu.a,{iconName:"Help"});var o=Object(iu.a)(n.props.theme);return""!==(t=t||function(e,t,n){return e?(e=function(e){return(e=(e=e.replace(au,"")).replace(cu," ")).trim()}(e),du.test(e)||!n&&uu.test(e)?"":function(e,t){var n="",r=e.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}(n._getText(),o,r))?Za.createElement("span",null,t):Za.createElement(gu.a,{iconName:"Contact"})},n._onPhotoLoadingStateChange=function(e){n.setState({isImageLoaded:e===Au.c.loaded,isImageError:e===Au.c.error}),n.props.onPhotoLoadingStateChange&&n.props.onPhotoLoadingStateChange(e)},n.state={isImageLoaded:!1,isImageError:!1},n}return Object(s.d)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.imageUrl!==this.props.imageUrl&&this.setState({isImageLoaded:!1,isImageError:!1})},t.prototype.render=function(){var e=this.props,t=e.className,n=e.coinProps,r=e.showUnknownPersonaCoin,o=e.coinSize,i=e.styles,a=e.imageUrl,u=e.isOutOfOffice,c=e.onRenderCoin,d=void 0===c?this._onRenderCoin:c,l=e.onRenderPersonaCoin,h=void 0===l?d:l,f=e.onRenderInitials,m=void 0===f?this._onRenderInitials:f,p=e.presence,g=e.presenceTitle,b=e.presenceColors,v=e.showInitialsUntilImageLoads,y=e.theme,_=this.props.size,w=Object(ou.d)(this.props,ou.c),k=Object(ou.d)(n||{},ou.c),S=o?{width:o,height:o}:void 0,j=r,C={coinSize:o,isOutOfOffice:u,presence:p,presenceTitle:g,presenceColors:b,size:_,theme:y},x=Nu(i,{theme:y,className:n&&n.className?n.className:t,size:_,coinSize:o,showUnknownPersonaCoin:r}),O=Boolean(!this.state.isImageLoaded&&(v&&a||!a||this.state.isImageError||j));return Za.createElement("div",Object(s.a)({role:"presentation"},w,{className:x.coin}),_!==fa.size8&&_!==fa.size10&&_!==fa.tiny?Za.createElement("div",Object(s.a)({role:"presentation"},k,{className:x.imageArea,style:S}),O&&Za.createElement("div",{className:Object(pu.C)(x.initials,!r&&{backgroundColor:ka(this.props)}),style:S,"aria-hidden":"true"},m(this.props,this._onRenderInitials)),!j&&h(this.props,this._onRenderCoin),Za.createElement(Eu,Object(s.a)({},C))):this.props.presence?Za.createElement(Eu,Object(s.a)({},C)):Za.createElement(gu.a,{iconName:"Contact",className:x.size10WithoutPresenceIcon}),this.props.children)},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.defaultProps={size:fa.size48,presence:ma.none,imageAlt:""},t}(Za.Component),Fu={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120"},Pu=Object(nu.a)(Tu,(function(e){var t,n=e.className,r=e.theme,o=e.coinSize,s=r.palette,i=r.fonts,a=bu(e.size),u=Object(pu.v)(Fu,r),c=o||e.size&&vu[e.size]||48;return{coin:[u.coin,i.medium,a.isSize8&&u.size8,a.isSize10&&u.size10,a.isSize16&&u.size16,a.isSize24&&u.size24,a.isSize28&&u.size28,a.isSize32&&u.size32,a.isSize40&&u.size40,a.isSize48&&u.size48,a.isSize56&&u.size56,a.isSize72&&u.size72,a.isSize100&&u.size100,a.isSize120&&u.size120,n],size10WithoutPresenceIcon:{fontSize:i.xSmall.fontSize,position:"absolute",top:"5px",right:"auto",left:0},imageArea:[u.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:c,width:c},c<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[u.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},c<=10&&{overflow:"visible",background:"transparent",height:0,width:0},c>10&&{height:c,width:c}],initials:[u.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?"rgb(168, 0, 0)":s.white,fontSize:i.large.fontSize,fontWeight:pu.d.semibold,lineHeight:48===c?46:c,height:c,selectors:(t={},t[pu.e]={border:"1px solid WindowText",MsHighContrastAdjust:"none",color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"},t.i={fontWeight:pu.d.semibold},t)},e.showUnknownPersonaCoin&&{backgroundColor:"rgb(234, 234, 234)"},c<32&&{fontSize:i.xSmall.fontSize},c>=32&&c<40&&{fontSize:i.medium.fontSize},c>=40&&c<56&&{fontSize:i.mediumPlus.fontSize},c>=56&&c<72&&{fontSize:i.xLarge.fontSize},c>=72&&c<100&&{fontSize:i.xxLarge.fontSize},c>=100&&{fontSize:i.superLarge.fontSize}]}}),void 0,{scope:"PersonaCoin"}),Ru=Object(ru.a)(),Du=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderPersonaCoin=function(e){return Za.createElement(Pu,Object(s.a)({},e))},n}return Object(s.d)(t,e),t.prototype.render=function(){var e=this._onRenderText(this._getText()),t=this._onRenderText(this.props.secondaryText),n=this._onRenderText(this.props.tertiaryText),r=this._onRenderText(this.props.optionalText),o=this.props,i=o.hidePersonaDetails,a=o.onRenderOptionalText,u=void 0===a?r:a,c=o.onRenderPrimaryText,d=void 0===c?e:c,l=o.onRenderSecondaryText,h=void 0===l?t:l,f=o.onRenderTertiaryText,m=void 0===f?n:f,p=o.onRenderPersonaCoin,g=void 0===p?this._onRenderPersonaCoin:p,b=this.props.size,v=this.props,y=v.allowPhoneInitials,_=v.className,w=v.coinProps,k=v.showUnknownPersonaCoin,S=v.coinSize,j=v.styles,C=v.imageAlt,x=v.imageInitials,O=v.imageShouldFadeIn,E=v.imageShouldStartVisible,I=v.imageUrl,A=v.initialsColor,N=v.isOutOfOffice,T=v.onPhotoLoadingStateChange,F=v.onRenderCoin,P=v.onRenderInitials,R=v.presence,D=v.presenceTitle,M=v.presenceColors,L=v.showInitialsUntilImageLoads,B=v.showSecondaryText,q=v.theme,z=Object(s.a)({allowPhoneInitials:y,showUnknownPersonaCoin:k,coinSize:S,imageAlt:C,imageInitials:x,imageShouldFadeIn:O,imageShouldStartVisible:E,imageUrl:I,initialsColor:A,onPhotoLoadingStateChange:T,onRenderCoin:F,onRenderInitials:P,presence:R,presenceTitle:D,showInitialsUntilImageLoads:L,size:b,text:this._getText(),isOutOfOffice:N,presenceColors:M},w),H=Ru(j,{theme:q,className:_,showSecondaryText:B,presence:R,size:b}),U=Object(ou.d)(this.props,ou.c),V=Za.createElement("div",{className:H.details},this._renderElement(H.primaryText,d,e),this._renderElement(H.secondaryText,h,t),this._renderElement(H.tertiaryText,m,n),this._renderElement(H.optionalText,u,r),this.props.children);return Za.createElement("div",Object(s.a)({},U,{className:H.root,style:S?{height:S,minWidth:S}:void 0}),g(z,this._onRenderPersonaCoin),(!i||b===fa.size8||b===fa.size10||b===fa.tiny)&&V)},t.prototype._renderElement=function(e,t,n){return Za.createElement("div",{dir:"auto",className:e},t&&t(this.props,n))},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.prototype._onRenderText=function(e){return e?function(){return Za.createElement(eu.a,{content:e,overflowMode:su.a.Parent,directionalHint:tu.a.topLeftEdge},e)}:void 0},t.defaultProps={size:fa.size48,presence:ma.none,imageAlt:""},t}(Za.Component),Mu={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"},Lu=Object(nu.a)(Du,(function(e){var t=e.className,n=e.showSecondaryText,r=e.theme,o=r.semanticColors,s=r.fonts,i=Object(pu.v)(Mu,r),a=bu(e.size),u=yu(e.presence),c="16px",d={color:o.bodySubtext,fontWeight:pu.d.regular,fontSize:s.small.fontSize};return{root:[i.root,r.fonts.medium,pu.E,{color:o.bodyText,position:"relative",height:hu.size48,minWidth:hu.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},a.isSize8&&[i.size8,{height:hu.size8,minWidth:hu.size8}],a.isSize10&&[i.size10,{height:hu.size10,minWidth:hu.size10}],a.isSize16&&[i.size16,{height:hu.size16,minWidth:hu.size16}],a.isSize24&&[i.size24,{height:hu.size24,minWidth:hu.size24}],a.isSize24&&n&&{height:"36px"},a.isSize28&&[i.size28,{height:hu.size28,minWidth:hu.size28}],a.isSize28&&n&&{height:"32px"},a.isSize32&&[i.size32,{height:hu.size32,minWidth:hu.size32}],a.isSize40&&[i.size40,{height:hu.size40,minWidth:hu.size40}],a.isSize48&&i.size48,a.isSize56&&[i.size56,{height:hu.size56,minWidth:hu.size56}],a.isSize72&&[i.size72,{height:hu.size72,minWidth:hu.size72}],a.isSize100&&[i.size100,{height:hu.size100,minWidth:hu.size100}],a.isSize120&&[i.size120,{height:hu.size120,minWidth:hu.size120}],u.isAvailable&&i.available,u.isAway&&i.away,u.isBlocked&&i.blocked,u.isBusy&&i.busy,u.isDoNotDisturb&&i.doNotDisturb,u.isOffline&&i.offline,t],details:[i.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(a.isSize8||a.isSize10)&&{paddingLeft:17},(a.isSize24||a.isSize28||a.isSize32)&&{padding:"0 8px"},(a.isSize40||a.isSize48)&&{padding:"0 12px"}],primaryText:[i.primaryText,pu.D,{color:o.bodyText,fontWeight:pu.d.regular,fontSize:s.medium.fontSize,selectors:{":hover":{color:o.inputTextHovered}}},n&&{height:c,lineHeight:c,overflowX:"hidden"},(a.isSize8||a.isSize10)&&{fontSize:s.small.fontSize,lineHeight:hu.size8},a.isSize16&&{lineHeight:hu.size28},(a.isSize24||a.isSize28||a.isSize32||a.isSize40||a.isSize48)&&n&&{height:18},(a.isSize56||a.isSize72||a.isSize100||a.isSize120)&&{fontSize:s.xLarge.fontSize},(a.isSize56||a.isSize72||a.isSize100||a.isSize120)&&n&&{height:22}],secondaryText:[i.secondaryText,pu.D,d,(a.isSize8||a.isSize10||a.isSize16||a.isSize24||a.isSize28||a.isSize32)&&{display:"none"},n&&{display:"block",height:c,lineHeight:c,overflowX:"hidden"},a.isSize24&&n&&{height:18},(a.isSize56||a.isSize72||a.isSize100||a.isSize120)&&{fontSize:s.medium.fontSize},(a.isSize56||a.isSize72||a.isSize100||a.isSize120)&&n&&{height:18}],tertiaryText:[i.tertiaryText,pu.D,d,{display:"none",fontSize:s.medium.fontSize},(a.isSize72||a.isSize100||a.isSize120)&&{display:"block"}],optionalText:[i.optionalText,pu.D,d,{display:"none",fontSize:s.medium.fontSize},(a.isSize100||a.isSize120)&&{display:"block"}],textContent:[i.textContent,pu.D]}}),void 0,{scope:"Persona"});const Bu=e=>Xa.a.createElement(eu.a,{content:e.userName,className:"nb-tooltip",calloutProps:{directionalHint:tu.a.topAutoEdge}},Xa.a.createElement(Lu,{coinProps:{styles:{initials:{color:"white"}}},initialsColor:e.userColor,size:fa.size24,text:e.userName,hidePersonaDetails:!0}));var qu,zu=Object(Ya.connect)((e,t)=>{const{cellId:n}=t;return function(e){const t=Ti(e,n);let r;return t&&(r=Fi(e,t)),{sessionStatus:Si(e),userInfo:r}}})(e=>{const{sessionStatus:t,userInfo:n}=e;return"joined"===t&&n?Xa.a.createElement("div",{className:"collab-output-persona"},Xa.a.createElement(Bu,{userName:n.userName,userColor:n.color})):null});!function(e){e[e.none=0]="none",e[e.descriptive=1]="descriptive",e[e.more=2]="more",e[e.downArrow=3]="downArrow"}(qu||(qu={}));var Hu=n("./node_modules/@uifabric/utilities/lib/initializeComponentRef.js"),Uu=n("./node_modules/@uifabric/utilities/lib/getId.js"),Vu=n("./node_modules/office-ui-fabric-react/lib/components/Button/BaseButton.js"),$u=n("./node_modules/@uifabric/utilities/lib/BaseComponent.js"),Wu=n("./node_modules/@uifabric/utilities/lib/customizations/customizable.js"),Ku=n("./node_modules/@uifabric/utilities/lib/memoize.js"),Gu=n("./node_modules/office-ui-fabric-react/lib/components/Button/BaseButton.styles.js"),Ju=Object(Ku.b)((function(e,t,n){var r=Object(Gu.a)(e),o=Object(pu.p)(r,n);return Object(s.a)(Object(s.a)({},o),{root:[r.root,t,e.fonts.medium,n&&n.root]})})),Zu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=Object(s.e)(e,["className","styles"]),o=Ju(this.props.theme,t,n);return Za.createElement(Vu.a,Object(s.a)({},r,{variantClassName:"ms-Button--facepile",styles:o,onRenderDescription:$u.a}))},Object(s.c)([Object(Wu.a)("FacepileButton",["theme","styles"],!0)],t)}(Za.Component),Xu=Object(ru.a)(),Yu=function(e){function t(t){var n=e.call(this,t)||this;return n._classNames=Xu(n.props.styles,{theme:n.props.theme,className:n.props.className}),n._getPersonaControl=function(e){var t=n.props,r=t.getPersonaProps,o=t.personaSize;return Za.createElement(Lu,Object(s.a)({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:o},r?r(e):null,{styles:{details:{flex:"1 0 auto"}}}))},n._getPersonaCoinControl=function(e){var t=n.props,r=t.getPersonaProps,o=t.personaSize;return Za.createElement(Pu,Object(s.a)({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:o},r?r(e):null))},Object(Hu.a)(n),n._ariaDescriptionId=Object(Uu.a)(),n}return Object(s.d)(t,e),t.prototype.render=function(){var e=this.props.overflowButtonProps,t=this.props,n=t.chevronButtonProps,r=t.maxDisplayablePersonas,o=t.personas,s=t.overflowPersonas,i=t.showAddButton,a=t.ariaLabel,u=this._classNames,c="number"==typeof r?Math.min(o.length,r):o.length;n&&!e&&(e=n);var d=s&&s.length>0,l=d?o:o.slice(0,c),h=(d?s:o.slice(c))||[];return Za.createElement("div",{className:u.root},this.onRenderAriaDescription(),Za.createElement("div",{className:u.itemContainer},i?this._getAddNewElement():null,Za.createElement("ul",{className:u.members,"aria-label":a},this._onRenderVisiblePersonas(l,0===h.length&&1===o.length)),e?this._getOverflowElement(h):null))},t.prototype.onRenderAriaDescription=function(){var e=this.props.ariaDescription,t=this._classNames;return e&&Za.createElement("span",{className:t.screenReaderOnly,id:this._ariaDescriptionId},e)},t.prototype._onRenderVisiblePersonas=function(e,t){var n=this,r=this.props,o=r.onRenderPersona,s=void 0===o?this._getPersonaControl:o,i=r.onRenderPersonaCoin,a=void 0===i?this._getPersonaCoinControl:i;return e.map((function(e,r){var o=t?s(e,n._getPersonaControl):a(e,n._getPersonaCoinControl);return Za.createElement("li",{key:(t?"persona":"personaCoin")+"-"+r,className:n._classNames.member},e.onClick?n._getElementWithOnClickEvent(o,e,r):n._getElementWithoutOnClickEvent(o,e,r))}))},t.prototype._getElementWithOnClickEvent=function(e,t,n){var r=t.keytipProps;return Za.createElement(Zu,Object(s.a)({},Object(ou.d)(t,ou.b),this._getElementProps(t,n),{keytipProps:r,onClick:this._onPersonaClick.bind(this,t)}),e)},t.prototype._getElementWithoutOnClickEvent=function(e,t,n){return Za.createElement("div",Object(s.a)({},Object(ou.d)(t,ou.b),this._getElementProps(t,n)),e)},t.prototype._getElementProps=function(e,t){var n=this._classNames;return{key:(e.imageUrl?"i":"")+t,"data-is-focusable":!0,className:n.itemButton,title:e.personaName,onMouseMove:this._onPersonaMouseMove.bind(this,e),onMouseOut:this._onPersonaMouseOut.bind(this,e)}},t.prototype._getOverflowElement=function(e){switch(this.props.overflowButtonType){case qu.descriptive:return this._getDescriptiveOverflowElement(e);case qu.downArrow:return this._getIconElement("ChevronDown");case qu.more:return this._getIconElement("More");default:return null}},t.prototype._getDescriptiveOverflowElement=function(e){var t=this.props.personaSize;if(!e||e.length<1)return null;var n=e.map((function(e){return e.personaName})).join(", "),r=Object(s.a)({title:n},this.props.overflowButtonProps),o=Math.max(e.length,0),i=this._classNames;return Za.createElement(Zu,Object(s.a)({},r,{ariaDescription:r.title,className:i.descriptiveOverflowButton}),Za.createElement(Pu,{size:t,onRenderInitials:this._renderInitialsNotPictured(o),initialsColor:pa.transparent}))},t.prototype._getIconElement=function(e){var t=this.props,n=t.overflowButtonProps,r=t.personaSize,o=this._classNames;return Za.createElement(Zu,Object(s.a)({},n,{className:o.overflowButton}),Za.createElement(Pu,{size:r,onRenderInitials:this._renderInitials(e,!0),initialsColor:pa.transparent}))},t.prototype._getAddNewElement=function(){var e=this.props,t=e.addButtonProps,n=e.personaSize,r=this._classNames;return Za.createElement(Zu,Object(s.a)({},t,{className:r.addButton}),Za.createElement(Pu,{size:n,onRenderInitials:this._renderInitials("AddFriend")}))},t.prototype._onPersonaClick=function(e,t){e.onClick(t,e),t.preventDefault(),t.stopPropagation()},t.prototype._onPersonaMouseMove=function(e,t){e.onMouseMove&&e.onMouseMove(t,e)},t.prototype._onPersonaMouseOut=function(e,t){e.onMouseOut&&e.onMouseOut(t,e)},t.prototype._renderInitials=function(e,t){var n=this._classNames;return function(){return Za.createElement(gu.a,{iconName:e,className:t?n.overflowInitialsIcon:""})}},t.prototype._renderInitialsNotPictured=function(e){var t=this._classNames;return function(){return Za.createElement("span",{className:t.overflowInitialsIcon},e<100?"+"+e:"99+")}},t.defaultProps={maxDisplayablePersonas:5,personas:[],overflowPersonas:[],personaSize:fa.size32},t}(Za.Component),Qu={root:"ms-Facepile",addButton:"ms-Facepile-addButton ms-Facepile-itemButton",descriptiveOverflowButton:"ms-Facepile-descriptiveOverflowButton ms-Facepile-itemButton",itemButton:"ms-Facepile-itemButton ms-Facepile-person",itemContainer:"ms-Facepile-itemContainer",members:"ms-Facepile-members",member:"ms-Facepile-member",overflowButton:"ms-Facepile-overflowButton ms-Facepile-itemButton"},ec=Object(nu.a)(Yu,(function(e){var t=e.className,n=e.theme,r=e.spacingAroundItemButton,o=void 0===r?2:r,s=n.palette,i=n.fonts,a=Object(pu.v)(Qu,n),u={textAlign:"center",padding:0,borderRadius:"50%",verticalAlign:"top",display:"inline",backgroundColor:"transparent",border:"none",selectors:{"&::-moz-focus-inner":{padding:0,border:0}}};return{root:[a.root,n.fonts.medium,{width:"auto"},t],addButton:[a.addButton,Object(pu.u)(n,{inset:-1}),u,{fontSize:i.medium.fontSize,color:s.white,backgroundColor:s.themePrimary,marginRight:2*o+"px",selectors:{"&:hover":{backgroundColor:s.themeDark},"&:focus":{backgroundColor:s.themeDark},"&:active":{backgroundColor:s.themeDarker},"&:disabled":{backgroundColor:s.neutralTertiaryAlt}}}],descriptiveOverflowButton:[a.descriptiveOverflowButton,Object(pu.u)(n,{inset:-1}),u,{fontSize:i.small.fontSize,color:s.neutralSecondary,backgroundColor:s.neutralLighter,marginLeft:2*o+"px"}],itemButton:[a.itemButton,u],itemContainer:[a.itemContainer,{display:"flex"}],members:[a.members,{display:"flex",overflow:"hidden",listStyleType:"none",padding:0,margin:"-"+o+"px"}],member:[a.member,{display:"inline-flex",flex:"0 0 auto",margin:o+"px"}],overflowButton:[a.overflowButton,Object(pu.u)(n,{inset:-1}),u,{fontSize:i.medium.fontSize,color:s.neutralSecondary,backgroundColor:s.neutralLighter,marginLeft:2*o+"px"}],overflowInitialsIcon:[{color:s.neutralPrimary}],screenReaderOnly:pu.z}}),void 0,{scope:"Facepile"}),tc=n("./src/common/theme/index.ts"),nc=n("./node_modules/office-ui-fabric-react/lib/components/Stack/Stack.js"),rc=n("./node_modules/office-ui-fabric-react/lib/components/Callout/Callout.js"),oc=n("./node_modules/@uifabric/foundation/lib/createComponent.js"),sc=n("./node_modules/@uifabric/foundation/lib/slots.js"),ic=Object(oc.a)((function(e){if(0===Za.Children.count(e.children))return null;e.block,e.className;var t=e.as,n=void 0===t?"span":t,r=(e.variant,e.nowrap,Object(s.e)(e,["block","className","as","variant","nowrap"])),o=Object(sc.b)(e,{root:n});return Object(sc.c)(o.root,Object(s.a)({},Object(ou.d)(r,ou.e)))}),{displayName:"Text",styles:function(e,t){var n=e.as,r=e.className,o=e.block,s=e.nowrap,i=e.variant,a=t.fonts[i||"medium"];return{root:[t.fonts.medium,{display:o?"td"===n?"table-cell":"block":"inline",fontFamily:a.fontFamily,fontSize:a.fontSize,fontWeight:a.fontWeight,color:a.color,mozOsxFontSmoothing:a.MozOsxFontSmoothing,webkitFontSmoothing:a.WebkitFontSmoothing},s&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},r]}}});const ac=tc.k.div`
  max-width: 150px;
  padding-left: 10px;
`,uc=e=>e?Xa.a.createElement(Bu,{userName:e.data.userName,userColor:e.initialsColor}):null,cc={personas:[],maxDisplayablePersonas:4,overflowButtonType:qu.descriptive,overflowButtonProps:{},ariaDescription:"To move through the items use left and right arrow keys.",personaSize:10,getPersonaProps:()=>({hidePersonaDetails:!0,styles:{initials:{color:"white"}},coinProps:{styles:{initials:{color:"white"}}}}),onRenderPersonaCoin:uc,onRenderPersona:uc};var dc=Object(Ya.connect)(e=>{const t=Ci(e),n=ki(e);return{sessionStatus:Si(e),peers:t?[...t.values()].map(e=>e.toJS()).filter(e=>e.userId!==n&&e.presence===Ke.active):[]}})(e=>{const{sessionStatus:t,peers:n}=e;if("joined"===t&&n){const e=n.map(e=>({data:{userName:e.userName,userId:e.userId,presence:e.presence}})),t=e.slice(4,e.length).filter(e=>"active"===e.data.presence),r=Xa.a.useRef(null),[o,s]=Object(Za.useState)(!1),i=e=>{s(!o)},a=Object.assign(Object.assign({},cc),{personas:[...e],overflowButtonProps:{elementRef:r,ariaLabel:"More users",onClick:i}}),u=o?Xa.a.createElement(rc.a,{className:"collab-personas-callout",ariaLabelledBy:"personas-callout-label",ariaDescribedBy:"personas-callout-description",directionalHint:6,role:"alertdialog",gapSpace:0,target:r.current,onDismiss:i},Xa.a.createElement("div",{className:"collab-personas-callout-content"},Xa.a.createElement(ic,{id:"personas-callout-label"},"Also here: ",t.length),Xa.a.createElement(nc.a,{className:"collab-personas-callout-stack",tokens:{childrenGap:10}},t.map(e=>Xa.a.createElement(Lu,{text:e.data.userName,secondaryText:"active"===e.data.presence?"Has this document open":e.data.presence,showSecondaryText:!0,size:fa.size32}))))):null;return Xa.a.createElement(ac,null,Xa.a.createElement(ec,Object.assign({},a)),u)}return null}),lc=n("./node_modules/styled-components/dist/styled-components.browser.esm.js");class hc extends Xa.a.PureComponent{constructor(){super(...arguments),this.decorators=[]}componentDidMount(){const e=aa.c.DocumentUri.createCellUri(this.props.contentRef,this.props.cellId,this.props.languageId),t=aa.c.editor.getModel(e);t&&(this.decorators=t.deltaDecorations(this.decorators,this.renderDecorator(e)))}componentDidUpdate(e){const t=aa.c.DocumentUri.createCellUri(this.props.contentRef,this.props.cellId,this.props.languageId),n=e?aa.c.DocumentUri.createCellUri(e.contentRef,e.cellId,e.languageId):void 0;if(n&&n!==t){const e=aa.c.editor.getModel(n);e&&(this.decorators=e.deltaDecorations(this.decorators,[]))}const r=aa.c.editor.getModel(t);r&&(this.decorators=r.deltaDecorations(this.decorators,this.renderDecorator(t)))}componentWillUnmount(){const e=aa.c.DocumentUri.createCellUri(this.props.contentRef,this.props.cellId,this.props.languageId),t=aa.c.editor.getModel(e);t&&(this.decorators=t.deltaDecorations(this.decorators,[]))}render(){return null}renderDecorator(e){return[]}}var fc=Object(lc.default)(class extends hc{renderDecorator(){return[{range:aa.c.Range.fromPositions(this.props.position),options:{beforeContentClassName:this.props.className,stickiness:aa.c.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges}}]}})`
  ::before {
    color: ${e=>e.cursorColor} !important;
    content: "";
    text-decoration: none;
    margin: 0px 0px 0px -${e=>1===e.position.column?"0.17":"0.25"}ch;
    position: absolute;
    display: inline-block;
    top: 0;
    font-size: 200%;
    font-weight: bold;
    z-index: 1;
  }
`,mc=Object(lc.default)(class extends hc{renderDecorator(){return[{range:aa.c.Range.fromPositions(this.props.position),options:{afterContentClassName:this.props.className,stickiness:aa.c.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,zIndex:99}}]}})`
  ::after {
    content: "${e=>e.tagText}";
    background-color: ${e=>e.tagColor};
    text-decoration: none;
    position: absolute;
    top: -0.75rem;
    border-radius: 0.15rem;
    padding: 0px 0.5ch;
    display: inline-block;
    pointer-events: none;
    color: white !important;
    font-size: 0.7rem;
    z-index: 1;
    font-weight: bold;
  }
`,pc=n("./node_modules/color-string/index.js"),gc=Object(lc.default)(class extends hc{renderDecorator(){const e=this.props.selection;return!e||e.isEmpty()?[]:[{range:e,options:{inlineClassName:this.props.className,hoverMessage:{value:this.props.hoverText||""}}}]}})`
  background-color: ${e=>function(e,t){const n=pc.get.rgb(e);return n?(t=Math.min(1,Math.max(0,t)),n[3]=t,pc.to.rgb(n)):e}(e.selectionColor,.35)};
  border-radius: 0.1rem;
`;class bc extends Xa.a.PureComponent{render(){const{contentRef:e,presence:t}=this.props;return t?Xa.a.createElement(Xa.a.Fragment,null,this.renderCursorDecorators(e,t),this.renderTagDecorators(e,t),this.renderSelectionDecorators(e,t)):null}renderCursorDecorators(e,t){return t.map(t=>{const{line:n,column:r}=t.location.cursorPosition;return Xa.a.createElement(fc,{key:t.id,cursorColor:t.color,contentRef:e,cellId:t.location.focusedCell,position:{lineNumber:n,column:r},languageId:t.languageId})})}renderTagDecorators(e,t){return t.map(t=>{const{line:n,column:r}=t.location.cursorPosition;return Xa.a.createElement(mc,{key:t.id,tagColor:t.color,tagText:t.name,contentRef:e,cellId:t.location.focusedCell,position:{lineNumber:n,column:r},languageId:t.languageId})})}renderSelectionDecorators(e,t){return t.map(t=>{const{lineStart:n,columnStart:r,lineEnd:o,columnEnd:s}=t.location.selectionRange,i=new aa.c.Range(n,r,o,s);return Xa.a.createElement(gc,{key:t.id,selectionColor:t.color,hoverText:t.name,contentRef:e,cellId:t.location.focusedCell,selection:i,languageId:t.languageId})})}}var vc=Object(Ya.connect)(e=>{const t=Object(hi.activeContentRef)(e),n=Ci(e),r=xi(e);if(r&&n){const o=r.toArray().filter(([,e])=>e.get("userId")&&e.get("location")&&n.has(e.get("userId"))).map(([r,o])=>{const s=o.toJS(),i=n.get(s.userId).toJSON();return{id:r,name:i.userName,color:i.color||"grey",location:s.location,languageId:aa.c.getCellLanguage(e,t,s.location.focusedCell)}});return{sessionStatus:Si(e),contentRef:t,presence:o}}return{sessionStatus:Si(e),contentRef:t}})(bc)},17:function(e,t){},18:function(e,t){}}]);